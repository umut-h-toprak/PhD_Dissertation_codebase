!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=354)}([function(e,t){e.exports=jQuery},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.polarToCartesian=function(e,t){return t-=.5*Math.PI,[e*Math.cos(t),e*Math.sin(t)]},t.cartesianToPolar=function(e,t,n,r){var o=[Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),Math.atan((r-t)/(n-e))+.5*Math.PI];return n<e&&(o[1]+=Math.PI),o},t.range=function(e,t,n){for(var r=[];(t-e)*n>0;e+=n)r.push(e);return r},t.discreteColourGrayRed=function(){return["#808080","#e41a1c"]},t.discreteColour=function(e){switch(e){case 1:return["#0000ff"];case 2:return["#0000ff","#e41a1c"];case 3:return["#e41a1c","#0000ff","#000000"];case 4:return["#e41a1c","#0000ff","#4daf4a","#000000"];case 5:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#000000"];case 6:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#ff7f00","#000000"];case 7:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#ff7f00","#a65628","#000000"];case 8:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#ff7f00","#a65628","#f781bf","#000000"];case 9:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#ff7f00","#a65628","#f781bf","#999999","#000000"];case 10:return["#e41a1c","#0000ff","#4daf4a","#984ea3","#ff7f00","#a65628","#f781bf","#999999","#ffff33","#000000"];case 11:return["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#000000"];case 12:return["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#000000"];case 13:return["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928","#000000"];case 14:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#8c564b","#e377c2","#f7b6d2","#7f7f7f","#17becf","#000000"];case 15:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#8c564b","#e377c2","#f7b6d2","#7f7f7f","#bcbd22","#17becf","#000000"];case 16:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#bcbd22","#17becf","#000000"];case 17:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#17becf","#000000"];case 18:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#17becf","#000000"];case 19:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#17becf","#9edae5","#000000"];case 20:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#17becf","#9edae5","#000000"];case 21:return["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5","#000000"];default:for(var t=[],n=0;n<e;++n)t.push(c(e,n));return t}},t.clearAnnotations=function(){e("#smallVariantCounter").empty(),e("#midSizedSvCounter").empty(),e("#vdjSvCounter").empty(),e("#svCounter").empty(),e("#svDescription").empty(),e("#vdjSvDescription").empty(),e("#midSizedSvDescription").empty(),e("#smallVariantDescription").empty(),e('.nav-tabs a[href="#controlsPane"]').tab("show"),e("#tmpDonorTracer").remove()},t.cleanup=function(){o(["cohortSelectorGroup","subcohortSelectorGroup","mainContentControl","cohortMetadataContentControl","phenotypeExpressionContentPaneControl","survivalContentPaneControl","flexiblePlotsContentPaneControl","heatmapContentPaneControl","heatmapSubmit","cytobandDescriptionPaneControl","svDescriptionPaneControl","midSizedSvDescriptionPaneControl","vdjSvDescriptionPaneControl","smallVariantDescriptionPaneControl","tadDescriptionPaneControl","geneRecDescriptionPaneControl","helpPaneControl","cohortDescriptionPaneControl","variantGeneExpressionVolcanoControls","correlationGeneExpressionVolcanoControls","subcohortGeneExpressionVolcanoControls","variantGeneExpressionVolcanoContentPaneControl","correlationGeneExpressionVolcanoContentPaneControl","subcohortGeneExpressionVolcanoContentPaneControl","variantRppaExpressionVolcanoControls","correlationRppaExpressionVolcanoControls","subcohortRppaExpressionVolcanoControls","variantRppaExpressionVolcanoContentPaneControl","correlationRppaExpressionVolcanoContentPaneControl","subcohortRppaExpressionVolcanoContentPaneControl","subcohortMutexVolcanoControls","subcohortMutexVolcanoContentPaneControl","volcanoGeneDescriptionPaneControl","volcanoControls","selectorControlsCollapseControl","fontControlsCollapseControl","antibodySelectorGroup","volcanoSpecificGeneSelectorControls","geneSelectorControlsForMarkedGenes","geneSelectorControlsForMarkedGenesVolcanoSpecific","clearMarkedCytobands","expressionControls","metadataControls","complexSelectionCollapseControl","selectionToCategoricalCollapseControl","categoricalToSelectionCollapseControl","complexSelectionQueryBuilderGet","flexiblePlotControls","heatmapControls","survivalControls","resetFocus","variantDisplayControls","svgDownloader","heatmapClusteringChoicesCollapseControl","heatmapSubcohortMarkerGroup","subcohortSelectionFromHeatmapGroup"],[]),e("#geneExpressionContentVolcano").empty(),e("#rppaExpressionContentVolcano").empty(),e("#geneSelector").val(""),e("#chromosomeArmSelector").val(""),e("#cytobandSelector").val(""),e("#geneMarker").val(""),e("#cytobandMarker").val(""),e("#igTraMode").prop("checked",!1),e("#fontControlsCollapse").collapse("hide"),e("#selectionToCategoricalCollapse").collapse("hide"),e("#complexSelectionCollapse").collapse("hide"),e("#miniSelectionCollapse").collapse("hide"),e("#selectorControlsCollapse").collapse("hide"),e("#chromosomalSizeControlsCollapse").collapse("hide"),e("#aestheticsCollapse").collapse("hide"),e("#helpPaneControl").css("display","inline"),e("#cohortDescriptionPaneControl").css("display","inline"),e("#survivalContent").empty(),e("#expressionContent").empty(),e("#correlationGeneExpressionVolcanoGeneExpressionContentAux").empty(),e("#subcohortGeneExpressionVolcanoGeneExpressionContentAux").empty(),e("#subcohortMutexVolcanoGeneExpressionContentAux").empty(),e("#correlationRppaExpressionVolcanoGeneExpressionContentAux").empty(),e("#subcohortRppaExpressionVolcanoGeneExpressionContentAux").empty(),e("#variantGeneExpressionVolcanoGeneExpressionContentAux").empty(),e("#subcohortSelector").empty(),e("#subcohortSelectorFlexiblePlotGrid").empty(),e("#subcohortSelectorFlexiblePlotGridDefault").empty(),e("#flexibleSubcohortSelector").empty(),e("#flexibleSubcohortSelectorManifold").empty(),e("#groupSelectorSinglePhenotypeSelector1").empty(),e("#groupSelectorSinglePhenotypeSelector2").empty(),e("#heatmapSubcohortMarkerSelector").empty(),e("#miniSelectionBuilderSubgroupSelector").empty(),e("#subcohortDiffSelector").empty().append('<option value="-1">as-is</option>'),e("#singleDonorSelector").empty().append('<option value="-1">Select Donor</option>'),e("#mainContent").empty(),e("#wheelControls").empty(),e("#cohortMetadataTable").empty(),e("#volcanoControls").empty(),e("#flexiblePlotsContentMain").empty(),e("#heatmapContent").empty(),e("#heatmapDistanceSelector").val("-1"),e("#heatmapLinkageSelector").val("-1"),e("#geneExpressionContent").empty(),e("#rppaExpressionContent").empty(),e("#variantGeneExpressionVolcanoContent").empty(),e("#variantRppaExpressionVolcanoContent").empty(),e("#correlationGeneExpressionVolcanoContent").empty(),e("#subcohortGeneExpressionVolcanoContent").empty(),e("#subcohortMutexVolcanoContent").empty(),e("#subcohortRppaExpressionVolcanoContent").empty(),e("#antibodySelectorGroup").css("display","none"),e("#vdjTraModeGroup").css("display","none"),e("#vdjTraMode").prop("checked",!1),e("#numGridCellsXController").slider().slider("setValue",1).slider("refresh"),e("#numGridCellsYController").slider().slider("setValue",1).slider("refresh")},t.eqSet=function(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,o=void 0;try{for(var i,a=e[Symbol.iterator]();!(n=(i=a.next()).done);n=!0){var s=i.value;if(!t.has(s))return!1}}catch(e){r=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(r)throw o}}return!0},t.countCharacters=function(e,t){for(var n=-1,r=0;-1!==r;r=e.indexOf(t,r+1))n++;return n},t.shuff=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}},t.padENSG=function(e){var t=e.toString();return"ENSG"+"0".repeat(11-t.length)+t},t.padSE=function(e){var t=e.toString();return"SE_"+"0".repeat(5-t.length)+e},t.searchInPubMed=function(e,t){return'<a href="https://www.ncbi.nlm.nih.gov/pubmed?term=('+t.join(" OR ")+") AND "+e+'" target="_blank">'+e+"</a>"},t.getGenomeBrowserLink=function(e){return'<a href="https://genome.ucsc.edu/cgi-bin/hgTracks?org=human&db=hg19&position=chr'+e+'" target="_blank">'+e+"</a>"},t.getReactomeLink=function(e,t){return'<a href="https://reactome.org/PathwayBrowser/#/R-HSA-'+e+'" target="_blank">'+t+"</a>"},t.switchElements=o,t.transpose=function(e){for(var t=0;t<e.length;t++)for(var n=0;n<t;n++){var r=e[t][n];e[t][n]=e[n][t],e[n][t]=r}},t.transitionToVariantScreen=function(t){e("#mainContentPane").parent().addClass("active").siblings().removeClass("active"),e("#mainContent").addClass("active").siblings().removeClass("active"),e('.nav-tabs a[href="#controlsPane"]').tab("show"),e("#volcanoGeneDescriptionPaneControl").css("display","none"),t.markedGenes.size>0||t.hyperzoomMarkedGenes.size>0||t.volcanoMarkedGenes.size>0?e("#geneSelectorControlsForMarkedGenes").css("display","inline"):e("#geneSelectorControlsForMarkedGenes").css("display","none")},t.saveSvg=function(t,n){n=n.replace(/\//g,"of");var o=e("#"+t),i=o.attr("viewBox"),a=o.attr("height"),s=o.attr("width");o.attr("width",screen.height*.85.toString()),o.attr("height",screen.height*.85.toString());try{var l=document.querySelector("#"+t),c=new r;setTimeout(function(){c.asSvg(l,n),o.attr("viewBox",i),o.attr("width",s),o.attr("height",a)},0)}catch(e){console.error(e)}},t.variance=function(e){for(var t=0;t<e.length;++t);},t.getTestFullName=function(e){return i.has(e)?i.get(e):""},t.binary_to_std=function e(t){return t.left&&t.right?t.children=[e(t.left),e(t.right)]:t.left?t.children=[e(t.left)]:t.right&&(t.children=[e(t.right)]),t},t.recursive_sort=a,t.tcmp=s,t.canonical_sort=function(e){return a(e,s)},t.zip=l,t.depadTree=function e(t){t.right&&e(t.right),t.left?e(t.left):t.right||(t.identifier=t.value.pop())},t.getTreeLeaves=function(e){var t=[];return function e(n){if(n.left||n.right)return n.left&&e(n.left),n.right&&e(n.right),[];t.push(n.identifier)}(e),t},t.selectTextFromDivAndCopy=function(e){var t=document.getElementById(e),n=document.createRange();n.selectNodeContents(t),window.getSelection().removeAllRanges(),window.getSelection().addRange(n),document.execCommand("copy")},t.getAngles=function(e,t){return[t.genomicTheta(e.chromosomeIndex,e.startPos),t.genomicTheta(e.chromosomeIndex,e.endPos)]},t.linspace=function(e,t,n){for(var r=[],o=e,i=(t-e)/(n-1),a=0;a<n;++a)r.push(o+i*a);return r},t.rainbow=c,t.currentTime=function(){var e=new Date;return e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},t.generalizedSliderEvents=function(t,n,r,o){e("#"+t).slider().off("change").on("change",function(){e("#"+t+"Label").html(r+" "+n(+e(this).val()))}).off("slideStop").on("slideStop",function(){var t=this;setTimeout(function(){o(+e(t).val())},0)})};var r=n(349);function o(t,n){for(var r=0;r<t.length;++r)e("#"+t[r]).css("display","none");for(var o=0;o<n.length;++o)e("#"+n[o]).css("display","inline")}var i=new Map;function a(e,t,n){for(var r=e.children?e.children:[],o=0;o<r.length;++o)a(r[o],t,n);return n&&n(e),r.sort(t)}function s(e,t){for(var n=null!=e.children?e.children:[],r=null!=t.children?t.children:[],o=l(n,r),i=0;i<o.length;++i){var a=s(o[i][0],o[i][1]);if(0!==a)return a}return r.length-n.length}function l(){var e=[].slice.call(arguments);return(0===e.length?[]:e.reduce(function(e,t){return e.length<t.length?e:t})).map(function(t,n){return e.map(function(e){return e[n]})})}function c(e,t){var n=void 0,r=void 0,o=void 0,i=t/e,a=~~(6*i),s=6*i-a,l=1-s;switch(a%6){case 0:n=1,r=s,o=0;break;case 1:n=l,r=1,o=0;break;case 2:n=0,r=1,o=s;break;case 3:n=0,r=l,o=1;break;case 4:n=s,r=0,o=1;break;case 5:n=1,r=0,o=l}return"#"+("00"+(~~(255*n)).toString(16)).slice(-2)+("00"+(~~(255*r)).toString(16)).slice(-2)+("00"+(~~(255*o)).toString(16)).slice(-2)}i.set("Jf","Fisher's Exact Test on Jenk-Optimized Breaks"),i.set("Kw","Kruskal-Wallis Test"),i.set("Ks","Kolmogorov-Smirnov Test"),i.set("T","T-test")}).call(this,n(0))},function(e,t,n){"use strict";n.r(t);var r="http://www.w3.org/1999/xhtml",o={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},i=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),o.hasOwnProperty(t)?{space:o[t],local:e}:e},a=function(e){var t=i(e);return(t.local?function(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===r&&t.documentElement.namespaceURI===r?t.createElement(e):t.createElementNS(n,e)}})(t)};function s(){}var l=function(e){return null==e?s:function(){return this.querySelector(e)}};function c(){return[]}var A=function(e){return null==e?c:function(){return this.querySelectorAll(e)}},u=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var h=document.documentElement;if(!h.matches){var d=h.webkitMatchesSelector||h.msMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector;u=function(e){return function(){return d.call(this,e)}}}}var f=u,p=function(e){return new Array(e.length)};function g(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}g.prototype={constructor:g,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var m="$";function v(e,t,n,r,o,i){for(var a,s=0,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],r[s]=a):n[s]=new g(e,i[s]);for(;s<l;++s)(a=t[s])&&(o[s]=a)}function y(e,t,n,r,o,i,a){var s,l,c,A={},u=t.length,h=i.length,d=new Array(u);for(s=0;s<u;++s)(l=t[s])&&(d[s]=c=m+a.call(l,l.__data__,s,t),c in A?o[s]=l:A[c]=l);for(s=0;s<h;++s)(l=A[c=m+a.call(e,i[s],s,i)])?(r[s]=l,l.__data__=i[s],A[c]=null):n[s]=new g(e,i[s]);for(s=0;s<u;++s)(l=t[s])&&A[d[s]]===l&&(o[s]=l)}function b(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var I=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function x(e,t){return e.style.getPropertyValue(t)||I(e).getComputedStyle(e,null).getPropertyValue(t)}function w(e){return e.trim().split(/^|\s+/)}function C(e){return e.classList||new E(e)}function E(e){this._node=e,this._names=w(e.getAttribute("class")||"")}function S(e,t){for(var n=C(e),r=-1,o=t.length;++r<o;)n.add(t[r])}function M(e,t){for(var n=C(e),r=-1,o=t.length;++r<o;)n.remove(t[r])}function k(){this.textContent=""}function B(){this.innerHTML=""}function D(){this.nextSibling&&this.parentNode.appendChild(this)}function P(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Q(){return null}function T(){var e=this.parentNode;e&&e.removeChild(this)}function G(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function R(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}E.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var _={},V=null;function N(e,t,n){return e=F(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function F(e,t,n){return function(r){var o=V;V=r;try{e.call(this,this.__data__,t,n)}finally{V=o}}}function O(e){return function(){var t=this.__on;if(t){for(var n,r=0,o=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?t.length=o:delete this.__on}}}function L(e,t,n){var r=_.hasOwnProperty(e.type)?N:F;return function(o,i,a){var s,l=this.__on,c=r(t,i,a);if(l)for(var A=0,u=l.length;A<u;++A)if((s=l[A]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=t);this.addEventListener(e.type,c,n),s={type:e.type,name:e.name,value:t,listener:c,capture:n},l?l.push(s):this.__on=[s]}}function j(e,t,n,r){var o=V;e.sourceEvent=V,V=e;try{return t.apply(n,r)}finally{V=o}}function z(e,t,n){var r=I(e),o=r.CustomEvent;"function"==typeof o?o=new o(t,n):(o=r.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(_={mouseenter:"mouseover",mouseleave:"mouseout"}));var H=[null];function U(e,t){this._groups=e,this._parents=t}function Y(){return new U([[document.documentElement]],H)}U.prototype=Y.prototype={constructor:U,select:function(e){"function"!=typeof e&&(e=l(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a,s=t[o],c=s.length,A=r[o]=new Array(c),u=0;u<c;++u)(i=s[u])&&(a=e.call(i,i.__data__,u,s))&&("__data__"in i&&(a.__data__=i.__data__),A[u]=a);return new U(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=A(e));for(var t=this._groups,n=t.length,r=[],o=[],i=0;i<n;++i)for(var a,s=t[i],l=s.length,c=0;c<l;++c)(a=s[c])&&(r.push(e.call(a,a.__data__,c,s)),o.push(a));return new U(r,o)},filter:function(e){"function"!=typeof e&&(e=f(e));for(var t=this._groups,n=t.length,r=new Array(n),o=0;o<n;++o)for(var i,a=t[o],s=a.length,l=r[o]=[],c=0;c<s;++c)(i=a[c])&&e.call(i,i.__data__,c,a)&&l.push(i);return new U(r,this._parents)},data:function(e,t){if(!e)return d=new Array(this.size()),c=-1,this.each(function(e){d[++c]=e}),d;var n=t?y:v,r=this._parents,o=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var i=o.length,a=new Array(i),s=new Array(i),l=new Array(i),c=0;c<i;++c){var A=r[c],u=o[c],h=u.length,d=e.call(A,A&&A.__data__,c,r),f=d.length,p=s[c]=new Array(f),g=a[c]=new Array(f);n(A,u,p,g,l[c]=new Array(h),d,t);for(var m,b,I=0,x=0;I<f;++I)if(m=p[I]){for(I>=x&&(x=I+1);!(b=g[x])&&++x<f;);m._next=b||null}}return(a=new U(a,r))._enter=s,a._exit=l,a},enter:function(){return new U(this._enter||this._groups.map(p),this._parents)},exit:function(){return new U(this._exit||this._groups.map(p),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var l,c=t[s],A=n[s],u=c.length,h=a[s]=new Array(u),d=0;d<u;++d)(l=c[d]||A[d])&&(h[d]=l);for(;s<r;++s)a[s]=t[s];return new U(a,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,o=e[t],i=o.length-1,a=o[i];--i>=0;)(r=o[i])&&(a&&a!==r.nextSibling&&a.parentNode.insertBefore(r,a),a=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=b);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var a,s=n[i],l=s.length,c=o[i]=new Array(l),A=0;A<l;++A)(a=s[A])&&(c[A]=a);c.sort(t)}return new U(o,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],o=0,i=r.length;o<i;++o){var a=r[o];if(a)return a}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var o,i=t[n],a=0,s=i.length;a<s;++a)(o=i[a])&&e.call(o,o.__data__,a,i);return this},attr:function(e,t){var n=i(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):x(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function(e){return function(){delete this[e]}}:"function"==typeof t?function(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=w(e+"");if(arguments.length<2){for(var r=C(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof t?function(e,t){return function(){(t.apply(this,arguments)?S:M)(this,e)}}:t?function(e){return function(){S(this,e)}}:function(e){return function(){M(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?k:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?B:("function"==typeof e?function(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(D)},lower:function(){return this.each(P)},append:function(e){var t="function"==typeof e?e:a(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:a(e),r=null==t?Q:"function"==typeof t?t:l(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(T)},clone:function(e){return this.select(e?R:G)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,o,i=function(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(s=t?L:O,null==n&&(n=!1),r=0;r<a;++r)this.each(s(i[r],t,n));return this}var s=this.node().__on;if(s)for(var l,c=0,A=s.length;c<A;++c)for(r=0,l=s[c];r<a;++r)if((o=i[r]).type===l.type&&o.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"==typeof t?function(e,t){return function(){return z(this,e,t.apply(this,arguments))}}:function(e,t){return function(){return z(this,e,t)}})(e,t))}};var X=Y,q=function(e){return"string"==typeof e?new U([[document.querySelector(e)]],[document.documentElement]):new U([[e]],H)},K=function(e){return q(a(e).call(document.documentElement))},Z=0;function W(){return new J}function J(){this._="@"+(++Z).toString(36)}J.prototype=W.prototype={constructor:J,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};var $=function(){for(var e,t=V;e=t.sourceEvent;)t=e;return t},ee=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]},te=function(e){var t=$();return t.changedTouches&&(t=t.changedTouches[0]),ee(e,t)},ne=function(e){return"string"==typeof e?new U([document.querySelectorAll(e)],[document.documentElement]):new U([null==e?[]:e],H)},re=function(e,t,n){arguments.length<3&&(n=t,t=$().changedTouches);for(var r,o=0,i=t?t.length:0;o<i;++o)if((r=t[o]).identifier===n)return ee(e,r);return null},oe=function(e,t){null==t&&(t=$().touches);for(var n=0,r=t?t.length:0,o=new Array(r);n<r;++n)o[n]=ee(e,t[n]);return o};n.d(t,"create",function(){return K}),n.d(t,"creator",function(){return a}),n.d(t,"local",function(){return W}),n.d(t,"matcher",function(){return f}),n.d(t,"mouse",function(){return te}),n.d(t,"namespace",function(){return i}),n.d(t,"namespaces",function(){return o}),n.d(t,"clientPoint",function(){return ee}),n.d(t,"select",function(){return q}),n.d(t,"selectAll",function(){return ne}),n.d(t,"selection",function(){return X}),n.d(t,"selector",function(){return l}),n.d(t,"selectorAll",function(){return A}),n.d(t,"style",function(){return x}),n.d(t,"touch",function(){return re}),n.d(t,"touches",function(){return oe}),n.d(t,"window",function(){return I}),n.d(t,"event",function(){return V}),n.d(t,"customEvent",function(){return j})},function(e,t,n){"use strict";var r=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function o(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function i(){}var a="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3})$/,A=/^#([0-9a-f]{6})$/,u=new RegExp("^rgb\\("+[a,a,a]+"\\)$"),h=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),d=new RegExp("^rgba\\("+[a,a,a,s]+"\\)$"),f=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),p=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function v(e){var t;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?new w((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=A.exec(e))?y(parseInt(t[1],16)):(t=u.exec(e))?new w(t[1],t[2],t[3],1):(t=h.exec(e))?new w(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=d.exec(e))?b(t[1],t[2],t[3],t[4]):(t=f.exec(e))?b(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=p.exec(e))?E(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?E(t[1],t[2]/100,t[3]/100,t[4]):m.hasOwnProperty(e)?y(m[e]):"transparent"===e?new w(NaN,NaN,NaN,0):null}function y(e){return new w(e>>16&255,e>>8&255,255&e,1)}function b(e,t,n,r){return r<=0&&(e=t=n=NaN),new w(e,t,n,r)}function I(e){return e instanceof i||(e=v(e)),e?new w((e=e.rgb()).r,e.g,e.b,e.opacity):new w}function x(e,t,n,r){return 1===arguments.length?I(e):new w(e,t,n,null==r?1:r)}function w(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function C(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function E(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new M(e,t,n,r)}function S(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof M)return new M(e.h,e.s,e.l,e.opacity);if(e instanceof i||(e=v(e)),!e)return new M;if(e instanceof M)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,o=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,l=a-o,c=(a+o)/2;return l?(s=t===a?(n-r)/l+6*(n<r):n===a?(r-t)/l+2:(t-n)/l+4,l/=c<.5?a+o:2-a-o,s*=60):l=c>0&&c<1?0:s,new M(s,l,c,e.opacity)}(e):new M(e,t,n,null==r?1:r)}function M(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function k(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r(i,v,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),r(w,x,o(i,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new w(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+C(this.r)+C(this.g)+C(this.b)},toString:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),r(M,S,o(i,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new M(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new M(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,o=2*n-r;return new w(k(e>=240?e-240:e+120,o,r),k(e,o,r),k(e<120?e+240:e-120,o,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var B=Math.PI/180,D=180/Math.PI,P=.96422,Q=1,T=.82521,G=4/29,R=6/29,_=3*R*R,V=R*R*R;function N(e){if(e instanceof O)return new O(e.l,e.a,e.b,e.opacity);if(e instanceof Y){if(isNaN(e.h))return new O(e.l,0,0,e.opacity);var t=e.h*B;return new O(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof w||(e=I(e));var n,r,o=H(e.r),i=H(e.g),a=H(e.b),s=L((.2225045*o+.7168786*i+.0606169*a)/Q);return o===i&&i===a?n=r=s:(n=L((.4360747*o+.3850649*i+.1430804*a)/P),r=L((.0139322*o+.0971045*i+.7141733*a)/T)),new O(116*s-16,500*(n-s),200*(s-r),e.opacity)}function F(e,t,n,r){return 1===arguments.length?N(e):new O(e,t,n,null==r?1:r)}function O(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function L(e){return e>V?Math.pow(e,1/3):e/_+G}function j(e){return e>R?e*e*e:_*(e-G)}function z(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function H(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function U(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof Y)return new Y(e.h,e.c,e.l,e.opacity);if(e instanceof O||(e=N(e)),0===e.a&&0===e.b)return new Y(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*D;return new Y(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}(e):new Y(e,t,n,null==r?1:r)}function Y(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}r(O,F,o(i,{brighter:function(e){return new O(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new O(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new w(z(3.1338561*(t=P*j(t))-1.6168667*(e=Q*j(e))-.4906146*(n=T*j(n))),z(-.9787684*t+1.9161415*e+.033454*n),z(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),r(Y,U,o(i,{brighter:function(e){return new Y(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Y(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return N(this).rgb()}}));var X=-.14861,q=1.78277,K=-.29227,Z=-.90649,W=1.97294,J=W*Z,$=W*q,ee=q*K-Z*X;function te(e,t,n,r){return 1===arguments.length?function(e){if(e instanceof ne)return new ne(e.h,e.s,e.l,e.opacity);e instanceof w||(e=I(e));var t=e.r/255,n=e.g/255,r=e.b/255,o=(ee*r+J*t-$*n)/(ee+J-$),i=r-o,a=(W*(n-o)-K*i)/Z,s=Math.sqrt(a*a+i*i)/(W*o*(1-o)),l=s?Math.atan2(a,i)*D-120:NaN;return new ne(l<0?l+360:l,s,o,e.opacity)}(e):new ne(e,t,n,null==r?1:r)}function ne(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}r(ne,te,o(i,{brighter:function(e){return e=null==e?1/.7:Math.pow(1/.7,e),new ne(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new ne(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*B,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),o=Math.sin(e);return new w(255*(t+n*(X*r+q*o)),255*(t+n*(K*r+Z*o)),255*(t+n*(W*r)),this.opacity)}})),n.d(t,"a",function(){return v}),n.d(t,"f",function(){return x}),n.d(t,"d",function(){return S}),n.d(t,"e",function(){return F}),n.d(t,"c",function(){return U}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,"b",function(){return te})},function(e,t,n){"use strict";var r=n(3);function o(e,t,n,r,o){var i=e*e,a=i*e;return((1-3*e+3*i-a)*t+(4-6*i+3*a)*n+(1+3*e+3*i-3*a)*r+a*o)/6}var i=function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],s=r>0?e[r-1]:2*i-a,l=r<t-1?e[r+2]:2*a-i;return o((n-r/t)*t,s,i,a,l)}},a=function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return o((n-r/t)*t,i,a,s,l)}},s=function(e){return function(){return e}};function l(e,t){return function(n){return e+n*t}}function c(e,t){var n=t-e;return n?l(e,n>180||n<-180?n-360*Math.round(n/360):n):s(isNaN(e)?t:e)}function A(e,t){var n=t-e;return n?l(e,n):s(isNaN(e)?t:e)}var u=function e(t){var n=function(e){return 1==(e=+e)?A:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):s(isNaN(t)?n:t)}}(t);function o(e,t){var o=n((e=Object(r.f)(e)).r,(t=Object(r.f)(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),s=A(e.opacity,t.opacity);return function(t){return e.r=o(t),e.g=i(t),e.b=a(t),e.opacity=s(t),e+""}}return o.gamma=e,o}(1);function h(e){return function(t){var n,o,i=t.length,a=new Array(i),s=new Array(i),l=new Array(i);for(n=0;n<i;++n)o=Object(r.f)(t[n]),a[n]=o.r||0,s[n]=o.g||0,l[n]=o.b||0;return a=e(a),s=e(s),l=e(l),o.opacity=1,function(e){return o.r=a(e),o.g=s(e),o.b=l(e),o+""}}}h(i),h(a);var d,f,p,g,m=function(e,t){var n,r=t?t.length:0,o=e?Math.min(r,e.length):0,i=new Array(o),a=new Array(r);for(n=0;n<o;++n)i[n]=C(e[n],t[n]);for(;n<r;++n)a[n]=t[n];return function(e){for(n=0;n<o;++n)a[n]=i[n](e);return a}},v=function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}},y=function(e,t){return t-=e=+e,function(n){return e+t*n}},b=function(e,t){var n,r={},o={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?r[n]=C(e[n],t[n]):o[n]=t[n];return function(e){for(n in r)o[n]=r[n](e);return o}},I=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(I.source,"g"),w=function(e,t){var n,r,o,i=I.lastIndex=x.lastIndex=0,a=-1,s=[],l=[];for(e+="",t+="";(n=I.exec(e))&&(r=x.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),s[a]?s[a]+=o:s[++a]=o),(n=n[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:y(n,r)})),i=x.lastIndex;return i<t.length&&(o=t.slice(i),s[a]?s[a]+=o:s[++a]=o),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)s[(n=l[r]).i]=n.x(e);return s.join("")})},C=function(e,t){var n,o=typeof t;return null==t||"boolean"===o?s(t):("number"===o?y:"string"===o?(n=Object(r.a)(t))?(t=n,u):w:t instanceof r.a?u:t instanceof Date?v:Array.isArray(t)?m:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?b:y)(e,t)},E=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},S=180/Math.PI,M={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},k=function(e,t,n,r,o,i){var a,s,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*S,skewX:Math.atan(l)*S,scaleX:a,scaleY:s}};function B(e,t,n,r){function o(e){return e.length?e.pop()+" ":""}return function(i,a){var s=[],l=[];return i=e(i),a=e(a),function(e,r,o,i,a,s){if(e!==o||r!==i){var l=a.push("translate(",null,t,null,n);s.push({i:l-4,x:y(e,o)},{i:l-2,x:y(r,i)})}else(o||i)&&a.push("translate("+o+t+i+n)}(i.translateX,i.translateY,a.translateX,a.translateY,s,l),function(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),l.push({i:n.push(o(n)+"rotate(",null,r)-2,x:y(e,t)})):t&&n.push(o(n)+"rotate("+t+r)}(i.rotate,a.rotate,s),function(e,t,n,i){e!==t?l.push({i:n.push(o(n)+"skewX(",null,r)-2,x:y(e,t)}):t&&n.push(o(n)+"skewX("+t+r)}(i.skewX,a.skewX,s),function(e,t,n,r,i,a){if(e!==n||t!==r){var s=i.push(o(i)+"scale(",null,",",null,")");a.push({i:s-4,x:y(e,n)},{i:s-2,x:y(t,r)})}else 1===n&&1===r||i.push(o(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,s,l),i=a=null,function(e){for(var t,n=-1,r=l.length;++n<r;)s[(t=l[n]).i]=t.x(e);return s.join("")}}}var D=B(function(e){return"none"===e?M:(d||(d=document.createElement("DIV"),f=document.documentElement,p=document.defaultView),d.style.transform=e,e=p.getComputedStyle(f.appendChild(d),null).getPropertyValue("transform"),f.removeChild(d),e=e.slice(7,-1).split(","),k(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),P=B(function(e){return null==e?M:(g||(g=document.createElementNS("http://www.w3.org/2000/svg","g")),g.setAttribute("transform",e),(e=g.transform.baseVal.consolidate())?(e=e.matrix,k(e.a,e.b,e.c,e.d,e.e,e.f)):M)},", ",")",")");function Q(e){return function(t,n){var o=e((t=Object(r.d)(t)).h,(n=Object(r.d)(n)).h),i=A(t.s,n.s),a=A(t.l,n.l),s=A(t.opacity,n.opacity);return function(e){return t.h=o(e),t.s=i(e),t.l=a(e),t.opacity=s(e),t+""}}}function T(e){return function(t,n){var o=e((t=Object(r.c)(t)).h,(n=Object(r.c)(n)).h),i=A(t.c,n.c),a=A(t.l,n.l),s=A(t.opacity,n.opacity);return function(e){return t.h=o(e),t.c=i(e),t.l=a(e),t.opacity=s(e),t+""}}}function G(e){return function t(n){function o(t,o){var i=e((t=Object(r.b)(t)).h,(o=Object(r.b)(o)).h),a=A(t.s,o.s),s=A(t.l,o.l),l=A(t.opacity,o.opacity);return function(e){return t.h=i(e),t.s=a(e),t.l=s(Math.pow(e,n)),t.opacity=l(e),t+""}}return n=+n,o.gamma=t,o}(1)}Math.SQRT2,Q(c),Q(A),T(c),T(A),G(c),G(A),n.d(t,"a",function(){return C}),n.d(t,!1,function(){return m}),n.d(t,!1,function(){return i}),n.d(t,!1,function(){return a}),n.d(t,!1,function(){return v}),n.d(t,"b",function(){return y}),n.d(t,!1,function(){return b}),n.d(t,"d",function(){return E}),n.d(t,"e",function(){return w}),n.d(t,"f",function(){return D}),n.d(t,"g",function(){return P}),n.d(t,!1,function(){}),n.d(t,"c",function(){return u}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){}),n.d(t,!1,function(){})},function(e,t,n){"use strict";e.exports=function(e){return"string"==typeof e}},function(e,t,n){"use strict";function r(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}t.isNumber=function(e){return"number"==typeof e},t.isInteger=function(e){return!!isFinite(e)&&e==Math.round(e)},t.sign=Math.sign||function(e){return e>0?1:e<0?-1:0},t.format=function(e,n){if("function"==typeof n)return n(e);if(e===1/0)return"Infinity";if(e===-1/0)return"-Infinity";if(isNaN(e))return"NaN";var r="auto",o=void 0;switch(n&&(n.notation&&(r=n.notation),t.isNumber(n)?o=n:n.precision&&(o=n.precision)),r){case"fixed":return t.toFixed(e,o);case"exponential":return t.toExponential(e,o);case"engineering":return t.toEngineering(e,o);case"auto":return t.toPrecision(e,o,n&&n.exponential).replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},t.splitNumber=function(e){var t=String(e).toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],r=t[2],o=parseFloat(t[4]||"0"),i=r.indexOf(".");o+=-1!==i?i-1:r.length-1;var a=r.replace(".","").replace(/^0*/,function(e){return o-=e.length,""}).replace(/0*$/,"").split("").map(function(e){return parseInt(e)});return 0===a.length&&(a.push(0),o++),{sign:n,coefficients:a,exponent:o}},t.toEngineering=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var o=t.roundDigits(t.splitNumber(e),n),i=o.exponent,a=o.coefficients,s=i%3==0?i:i<0?i-3-i%3:i-i%3,l=i>=0?i:Math.abs(s);a.length-1<l&&(a=a.concat(r(l-(a.length-1))));for(var c=Math.abs(i-s),A=1;--c>=0;)A++;var u=a.slice(A).join(""),h=u.match(/[1-9]/)?"."+u:"",d=a.slice(0,A).join("")+h+"e"+(i>=0?"+":"")+s.toString();return o.sign+d},t.toFixed=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var o=t.splitNumber(e),i=t.roundDigits(o,o.exponent+1+(n||0)),a=i.coefficients,s=i.exponent+1,l=s+(n||0);return a.length<l&&(a=a.concat(r(l-a.length))),s<0&&(a=r(1-s).concat(a),s=1),n&&a.splice(s,0,0===s?"0.":"."),i.sign+a.join("")},t.toExponential=function(e,n){if(isNaN(e)||!isFinite(e))return String(e);var o=t.splitNumber(e),i=n?t.roundDigits(o,n):o,a=i.coefficients,s=i.exponent;a.length<n&&(a=a.concat(r(n-a.length)));var l=a.shift();return i.sign+l+(a.length>0?"."+a.join(""):"")+"e"+(s>=0?"+":"")+s},t.toPrecision=function(e,n,o){if(isNaN(e)||!isFinite(e))return String(e);var i=o&&void 0!==o.lower?o.lower:.001,a=o&&void 0!==o.upper?o.upper:1e5,s=t.splitNumber(e),l=Math.abs(Math.pow(10,s.exponent));if(l<i||l>=a)return t.toExponential(e,n);var c=n?t.roundDigits(s,n):s,A=c.coefficients,u=c.exponent;A.length<n&&(A=A.concat(r(n-A.length))),A=A.concat(r(u-A.length+1+(A.length<n?n-A.length:0))),A=r(-u).concat(A);var h=u>0?u:0;return h<A.length-1&&A.splice(h+1,0,"."),c.sign+A.join("")},t.roundDigits=function(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},r=n.coefficients;t<=0;)r.unshift(0),n.exponent++,t++;if(r.length>t&&r.splice(t,r.length-t)[0]>=5){var o=t-1;for(r[o]++;10===r[o];)r.pop(),0===o&&(r.unshift(0),n.exponent++,o++),r[--o]++}return n},t.digits=function(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length},t.DBL_EPSILON=Number.EPSILON||2.220446049250313e-16,t.nearlyEqual=function(e,n,r){if(null==r)return e==n;if(e==n)return!0;if(isNaN(e)||isNaN(n))return!1;if(isFinite(e)&&isFinite(n)){var o=Math.abs(e-n);return o<t.DBL_EPSILON||o<=Math.max(Math.abs(e),Math.abs(n))*r}return!1}},function(e,t,n){"use strict";var r=n(61);t.clone=function e(n){var o=typeof n;if("number"===o||"string"===o||"boolean"===o||null===n||void 0===n)return n;if("function"==typeof n.clone)return n.clone();if(Array.isArray(n))return n.map(function(t){return e(t)});if(n instanceof Number)return new Number(n.valueOf());if(n instanceof String)return new String(n.valueOf());if(n instanceof Boolean)return new Boolean(n.valueOf());if(n instanceof Date)return new Date(n.valueOf());if(r(n))return n;if(n instanceof RegExp)throw new TypeError("Cannot clone "+n);return t.map(n,e)},t.map=function(e,n){var r={};for(var o in e)t.hasOwnProperty(e,o)&&(r[o]=n(e[o]));return r},t.extend=function(e,n){for(var r in n)t.hasOwnProperty(n,r)&&(e[r]=n[r]);return e},t.deepExtend=function e(n,r){if(Array.isArray(r))throw new TypeError("Arrays are not supported by deepExtend");for(var o in r)if(t.hasOwnProperty(r,o))if(r[o]&&r[o].constructor===Object)void 0===n[o]&&(n[o]={}),n[o].constructor===Object?e(n[o],r[o]):n[o]=r[o];else{if(Array.isArray(r[o]))throw new TypeError("Arrays are not supported by deepExtend");n[o]=r[o]}return n},t.deepEqual=function(e,n){var r,o,i;if(Array.isArray(e)){if(!Array.isArray(n))return!1;if(e.length!=n.length)return!1;for(o=0,i=e.length;o<i;o++)if(!t.deepEqual(e[o],n[o]))return!1;return!0}if(e instanceof Object){if(Array.isArray(n)||!(n instanceof Object))return!1;for(r in e)if(!t.deepEqual(e[r],n[r]))return!1;for(r in n)if(!t.deepEqual(e[r],n[r]))return!1;return!0}return typeof e==typeof n&&e==n},t.canDefineProperty=function(){try{if(Object.defineProperty)return Object.defineProperty({},"x",{get:function(){}}),!0}catch(e){}return!1},t.lazy=function(e,n,r){if(t.canDefineProperty()){var o,i=!0;Object.defineProperty(e,n,{get:function(){return i&&(o=r(),i=!1),o},set:function(e){o=e,i=!1},configurable:!0,enumerable:!0})}else e[n]=r()},t.traverse=function(e,t){var n=e;if(t)for(var r=t.split("."),o=0;o<r.length;o++){var i=r[o];i in n||(n[i]={}),n=n[i]}return n},t.hasOwnProperty=function(e,t){return e&&Object.hasOwnProperty.call(e,t)},t.isFactory=function(e){return e&&"function"==typeof e.factory}},function(e,t){e.exports=d3},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";e.exports=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="DimensionError",r.prototype.isDimensionError=!0,e.exports=r},function(e,t,n){"use strict";n.r(t);var r=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},o=function(e){return(e=r(Math.abs(e)))?e[1]:NaN},i=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(e){return new s(e)}function s(e){if(!(t=i.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}a.prototype=s.prototype,s.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l,c,A,u,h=function(e){e:for(var t,n=e.length,r=1,o=-1;r<n;++r)switch(e[r]){case".":o=t=r;break;case"0":0===o&&(o=r),t=r;break;default:if(o>0){if(!+e[r])break e;o=0}}return o>0?e.slice(0,o)+e.slice(t+1):e},d=function(e,t){var n=r(e,t);if(!n)return e+"";var o=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+o:o.length>i+1?o.slice(0,i+1)+"."+o.slice(i+1):o+new Array(i-o.length+2).join("0")},f={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return d(100*e,t)},r:d,s:function(e,t){var n=r(e,t);if(!n)return e+"";var o=n[0],i=n[1],a=i-(l=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=o.length;return a===s?o:a>s?o+new Array(a-s+1).join("0"):a>0?o.slice(0,a)+"."+o.slice(a):"0."+new Array(1-a).join("0")+r(e,Math.max(0,t+a-1))[0]},X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}},p=function(e){return e},g=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],m=function(e){var t=e.grouping&&e.thousands?function(e,t){return function(n,r){for(var o=n.length,i=[],a=0,s=e[0],l=0;o>0&&s>0&&(l+s+1>r&&(s=Math.max(1,r-l)),i.push(n.substring(o-=s,o+s)),!((l+=s+1)>r));)s=e[a=(a+1)%e.length];return i.reverse().join(t)}}(e.grouping,e.thousands):p,n=e.currency,r=e.decimal,i=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(e.numerals):p,s=e.percent||"%";function c(e){var o=(e=a(e)).fill,c=e.align,A=e.sign,u=e.symbol,d=e.zero,p=e.width,m=e.comma,v=e.precision,y=e.trim,b=e.type;"n"===b?(m=!0,b="g"):f[b]||(null==v&&(v=12),y=!0,b="g"),(d||"0"===o&&"="===c)&&(d=!0,o="0",c="=");var I="$"===u?n[0]:"#"===u&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",x="$"===u?n[1]:/[%p]/.test(b)?s:"",w=f[b],C=/[defgprs%]/.test(b);function E(e){var n,a,s,u=I,f=x;if("c"===b)f=w(e)+f,e="";else{var E=(e=+e)<0;if(e=w(Math.abs(e),v),y&&(e=h(e)),E&&0==+e&&(E=!1),u=(E?"("===A?A:"-":"-"===A||"("===A?"":A)+u,f=("s"===b?g[8+l/3]:"")+f+(E&&"("===A?")":""),C)for(n=-1,a=e.length;++n<a;)if(48>(s=e.charCodeAt(n))||s>57){f=(46===s?r+e.slice(n+1):e.slice(n))+f,e=e.slice(0,n);break}}m&&!d&&(e=t(e,1/0));var S=u.length+e.length+f.length,M=S<p?new Array(p-S+1).join(o):"";switch(m&&d&&(e=t(M+e,M.length?p-f.length:1/0),M=""),c){case"<":e=u+e+f+M;break;case"=":e=u+M+e+f;break;case"^":e=M.slice(0,S=M.length>>1)+u+e+f+M.slice(S);break;default:e=M+u+e+f}return i(e)}return v=null==v?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v)),E.toString=function(){return e+""},E}return{format:c,formatPrefix:function(e,t){var n=c(((e=a(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(o(t)/3))),i=Math.pow(10,-r),s=g[8+r/3];return function(e){return n(i*e)+s}}}};function v(e){return c=m(e),A=c.format,u=c.formatPrefix,c}v({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var y=function(e){return Math.max(0,-o(Math.abs(e)))},b=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(o(t)/3)))-o(Math.abs(e)))},I=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,o(t)-o(e))+1};n.d(t,"formatDefaultLocale",function(){return v}),n.d(t,"format",function(){return A}),n.d(t,"formatPrefix",function(){return u}),n.d(t,"formatLocale",function(){return m}),n.d(t,"formatSpecifier",function(){return a}),n.d(t,"precisionFixed",function(){return y}),n.d(t,"precisionPrefix",function(){return b}),n.d(t,"precisionRound",function(){return I})},function(e,t,n){"use strict";n.r(t);var r=[].slice,o={};function i(e){this._size=e,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function a(e){if(!e._start)try{!function(e){for(;e._start=e._waiting&&e._active<e._size;){var t=e._ended+e._active,n=e._tasks[t],r=n.length-1,i=n[r];n[r]=s(e,t),--e._waiting,++e._active,n=i.apply(null,n),e._tasks[t]&&(e._tasks[t]=n||o)}}(e)}catch(t){if(e._tasks[e._ended+e._active-1])l(e,t);else if(!e._data)throw t}}function s(e,t){return function(n,r){e._tasks[t]&&(--e._active,++e._ended,e._tasks[t]=null,null==e._error&&(null!=n?l(e,n):(e._data[t]=r,e._waiting?a(e):c(e))))}}function l(e,t){var n,r=e._tasks.length;for(e._error=t,e._data=void 0,e._waiting=NaN;--r>=0;)if((n=e._tasks[r])&&(e._tasks[r]=null,n.abort))try{n.abort()}catch(t){}e._active=NaN,c(e)}function c(e){if(!e._active&&e._call){var t=e._data;e._data=void 0,e._call(e._error,t)}}function A(e){if(null==e)e=1/0;else if(!((e=+e)>=1))throw new Error("invalid concurrency");return new i(e)}i.prototype=A.prototype={constructor:i,defer:function(e){if("function"!=typeof e)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var t=r.call(arguments,1);return t.push(e),++this._waiting,this._tasks.push(t),a(this),this},abort:function(){return null==this._error&&l(this,new Error("abort")),this},await:function(e){if("function"!=typeof e)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(t,n){e.apply(null,[t].concat(n))},c(this),this},awaitAll:function(e){if("function"!=typeof e)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=e,c(this),this}},n.d(t,"queue",function(){return A})},function(e,t,n){var r=n(23),o=n(103),i=n(52);function a(){this.mean=0,this.variance=1}Normal=function(e,t){this.mean=e,this.variance=t},Normal.prototype._de=function(e){return 1/(Math.sqrt(this.variance)*Math.sqrt(2*Math.PI))*Math.exp(-Math.pow(e-this.mean,2)/(2*this.variance))},Normal.prototype._di=function(e){return.5*(1+o.Misc.erf((e-this.mean)/(Math.sqrt(this.variance)*Math.sqrt(2))))},Normal.prototype.dens=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._de(e.elements[t]));return result}return this._de(e)},Normal.prototype.distr=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._di(e.elements[t]));return result}return this._di(e)},Normal.prototype.inverse=function(e){var t,n,r=-.007784894002430293,o=-.3223964580411365,i=-2.400758277161838,a=-2.549732539343734,s=4.374664141464968,l=2.938163982698783,c=.007784695709041462,A=.3224671290700398,u=2.445134137142996,h=3.754408661907416;return(e<.02425?(((((r*(t=Math.sqrt(-2*Math.log(e)))+o)*t+i)*t+a)*t+s)*t+l)/((((c*t+A)*t+u)*t+h)*t+1):e<.97575?(((((-39.69683028665376*(n=(t=e-.5)*t)+220.9460984245205)*n-275.9285104469687)*n+138.357751867269)*n-30.66479806614716)*n+2.506628277459239)*t/(((((-54.47609879822406*n+161.5858368580409)*n-155.6989798598866)*n+66.80131188771972)*n-13.28068155288572)*n+1):-(((((r*(t=Math.sqrt(-2*Math.log(1-e)))+o)*t+i)*t+a)*t+s)*t+l)/((((c*t+A)*t+u)*t+h)*t+1))*this.variance+this.mean},a.prototype=new Normal,a.prototype.constructor=a,T=function(e){this.df=e},T.prototype._de=function(e){return o.Misc.gamma((this.df+1)/2)/(Math.sqrt(this.df*Math.PI)*o.Misc.gamma(this.df/2))*Math.pow(1+Math.pow(e,2)/this.df,-(this.df+1)/2)},T.prototype._di=function(e){return e<0?.5*o.Misc.rbeta(this.df/(Math.pow(e,2)+this.df),this.df/2,.5):1-.5*o.Misc.rbeta(this.df/(Math.pow(e,2)+this.df),this.df/2,.5)},T.prototype.dens=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._de(e.elements[t]));return result}return this._de(e)},T.prototype.distr=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._di(e.elements[t]));return result}return this._di(e)},T.prototype.inverse=function(e){return function(e,t){return i.Numeric.bisection(function(n){return e._di(n)-t},-10.1,10)}(this,e)},Kolmogorov=function(){},Kolmogorov.prototype._di=function(e){var t,n=0,r=1;do{n+=t=Math.exp(-Math.pow(2*r-1,2)*Math.pow(Math.PI,2)/(8*Math.pow(e,2))),r++}while(Math.abs(t)>1e-12);return Math.sqrt(2*Math.PI)*n/e},Kolmogorov.prototype.distr=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._di(e.elements[t]));return result}return this._di(e)},Kolmogorov.prototype.inverse=function(e){return function(e,t){return i.Numeric.bisection(function(n){return e._di(n)-t},0,1)}(this,e)},F=function(e,t){this.df1=e,this.df2=t},F.prototype._di=function(e){return o.Misc.rbeta(this.df1*e/(this.df1*e+this.df2),this.df1/2,this.df2/2)},F.prototype.distr=function(e){if(e instanceof r.Vector){result=new r.Vector([]);for(var t=0;t<e.length();++t)result.push(this._di(e.elements[t]));return result}return this._di(e)},e.exports.Normal=Normal,e.exports.StandardNormal=a,e.exports.T=T,e.exports.F=F,e.exports.Kolmogorov=Kolmogorov},function(e,t,n){"use strict";t.name="matrix",t.factory=function(e,t,n,r){var o=r("matrix",{"":function(){return i([])},string:function(e){return i([],e)},"string, string":function(e,t){return i([],e,t)},Array:function(e){return i(e)},Matrix:function(e){return i(e,e.storage())},"Array | Matrix, string":i,"Array | Matrix, string, string":i});return o.toTex={0:"\\begin{bmatrix}\\end{bmatrix}",1:"\\left(${args[0]}\\right)",2:"\\left(${args[0]}\\right)"},o;function i(t,n,r){return new(e.Matrix.storage(n||"default"))(t,r)}}},function(e,t,n){"use strict";e.exports=function(e){return"number"==typeof e&&e==e}},function(e,t,n){"use strict";var r=n(311);t.symbols={Alpha:"A",alpha:"\\alpha",Beta:"B",beta:"\\beta",Gamma:"\\Gamma",gamma:"\\gamma",Delta:"\\Delta",delta:"\\delta",Epsilon:"E",epsilon:"\\epsilon",varepsilon:"\\varepsilon",Zeta:"Z",zeta:"\\zeta",Eta:"H",eta:"\\eta",Theta:"\\Theta",theta:"\\theta",vartheta:"\\vartheta",Iota:"I",iota:"\\iota",Kappa:"K",kappa:"\\kappa",varkappa:"\\varkappa",Lambda:"\\Lambda",lambda:"\\lambda",Mu:"M",mu:"\\mu",Nu:"N",nu:"\\nu",Xi:"\\Xi",xi:"\\xi",Omicron:"O",omicron:"o",Pi:"\\Pi",pi:"\\pi",varpi:"\\varpi",Rho:"P",rho:"\\rho",varrho:"\\varrho",Sigma:"\\Sigma",sigma:"\\sigma",varsigma:"\\varsigma",Tau:"T",tau:"\\tau",Upsilon:"\\Upsilon",upsilon:"\\upsilon",Phi:"\\Phi",phi:"\\phi",varphi:"\\varphi",Chi:"X",chi:"\\chi",Psi:"\\Psi",psi:"\\psi",Omega:"\\Omega",omega:"\\omega",true:"\\mathrm{True}",false:"\\mathrm{False}",i:"i",inf:"\\infty",Inf:"\\infty",infinity:"\\infty",Infinity:"\\infty",oo:"\\infty",lim:"\\lim",undefined:"\\mathbf{?}"},t.operators={transpose:"^\\top",factorial:"!",pow:"^",dotPow:".^\\wedge",unaryPlus:"+",unaryMinus:"-",bitNot:"~",not:"\\neg",multiply:"\\cdot",divide:"\\frac",dotMultiply:".\\cdot",dotDivide:".:",mod:"\\mod",add:"+",subtract:"-",to:"\\rightarrow",leftShift:"<<",rightArithShift:">>",rightLogShift:">>>",equal:"=",unequal:"\\neq",smaller:"<",larger:">",smallerEq:"\\leq",largerEq:"\\geq",bitAnd:"\\&",bitXor:"\\underline{|}",bitOr:"|",and:"\\wedge",xor:"\\veebar",or:"\\vee"},t.defaultTemplate="\\mathrm{${name}}\\left(${args}\\right)";var o={deg:"^\\circ"};t.escape=function(e){return r(e,{preserveFormatting:!0})},t.toSymbol=function(e,n){return(n=void 0!==n&&n)?o.hasOwnProperty(e)?o[e]:"\\mathrm{"+t.escape(e)+"}":t.symbols.hasOwnProperty(e)?t.symbols[e]:t.escape(e)}},function(e,t,n){e.exports=n(324)},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";const r=Object.prototype.toString;e.exports=function(e){return r.call(e).endsWith("Array]")}},function(e,t,n){"use strict";var r={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array};e.exports=r},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){function n(e,t,n){this.elements=[];for(var r=e;r<=t;r+=n)this.elements.push(r)}Vector=function(e){this.elements=e},Vector.prototype.push=function(e){this.elements.push(e)},Vector.prototype.map=function(e){return new Vector(this.elements.map(e))},Vector.prototype.length=function(){return this.elements.length},Vector.prototype.concat=function(e){return new Vector(this.elements.slice(0).concat(e.elements.slice(0)))},Vector.prototype.abs=function(){for(var e=[],t=0;t<this.elements.length;t++)e.push(Math.abs(this.elements[t]));return new Vector(e)},Vector.prototype.dot=function(e){for(var t=0,n=0;n<this.length();n++)t+=this.elements[n]*e.elements[n];return t},Vector.prototype.sum=function(){for(var e=0,t=0,n=this.elements.length;t<n;++t)e+=this.elements[t];return e},Vector.prototype.log=function(){for(var e=new Vector(this.elements.slice(0)),t=0,n=this.elements.length;t<n;++t)e.elements[t]=Math.log(e.elements[t]);return e},Vector.prototype.add=function(e){var t=new Vector(this.elements.slice(0));if(e instanceof Vector)for(var n=0,r=t.elements.length;n<r;++n)t.elements[n]+=e.elements[n];else for(n=0,r=t.elements.length;n<r;++n)t.elements[n]+=e;return t},Vector.prototype.subtract=function(e){return this.add(e.multiply(-1))},Vector.prototype.multiply=function(e){var t=new Vector(this.elements.slice(0));if(e instanceof Vector)for(var n=0,r=t.elements.length;n<r;++n)t.elements[n]=t.elements[n]*e.elements[n];else for(n=0,r=t.elements.length;n<r;++n)t.elements[n]=t.elements[n]*e;return t},Vector.prototype.pow=function(e){var t=new Vector(this.elements.slice(0));if(e instanceof Vector)for(var n=0,r=t.elements.length;n<r;++n)t.elements[n]=Math.pow(t.elements[n],e.elements[n]);else for(n=0,r=t.elements.length;n<r;++n)t.elements[n]=Math.pow(t.elements[n],e);return t},Vector.prototype.mean=function(){for(var e=0,t=0,n=this.elements.length;t<n;++t)e+=this.elements[t];return e/this.elements.length},Vector.prototype.geomean=function(){return Math.exp(this.log().sum()/this.elements.length)},Vector.prototype.sortElements=function(){for(var e,t,n=this.elements.slice(0),r=0;r<n.length;++r){for(t=n[r],e=r-1;e>=0&&n[e]>t;--e)n[e+1]=n[e];n[e+1]=t}return n},Vector.prototype._ecdf=function(e){for(var t=this.sortElements(),n=0,r=0;r<t.length&&t[r]<=e;r++)n++;return n/t.length},Vector.prototype.ecdf=function(e){if(e instanceof Vector){for(var t=new Vector([]),n=0;n<e.length();n++)t.push(this._ecdf(e.elements[n]));return t}return this._ecdf(e)},Vector.prototype.sort=function(){return new Vector(this.sortElements())},Vector.prototype.min=function(){return this.sortElements()[0]},Vector.prototype.max=function(){return this.sortElements().pop()},Vector.prototype.toString=function(){return"["+this.elements.join(", ")+"]"},Vector.prototype.variance=function(){return this.ss()/(this.elements.length-1)},Vector.prototype.biasedVariance=function(){return this.ss()/this.elements.length},Vector.prototype.sd=function(){return Math.sqrt(this.variance())},Vector.prototype.uncorrectedSd=function(){return Math.sqrt(this.biasedVariance())},Vector.prototype.sem=function(){return this.sd()/Math.sqrt(this.elements.length)},Vector.prototype.ss=function(){for(var e=this.mean(),t=0,n=0,r=this.elements.length;n<r;++n)t+=Math.pow(this.elements[n]-e,2);return t},Vector.prototype.res=function(){return this.add(-this.mean())},Vector.prototype.kurtosis=function(){return this.res().pow(4).mean()/Math.pow(this.res().pow(2).mean(),2)},Vector.prototype.skewness=function(){return this.res().pow(3).mean()/Math.pow(this.res().pow(2).mean(),1.5)},n.prototype=new Vector,n.prototype.constructor=n,e.exports.Vector=Vector,e.exports.Sequence=n},function(e,t,n){"use strict";var r=n(7).clone;t.name="algorithm14",t.factory=function(e,t,n,o){var i=e.DenseMatrix,a=function(e,t,n,r,o,i,s){var l=[];if(t===n.length-1)for(var c=0;c<r;c++)l[c]=s?e(i,o[c]):e(o[c],i);else for(var A=0;A<r;A++)l[A]=a(e,t+1,n,n[t+1],o[A],i,s);return l};return function(e,t,n,s){var l,c=e._data,A=e._size,u=e._datatype,h=n;"string"==typeof u&&(l=u,t=o.convert(t,l),h=o.find(n,[l,l]));var d=A.length>0?a(h,0,A,A[0],c,t,s):[];return new i({data:d,size:r(A),datatype:l})}}},function(e,t,n){"use strict";var r=n(6).nearlyEqual,o=n(40);t.factory=function(e,t,n,i){var a=i("equalScalar",{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,n){return e===n||r(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.eq(n)||o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return e.equals(t)},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return a(e.value,t.value)},"string, string":function(e,t){return e===t}});return a}},function(e,t,n){"use strict";var r=Math.exp,o=Math.pow,i=Math.sqrt,a=Math.PI;e.exports=function(e,t){var n=o(t,2),s=1/i(2*n*a),l=-1/(2*n);return 0===t?function(t){return t===e?Number.POSITIVE_INFINITY:0}:function(t){return s*r(l*o(t-e,2))}}},function(e,t,n){"use strict";var r=n(210);e.exports=function(e){return r(e)&&e>=0}},function(e,t,n){"use strict";var r=n(16);e.exports=function(e){return r(e)&&e%1==0}},function(e,t,n){"use strict";t.array=n(56),t.boolean=n(309),t.function=n(308),t.number=n(6),t.object=n(7),t.string=n(55),t.types=n(111),t.emitter=n(112)},function(e,t,n){"use strict";var r=n(29),o=n(11);r.string.isString,t.name="algorithm13",t.factory=function(e,t,n,r){var i=e.DenseMatrix,a=function(e,t,n,r,o,i){var s=[];if(t===n.length-1)for(var l=0;l<r;l++)s[l]=e(o[l],i[l]);else for(var c=0;c<r;c++)s[c]=a(e,t+1,n,n[t+1],o[c],i[c]);return s};return function(e,t,n){var s,l=e._data,c=e._size,A=e._datatype,u=t._data,h=t._size,d=t._datatype,f=[];if(c.length!==h.length)throw new o(c.length,h.length);for(var p=0;p<c.length;p++){if(c[p]!==h[p])throw new RangeError("Dimension mismatch. Matrix A ("+c+") must match Matrix B ("+h+")");f[p]=c[p]}var g=n;"string"==typeof A&&A===d&&(s=A,t=r.convert(t,s),g=r.find(n,[s,s]));var m=f.length>0?a(g,0,f,f[0],l,u):[];return new i({data:m,size:f,datatype:s})}}},function(e,t,n){"use strict";n.r(t);var r=n(20),o=n.n(r),i=function(e){if(!o()(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");for(var t=e[0],n=1;n<e.length;n++)e[n]>t&&(t=e[n]);return t},a=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!o()(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");if(void 0!==n.output){if(!o()(n.output))throw new TypeError("output option must be an array if specified");t=n.output}else t=new Array(e.length);var r=function(e){if(!o()(e))throw new TypeError("input must be an array");if(0===e.length)throw new TypeError("input must not be empty");for(var t=e[0],n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t}(e),a=i(e);if(r===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var s=n.min,l=void 0===s?n.autoMinMax?r:0:s,c=n.max,A=void 0===c?n.autoMinMax?a:1:c;if(l>=A)throw new RangeError("min option must be smaller than max option");for(var u=(A-l)/(a-r),h=0;h<e.length;h++)t[h]=(e[h]-r)*u+l;return t};class s{constructor(e){var t,n,r,o,i,a,s,l,c,A=(e=T.checkMatrix(e)).clone(),u=A.rows,h=A.columns,d=new Array(u),f=1;for(t=0;t<u;t++)d[t]=t;for(l=new Array(u),n=0;n<h;n++){for(t=0;t<u;t++)l[t]=A.get(t,n);for(t=0;t<u;t++){for(c=Math.min(t,n),i=0,r=0;r<c;r++)i+=A.get(t,r)*l[r];l[t]-=i,A.set(t,n,l[t])}for(o=n,t=n+1;t<u;t++)Math.abs(l[t])>Math.abs(l[o])&&(o=t);if(o!==n){for(r=0;r<h;r++)a=A.get(o,r),A.set(o,r,A.get(n,r)),A.set(n,r,a);s=d[o],d[o]=d[n],d[n]=s,f=-f}if(n<u&&0!==A.get(n,n))for(t=n+1;t<u;t++)A.set(t,n,A.get(t,n)/A.get(n,n))}this.LU=A,this.pivotVector=d,this.pivotSign=f}isSingular(){for(var e=this.LU,t=e.columns,n=0;n<t;n++)if(0===e[n][n])return!0;return!1}solve(e){e=P.checkMatrix(e);var t=this.LU;if(t.rows!==e.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");var n,r,o,i=e.columns,a=e.subMatrixRow(this.pivotVector,0,i-1),s=t.columns;for(o=0;o<s;o++)for(n=o+1;n<s;n++)for(r=0;r<i;r++)a[n][r]-=a[o][r]*t[n][o];for(o=s-1;o>=0;o--){for(r=0;r<i;r++)a[o][r]/=t[o][o];for(n=0;n<o;n++)for(r=0;r<i;r++)a[n][r]-=a[o][r]*t[n][o]}return a}get determinant(){var e=this.LU;if(!e.isSquare())throw new Error("Matrix must be square");for(var t=this.pivotSign,n=e.columns,r=0;r<n;r++)t*=e[r][r];return t}get lowerTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,r=new P(t,n),o=0;o<t;o++)for(var i=0;i<n;i++)r[o][i]=o>i?e[o][i]:o===i?1:0;return r}get upperTriangularMatrix(){for(var e=this.LU,t=e.rows,n=e.columns,r=new P(t,n),o=0;o<t;o++)for(var i=0;i<n;i++)r[o][i]=o<=i?e[o][i]:0;return r}get pivotPermutationVector(){return this.pivotVector.slice()}}function l(e,t){var n=0;return Math.abs(e)>Math.abs(t)?(n=t/e,Math.abs(e)*Math.sqrt(1+n*n)):0!==t?(n=e/t,Math.abs(t)*Math.sqrt(1+n*n)):0}function c(e,t,n){for(var r=new Array(e),o=0;o<e;o++){r[o]=new Array(t);for(var i=0;i<t;i++)r[o][i]=n}return r}class A{constructor(e,t={}){var n=(e=T.checkMatrix(e)).rows,r=e.columns;const{computeLeftSingularVectors:o=!0,computeRightSingularVectors:i=!0,autoTranspose:a=!1}=t;var s,A=Boolean(o),u=Boolean(i),h=!1;if(n<r)if(a){n=(s=e.transpose()).rows,r=s.columns,h=!0;var d=A;A=u,u=d}else s=e.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else s=e.clone();var f=Math.min(n,r),p=Math.min(n+1,r),g=new Array(p),m=c(n,f,0),v=c(r,r,0),y=new Array(r),b=new Array(n),I=new Array(p);for(let e=0;e<p;e++)I[e]=e;var x=Math.min(n-1,r),w=Math.max(0,Math.min(r-2,n)),C=Math.max(x,w);for(let e=0;e<C;e++){if(e<x){g[e]=0;for(let t=e;t<n;t++)g[e]=l(g[e],s[t][e]);if(0!==g[e]){s[e][e]<0&&(g[e]=-g[e]);for(let t=e;t<n;t++)s[t][e]/=g[e];s[e][e]+=1}g[e]=-g[e]}for(let t=e+1;t<r;t++){if(e<x&&0!==g[e]){let r=0;for(let o=e;o<n;o++)r+=s[o][e]*s[o][t];r=-r/s[e][e];for(let o=e;o<n;o++)s[o][t]+=r*s[o][e]}y[t]=s[e][t]}if(A&&e<x)for(let t=e;t<n;t++)m[t][e]=s[t][e];if(e<w){y[e]=0;for(let t=e+1;t<r;t++)y[e]=l(y[e],y[t]);if(0!==y[e]){y[e+1]<0&&(y[e]=0-y[e]);for(let t=e+1;t<r;t++)y[t]/=y[e];y[e+1]+=1}if(y[e]=-y[e],e+1<n&&0!==y[e]){for(let t=e+1;t<n;t++)b[t]=0;for(let t=e+1;t<n;t++)for(let n=e+1;n<r;n++)b[t]+=y[n]*s[t][n];for(let t=e+1;t<r;t++){let r=-y[t]/y[e+1];for(let o=e+1;o<n;o++)s[o][t]+=r*b[o]}}if(u)for(let t=e+1;t<r;t++)v[t][e]=y[t]}}let E=Math.min(r,n+1);if(x<r&&(g[x]=s[x][x]),n<E&&(g[E-1]=0),w+1<E&&(y[w]=s[w][E-1]),y[E-1]=0,A){for(let e=x;e<f;e++){for(let t=0;t<n;t++)m[t][e]=0;m[e][e]=1}for(let e=x-1;e>=0;e--)if(0!==g[e]){for(let t=e+1;t<f;t++){let r=0;for(let o=e;o<n;o++)r+=m[o][e]*m[o][t];r=-r/m[e][e];for(let o=e;o<n;o++)m[o][t]+=r*m[o][e]}for(let t=e;t<n;t++)m[t][e]=-m[t][e];m[e][e]=1+m[e][e];for(let t=0;t<e-1;t++)m[t][e]=0}else{for(let t=0;t<n;t++)m[t][e]=0;m[e][e]=1}}if(u)for(let e=r-1;e>=0;e--){if(e<w&&0!==y[e])for(let t=e+1;t<r;t++){let n=0;for(let o=e+1;o<r;o++)n+=v[o][e]*v[o][t];n=-n/v[e+1][e];for(let o=e+1;o<r;o++)v[o][t]+=n*v[o][e]}for(let t=0;t<r;t++)v[t][e]=0;v[e][e]=1}for(var S=E-1,M=Number.EPSILON;E>0;){let e,t;for(e=E-2;e>=-1&&-1!==e;e--){const t=Number.MIN_VALUE+M*Math.abs(g[e]+Math.abs(g[e+1]));if(Math.abs(y[e])<=t||Number.isNaN(y[e])){y[e]=0;break}}if(e===E-2)t=4;else{let n;for(n=E-1;n>=e&&n!==e;n--){let t=(n!==E?Math.abs(y[n]):0)+(n!==e+1?Math.abs(y[n-1]):0);if(Math.abs(g[n])<=M*t){g[n]=0;break}}n===e?t=3:n===E-1?t=1:(t=2,e=n)}switch(e++,t){case 1:{let t=y[E-2];y[E-2]=0;for(let n=E-2;n>=e;n--){let o=l(g[n],t),i=g[n]/o,a=t/o;if(g[n]=o,n!==e&&(t=-a*y[n-1],y[n-1]=i*y[n-1]),u)for(let e=0;e<r;e++)o=i*v[e][n]+a*v[e][E-1],v[e][E-1]=-a*v[e][n]+i*v[e][E-1],v[e][n]=o}break}case 2:{let t=y[e-1];y[e-1]=0;for(let r=e;r<E;r++){let o=l(g[r],t),i=g[r]/o,a=t/o;if(g[r]=o,t=-a*y[r],y[r]=i*y[r],A)for(let t=0;t<n;t++)o=i*m[t][r]+a*m[t][e-1],m[t][e-1]=-a*m[t][r]+i*m[t][e-1],m[t][r]=o}break}case 3:{const t=Math.max(Math.abs(g[E-1]),Math.abs(g[E-2]),Math.abs(y[E-2]),Math.abs(g[e]),Math.abs(y[e])),o=g[E-1]/t,i=g[E-2]/t,a=y[E-2]/t,s=g[e]/t,c=y[e]/t,h=((i+o)*(i-o)+a*a)/2,d=o*a*(o*a);let f=0;0===h&&0===d||(f=d/(h+(f=h<0?0-Math.sqrt(h*h+d):Math.sqrt(h*h+d))));let p=(s+o)*(s-o)+f,b=s*c;for(let t=e;t<E-1;t++){let o=l(p,b);0===o&&(o=Number.MIN_VALUE);let i=p/o,a=b/o;if(t!==e&&(y[t-1]=o),p=i*g[t]+a*y[t],y[t]=i*y[t]-a*g[t],b=a*g[t+1],g[t+1]=i*g[t+1],u)for(let e=0;e<r;e++)o=i*v[e][t]+a*v[e][t+1],v[e][t+1]=-a*v[e][t]+i*v[e][t+1],v[e][t]=o;if(0===(o=l(p,b))&&(o=Number.MIN_VALUE),i=p/o,a=b/o,g[t]=o,p=i*y[t]+a*g[t+1],g[t+1]=-a*y[t]+i*g[t+1],b=a*y[t+1],y[t+1]=i*y[t+1],A&&t<n-1)for(let e=0;e<n;e++)o=i*m[e][t]+a*m[e][t+1],m[e][t+1]=-a*m[e][t]+i*m[e][t+1],m[e][t]=o}y[E-2]=p;break}case 4:if(g[e]<=0&&(g[e]=g[e]<0?-g[e]:0,u))for(let t=0;t<=S;t++)v[t][e]=-v[t][e];for(;e<S&&!(g[e]>=g[e+1]);){let t=g[e];if(g[e]=g[e+1],g[e+1]=t,u&&e<r-1)for(let n=0;n<r;n++)t=v[n][e+1],v[n][e+1]=v[n][e],v[n][e]=t;if(A&&e<n-1)for(let r=0;r<n;r++)t=m[r][e+1],m[r][e+1]=m[r][e],m[r][e]=t;e++}E--}}if(h){var k=v;v=m,m=k}this.m=n,this.n=r,this.s=g,this.U=m,this.V=v}solve(e){var t=e,n=this.threshold,r=this.s.length,o=P.zeros(r,r);for(let e=0;e<r;e++)Math.abs(this.s[e])<=n?o[e][e]=0:o[e][e]=1/this.s[e];var i=this.U,a=this.rightSingularVectors,s=a.mmul(o),l=a.rows,c=i.length,A=P.zeros(l,c);for(let e=0;e<l;e++)for(let t=0;t<c;t++){let n=0;for(let o=0;o<r;o++)n+=s[e][o]*i[t][o];A[e][t]=n}return A.mmul(t)}solveForDiagonal(e){return this.solve(P.diag(e))}inverse(){var e=this.V,t=this.threshold,n=e.length,r=e[0].length,o=new P(n,this.s.length);for(let i=0;i<n;i++)for(let n=0;n<r;n++)Math.abs(this.s[n])>t?o[i][n]=e[i][n]/this.s[n]:o[i][n]=0;var i=this.U,a=i.length,s=i[0].length,l=new P(n,a);for(let e=0;e<n;e++)for(let t=0;t<a;t++){let n=0;for(let r=0;r<s;r++)n+=o[e][r]*i[t][r];l[e][t]=n}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){for(var e=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,t=0,n=this.s,r=0,o=n.length;r<o;r++)n[r]>e&&t++;return t}get diagonal(){return this.s}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return P.isMatrix(this.U)||(this.U=new P(this.U)),this.U}get rightSingularVectors(){return P.isMatrix(this.V)||(this.V=new P(this.V)),this.V}get diagonalMatrix(){return P.diag(this.s)}}function u(e,t,n){var r=n?e.rows:e.rows-1;if(t<0||t>r)throw new RangeError("Row index out of range")}function h(e,t,n){var r=n?e.columns:e.columns-1;if(t<0||t>r)throw new RangeError("Column index out of range")}function d(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.columns)throw new RangeError("vector size must be the same as the number of columns");return t}function f(e,t){if(t.to1DArray&&(t=t.to1DArray()),t.length!==e.rows)throw new RangeError("vector size must be the same as the number of rows");return t}function p(e,t,n){return{row:g(e,t),column:m(e,n)}}function g(e,t){if("object"!=typeof t)throw new TypeError("unexpected type for row indices");if(t.some(t=>t<0||t>=e.rows))throw new RangeError("row indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function m(e,t){if("object"!=typeof t)throw new TypeError("unexpected type for column indices");if(t.some(t=>t<0||t>=e.columns))throw new RangeError("column indices are out of range");return Array.isArray(t)||(t=Array.from(t)),t}function v(e,t,n,r,o){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(y("startRow",t),y("endRow",n),y("startColumn",r),y("endColumn",o),t>n||r>o||t<0||t>=e.rows||n<0||n>=e.rows||r<0||r>=e.columns||o<0||o>=e.columns)throw new RangeError("Submatrix indices are out of range")}function y(e,t){if("number"!=typeof t)throw new TypeError(`${e} must be a number`)}class b extends(D()){constructor(e,t,n){super(),this.matrix=e,this.rows=t,this.columns=n}static get[Symbol.species](){return P}}class I extends b{constructor(e){super(e,e.columns,e.rows)}set(e,t,n){return this.matrix.set(t,e,n),this}get(e,t){return this.matrix.get(t,e)}}class x extends b{constructor(e,t){super(e,1,e.columns),this.row=t}set(e,t,n){return this.matrix.set(this.row,t,n),this}get(e,t){return this.matrix.get(this.row,t)}}class w extends b{constructor(e,t,n,r,o){v(e,t,n,r,o),super(e,n-t+1,o-r+1),this.startRow=t,this.startColumn=r}set(e,t,n){return this.matrix.set(this.startRow+e,this.startColumn+t,n),this}get(e,t){return this.matrix.get(this.startRow+e,this.startColumn+t)}}class C extends b{constructor(e,t,n){var r=p(e,t,n);super(e,r.row.length,r.column.length),this.rowIndices=r.row,this.columnIndices=r.column}set(e,t,n){return this.matrix.set(this.rowIndices[e],this.columnIndices[t],n),this}get(e,t){return this.matrix.get(this.rowIndices[e],this.columnIndices[t])}}class E extends b{constructor(e,t){super(e,(t=g(e,t)).length,e.columns),this.rowIndices=t}set(e,t,n){return this.matrix.set(this.rowIndices[e],t,n),this}get(e,t){return this.matrix.get(this.rowIndices[e],t)}}class S extends b{constructor(e,t){t=m(e,t),super(e,e.rows,t.length),this.columnIndices=t}set(e,t,n){return this.matrix.set(e,this.columnIndices[t],n),this}get(e,t){return this.matrix.get(e,this.columnIndices[t])}}class M extends b{constructor(e,t){super(e,e.rows,1),this.column=t}set(e,t,n){return this.matrix.set(e,this.column,n),this}get(e){return this.matrix.get(e,this.column)}}class k extends b{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(this.rows-e-1,t,n),this}get(e,t){return this.matrix.get(this.rows-e-1,t)}}class B extends b{constructor(e){super(e,e.rows,e.columns)}set(e,t,n){return this.matrix.set(e,this.columns-t-1,n),this}get(e,t){return this.matrix.get(e,this.columns-t-1)}}function D(e){void 0===e&&(e=Object);class t extends e{static get[Symbol.species](){return this}static from1DArray(e,t,n){if(e*t!==n.length)throw new RangeError("Data length does not match given dimensions");for(var r=new this(e,t),o=0;o<e;o++)for(var i=0;i<t;i++)r.set(o,i,n[o*t+i]);return r}static rowVector(e){for(var t=new this(1,e.length),n=0;n<e.length;n++)t.set(0,n,e[n]);return t}static columnVector(e){for(var t=new this(e.length,1),n=0;n<e.length;n++)t.set(n,0,e[n]);return t}static empty(e,t){return new this(e,t)}static zeros(e,t){return this.empty(e,t).fill(0)}static ones(e,t){return this.empty(e,t).fill(1)}static rand(e,t,n){void 0===n&&(n=Math.random);for(var r=this.empty(e,t),o=0;o<e;o++)for(var i=0;i<t;i++)r.set(o,i,n());return r}static randInt(e,t,n,r){void 0===n&&(n=1e3),void 0===r&&(r=Math.random);for(var o=this.empty(e,t),i=0;i<e;i++)for(var a=0;a<t;a++){var s=Math.floor(r()*n);o.set(i,a,s)}return o}static eye(e,t,n){void 0===t&&(t=e),void 0===n&&(n=1);for(var r=Math.min(e,t),o=this.zeros(e,t),i=0;i<r;i++)o.set(i,i,n);return o}static diag(e,t,n){var r=e.length;void 0===t&&(t=r),void 0===n&&(n=t);for(var o=Math.min(r,t,n),i=this.zeros(t,n),a=0;a<o;a++)i.set(a,a,e[a]);return i}static min(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,r=e.columns,o=new this(n,r),i=0;i<n;i++)for(var a=0;a<r;a++)o.set(i,a,Math.min(e.get(i,a),t.get(i,a)));return o}static max(e,t){e=this.checkMatrix(e),t=this.checkMatrix(t);for(var n=e.rows,r=e.columns,o=new this(n,r),i=0;i<n;i++)for(var a=0;a<r;a++)o.set(i,a,Math.max(e.get(i,a),t.get(i,a)));return o}static checkMatrix(e){return t.isMatrix(e)?e:new this(e)}static isMatrix(e){return null!=e&&"Matrix"===e.klass}get size(){return this.rows*this.columns}apply(e){if("function"!=typeof e)throw new TypeError("callback must be a function");for(var t=this.rows,n=this.columns,r=0;r<t;r++)for(var o=0;o<n;o++)e.call(this,r,o);return this}to1DArray(){for(var e=new Array(this.size),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e[t*this.columns+n]=this.get(t,n);return e}to2DArray(){for(var e=new Array(this.rows),t=0;t<this.rows;t++){e[t]=new Array(this.columns);for(var n=0;n<this.columns;n++)e[t][n]=this.get(t,n)}return e}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isSymmetric(){if(this.isSquare()){for(var e=0;e<this.rows;e++)for(var t=0;t<=e;t++)if(this.get(e,t)!==this.get(t,e))return!1;return!0}return!1}set(e,t,n){throw new Error("set method is unimplemented")}get(e,t){throw new Error("get method is unimplemented")}repeat(e,t){e=e||1,t=t||1;for(var n=new this.constructor[Symbol.species](this.rows*e,this.columns*t),r=0;r<e;r++)for(var o=0;o<t;o++)n.setSubMatrix(this,this.rows*r,this.columns*o);return n}fill(e){for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,e);return this}neg(){return this.mulS(-1)}getRow(e){u(this,e);for(var t=new Array(this.columns),n=0;n<this.columns;n++)t[n]=this.get(e,n);return t}getRowVector(e){return this.constructor.rowVector(this.getRow(e))}setRow(e,t){u(this,e),t=d(this,t);for(var n=0;n<this.columns;n++)this.set(e,n,t[n]);return this}swapRows(e,t){u(this,e),u(this,t);for(var n=0;n<this.columns;n++){var r=this.get(e,n);this.set(e,n,this.get(t,n)),this.set(t,n,r)}return this}getColumn(e){h(this,e);for(var t=new Array(this.rows),n=0;n<this.rows;n++)t[n]=this.get(n,e);return t}getColumnVector(e){return this.constructor.columnVector(this.getColumn(e))}setColumn(e,t){h(this,e),t=f(this,t);for(var n=0;n<this.rows;n++)this.set(n,e,t[n]);return this}swapColumns(e,t){h(this,e),h(this,t);for(var n=0;n<this.rows;n++){var r=this.get(n,e);this.set(n,e,this.get(n,t)),this.set(n,t,r)}return this}addRowVector(e){e=d(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[n]);return this}subRowVector(e){e=d(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[n]);return this}mulRowVector(e){e=d(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[n]);return this}divRowVector(e){e=d(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[n]);return this}addColumnVector(e){e=f(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)+e[t]);return this}subColumnVector(e){e=f(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)-e[t]);return this}mulColumnVector(e){e=f(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)*e[t]);return this}divColumnVector(e){e=f(this,e);for(var t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.set(t,n,this.get(t,n)/e[t]);return this}mulRow(e,t){u(this,e);for(var n=0;n<this.columns;n++)this.set(e,n,this.get(e,n)*t);return this}mulColumn(e,t){h(this,e);for(var n=0;n<this.rows;n++)this.set(n,e,this.get(n,e)*t);return this}max(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.get(t,n)>e&&(e=this.get(t,n));return e}maxIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)>e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}min(){for(var e=this.get(0,0),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)this.get(t,n)<e&&(e=this.get(t,n));return e}minIndex(){for(var e=this.get(0,0),t=[0,0],n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)this.get(n,r)<e&&(e=this.get(n,r),t[0]=n,t[1]=r);return t}maxRow(e){u(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)>t&&(t=this.get(e,n));return t}maxRowIndex(e){u(this,e);for(var t=this.get(e,0),n=[e,0],r=1;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r),n[1]=r);return n}minRow(e){u(this,e);for(var t=this.get(e,0),n=1;n<this.columns;n++)this.get(e,n)<t&&(t=this.get(e,n));return t}minRowIndex(e){u(this,e);for(var t=this.get(e,0),n=[e,0],r=1;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r),n[1]=r);return n}maxColumn(e){h(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)>t&&(t=this.get(n,e));return t}maxColumnIndex(e){h(this,e);for(var t=this.get(0,e),n=[0,e],r=1;r<this.rows;r++)this.get(r,e)>t&&(t=this.get(r,e),n[0]=r);return n}minColumn(e){h(this,e);for(var t=this.get(0,e),n=1;n<this.rows;n++)this.get(n,e)<t&&(t=this.get(n,e));return t}minColumnIndex(e){h(this,e);for(var t=this.get(0,e),n=[0,e],r=1;r<this.rows;r++)this.get(r,e)<t&&(t=this.get(r,e),n[0]=r);return n}diag(){for(var e=Math.min(this.rows,this.columns),t=new Array(e),n=0;n<e;n++)t[n]=this.get(n,n);return t}sum(e){switch(e){case"row":return function(e){for(var t=P.zeros(e.rows,1),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t.set(n,0,t.get(n,0)+e.get(n,r));return t}(this);case"column":return function(e){for(var t=P.zeros(1,e.columns),n=0;n<e.rows;++n)for(var r=0;r<e.columns;++r)t.set(0,r,t.get(0,r)+e.get(n,r));return t}(this);default:return function(e){for(var t=0,n=0;n<e.rows;n++)for(var r=0;r<e.columns;r++)t+=e.get(n,r);return t}(this)}}mean(){return this.sum()/this.size}prod(){for(var e=1,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e*=this.get(t,n);return e}norm(e="frobenius"){var t=0;if("max"===e)return this.max();if("frobenius"===e){for(var n=0;n<this.rows;n++)for(var r=0;r<this.columns;r++)t+=this.get(n,r)*this.get(n,r);return Math.sqrt(t)}throw new RangeError(`unknown norm type: ${e}`)}cumulativeSum(){for(var e=0,t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e+=this.get(t,n),this.set(t,n,e);return this}dot(e){t.isMatrix(e)&&(e=e.to1DArray());var n=this.to1DArray();if(n.length!==e.length)throw new RangeError("vectors do not have the same size");for(var r=0,o=0;o<n.length;o++)r+=n[o]*e[o];return r}mmul(e){e=this.constructor.checkMatrix(e),this.columns!==e.rows&&console.warn("Number of columns of left matrix are not equal to number of rows of right matrix.");for(var t=this.rows,n=this.columns,r=e.columns,o=new this.constructor[Symbol.species](t,r),i=new Array(n),a=0;a<r;a++){for(var s=0;s<n;s++)i[s]=e.get(s,a);for(var l=0;l<t;l++){var c=0;for(s=0;s<n;s++)c+=this.get(l,s)*i[s];o.set(l,a,c)}}return o}strassen2x2(e){var t=new this.constructor[Symbol.species](2,2);const n=this.get(0,0),r=e.get(0,0),o=this.get(0,1),i=e.get(0,1),a=this.get(1,0),s=e.get(1,0),l=this.get(1,1),c=e.get(1,1),A=(n+l)*(r+c),u=(a+l)*r,h=n*(i-c),d=l*(s-r),f=(n+o)*c,p=A+d-f+(o-l)*(s+c),g=h+f,m=u+d,v=A-u+h+(a-n)*(r+i);return t.set(0,0,p),t.set(0,1,g),t.set(1,0,m),t.set(1,1,v),t}strassen3x3(e){var t=new this.constructor[Symbol.species](3,3);const n=this.get(0,0),r=this.get(0,1),o=this.get(0,2),i=this.get(1,0),a=this.get(1,1),s=this.get(1,2),l=this.get(2,0),c=this.get(2,1),A=this.get(2,2),u=e.get(0,0),h=e.get(0,1),d=e.get(0,2),f=e.get(1,0),p=e.get(1,1),g=e.get(1,2),m=e.get(2,0),v=e.get(2,1),y=e.get(2,2),b=(n-i)*(-h+p),I=(-n+i+a)*(u-h+p),x=(i+a)*(-u+h),w=n*u,C=(-n+l+c)*(u-d+g),E=(-n+l)*(d-g),S=(l+c)*(-u+d),M=(-o+c+A)*(p+m-v),k=(o-A)*(p-v),B=o*m,D=(c+A)*(-m+v),P=(-o+a+s)*(g+m-y),Q=(o-s)*(g-y),T=(a+s)*(-m+y),G=w+B+r*f,R=(n+r+o-i-a-c-A)*p+I+x+w+M+B+D,_=w+C+S+(n+r+o-a-s-l-c)*g+B+P+T,V=b+a*(-u+h+f-p-g-m+y)+I+w+B+P+Q,N=b+I+x+w+s*v,F=B+P+Q+T+i*d,O=w+C+E+c*(-u+d+f-p-g-m+v)+M+k+B,L=M+k+B+D+l*h,j=w+C+E+S+A*y;return t.set(0,0,G),t.set(0,1,R),t.set(0,2,_),t.set(1,0,V),t.set(1,1,N),t.set(1,2,F),t.set(2,0,O),t.set(2,1,L),t.set(2,2,j),t}mmulStrassen(e){var n=this.clone(),r=n.rows,o=n.columns,i=e.rows,a=e.columns;function s(e,n,r){var o=e.rows,i=e.columns;if(o===n&&i===r)return e;var a=t.zeros(n,r);return a.setSubMatrix(e,0,0)}o!==i&&console.warn(`Multiplying ${r} x ${o} and ${i} x ${a} matrix: dimensions do not match.`);var l=Math.max(r,i),c=Math.max(o,a);return function e(n,r,o,i){if(o<=512||i<=512)return n.mmul(r);o%2==1&&i%2==1?(n=s(n,o+1,i+1),r=s(r,o+1,i+1)):o%2==1?(n=s(n,o+1,i),r=s(r,o+1,i)):i%2==1&&(n=s(n,o,i+1),r=s(r,o,i+1));var a=parseInt(n.rows/2,10),l=parseInt(n.columns/2,10),c=n.subMatrix(0,a-1,0,l-1),A=r.subMatrix(0,a-1,0,l-1),u=n.subMatrix(0,a-1,l,n.columns-1),h=r.subMatrix(0,a-1,l,r.columns-1),d=n.subMatrix(a,n.rows-1,0,l-1),f=r.subMatrix(a,r.rows-1,0,l-1),p=n.subMatrix(a,n.rows-1,l,n.columns-1),g=r.subMatrix(a,r.rows-1,l,r.columns-1),m=e(t.add(c,p),t.add(A,g),a,l),v=e(t.add(d,p),A,a,l),y=e(c,t.sub(h,g),a,l),b=e(p,t.sub(f,A),a,l),I=e(t.add(c,u),g,a,l),x=e(t.sub(d,c),t.add(A,h),a,l),w=e(t.sub(u,p),t.add(f,g),a,l),C=t.add(m,b);C.sub(I),C.add(w);var E=t.add(y,I),S=t.add(v,b),M=t.sub(m,v);M.add(y),M.add(x);var k=t.zeros(2*C.rows,2*C.columns);return(k=(k=(k=(k=k.setSubMatrix(C,0,0)).setSubMatrix(E,C.rows,0)).setSubMatrix(S,0,C.columns)).setSubMatrix(M,C.rows,C.columns)).subMatrix(0,o-1,0,i-1)}(n=s(n,l,c),e=s(e,l,c),l,c)}scaleRows(e,t){if((e=void 0===e?0:e)>=(t=void 0===t?1:t))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.rows;r++){var o=a(this.getRow(r),{min:e,max:t});n.setRow(r,o)}return n}scaleColumns(e,t){if((e=void 0===e?0:e)>=(t=void 0===t?1:t))throw new RangeError("min should be strictly smaller than max");for(var n=this.constructor.empty(this.rows,this.columns),r=0;r<this.columns;r++){var o=a(this.getColumn(r),{min:e,max:t});n.setColumn(r,o)}return n}kroneckerProduct(e){e=this.constructor.checkMatrix(e);for(var t=this.rows,n=this.columns,r=e.rows,o=e.columns,i=new this.constructor[Symbol.species](t*r,n*o),a=0;a<t;a++)for(var s=0;s<n;s++)for(var l=0;l<r;l++)for(var c=0;c<o;c++)i[r*a+l][o*s+c]=this.get(a,s)*e.get(l,c);return i}transpose(){for(var e=new this.constructor[Symbol.species](this.columns,this.rows),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(n,t,this.get(t,n));return e}sortRows(e){void 0===e&&(e=n);for(var t=0;t<this.rows;t++)this.setRow(t,this.getRow(t).sort(e));return this}sortColumns(e){void 0===e&&(e=n);for(var t=0;t<this.columns;t++)this.setColumn(t,this.getColumn(t).sort(e));return this}subMatrix(e,t,n,r){v(this,e,t,n,r);for(var o=new this.constructor[Symbol.species](t-e+1,r-n+1),i=e;i<=t;i++)for(var a=n;a<=r;a++)o[i-e][a-n]=this.get(i,a);return o}subMatrixRow(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.columns-1),t>n||t<0||t>=this.columns||n<0||n>=this.columns)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](e.length,n-t+1),o=0;o<e.length;o++)for(var i=t;i<=n;i++){if(e[o]<0||e[o]>=this.rows)throw new RangeError(`Row index out of range: ${e[o]}`);r.set(o,i-t,this.get(e[o],i))}return r}subMatrixColumn(e,t,n){if(void 0===t&&(t=0),void 0===n&&(n=this.rows-1),t>n||t<0||t>=this.rows||n<0||n>=this.rows)throw new RangeError("Argument out of range");for(var r=new this.constructor[Symbol.species](n-t+1,e.length),o=0;o<e.length;o++)for(var i=t;i<=n;i++){if(e[o]<0||e[o]>=this.columns)throw new RangeError(`Column index out of range: ${e[o]}`);r.set(i-t,o,this.get(i,e[o]))}return r}setSubMatrix(e,t,n){v(this,t,t+(e=this.constructor.checkMatrix(e)).rows-1,n,n+e.columns-1);for(var r=0;r<e.rows;r++)for(var o=0;o<e.columns;o++)this[t+r][n+o]=e.get(r,o);return this}selection(e,t){for(var n=p(this,e,t),r=new this.constructor[Symbol.species](e.length,t.length),o=0;o<n.row.length;o++)for(var i=n.row[o],a=0;a<n.column.length;a++){var s=n.column[a];r[o][a]=this.get(i,s)}return r}trace(){for(var e=Math.min(this.rows,this.columns),t=0,n=0;n<e;n++)t+=this.get(n,n);return t}transposeView(){return new I(this)}rowView(e){return u(this,e),new x(this,e)}columnView(e){return h(this,e),new M(this,e)}flipRowView(){return new k(this)}flipColumnView(){return new B(this)}subMatrixView(e,t,n,r){return new w(this,e,t,n,r)}selectionView(e,t){return new C(this,e,t)}rowSelectionView(e){return new E(this,e)}columnSelectionView(e){return new S(this,e)}det(){var e,t,n,r,o,i;if(this.isSquare())return 2===this.columns?(e=this.get(0,0),t=this.get(0,1),n=this.get(1,0),e*this.get(1,1)-t*n):3===this.columns?(r=this.selectionView([1,2],[1,2]),o=this.selectionView([1,2],[0,2]),i=this.selectionView([1,2],[0,1]),e=this.get(0,0),t=this.get(0,1),n=this.get(0,2),e*r.det()-t*o.det()+n*i.det()):new s(this).determinant;throw Error("Determinant can only be calculated for a square matrix.")}pseudoInverse(e){void 0===e&&(e=Number.EPSILON);for(var t=new A(this,{autoTranspose:!0}),n=t.leftSingularVectors,r=t.rightSingularVectors,o=t.diagonal,i=0;i<o.length;i++)Math.abs(o[i])>e?o[i]=1/o[i]:o[i]=0;return o=this.constructor[Symbol.species].diag(o),r.mmul(o.mmul(n.transposeView()))}clone(){for(var e=new this.constructor[Symbol.species](this.rows,this.columns),t=0;t<this.rows;t++)for(var n=0;n<this.columns;n++)e.set(t,n,this.get(t,n));return e}}function n(e,t){return e-t}t.prototype.klass="Matrix",t.random=t.rand,t.diagonal=t.diag,t.prototype.diagonal=t.prototype.diag,t.identity=t.eye,t.prototype.negate=t.prototype.neg,t.prototype.tensorProduct=t.prototype.kroneckerProduct,t.prototype.determinant=t.prototype.det;var r,o=eval;for(var i of[["+","add"],["-","sub","subtract"],["*","mul","multiply"],["/","div","divide"],["%","mod","modulus"],["&","and"],["|","or"],["^","xor"],["<<","leftShift"],[">>","signPropagatingRightShift"],[">>>","rightShift","zeroFillRightShift"]]){var l=o(j("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",{name:i[1],op:i[0]})),c=o(j("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% value);\n        }\n    }\n    return this;\n})\n",{name:`${i[1]}S`,op:i[0]})),g=o(j("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, this.get(i, j) %op% matrix.get(i, j));\n        }\n    }\n    return this;\n})\n",{name:`${i[1]}M`,op:i[0]})),m=o(j("\n(function %name%(matrix, value) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(value);\n})\n",{name:i[1]}));for(r=1;r<i.length;r++)t.prototype[i[r]]=l,t.prototype[`${i[r]}S`]=c,t.prototype[`${i[r]}M`]=g,t[i[r]]=m}var y=[["~","not"]];for(var b of(["abs","acos","acosh","asin","asinh","atan","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","log","log1p","log10","log2","round","sign","sin","sinh","sqrt","tan","tanh","trunc"].forEach(function(e){y.push([`Math.${e}`,e])}),y)){var D=o(j("\n(function %name%() {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j)));\n        }\n    }\n    return this;\n})\n",{name:b[1],method:b[0]})),Q=o(j("\n(function %name%(matrix) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%();\n})\n",{name:b[1]}));for(r=1;r<b.length;r++)t.prototype[b[r]]=D,t[b[r]]=Q}for(var T of[["Math.pow",1,"pow"]]){var G="arg0";for(r=1;r<T[1];r++)G+=`, arg${r}`;if(1!==T[1]){var R=o(j("\n(function %name%(%args%) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), %args%));\n        }\n    }\n    return this;\n})\n",{name:T[2],method:T[0],args:G})),_=o(j("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",{name:T[2],args:G}));for(r=2;r<T.length;r++)t.prototype[T[r]]=R,t[T[r]]=_}else{var V={name:T[2],args:G,method:T[0]},N=o(j("\n(function %name%(value) {\n    if (typeof value === 'number') return this.%name%S(value);\n    return this.%name%M(value);\n})\n",V)),F=o(j("\n(function %name%S(value) {\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), value));\n        }\n    }\n    return this;\n})\n",V)),O=o(j("\n(function %name%M(matrix) {\n    matrix = this.constructor.checkMatrix(matrix);\n    if (this.rows !== matrix.rows ||\n        this.columns !== matrix.columns) {\n        throw new RangeError('Matrices dimensions must be equal');\n    }\n    for (var i = 0; i < this.rows; i++) {\n        for (var j = 0; j < this.columns; j++) {\n            this.set(i, j, %method%(this.get(i, j), matrix.get(i, j)));\n        }\n    }\n    return this;\n})\n",V)),L=o(j("\n(function %name%(matrix, %args%) {\n    var newMatrix = new this[Symbol.species](matrix);\n    return newMatrix.%name%(%args%);\n})\n",V));for(r=2;r<T.length;r++)t.prototype[T[r]]=N,t.prototype[`${T[r]}M`]=O,t.prototype[`${T[r]}S`]=F,t[T[r]]=L}}function j(e,t){for(var n in t)e=e.replace(new RegExp(`%${n}%`,"g"),t[n]);return e}return t}class P extends(D(Array)){constructor(e,t){var n;if(1===arguments.length&&"number"==typeof e)return new Array(e);if(P.isMatrix(e))return e.clone();if(Number.isInteger(e)&&e>0){if(super(e),!(Number.isInteger(t)&&t>0))throw new TypeError("nColumns must be a positive integer");for(n=0;n<e;n++)this[n]=new Array(t)}else{if(!Array.isArray(e))throw new TypeError("First argument must be a positive number or an array");{const r=e;if(e=r.length,"number"!=typeof(t=r[0].length)||0===t)throw new TypeError("Data must be a 2D array with at least one element");for(super(e),n=0;n<e;n++){if(r[n].length!==t)throw new RangeError("Inconsistent array dimensions");this[n]=[].concat(r[n])}}}return this.rows=e,this.columns=t,this}set(e,t,n){return this[e][t]=n,this}get(e,t){return this[e][t]}removeRow(e){if(u(this,e),1===this.rows)throw new RangeError("A matrix cannot have less than one row");return this.splice(e,1),this.rows-=1,this}addRow(e,t){return void 0===t&&(t=e,e=this.rows),u(this,e,!0),t=d(this,t),this.splice(e,0,t),this.rows+=1,this}removeColumn(e){if(h(this,e),1===this.columns)throw new RangeError("A matrix cannot have less than one column");for(var t=0;t<this.rows;t++)this[t].splice(e,1);return this.columns-=1,this}addColumn(e,t){void 0===t&&(t=e,e=this.columns),h(this,e,!0),t=f(this,t);for(var n=0;n<this.rows;n++)this[n].splice(e,0,t[n]);return this.columns+=1,this}}class Q extends(D()){constructor(e,t={}){const{rows:n=1}=t;if(e.length%n!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=n,this.columns=e.length/n,this.data=e}set(e,t,n){var r=this._calculateIndex(e,t);return this.data[r]=n,this}get(e,t){var n=this._calculateIndex(e,t);return this.data[n]}_calculateIndex(e,t){return e*this.columns+t}static get[Symbol.species](){return P}}class T extends(D()){constructor(e){super(),this.data=e,this.rows=e.length,this.columns=e[0].length}set(e,t,n){return this.data[e][t]=n,this}get(e,t){return this.data[e][t]}static get[Symbol.species](){return P}}function G(e,t){if(Array.isArray(e))return e[0]&&Array.isArray(e[0])?new T(e):new Q(e,t);throw new Error("the argument is not an array")}class R{constructor(e){var t,n,r,o,i=(e=T.checkMatrix(e)).clone(),a=e.rows,s=e.columns,c=new Array(s);for(r=0;r<s;r++){var A=0;for(t=r;t<a;t++)A=l(A,i.get(t,r));if(0!==A){for(i.get(r,r)<0&&(A=-A),t=r;t<a;t++)i.set(t,r,i.get(t,r)/A);for(i.set(r,r,i.get(r,r)+1),n=r+1;n<s;n++){for(o=0,t=r;t<a;t++)o+=i.get(t,r)*i.get(t,n);for(o=-o/i.get(r,r),t=r;t<a;t++)i.set(t,n,i.get(t,n)+o*i.get(t,r))}}c[r]=-A}this.QR=i,this.Rdiag=c}solve(e){e=P.checkMatrix(e);var t=this.QR,n=t.rows;if(e.rows!==n)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");var r,o,i,a,s=e.columns,l=e.clone(),c=t.columns;for(i=0;i<c;i++)for(o=0;o<s;o++){for(a=0,r=i;r<n;r++)a+=t[r][i]*l[r][o];for(a=-a/t[i][i],r=i;r<n;r++)l[r][o]+=a*t[r][i]}for(i=c-1;i>=0;i--){for(o=0;o<s;o++)l[i][o]/=this.Rdiag[i];for(r=0;r<i;r++)for(o=0;o<s;o++)l[r][o]-=l[i][o]*t[r][i]}return l.subMatrix(0,c-1,0,s-1)}isFullRank(){for(var e=this.QR.columns,t=0;t<e;t++)if(0===this.Rdiag[t])return!1;return!0}get upperTriangularMatrix(){var e,t,n=this.QR,r=n.columns,o=new P(r,r);for(e=0;e<r;e++)for(t=0;t<r;t++)o[e][t]=e<t?n[e][t]:e===t?this.Rdiag[e]:0;return o}get orthogonalMatrix(){var e,t,n,r,o=this.QR,i=o.rows,a=o.columns,s=new P(i,a);for(n=a-1;n>=0;n--){for(e=0;e<i;e++)s[e][n]=0;for(s[n][n]=1,t=n;t<a;t++)if(0!==o[n][n]){for(r=0,e=n;e<i;e++)r+=o[e][n]*s[e][t];for(r=-r/o[n][n],e=n;e<i;e++)s[e][t]+=r*o[e][n]}}return s}}function _(e,t=!1){return e=T.checkMatrix(e),t?new A(e).inverse():V(e,P.eye(e.rows))}function V(e,t,n=!1){return e=T.checkMatrix(e),t=T.checkMatrix(t),n?new A(e).solve(t):e.isSquare()?new s(e).solve(t):new R(e).solve(t)}function N(e,t){for(var n=[],r=0;r<e;r++)r!==t&&n.push(r);return n}function F(e,t,n,r=1e-9,o=1e-9){if(e>o)return new Array(t.rows+1).fill(0);for(var i=t.addRow(n,[0]),a=0;a<i.rows;a++)Math.abs(i.get(a,0))<r&&i.set(a,0,0);return i.to1DArray()}function O(e,t={}){const{thresholdValue:n=1e-9,thresholdError:r=1e-9}=t;for(var o=e.rows,a=new P(o,o),s=0;s<o;s++){var l=P.columnVector(e.getRow(s)),c=e.subMatrixRow(N(o,s)).transposeView(),u=new A(c).solve(l),h=i(P.sub(l,c.mmul(u)).abs().to1DArray());a.setRow(s,F(h,u,s,n,r))}return a}class L{constructor(e,t={}){const{assumeSymmetric:n=!1}=t;if(!(e=T.checkMatrix(e)).isSquare())throw new Error("Matrix is not a square matrix");var r,o,i=e.columns,a=c(i,i,0),s=new Array(i),A=new Array(i),u=e;if(n||e.isSymmetric()){for(r=0;r<i;r++)for(o=0;o<i;o++)a[r][o]=u.get(r,o);!function(e,t,n,r){var o,i,a,s,l,c,A,u;for(l=0;l<e;l++)n[l]=r[e-1][l];for(s=e-1;s>0;s--){for(u=0,a=0,c=0;c<s;c++)u+=Math.abs(n[c]);if(0===u)for(t[s]=n[s-1],l=0;l<s;l++)n[l]=r[s-1][l],r[s][l]=0,r[l][s]=0;else{for(c=0;c<s;c++)n[c]/=u,a+=n[c]*n[c];for(o=n[s-1],i=Math.sqrt(a),o>0&&(i=-i),t[s]=u*i,a-=o*i,n[s-1]=o-i,l=0;l<s;l++)t[l]=0;for(l=0;l<s;l++){for(o=n[l],r[l][s]=o,i=t[l]+r[l][l]*o,c=l+1;c<=s-1;c++)i+=r[c][l]*n[c],t[c]+=r[c][l]*o;t[l]=i}for(o=0,l=0;l<s;l++)t[l]/=a,o+=t[l]*n[l];for(A=o/(a+a),l=0;l<s;l++)t[l]-=A*n[l];for(l=0;l<s;l++){for(o=n[l],i=t[l],c=l;c<=s-1;c++)r[c][l]-=o*t[c]+i*n[c];n[l]=r[s-1][l],r[s][l]=0}}n[s]=a}for(s=0;s<e-1;s++){if(r[e-1][s]=r[s][s],r[s][s]=1,0!==(a=n[s+1])){for(c=0;c<=s;c++)n[c]=r[c][s+1]/a;for(l=0;l<=s;l++){for(i=0,c=0;c<=s;c++)i+=r[c][s+1]*r[c][l];for(c=0;c<=s;c++)r[c][l]-=i*n[c]}}for(c=0;c<=s;c++)r[c][s+1]=0}for(l=0;l<e;l++)n[l]=r[e-1][l],r[e-1][l]=0;r[e-1][e-1]=1,t[0]=0}(i,A,s,a),function(e,t,n,r){var o,i,a,s,c,A,u,h,d,f,p,g,m,v,y,b;for(a=1;a<e;a++)t[a-1]=t[a];t[e-1]=0;var I=0,x=0,w=Number.EPSILON;for(A=0;A<e;A++){for(x=Math.max(x,Math.abs(n[A])+Math.abs(t[A])),u=A;u<e&&!(Math.abs(t[u])<=w*x);)u++;if(u>A)do{for(o=n[A],d=l(h=(n[A+1]-o)/(2*t[A]),1),h<0&&(d=-d),n[A]=t[A]/(h+d),n[A+1]=t[A]*(h+d),f=n[A+1],i=o-n[A],a=A+2;a<e;a++)n[a]-=i;for(I+=i,h=n[u],g=p=1,m=p,v=t[A+1],y=0,b=0,a=u-1;a>=A;a--)for(m=g,g=p,b=y,o=p*t[a],i=p*h,d=l(h,t[a]),t[a+1]=y*d,y=t[a]/d,h=(p=h/d)*n[a]-y*o,n[a+1]=i+y*(p*o+y*n[a]),c=0;c<e;c++)i=r[c][a+1],r[c][a+1]=y*r[c][a]+p*i,r[c][a]=p*r[c][a]-y*i;h=-y*b*m*v*t[A]/f,t[A]=y*h,n[A]=p*h}while(Math.abs(t[A])>w*x);n[A]=n[A]+I,t[A]=0}for(a=0;a<e-1;a++){for(c=a,h=n[a],s=a+1;s<e;s++)n[s]<h&&(c=s,h=n[s]);if(c!==a)for(n[c]=n[a],n[a]=h,s=0;s<e;s++)h=r[s][a],r[s][a]=r[s][c],r[s][c]=h}}(i,A,s,a)}else{var h=c(i,i,0),d=new Array(i);for(o=0;o<i;o++)for(r=0;r<i;r++)h[r][o]=u.get(r,o);!function(e,t,n,r){var o,i,a,s,l,c,A,u=e-1;for(c=1;c<=u-1;c++){for(A=0,s=c;s<=u;s++)A+=Math.abs(t[s][c-1]);if(0!==A){for(a=0,s=u;s>=c;s--)n[s]=t[s][c-1]/A,a+=n[s]*n[s];for(i=Math.sqrt(a),n[c]>0&&(i=-i),a-=n[c]*i,n[c]=n[c]-i,l=c;l<e;l++){for(o=0,s=u;s>=c;s--)o+=n[s]*t[s][l];for(o/=a,s=c;s<=u;s++)t[s][l]-=o*n[s]}for(s=0;s<=u;s++){for(o=0,l=u;l>=c;l--)o+=n[l]*t[s][l];for(o/=a,l=c;l<=u;l++)t[s][l]-=o*n[l]}n[c]=A*n[c],t[c][c-1]=A*i}}for(s=0;s<e;s++)for(l=0;l<e;l++)r[s][l]=s===l?1:0;for(c=u-1;c>=1;c--)if(0!==t[c][c-1]){for(s=c+1;s<=u;s++)n[s]=t[s][c-1];for(l=c;l<=u;l++){for(i=0,s=c;s<=u;s++)i+=n[s]*r[s][l];for(i=i/n[c]/t[c][c-1],s=c;s<=u;s++)r[s][l]+=i*n[s]}}}(i,h,d,a),function(e,t,n,r,o){var i,a,s,l,c,A,u,h,d,f,p,g,m,v,y,b=e-1,I=e-1,x=Number.EPSILON,w=0,C=0,E=0,S=0,M=0,k=0,B=0,D=0;for(i=0;i<e;i++)for((i<0||i>I)&&(n[i]=o[i][i],t[i]=0),a=Math.max(i-1,0);a<e;a++)C+=Math.abs(o[i][a]);for(;b>=0;){for(l=b;l>0&&(0===(k=Math.abs(o[l-1][l-1])+Math.abs(o[l][l]))&&(k=C),!(Math.abs(o[l][l-1])<x*k));)l--;if(l===b)o[b][b]=o[b][b]+w,n[b]=o[b][b],t[b]=0,b--,D=0;else if(l===b-1){if(u=o[b][b-1]*o[b-1][b],S=(E=(o[b-1][b-1]-o[b][b])/2)*E+u,B=Math.sqrt(Math.abs(S)),o[b][b]=o[b][b]+w,o[b-1][b-1]=o[b-1][b-1]+w,h=o[b][b],S>=0){for(B=E>=0?E+B:E-B,n[b-1]=h+B,n[b]=n[b-1],0!==B&&(n[b]=h-u/B),t[b-1]=0,t[b]=0,E=(h=o[b][b-1])/(k=Math.abs(h)+Math.abs(B)),S=B/k,E/=M=Math.sqrt(E*E+S*S),S/=M,a=b-1;a<e;a++)B=o[b-1][a],o[b-1][a]=S*B+E*o[b][a],o[b][a]=S*o[b][a]-E*B;for(i=0;i<=b;i++)B=o[i][b-1],o[i][b-1]=S*B+E*o[i][b],o[i][b]=S*o[i][b]-E*B;for(i=0;i<=I;i++)B=r[i][b-1],r[i][b-1]=S*B+E*r[i][b],r[i][b]=S*r[i][b]-E*B}else n[b-1]=h+E,n[b]=h+E,t[b-1]=B,t[b]=-B;b-=2,D=0}else{if(h=o[b][b],d=0,u=0,l<b&&(d=o[b-1][b-1],u=o[b][b-1]*o[b-1][b]),10===D){for(w+=h,i=0;i<=b;i++)o[i][i]-=h;h=d=.75*(k=Math.abs(o[b][b-1])+Math.abs(o[b-1][b-2])),u=-.4375*k*k}if(30===D&&(k=(k=(d-h)/2)*k+u)>0){for(k=Math.sqrt(k),d<h&&(k=-k),k=h-u/((d-h)/2+k),i=0;i<=b;i++)o[i][i]-=k;w+=k,h=d=u=.964}for(D+=1,c=b-2;c>=l&&(E=((M=h-(B=o[c][c]))*(k=d-B)-u)/o[c+1][c]+o[c][c+1],S=o[c+1][c+1]-B-M-k,M=o[c+2][c+1],E/=k=Math.abs(E)+Math.abs(S)+Math.abs(M),S/=k,M/=k,c!==l)&&!(Math.abs(o[c][c-1])*(Math.abs(S)+Math.abs(M))<x*(Math.abs(E)*(Math.abs(o[c-1][c-1])+Math.abs(B)+Math.abs(o[c+1][c+1]))));)c--;for(i=c+2;i<=b;i++)o[i][i-2]=0,i>c+2&&(o[i][i-3]=0);for(s=c;s<=b-1&&(v=s!==b-1,s!==c&&(E=o[s][s-1],S=o[s+1][s-1],M=v?o[s+2][s-1]:0,0!==(h=Math.abs(E)+Math.abs(S)+Math.abs(M))&&(E/=h,S/=h,M/=h)),0!==h);s++)if(k=Math.sqrt(E*E+S*S+M*M),E<0&&(k=-k),0!==k){for(s!==c?o[s][s-1]=-k*h:l!==c&&(o[s][s-1]=-o[s][s-1]),h=(E+=k)/k,d=S/k,B=M/k,S/=E,M/=E,a=s;a<e;a++)E=o[s][a]+S*o[s+1][a],v&&(E+=M*o[s+2][a],o[s+2][a]=o[s+2][a]-E*B),o[s][a]=o[s][a]-E*h,o[s+1][a]=o[s+1][a]-E*d;for(i=0;i<=Math.min(b,s+3);i++)E=h*o[i][s]+d*o[i][s+1],v&&(E+=B*o[i][s+2],o[i][s+2]=o[i][s+2]-E*M),o[i][s]=o[i][s]-E,o[i][s+1]=o[i][s+1]-E*S;for(i=0;i<=I;i++)E=h*r[i][s]+d*r[i][s+1],v&&(E+=B*r[i][s+2],r[i][s+2]=r[i][s+2]-E*M),r[i][s]=r[i][s]-E,r[i][s+1]=r[i][s+1]-E*S}}}if(0!==C){for(b=e-1;b>=0;b--)if(E=n[b],0===(S=t[b]))for(l=b,o[b][b]=1,i=b-1;i>=0;i--){for(u=o[i][i]-E,M=0,a=l;a<=b;a++)M+=o[i][a]*o[a][b];if(t[i]<0)B=u,k=M;else if(l=i,0===t[i]?o[i][b]=0!==u?-M/u:-M/(x*C):(h=o[i][i+1],d=o[i+1][i],A=(h*k-B*M)/(S=(n[i]-E)*(n[i]-E)+t[i]*t[i]),o[i][b]=A,o[i+1][b]=Math.abs(h)>Math.abs(B)?(-M-u*A)/h:(-k-d*A)/B),x*(A=Math.abs(o[i][b]))*A>1)for(a=i;a<=b;a++)o[a][b]=o[a][b]/A}else if(S<0)for(l=b-1,Math.abs(o[b][b-1])>Math.abs(o[b-1][b])?(o[b-1][b-1]=S/o[b][b-1],o[b-1][b]=-(o[b][b]-E)/o[b][b-1]):(y=j(0,-o[b-1][b],o[b-1][b-1]-E,S),o[b-1][b-1]=y[0],o[b-1][b]=y[1]),o[b][b-1]=0,o[b][b]=1,i=b-2;i>=0;i--){for(f=0,p=0,a=l;a<=b;a++)f+=o[i][a]*o[a][b-1],p+=o[i][a]*o[a][b];if(u=o[i][i]-E,t[i]<0)B=u,M=f,k=p;else if(l=i,0===t[i]?(y=j(-f,-p,u,S),o[i][b-1]=y[0],o[i][b]=y[1]):(h=o[i][i+1],d=o[i+1][i],g=(n[i]-E)*(n[i]-E)+t[i]*t[i]-S*S,m=2*(n[i]-E)*S,0===g&&0===m&&(g=x*C*(Math.abs(u)+Math.abs(S)+Math.abs(h)+Math.abs(d)+Math.abs(B))),y=j(h*M-B*f+S*p,h*k-B*p-S*f,g,m),o[i][b-1]=y[0],o[i][b]=y[1],Math.abs(h)>Math.abs(B)+Math.abs(S)?(o[i+1][b-1]=(-f-u*o[i][b-1]+S*o[i][b])/h,o[i+1][b]=(-p-u*o[i][b]-S*o[i][b-1])/h):(y=j(-M-d*o[i][b-1],-k-d*o[i][b],B,S),o[i+1][b-1]=y[0],o[i+1][b]=y[1])),x*(A=Math.max(Math.abs(o[i][b-1]),Math.abs(o[i][b])))*A>1)for(a=i;a<=b;a++)o[a][b-1]=o[a][b-1]/A,o[a][b]=o[a][b]/A}for(i=0;i<e;i++)if(i<0||i>I)for(a=i;a<e;a++)r[i][a]=o[i][a];for(a=e-1;a>=0;a--)for(i=0;i<=I;i++){for(B=0,s=0;s<=Math.min(a,I);s++)B+=r[i][s]*o[s][a];r[i][a]=B}}}(i,A,s,a,h)}this.n=i,this.e=A,this.d=s,this.V=a}get realEigenvalues(){return this.d}get imaginaryEigenvalues(){return this.e}get eigenvectorMatrix(){return P.isMatrix(this.V)||(this.V=new P(this.V)),this.V}get diagonalMatrix(){var e,t,n=this.n,r=this.e,o=this.d,i=new P(n,n);for(e=0;e<n;e++){for(t=0;t<n;t++)i[e][t]=0;i[e][e]=o[e],r[e]>0?i[e][e+1]=r[e]:r[e]<0&&(i[e][e-1]=r[e])}return i}}function j(e,t,n,r){var o,i;return Math.abs(n)>Math.abs(r)?[(e+(o=r/n)*t)/(i=n+o*r),(t-o*e)/i]:[((o=n/r)*e+t)/(i=r+o*n),(o*t-e)/i]}class z{constructor(e){if(!(e=T.checkMatrix(e)).isSymmetric())throw new Error("Matrix is not symmetric");var t,n,r,o=e,i=o.rows,a=new P(i,i),s=!0;for(n=0;n<i;n++){var l=a[n],c=0;for(r=0;r<n;r++){var A=a[r],u=0;for(t=0;t<r;t++)u+=A[t]*l[t];l[r]=u=(o.get(n,r)-u)/a[r][r],c+=u*u}for(s&=(c=o.get(n,n)-c)>0,a[n][n]=Math.sqrt(Math.max(c,0)),r=n+1;r<i;r++)a[n][r]=0}if(!s)throw new Error("Matrix is not positive definite");this.L=a}solve(e){e=T.checkMatrix(e);var t=this.L,n=t.rows;if(e.rows!==n)throw new Error("Matrix dimensions do not match");var r,o,i,a=e.columns,s=e.clone();for(i=0;i<n;i++)for(o=0;o<a;o++){for(r=0;r<i;r++)s[i][o]-=s[r][o]*t[i][r];s[i][o]/=t[i][i]}for(i=n-1;i>=0;i--)for(o=0;o<a;o++){for(r=i+1;r<n;r++)s[i][o]-=s[r][o]*t[r][i];s[i][o]/=t[i][i]}return s}get lowerTriangularMatrix(){return this.L}}n.d(t,"default",function(){return P}),n.d(t,"Matrix",function(){return P}),n.d(t,"abstractMatrix",function(){return D}),n.d(t,"wrap",function(){return G}),n.d(t,"WrapperMatrix2D",function(){return T}),n.d(t,"WrapperMatrix1D",function(){return Q}),n.d(t,"solve",function(){return V}),n.d(t,"inverse",function(){return _}),n.d(t,"linearDependencies",function(){return O}),n.d(t,"SingularValueDecomposition",function(){return A}),n.d(t,"SVD",function(){return A}),n.d(t,"EigenvalueDecomposition",function(){return L}),n.d(t,"EVD",function(){return L}),n.d(t,"CholeskyDecomposition",function(){return z}),n.d(t,"CHO",function(){return z}),n.d(t,"LuDecomposition",function(){return s}),n.d(t,"LU",function(){return s}),n.d(t,"QrDecomposition",function(){return R}),n.d(t,"QR",function(){return R})},function(e,t,n){"use strict";var r=n(5),o=n(27),i=/^(?:(?:-(?=\d+))?\d*|end(?:-\d+|\/\d+)?):(?:(?:-(?=\d+))?\d*|end(?:-\d+|\/\d+)?)(?:\:(?=-?\d*)(?:-?\d+)?)?$/,a=/^end/,s=/(-|\/)(?=\d+)(\d+)?$/;e.exports=function(e,t){var n,l,c,A,u;if(!r(e)||!i.test(e))throw new Error("indexspace()::invalid input argument. Invalid subsequence syntax. Please consult documentation. Value: `"+e+"`.");if(!o(t))throw new TypeError("indexspace()::invalid input argument. Reference array length must be a nonnegative integer. Value: `"+t+"`.");if(!t)return[];if(n=(e=e.split(":"))[0],l=e[1],0===(A=2===e.length?1:parseInt(e[2],10)))throw new Error("indexspace()::invalid syntax. Increment must be an integer not equal to 0. Value: `"+A+"`.");if(a.test(n))(c=n.match(s))?"-"===c[1]?(n=t-1-parseInt(c[2],10))<0&&(n=0):(n=(t-1)/parseInt(c[2],10),n=Math.ceil(n)):n=t-1;else if((n=parseInt(n,10))!=n)n=A<0?t-1:0;else if(n<0)(n=t+n)<0&&(n=0);else if(n>=t)return[];if(a.test(l)?(c=l.match(s))?"-"===c[1]?(l=t-1-parseInt(c[2],10))<0&&(l=0):(l=(t-1)/parseInt(c[2],10),l=Math.ceil(l)-1):l=t-1:(l=parseInt(l,10))!=l?l=A<0?0:t-1:l<0?((l=t+l)<0&&(l=0),A>0&&(l-=1)):A<0?l+=1:l>=t?l=t-1:l-=1,u=[],A<0){if(l>n)return u;for(;n>=l;)u.push(n),n+=A}else{if(n>l)return u;for(;n<=l;)u.push(n),n+=A}return u}},function(e,t,n){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){for(var n=new Array(3).fill([]),r=0;r<3;++r)n[r]=new Array(e).fill([]);for(var o=0;o<e;++o)n[0][o]=new Array(t).fill(-1);for(var i=0;i<e;++i)n[1][i]=new Array(t).fill(Number.MAX_VALUE);for(var a=0;a<e;++a)n[2][a]=new Array(t).fill(0);return n}function i(e){return e[0]=(4294967294&e[0])<<12&4294967295^(e[0]<<13&4294967295^e[0])>>19,e[1]=(4294967288&e[1])<<4&4294967295^(e[1]<<2&4294967295^e[1])>>25,e[2]=(4294967280&e[2])<<17&4294967295^(e[2]<<3&4294967295^e[2])>>11,e[0]^e[1]^e[2]}function a(e,t,n,r,o){var i=e[0][t],a=e[1][t],s=e[2][t];if(n>=a[0])return 0;for(var l=0;l<i.length;++l)if(r===i[l])return 0;a[0]=n,i[0]=r,s[0]=o;for(var c=e[0].length,A=e[0][0].length,u=0;;){var h=null,d=2*u+1,f=d+1;if(d>=c)break;if(f>=A){if(!(a[d]>n))break;h=d}else{if(!(n<a[f]))break;h=f}a[u]=a[h],i[u]=i[h],s[u]=s[h],u=h}return a[u]=n,i[u]=r,s[u]=o,1}function s(e){return Math.abs(i(e)/2147483647)}function l(e,t,n,r){for(var o=e.length,i=Math.min(r,o);2*n+1<i;){var a=2*n+1,s=a+1,l=n;if(e[l]<e[a]&&(l=a),s<i&&e[l]<e[s]&&(l=s),l===n)break;var c=[e[l],e[n]];e[n]=c[0],e[l]=c[1];var A=[t[l],t[n]];t[n]=A[0],t[l]=A[1],n=l}}Object.defineProperty(t,"__esModule",{value:!0}),t.make_heap=o,t.rejection_sample=function(e,t,n){for(var r=new Array(e).fill(null),o=null,a=0;a<e;++a){for(var s=!0;s;){o=(i(n)%t+t)%t;for(var l=0;l<a&&o!==r[l];++l)s=!1}r[a]=o}return r},t.tau_rand_int=i,t.heap_push=a,t.build_candidates=function(e,t,n,r,i){for(var l=o(t,r),c=0;c<t;++c)for(var A=0;c<n;++A)if(!(e[0][c][A]<0)){var u=e[0][c][A],h=e[2][c][A],d=s(i);a(l,c,d,u,h),a(l,u,d,c,h),e[2][c][A]=0}return l},t.tau_rand=s,t.deheap_sort=function(e){for(var t=e[0],n=e[1],r=t.length,o=0;o<r;++o)for(var i=t[o],a=n[o],s=i.length,c=a.length,A=0;A<r-1;++A){var u=[i[s-A-1],i[0]];i[0]=u[0],i[s-A-1]=u[1];var h=[a[c-A-1],a[0]];a[0]=h[0],a[c-A-1]=h[1],l(a,i,0,c-A-1)}return[t,n]},t.siftdown=l,t.l2Norm=function(e){for(var t=0,n=0;n<e.length;++n)t+=Math.pow(e[n],2);return Math.sqrt(t)},t.rdist=function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.pow(e[o]-t[o],2);return n},t.linspace=function(e,t,n){for(var r=[],o=e,i=(t-e)/(n-1),a=0;a<n;a++)r.push(o+i*a);return r},t.clip=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return e>t?t:e<-t?-t:e},t.pairwise_distances=function(e,t,n){for(var o=e.length,i=new Array(o).fill([]),a=0;a<o;++a){i[a]=new Array(o).fill(0);for(var s=0;s<a;++s){var l=t.apply(void 0,[e[a],e[s]].concat(r(n)));i[a][s]=l,i[s][a]=l}}return i},t.pairwise_distancesXY=function(e,t,n,o){for(var i=e.length,a=t.length,s=new Array(i).fill([]),l=0;l<i;++l){s[l]=new Array(a).fill(0);for(var c=0;c<a;++c)s[l][c]=n.apply(void 0,[e[l],t[c]].concat(r(o)))}return s},t.generateGaussian=function(e,t){var n=Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(c*r)*t+e};var c=2*Math.PI},function(e,t,n){"use strict";var r="unbiased",o=n(253);t.name="var",t.factory=function(e,t,i,a){var s=i(n(41)),l=i(n(252)),c=i(n(54)),A=i(n(250)),u=a("variance",{"Array | Matrix":function(e){return h(e,r)},"Array | Matrix, string":h,"...":function(e){return h(e,r)}});return u.toTex="\\mathrm{Var}\\left(${args}\\right)",u;function h(t,n){var r=0,i=0;if(0==t.length)throw new SyntaxError("Function var requires one or more parameters (0 provided)");if(o(t,function(e){r=s(r,e),i++}),0===i)throw new Error("Cannot calculate var of an empty array");var a=A(r,i);switch(r=0,o(t,function(e){var t=l(e,a);r=s(r,c(t,t))}),n){case"uncorrected":return A(r,i);case"biased":return A(r,i+1);case"unbiased":var u=e.isBigNumber(r)?new e.BigNumber(0):0;return 1==i?u:A(r,i-1);default:throw new Error('Unknown normalization "'+n+'". Choose "unbiased" (default), "uncorrected", or "biased".')}}}},function(e,t,n){"use strict";var r=n(7).clone,o=n(55).format;t.name="transpose",t.factory=function(e,t,i,a){var s=n(17),l=i(n(15)),c=e.DenseMatrix,A=e.SparseMatrix,u=a("transpose",{Array:function(e){return u(l(e)).valueOf()},Matrix:function(e){var t,n=e.size();switch(n.length){case 1:t=e.clone();break;case 2:var r=n[0],i=n[1];if(0===i)throw new RangeError("Cannot transpose a 2D matrix with no columns (size: "+o(n)+")");switch(e.storage()){case"dense":t=h(e,r,i);break;case"sparse":t=d(e,r,i)}break;default:throw new RangeError("Matrix must be a vector or two dimensional (size: "+o(this._size)+")")}return t},any:function(e){return r(e)}}),h=function(e,t,n){for(var o,i=e._data,a=[],s=0;s<n;s++){o=a[s]=[];for(var l=0;l<t;l++)o[l]=r(i[l][s])}return new c({data:a,size:[n,t],datatype:e._datatype})},d=function(e,t,n){for(var o,i,a,s=e._values,l=e._index,c=e._ptr,u=s?[]:void 0,h=[],d=[],f=[],p=0;p<t;p++)f[p]=0;for(o=0,i=l.length;o<i;o++)f[l[o]]++;for(var g=0,m=0;m<t;m++)d.push(g),g+=f[m],f[m]=d[m];for(d.push(g),a=0;a<n;a++)for(var v=c[a],y=c[a+1],b=v;b<y;b++){var I=f[l[b]]++;h[I]=a,s&&(u[I]=r(s[b]))}return new A({values:u,index:h,ptr:d,size:[n,t],datatype:e._datatype})};return u.toTex={1:"\\left(${args[0]}\\right)"+s.operators.transpose},u}},function(e,t,n){e.exports=[n(47),n(95),n(262),n(261),n(260),n(258),n(257),n(256),n(255),n(15),n(254)]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.DistanceMeasures=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.validMetricsSparse=new Set("cityblock","cosine","euclidean","L1","L2","manhattan"),this.validMetrics=new Set("cityblock","cosine","euclidean","L1","L2","manhattan","braycurtis","canberra","chebyshev","correlation","dice","hamming","jaccard","kulsinski","mahalanobis","minkowski","rogerstanimoto","russellrao","sokalmichener","sokalsneath","sqeuclidean","yule"),this.realValidMetrics=["cosine","euclidean","sqeuclidean","correlation","manhattan","braycurtis","canberra","chebyshev","hamming","diceBoolean","jaccardBoolean","kulsinskiBoolean","rogerstanimotoBoolean","russellraoBoolean","sokalmichenerBoolean","sokalsneathBoolean","yuleBoolean"]}return r(e,null,[{key:"cityblock",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.abs(e[o]-t[o]);return n}},{key:"manhattan",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.abs(e[o]-t[o]);return n}},{key:"L1",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.abs(e[o]-t[o]);return n}},{key:"cosine",value:function(e,t){for(var n=0,r=0,o=0,i=e.length,a=0;a<i;++a)n+=Math.pow(e[a],2),r+=Math.pow(t[a],2),o+=e[a]*t[a];return 1-o/(Math.sqrt(n)*Math.sqrt(r))}},{key:"euclidean",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.pow(e[o]-t[o],2);return Math.sqrt(n)}},{key:"L2",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.pow(e[o]-t[o],2);return Math.sqrt(n)}},{key:"braycurtis",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)n+=Math.abs(e[i]-t[i]),r+=Math.abs(e[i]+t[i]);return n/r}},{key:"canberra",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)n+=Math.abs(e[i]-t[i]),r+=Math.abs(e[i])+Math.abs(t[i]);return n/r}},{key:"chebyshev",value:function(e,t){for(var n=0,r=-1,o=e.length,i=0;i<o;++i)(r=Math.abs(e[i]-t[i]))>n&&(n=r);return n}},{key:"correlation",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)n+=e[i],r+=t[i];for(var a=n/o,s=r/o,l=e,c=t,A=0,u=0,h=0,d=0;d<o;++d)l[d]-=a,c[d]-=s,h+=l[d]*c[d],A+=Math.pow(l[d],2),u+=Math.pow(c[d],2);return 1-h/Math.sqrt(A*u)}},{key:"hamming",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)e[o]!==t[o]&&(n+=1);return n/r}},{key:"sqeuclidean",value:function(e,t){for(var n=0,r=e.length,o=0;o<r;++o)n+=Math.pow(e[o]-t[o],2);return n}},{key:"diceBoolean",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)e[i]===t[i]?1===e[i]&&(n+=1):r+=1;return r/(2*n+r)}},{key:"jaccardBoolean",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)e[i]===t[i]?1===e[i]&&(n+=1):r+=1;return r/(n+r)}},{key:"kulsinskiBoolean",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)e[i]===t[i]?1===e[i]&&(n+=1):r+=1;return(r-n+o)/(o+r)}},{key:"rogerstanimotoBoolean",value:function(e,t){for(var n=e.length,r=0,o=0,i=0;i<n;++i)e[i]===t[i]?r+=1:o+=1;return 2*o/r}},{key:"russellraoBoolean",value:function(e,t){for(var n=e.length,r=0,o=0;o<n;++o)e[o]===t[o]&&(r+=1);return(n-r)/n}},{key:"sokalmichenerBoolean",value:function(e,t){for(var n=e.length,r=0,o=0,i=0;i<n;++i)e[i]===t[i]?r+=1:o+=1;return 2*o/(2*o+r)}},{key:"sokalsneathBoolean",value:function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;++i)e[i]===t[i]?1===e[i]&&(n+=1):r+=1;return 2*r/(n+2*r)}},{key:"yuleBoolean",value:function(e,t){for(var n=0,r=0,o=0,i=0,a=e.length,s=0;s<a;++s)e[s]===t[s]?1===e[s]?n+=1:r+=1:1===e[s]?o+=1:i+=1;return 2*i*o/(n*r+o*i)}}]),e}()},function(e,t,n){"use strict";var r=n(11);t.name="algorithm03",t.factory=function(e,t,n,o){var i=e.DenseMatrix;return function(e,t,n,a){var s=e._data,l=e._size,c=e._datatype,A=t._values,u=t._index,h=t._ptr,d=t._size,f=t._datatype;if(l.length!==d.length)throw new r(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!A)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,g=l[0],m=l[1],v=0,y=n;"string"==typeof c&&c===f&&(p=c,v=o.convert(0,p),y=o.find(n,[p,p]));for(var b=[],I=0;I<g;I++)b[I]=[];for(var x=[],w=[],C=0;C<m;C++){for(var E=C+1,S=h[C],M=h[C+1],k=S;k<M;k++){var B=u[k];x[B]=a?y(A[k],s[B][C]):y(s[B][C],A[k]),w[B]=E}for(var D=0;D<g;D++)w[D]===E?b[D][C]=x[D]:b[D][C]=a?y(v,s[D][C]):y(s[D][C],v)}return new i({data:b,size:[g,m],datatype:p})}}},function(e,t,n){"use strict";e.exports=function(e,t,n){if(null==n)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var r=e.minus(t).abs();if(r.isZero())return!0;var o=e.constructor.max(e.abs(),t.abs());return r.lte(o.times(n))}return!1}},function(e,t,n){"use strict";t.factory=function(e,t,n,r){var o=r("add",{"number, number":function(e,t){return e+t},"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":function(e,t){if(null==e.value)throw new Error("Parameter x contains a unit with undefined value");if(null==t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=o(n.value,t.value),n.fixPrefix=!1,n}});return o}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e){return"object"==typeof e&&null!==e&&!r(e)}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=Array.prototype.slice,a=n(185),s=Object.prototype.propertyIsEnumerable,l=!s.call({toString:null},"toString"),c=s.call(function(){},"prototype"),A=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(e){var t=e.constructor;return t&&t.prototype===e},h={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{u(window[e])}catch(e){return!0}}catch(e){return!0}return!1}(),f=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===o.call(e),i=a(e),s=t&&"[object String]"===o.call(e),h=[];if(!t&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var f=c&&n;if(s&&e.length>0&&!r.call(e,0))for(var p=0;p<e.length;++p)h.push(String(p));if(i&&e.length>0)for(var g=0;g<e.length;++g)h.push(String(g));else for(var m in e)f&&"prototype"===m||!r.call(e,m)||h.push(String(m));if(l)for(var v=function(e){if("undefined"==typeof window||!d)return u(e);try{return u(e)}catch(e){return!1}}(e),y=0;y<A.length;++y)v&&"constructor"===A[y]||!r.call(e,A[y])||h.push(A[y]);return h};f.shim=function(){if(Object.keys){if(!function(){return 2===(Object.keys(arguments)||"").length}(1,2)){var e=Object.keys;Object.keys=function(t){return a(t)?e(i.call(t)):e(t)}}}else Object.keys=f;return Object.keys||f},e.exports=f},function(e,t,n){"use strict";e.exports=function(e){return("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))&&e.valueOf()!=e.valueOf()}},function(e,t,n){"use strict";var r=n(10),o=n(27);e.exports=function(e){var t;if(!r(e))return!1;if(!(t=e.length))return!1;for(var n=0;n<t;n++)if(!o(e[n]))return!1;return!0}},function(e,t,n){"use strict";var r=n(28),o=n(88);e.exports=function(e){return void 0!==e&&null!==e&&"function"!=typeof e&&r(e.length)&&e.length>=0&&e.length<=o}},function(e,t,n){"use strict";var r=n(29).string.isString;t.name="Matrix",t.path="type",t.factory=function(e,t,n,o){function i(){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator")}return i.prototype.type="Matrix",i.prototype.isMatrix=!0,i.storage=function(e){if(!r(e))throw new TypeError("format must be a string value");var t=i._storage[e];if(!t)throw new SyntaxError("Unsupported matrix storage format: "+e);return t},i._storage={},i.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},i.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},i.prototype.create=function(e,t){throw new Error("Cannot invoke create on a Matrix interface")},i.prototype.subset=function(e,t,n){throw new Error("Cannot invoke subset on a Matrix interface")},i.prototype.get=function(e){throw new Error("Cannot invoke get on a Matrix interface")},i.prototype.set=function(e,t,n){throw new Error("Cannot invoke set on a Matrix interface")},i.prototype.resize=function(e,t){throw new Error("Cannot invoke resize on a Matrix interface")},i.prototype.reshape=function(e,t){throw new Error("Cannot invoke reshape on a Matrix interface")},i.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},i.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},i.prototype.map=function(e,t){throw new Error("Cannot invoke map on a Matrix interface")},i.prototype.forEach=function(e){throw new Error("Cannot invoke forEach on a Matrix interface")},i.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},i.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},i.prototype.format=function(e){throw new Error("Cannot invoke format on a Matrix interface")},i.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},i}},function(e,t,n){"use strict";function r(e){this._options=e}e.exports=r,r.prototype.testValue=function(){return(this._mean-this._options.mu)/this._se},r.prototype.pValue=function(){const e=this.testValue();switch(this._options.alternative){case 1:return 1-this._dist.cdf(e);case-1:return this._dist.cdf(e);case 0:return 2*(1-this._dist.cdf(Math.abs(e)))}},r.prototype.confidence=function(){let e;switch(this._options.alternative){case 1:return e=Math.abs(this._dist.inv(this._options.alpha))*this._se,[this._mean-e,1/0];case-1:return e=Math.abs(this._dist.inv(this._options.alpha))*this._se,[-1/0,this._mean+e];case 0:return e=Math.abs(this._dist.inv(this._options.alpha/2))*this._se,[this._mean-e,this._mean+e]}},r.prototype.valid=function(){return this.pValue()>=this._options.alpha},r.prototype.freedom=function(){return this._df}},function(e,t,n){(function(e,r){var o=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}}),l=r[n];n<i;l=r[++n])p(l)||!b(l)?a+=" "+l:a+=" "+s(l);return a},t.deprecate=function(n,o){if(v(e.process))return function(){return t.deprecate(n,o).apply(this,arguments)};if(!0===r.noDeprecation)return n;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return n.apply(this,arguments)}};var i,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),f(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=l),A(r,e,r.depth)}function l(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function A(e,n,r){if(e.customInspect&&n&&w(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return m(o)||(o=A(e,o,r)),o}var i=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(m(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return g(t)?e.stylize(""+t,"number"):f(t)?e.stylize(""+t,"boolean"):p(t)?e.stylize("null","null"):void 0}(e,n);if(i)return i;var a=Object.keys(n),s=function(e){var t={};return a.forEach(function(e,n){t[e]=!0}),t}();if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),x(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return u(n);if(0===a.length){if(w(n)){var l=n.name?": "+n.name:"";return e.stylize("[Function"+l+"]","special")}if(y(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(I(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return u(n)}var c,b="",C=!1,E=["{","}"];return d(n)&&(C=!0,E=["[","]"]),w(n)&&(b=" [Function"+(n.name?": "+n.name:"")+"]"),y(n)&&(b=" "+RegExp.prototype.toString.call(n)),I(n)&&(b=" "+Date.prototype.toUTCString.call(n)),x(n)&&(b=" "+u(n)),0!==a.length||C&&0!=n.length?r<0?y(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=C?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)M(t,String(a))?i.push(h(e,t,n,r,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(h(e,t,n,r,o,!0))}),i}(e,n,r,s,a):a.map(function(t){return h(e,n,r,s,t,C)}),e.seen.pop(),function(e,t,n){return e.reduce(function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,b,E)):E[0]+b+E[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,o,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),M(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(l.value)<0?(s=p(n)?A(e,l.value,null):A(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+s.split("\n").map(function(e){return"   "+e}).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function d(e){return Array.isArray(e)}function f(e){return"boolean"==typeof e}function p(e){return null===e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function v(e){return void 0===e}function y(e){return b(e)&&"[object RegExp]"===C(e)}function b(e){return"object"==typeof e&&null!==e}function I(e){return b(e)&&"[object Date]"===C(e)}function x(e){return b(e)&&("[object Error]"===C(e)||e instanceof Error)}function w(e){return"function"==typeof e}function C(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(v(i)&&(i=r.env.NODE_DEBUG||""),e=e.toUpperCase(),!a[e])if(new RegExp("\\b"+e+"\\b","i").test(i)){var n=r.pid;a[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,r)}}else a[e]=function(){};return a[e]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=f,t.isNull=p,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=y,t.isObject=b,t.isDate=I,t.isError=x,t.isFunction=w,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(281);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function M(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",function(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}(),t.format.apply(t,arguments))},t.inherits=n(280),t._extend=function(e,t){if(!t||!b(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e}}).call(this,n(101),n(100))},function(e,t,n){const r=n(291);t.compiled=r.compiled,t.signbit=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return 0|r._cephes_signbit(t)},t.isnan=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return 0|r._cephes_isnan(t)},t.isfinite=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return 0|r._cephes_isfinite(t)},t.cbrt=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cbrt(t)},t.polevl=function(e,t,n){const o=r.stackSave();if("number"!=typeof e)throw r.stackRestore(o),new TypeError("x must be a number");const i=e;if(!(t instanceof Float64Array))throw r.stackRestore(o),new TypeError("coef must be either a Float64Array");const a=r.stackAlloc(t.length<<3);if(r.writeArrayToMemory(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a),"number"!=typeof n)throw r.stackRestore(o),new TypeError("N must be a number");const s=0|n,l=r._cephes_polevl(i,a,s);return r.stackRestore(o),l},t.chbevl=function(e,t,n){const o=r.stackSave();if("number"!=typeof e)throw r.stackRestore(o),new TypeError("x must be a number");const i=e;if(!(t instanceof Float64Array))throw r.stackRestore(o),new TypeError("array must be either a Float64Array");const a=r.stackAlloc(t.length<<3);if(r.writeArrayToMemory(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a),"number"!=typeof n)throw r.stackRestore(o),new TypeError("n must be a number");const s=0|n,l=r._cephes_chbevl(i,a,s);return r.stackRestore(o),l},t.round=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_round(t)},t.frexp=function(e){const t=r.stackSave();if("number"!=typeof e)throw r.stackRestore(t),new TypeError("x must be a number");const n=e,o=r.stackAlloc(4),i=[r._cephes_frexp(n,o),{pw2:r.getValue(o,"i32")}];return r.stackRestore(t),i},t.ldexp=function(e,t){if("number"!=typeof e)throw new TypeError("x must be a number");const n=e;if("number"!=typeof t)throw new TypeError("pw2 must be a number");const o=0|t;return r._cephes_ldexp(n,o)},t.expx2=function(e,t){if("number"!=typeof e)throw new TypeError("x must be a number");const n=e;if("number"!=typeof t)throw new TypeError("sign must be a number");const o=0|t;return r._cephes_expx2(n,o)},t.radian=function(e,t,n){if("number"!=typeof e)throw new TypeError("d must be a number");const o=e;if("number"!=typeof t)throw new TypeError("m must be a number");const i=t;if("number"!=typeof n)throw new TypeError("s must be a number");const a=n;return r._cephes_radian(o,i,a)},t.sincos=function(e,t){const n=r.stackSave();if("number"!=typeof e)throw r.stackRestore(n),new TypeError("x must be a number");const o=e,i=r.stackAlloc(8),a=r.stackAlloc(8);if("number"!=typeof t)throw r.stackRestore(n),new TypeError("flg must be a number");const s=0|t,l=[0|r._cephes_sincos(o,i,a,s),{s:r.getValue(i,"double"),c:r.getValue(a,"double")}];return r.stackRestore(n),l},t.cot=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cot(t)},t.cotdg=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cotdg(t)},t.log1p=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_log1p(t)},t.expm1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_expm1(t)},t.cosm1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cosm1(t)},t.acos=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_acos(t)},t.acosh=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_acosh(t)},t.asinh=function(e){if("number"!=typeof e)throw new TypeError("xx must be a number");const t=e;return r._cephes_asinh(t)},t.atanh=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_atanh(t)},t.asin=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_asin(t)},t.atan=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_atan(t)},t.atan2=function(e,t){if("number"!=typeof e)throw new TypeError("y must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_atan2(n,o)},t.cos=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cos(t)},t.cosdg=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cosdg(t)},t.exp=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_exp(t)},t.exp2=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_exp2(t)},t.exp10=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_exp10(t)},t.cosh=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_cosh(t)},t.sinh=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_sinh(t)},t.tanh=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_tanh(t)},t.log=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_log(t)},t.log2=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_log2(t)},t.log10=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_log10(t)},t.pow=function(e,t){if("number"!=typeof e)throw new TypeError("x must be a number");const n=e;if("number"!=typeof t)throw new TypeError("y must be a number");const o=t;return r._cephes_pow(n,o)},t.powi=function(e,t){if("number"!=typeof e)throw new TypeError("x must be a number");const n=e;if("number"!=typeof t)throw new TypeError("nn must be a number");const o=0|t;return r._cephes_powi(n,o)},t.sin=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_sin(t)},t.sindg=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_sindg(t)},t.tan=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_tan(t)},t.tandg=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_tandg(t)},t.ei=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_ei(t)},t.expn=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_expn(n,o)},t.shichi=function(e){const t=r.stackSave();if("number"!=typeof e)throw r.stackRestore(t),new TypeError("x must be a number");const n=e,o=r.stackAlloc(8),i=r.stackAlloc(8),a=[0|r._cephes_shichi(n,o,i),{si:r.getValue(o,"double"),ci:r.getValue(i,"double")}];return r.stackRestore(t),a},t.sici=function(e){const t=r.stackSave();if("number"!=typeof e)throw r.stackRestore(t),new TypeError("x must be a number");const n=e,o=r.stackAlloc(8),i=r.stackAlloc(8),a=[0|r._cephes_sici(n,o,i),{si:r.getValue(o,"double"),ci:r.getValue(i,"double")}];return r.stackRestore(t),a},t.lbeta=function(e,t){if("number"!=typeof e)throw new TypeError("a must be a number");const n=e;if("number"!=typeof t)throw new TypeError("b must be a number");const o=t;return r._cephes_lbeta(n,o)},t.beta=function(e,t){if("number"!=typeof e)throw new TypeError("a must be a number");const n=e;if("number"!=typeof t)throw new TypeError("b must be a number");const o=t;return r._cephes_beta(n,o)},t.fac=function(e){if("number"!=typeof e)throw new TypeError("i must be a number");const t=0|e;return r._cephes_fac(t)},t.gamma=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_gamma(t)},t.lgam=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_lgam(t)},t.incbet=function(e,t,n){if("number"!=typeof e)throw new TypeError("aa must be a number");const o=e;if("number"!=typeof t)throw new TypeError("bb must be a number");const i=t;if("number"!=typeof n)throw new TypeError("xx must be a number");const a=n;return r._cephes_incbet(o,i,a)},t.incbi=function(e,t,n){if("number"!=typeof e)throw new TypeError("aa must be a number");const o=e;if("number"!=typeof t)throw new TypeError("bb must be a number");const i=t;if("number"!=typeof n)throw new TypeError("yy0 must be a number");const a=n;return r._cephes_incbi(o,i,a)},t.igam=function(e,t){if("number"!=typeof e)throw new TypeError("a must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_igam(n,o)},t.igamc=function(e,t){if("number"!=typeof e)throw new TypeError("a must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_igamc(n,o)},t.igami=function(e,t){if("number"!=typeof e)throw new TypeError("a must be a number");const n=e;if("number"!=typeof t)throw new TypeError("y0 must be a number");const o=t;return r._cephes_igami(n,o)},t.psi=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_psi(t)},t.rgamma=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_rgamma(t)},t.erf=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_erf(t)},t.erfc=function(e){if("number"!=typeof e)throw new TypeError("a must be a number");const t=e;return r._cephes_erfc(t)},t.dawsn=function(e){if("number"!=typeof e)throw new TypeError("xx must be a number");const t=e;return r._cephes_dawsn(t)},t.fresnl=function(e){const t=r.stackSave();if("number"!=typeof e)throw r.stackRestore(t),new TypeError("xxa must be a number");const n=e,o=r.stackAlloc(8),i=r.stackAlloc(8),a=[0|r._cephes_fresnl(n,o,i),{ssa:r.getValue(o,"double"),cca:r.getValue(i,"double")}];return r.stackRestore(t),a},t.airy=function(e){const t=r.stackSave();if("number"!=typeof e)throw r.stackRestore(t),new TypeError("x must be a number");const n=e,o=r.stackAlloc(8),i=r.stackAlloc(8),a=r.stackAlloc(8),s=r.stackAlloc(8),l=[0|r._cephes_airy(n,o,i,a,s),{ai:r.getValue(o,"double"),aip:r.getValue(i,"double"),bi:r.getValue(a,"double"),bip:r.getValue(s,"double")}];return r.stackRestore(t),l},t.j0=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_j0(t)},t.j1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_j1(t)},t.jn=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_jn(n,o)},t.jv=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_jv(n,o)},t.y0=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_y0(t)},t.y1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_y1(t)},t.yn=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_yn(n,o)},t.yv=function(e,t){if("number"!=typeof e)throw new TypeError("v must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_yv(n,o)},t.i0=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_i0(t)},t.i0e=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_i0e(t)},t.i1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_i1(t)},t.i1e=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_i1e(t)},t.iv=function(e,t){if("number"!=typeof e)throw new TypeError("v must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_iv(n,o)},t.k0=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_k0(t)},t.k0e=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_k0e(t)},t.k1=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_k1(t)},t.k1e=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_k1e(t)},t.kn=function(e,t){if("number"!=typeof e)throw new TypeError("nn must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_kn(n,o)},t.hyperg=function(e,t,n){if("number"!=typeof e)throw new TypeError("a must be a number");const o=e;if("number"!=typeof t)throw new TypeError("b must be a number");const i=t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_hyperg(o,i,a)},t.hyp2f1=function(e,t,n,o){if("number"!=typeof e)throw new TypeError("a must be a number");const i=e;if("number"!=typeof t)throw new TypeError("b must be a number");const a=t;if("number"!=typeof n)throw new TypeError("c must be a number");const s=n;if("number"!=typeof o)throw new TypeError("x must be a number");const l=o;return r._cephes_hyp2f1(i,a,s,l)},t.ellpe=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_ellpe(t)},t.ellie=function(e,t){if("number"!=typeof e)throw new TypeError("phi must be a number");const n=e;if("number"!=typeof t)throw new TypeError("m must be a number");const o=t;return r._cephes_ellie(n,o)},t.ellpk=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_ellpk(t)},t.ellik=function(e,t){if("number"!=typeof e)throw new TypeError("phi must be a number");const n=e;if("number"!=typeof t)throw new TypeError("m must be a number");const o=t;return r._cephes_ellik(n,o)},t.ellpj=function(e,t){const n=r.stackSave();if("number"!=typeof e)throw r.stackRestore(n),new TypeError("u must be a number");const o=e;if("number"!=typeof t)throw r.stackRestore(n),new TypeError("m must be a number");const i=t,a=r.stackAlloc(8),s=r.stackAlloc(8),l=r.stackAlloc(8),c=r.stackAlloc(8),A=[0|r._cephes_ellpj(o,i,a,s,l,c),{sn:r.getValue(a,"double"),cn:r.getValue(s,"double"),dn:r.getValue(l,"double"),ph:r.getValue(c,"double")}];return r.stackRestore(n),A},t.btdtr=function(e,t,n){if("number"!=typeof e)throw new TypeError("a must be a number");const o=e;if("number"!=typeof t)throw new TypeError("b must be a number");const i=t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_btdtr(o,i,a)},t.smirnov=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("e must be a number");const o=t;return r._cephes_smirnov(n,o)},t.kolmogorov=function(e){if("number"!=typeof e)throw new TypeError("y must be a number");const t=e;return r._cephes_kolmogorov(t)},t.smirnovi=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("p must be a number");const o=t;return r._cephes_smirnovi(n,o)},t.kolmogi=function(e){if("number"!=typeof e)throw new TypeError("p must be a number");const t=e;return r._cephes_kolmogi(t)},t.nbdtri=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("p must be a number");const a=n;return r._cephes_nbdtri(o,i,a)},t.stdtri=function(e,t){if("number"!=typeof e)throw new TypeError("k must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("p must be a number");const o=t;return r._cephes_stdtri(n,o)},t.bdtr=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("p must be a number");const a=n;return r._cephes_bdtr(o,i,a)},t.bdtrc=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("p must be a number");const a=n;return r._cephes_bdtrc(o,i,a)},t.bdtri=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("y must be a number");const a=n;return r._cephes_bdtri(o,i,a)},t.chdtr=function(e,t){if("number"!=typeof e)throw new TypeError("df must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_chdtr(n,o)},t.chdtrc=function(e,t){if("number"!=typeof e)throw new TypeError("df must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_chdtrc(n,o)},t.chdtri=function(e,t){if("number"!=typeof e)throw new TypeError("df must be a number");const n=e;if("number"!=typeof t)throw new TypeError("y must be a number");const o=t;return r._cephes_chdtri(n,o)},t.fdtr=function(e,t,n){if("number"!=typeof e)throw new TypeError("ia must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("ib must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_fdtr(o,i,a)},t.fdtrc=function(e,t,n){if("number"!=typeof e)throw new TypeError("ia must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("ib must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_fdtrc(o,i,a)},t.fdtri=function(e,t,n){if("number"!=typeof e)throw new TypeError("ia must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("ib must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("y must be a number");const a=n;return r._cephes_fdtri(o,i,a)},t.gdtr=function(e,t,n){if("number"!=typeof e)throw new TypeError("a must be a number");const o=e;if("number"!=typeof t)throw new TypeError("b must be a number");const i=t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_gdtr(o,i,a)},t.gdtrc=function(e,t,n){if("number"!=typeof e)throw new TypeError("a must be a number");const o=e;if("number"!=typeof t)throw new TypeError("b must be a number");const i=t;if("number"!=typeof n)throw new TypeError("x must be a number");const a=n;return r._cephes_gdtrc(o,i,a)},t.nbdtr=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("p must be a number");const a=n;return r._cephes_nbdtr(o,i,a)},t.nbdtrc=function(e,t,n){if("number"!=typeof e)throw new TypeError("k must be a number");const o=0|e;if("number"!=typeof t)throw new TypeError("n must be a number");const i=0|t;if("number"!=typeof n)throw new TypeError("p must be a number");const a=n;return r._cephes_nbdtrc(o,i,a)},t.ndtr=function(e){if("number"!=typeof e)throw new TypeError("a must be a number");const t=e;return r._cephes_ndtr(t)},t.ndtri=function(e){if("number"!=typeof e)throw new TypeError("y0 must be a number");const t=e;return r._cephes_ndtri(t)},t.pdtr=function(e,t){if("number"!=typeof e)throw new TypeError("k must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("m must be a number");const o=t;return r._cephes_pdtr(n,o)},t.pdtrc=function(e,t){if("number"!=typeof e)throw new TypeError("k must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("m must be a number");const o=t;return r._cephes_pdtrc(n,o)},t.pdtri=function(e,t){if("number"!=typeof e)throw new TypeError("k must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("y must be a number");const o=t;return r._cephes_pdtri(n,o)},t.stdtr=function(e,t){if("number"!=typeof e)throw new TypeError("k must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("t must be a number");const o=t;return r._cephes_stdtr(n,o)},t.plancki=function(e,t){if("number"!=typeof e)throw new TypeError("w must be a number");const n=e;if("number"!=typeof t)throw new TypeError("T must be a number");const o=t;return r._cephes_plancki(n,o)},t.planckc=function(e,t){if("number"!=typeof e)throw new TypeError("w must be a number");const n=e;if("number"!=typeof t)throw new TypeError("T must be a number");const o=t;return r._cephes_planckc(n,o)},t.planckd=function(e,t){if("number"!=typeof e)throw new TypeError("w must be a number");const n=e;if("number"!=typeof t)throw new TypeError("T must be a number");const o=t;return r._cephes_planckd(n,o)},t.planckw=function(e){if("number"!=typeof e)throw new TypeError("T must be a number");const t=e;return r._cephes_planckw(t)},t.spence=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_spence(t)},t.zetac=function(e){if("number"!=typeof e)throw new TypeError("x must be a number");const t=e;return r._cephes_zetac(t)},t.zeta=function(e,t){if("number"!=typeof e)throw new TypeError("x must be a number");const n=e;if("number"!=typeof t)throw new TypeError("q must be a number");const o=t;return r._cephes_zeta(n,o)},t.struve=function(e,t){if("number"!=typeof e)throw new TypeError("v must be a number");const n=e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_struve(n,o)},t.p1evl=function(e,t,n){const o=r.stackSave();if("number"!=typeof e)throw r.stackRestore(o),new TypeError("x must be a number");const i=e;if(!(t instanceof Float64Array))throw r.stackRestore(o),new TypeError("coef must be either a Float64Array");const a=r.stackAlloc(t.length<<3);if(r.writeArrayToMemory(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a),"number"!=typeof n)throw r.stackRestore(o),new TypeError("N must be a number");const s=0|n,l=r._cephes_p1evl(i,a,s);return r.stackRestore(o),l},t.polylog=function(e,t){if("number"!=typeof e)throw new TypeError("n must be a number");const n=0|e;if("number"!=typeof t)throw new TypeError("x must be a number");const o=t;return r._cephes_polylog(n,o)}},function(e,t,n){t.Normal=n(292),t.Studentt=n(284),t.Uniform=n(283),t.Binomial=n(282)},function(e,t){Numeric=function(){},Numeric._adaptive=function(e,t,n,r,o,i,a,s,l){var c=(t+n)/2,A=n-t,u=(c+n)/2,h=e((t+c)/2),d=e(u),f=A/12*(i+4*h+s),p=A/12*(s+4*d+a),g=f+p;return l<=0||Math.abs(g-o)<=15*r?g+(g-o)/15:this._adaptive(e,t,c,r/2,f,i,s,h,l-1)+this._adaptive(e,c,n,r/2,p,s,a,d,l-1)},Numeric.adaptiveSimpson=function(e,t,n,r,o){var i=(t+n)/2,a=n-t,s=e(t),l=e(n),c=e(i),A=a/6*(s+4*c+l);return this._adaptive(e,t,n,r,A,s,l,c,o)},Numeric.bisection=function(e,t,n,r){for(r=void 0!==r?r:1e-9;Math.abs(t-n)>r;)e(t)*e((t+n)/2)<0?n=(t+n)/2:t=(t+n)/2;return(t+n)/2},Numeric.secant=function(e,t,n,r){r=void 0!==r?r:1e-9;for(var o=[t,n];Math.abs(o[0]-o[1])>r;)o.push((o[0]*e(o[1])-o[1]*e(o[0]))/(e(o[1])-e(o[0]))),o.shift();return(o[0]+o[1])/2},e.exports.Numeric=Numeric},function(e,t,n){"use strict";t.name="algorithm12",t.factory=function(e,t,n,r){var o=e.DenseMatrix;return function(e,t,n,i){var a=e._values,s=e._index,l=e._ptr,c=e._size,A=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,h=c[0],d=c[1],f=n;"string"==typeof A&&(u=A,t=r.convert(t,u),f=r.find(n,[u,u]));for(var p=[],g=new o({data:p,size:[h,d],datatype:u}),m=[],v=[],y=0;y<d;y++){for(var b=y+1,I=l[y],x=l[y+1],w=I;w<x;w++){var C=s[w];m[C]=a[w],v[C]=b}for(var E=0;E<h;E++)0===y&&(p[E]=[]),v[E]===b?p[E][y]=i?f(t,m[E]):f(m[E],t):p[E][y]=i?f(t,0):f(0,t)}return g}}},function(e,t,n){"use strict";t.factory=function(e,t,n,r){var o=r("multiplyScalar",{"number, number":function(e,t){return e*t},"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":function(e,t){var n=t.clone();return n.value=null===n.value?n._normalize(e):o(n.value,e),n},"Unit, number | Fraction | BigNumber | Complex":function(e,t){var n=e.clone();return n.value=null===n.value?n._normalize(t):o(n.value,t),n},"Unit, Unit":function(e,t){return e.multiply(t)}});return o}},function(e,t,n){"use strict";var r=n(6).format,o=n(314).format,i=n(61);t.isString=function(e){return"string"==typeof e},t.endsWith=function(e,t){var n=e.length-t.length,r=e.length;return e.substring(n,r)===t},t.format=function(e,n){if("number"==typeof e)return r(e,n);if(i(e))return o(e,n);if(function(e){return e&&"object"==typeof e&&"number"==typeof e.s&&"number"==typeof e.n&&"number"==typeof e.d||!1}(e))return n&&"decimal"===n.fraction?e.toString():e.s*e.n+"/"+e.d;if(Array.isArray(e))return function e(n,r){if(Array.isArray(n)){for(var o="[",i=n.length,a=0;a<i;a++)0!=a&&(o+=", "),o+=e(n[a],r);return o+"]"}return t.format(n,r)}(e,n);if(t.isString(e))return'"'+e+'"';if("function"==typeof e)return e.syntax?String(e.syntax):"function";if(e&&"object"==typeof e){if("function"==typeof e.format)return e.format(n);if(e&&e.toString()!=={}.toString())return e.toString();var a=[];for(var s in e)e.hasOwnProperty(s)&&a.push('"'+s+'": '+t.format(e[s],n));return"{"+a.join(", ")+"}"}return String(e)},t.stringify=function(e){for(var t=String(e),n="",r=0;r<t.length;){var o=t.charAt(r);"\\"===o?(n+=o,r++,""!==(o=t.charAt(r))&&-1!=='"\\/bfnrtu'.indexOf(o)||(n+="\\"),n+=o):n+='"'===o?'\\"':o,r++}return'"'+n+'"'},t.escape=function(e){var t=String(e);return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}},function(e,t,n){"use strict";var r=n(6),o=n(55),i=(n(7),n(111),n(11)),a=n(313);t.size=function(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t},t.validate=function(e,t){if(0==t.length){if(Array.isArray(e))throw new i(e.length,0)}else!function e(t,n,r){var o,a=t.length;if(a!=n[r])throw new i(a,n[r]);if(r<n.length-1){var s=r+1;for(o=0;o<a;o++){var l=t[o];if(!Array.isArray(l))throw new i(n.length-1,n.length,"<");e(t[o],n,s)}}else for(o=0;o<a;o++)if(Array.isArray(t[o]))throw new i(n.length+1,n.length,">")}(e,t,0)},t.validateIndex=function(e,t){if(!r.isNumber(e)||!r.isInteger(e))throw new TypeError("Index must be an integer (value: "+e+")");if(e<0||"number"==typeof t&&e>=t)throw new a(e,t)},t.UNINITIALIZED={},t.resize=function(e,n,i){if(!Array.isArray(e)||!Array.isArray(n))throw new TypeError("Array expected");if(0===n.length)throw new Error("Resizing to scalar is not supported");return n.forEach(function(e){if(!r.isNumber(e)||!r.isInteger(e)||e<0)throw new TypeError("Invalid size, must contain positive integers (size: "+o.format(n)+")")}),function e(n,r,o,i){var a,s,l=n.length,c=r[o],A=Math.min(l,c);if(n.length=c,o<r.length-1){var u=o+1;for(a=0;a<A;a++)s=n[a],Array.isArray(s)||(s=[s],n[a]=s),e(s,r,u,i);for(a=A;a<c;a++)s=[],n[a]=s,e(s,r,u,i)}else{for(a=0;a<A;a++)for(;Array.isArray(n[a]);)n[a]=n[a][0];if(i!==t.UNINITIALIZED)for(a=A;a<c;a++)n[a]=i}}(e,n,0,void 0!==i?i:0),e},t.reshape=function(e,n){var r,o=t.flatten(e),a=function(e){return e.reduce(function(e,t){return e*t})};if(!Array.isArray(e)||!Array.isArray(n))throw new TypeError("Array expected");if(0===n.length)throw new i(0,a(t.size(e)),"!=");try{r=function e(t,n){var r,o=[];if(0===n.length){if(0===t.length)throw new i(null,null,"!=");return t.shift()}for(r=0;r<n[0];r+=1)o.push(e(t,n.slice(1)));return o}(o,n)}catch(r){if(r instanceof i)throw new i(a(n),a(t.size(e)),"!=");throw r}if(o.length>0)throw new i(a(n),a(t.size(e)),"!=");return r},t.squeeze=function(e,n){for(var r=n||t.size(e);Array.isArray(e)&&1===e.length;)e=e[0],r.shift();for(var o=r.length;1===r[o-1];)o--;return o<r.length&&(e=function e(t,n,r){var o,i;if(r<n){var a=r+1;for(o=0,i=t.length;o<i;o++)t[o]=e(t[o],n,a)}else for(;Array.isArray(t);)t=t[0];return t}(e,o,0),r.length=o),e},t.unsqueeze=function(e,n,r,o){var i=o||t.size(e);if(r)for(var a=0;a<r;a++)e=[e],i.unshift(1);for(e=function e(t,n,r){var o,i;if(Array.isArray(t)){var a=r+1;for(o=0,i=t.length;o<i;o++)t[o]=e(t[o],n,a)}else for(var s=r;s<n;s++)t=[t];return t}(e,n,0);i.length<n;)i.push(1);return e},t.flatten=function(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function e(n){Array.isArray(n)?n.forEach(e):t.push(n)}),t},t.map=function(e,t){return Array.prototype.map.call(e,t)},t.forEach=function(e,t){Array.prototype.forEach.call(e,t)},t.filter=function(e,n){if(1!==t.size(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,n)},t.filterRegExp=function(e,n){if(1!==t.size(e).length)throw new Error("Only one dimensional matrices supported");return Array.prototype.filter.call(e,function(e){return n.test(e)})},t.join=function(e,t){return Array.prototype.join.call(e,t)},t.identify=function(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;var t=[],n=0;t[0]={value:e[0],identifier:0};for(var r=1;r<e.length;r++)e[r]===e[r-1]?n++:n=0,t.push({value:e[r],identifier:n});return t},t.generalize=function(e){if(!Array.isArray(e))throw new TypeError("Array input expected");if(0===e.length)return e;for(var t=[],n=0;n<e.length;n++)t.push(e[n].value);return t},t.isArray=Array.isArray},function(e,t,n){"use strict";var r=n(6).isInteger,o=n(6).isNumber,i=n(56).flatten,a=n(312);t.name="quantileSeq",t.factory=function(e,t,s,l){var c=s(n(110)),A=s(n(307)),u=s(n(305)),h=s(n(107));function d(e,t,n){var r=i(e),a=r.length;if(0===a)throw new Error("Cannot calculate quantile of an empty sequence");if(o(t)){var s;if(0==(v=(s=t*(a-1))%1)){var l=n?r[s]:u(r,s);return f(l),l}var d=Math.floor(s);if(n)g=r[d],m=r[d+1];else{m=u(r,d+1),g=r[d];for(var p=0;p<d;++p)h(r[p],g)>0&&(g=r[p])}return f(g),f(m),c(A(g,1-v),A(m,v))}if((s=t.times(a-1)).isInteger())return s=s.toNumber(),l=n?r[s]:u(r,s),f(l),l;d=s.floor();var g,m,v=s.minus(d),y=d.toNumber();if(n)g=r[y],m=r[y+1];else for(m=u(r,y+1),g=r[y],p=0;p<y;++p)h(r[p],g)>0&&(g=r[p]);f(g),f(m);var b=new v.constructor(1);return c(A(g,b.minus(v)),A(m,v))}var f=l({"number | BigNumber | Unit":function(e){return e}});return function(t,n,i){var s,l,c;if(arguments.length<2||arguments.length>3)throw new SyntaxError("Function quantileSeq requires two or three parameters");if(a(t)){if("boolean"==typeof(i=i||!1)){if(l=t.valueOf(),o(n)){if(n<0)throw new Error("N/prob must be non-negative");if(n<=1)return d(l,n,i);if(n>1){if(!r(n))throw new Error("N must be a positive integer");var A=n+1;s=new Array(n);for(var u=0;u<n;)s[u]=d(l,++u/A,i);return s}}if(e.isBigNumber(n)){if(n.isNegative())throw new Error("N/prob must be non-negative");if(c=new n.constructor(1),n.lte(c))return d(l,n,i);if(n.gt(c)){if(!n.isInteger())throw new Error("N must be a positive integer");var h=n.toNumber();if(h>4294967295)throw new Error("N must be less than or equal to 2^32-1, as that is the maximum length of an Array");for(A=new e.BigNumber(h+1),s=new Array(h),u=0;u<h;)s[u]=d(l,new e.BigNumber(++u).div(A),i);return s}}if(Array.isArray(n)){for(s=new Array(n.length),u=0;u<s.length;++u){var f=n[u];if(o(f)){if(f<0||f>1)throw new Error("Probability must be between 0 and 1, inclusive")}else{if(!e.isBigNumber(f))throw new TypeError("Unexpected type of argument in function quantileSeq");if(c=new f.constructor(1),f.isNegative()||f.gt(c))throw new Error("Probability must be between 0 and 1, inclusive")}s[u]=d(l,f,i)}return s}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}throw new TypeError("Unexpected type of argument in function quantileSeq")}}},function(e,t,n){"use strict";e.exports=function e(t,n,r){return t&&"function"==typeof t.map?t.map(function(t){return e(t,n,r)}):n(t)}},function(e,t,n){e.exports=[n(317),n(315)]},function(e,t,n){"use strict";e.exports=function(e){return e&&e.constructor.prototype.isMatrix||!1}},function(e,t){e.exports=function(e){return e&&e.constructor.prototype.isBigNumber||!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneEntry=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t.GeneEntry=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.geneId=parseInt(t.geneId),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.startPos=parseInt(t.startPos),this.endPos=parseInt(t.endPos),this.geneTypeIndex=parseInt(t.geneTypeIndex),this.cytobandIndices=[],t.cytobandIndices.split(";").forEach(function(e){n.cytobandIndices.push(parseInt(e))}),this.tadIndices=[],t.tadIndices.split(";").forEach(function(e){n.tadIndices.push(parseInt(e))}),this.rppaIds=[],"."!==t.rppaIds&&t.rppaIds.split(";").forEach(function(e){n.rppaIds.push(parseInt(e))}),this.geneName=t.geneName,this.cancerGene=1===parseInt(t.cancerGene),this.batch=parseInt(t.batch),this.reactomePathwayIds=[],"."!==t.reactomePathwayIds&&t.reactomePathwayIds.split(";").forEach(function(e){n.reactomePathwayIds.push(parseInt(e))}),t.hasOwnProperty("expressions")&&(this.expressions=t.expressions),t.hasOwnProperty("singleDonorVariantContributions")&&(this.singleDonorVariantContributions=t.singleDonorVariantContributions),this.currentDonorContributions=new Map,this.currentVolcanoContributions=new Map}return r(e,[{key:"getMidAngle",value:function(e){return e.genomicTheta(this.chromosomeIndex,.5*(this.startPos+this.endPos))}},{key:"checkVdjTargetValidity",value:function(){return!(this.geneName.startsWith("IGH")||this.geneName.startsWith("IGK")||this.geneName.startsWith("IGL"))||!this.geneName.includes("OR")}},{key:"isSecondClassVdjTarget",value:function(){return this.geneName.startsWith("RP11")||this.geneName.startsWith("RP5")||this.geneName.startsWith("AC0")||this.geneName.startsWith("LOC")}},{key:"addCurrentDonorContributions",value:function(e){this.currentDonorContributions=e}},{key:"getGeneCardsLink",value:function(){return-1===this.geneId?"<a>"+this.geneName+"</a>":this.cancerGene?'<a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene='+(0,o.padENSG)(this.geneId)+'#aliases_descriptions" target="_blank"><font color="red">'+this.geneName+"</font></a>":'<a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene='+(0,o.padENSG)(this.geneId)+'#aliases_descriptions" target="_blank">'+this.geneName+"</a>"}},{key:"getGeneCardsLinkPlain",value:function(){return-1===this.geneId?"<a>"+this.geneName+"</a>":'\n            <a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene='+(0,o.padENSG)(this.geneId)+'#aliases_descriptions" target="_blank">\n                '+this.geneName+"\n            </a>"}},{key:"launchDefaultDb",value:function(){window.open("https://www.genecards.org/cgi-bin/carddisp.pl?gene="+(0,o.padENSG)(this.geneId)+"#aliases_descriptions","_blank")}},{key:"annotateDonorContributions",value:function(e,t,n,r,i){var a=new Map,s=new Map,l=new Set;n.forEach(function(e,t){if(r.has(t)){for(var n=[],o=[],c=0;c<e.length;++c)i.has(e[c])?(n.push(e[c]),l.add(e[c])):o.push(e[c]);n.length>0&&a.set(t,n),o.length>0&&s.set(t,o)}else s.set(t,e)});for(var c="",A=0;A<this.cytobandIndices.length;++A)c+=(0,o.searchInPubMed)(t.cytobands[this.cytobandIndices[A]].cytobandName,e.diseaseNameAlternatives),A<this.cytobandIndices.length-1&&(c+=" and ");var u=this.getGeneCardsLink()+" on "+c+" spans the region ",h=t.chromosomes[this.chromosomeIndex].chromosomeName+":"+this.startPos+"-"+this.endPos;u+=(0,o.getGenomeBrowserLink)(h)+" ("+((this.endPos-this.startPos)/1e6).toFixed(1)+" Mb)",u+="<br />",u+="and overlaps with the TADs ";for(var d=0;d<this.tadIndices.length;++d)u+=t.tads[this.tadIndices[d]].getGenomeBrowserLink(),d<this.tadIndices.length-1&&(u+=", ");return u+="<br />",u+="The following variant classes and donors are displayed on the clicked recurrence layer:",u+="<br />",a.forEach(function(n,r){u+=t.variantTypes[r].variantType+" in "+n.length+" donor"+(n.length>1?"s":"")+" : ";for(var o=0;o<n.length;++o)u+=e.metadata[n[o]].donor,o<n.length-1&&(u+=", ");u+="<br />"}),u+="<br />",u+="The following variant classes and donors have been observed in the cohort but are not displayed on the clicked recurrence layer:",u+="<br />",s.forEach(function(n,r){u+=t.variantTypes[r].variantType+" in "+n.length+" donor"+(n.length>1?"s":"")+": ";for(var o=0;o<n.length;++o)u+=e.metadata[n[o]].donor,o<n.length-1&&(u+=", ");u+="<br />"}),[u,l]}},{key:"searchInPubMed",value:function(e){window.open('https://www.ncbi.nlm.nih.gov/pubmed?term=("'+e.join('"%20OR%20"')+'")%20AND%20'+this.geneName,"_blank")}},{key:"getIndex",value:function(){return this.geneId}},{key:"resetCohortContributions",value:function(){this.currentVolcanoContributions=new Map}},{key:"textExport",value:function(e,t,n){for(var r=[e.chromosomes[this.chromosomeIndex].chromosomeName,this.startPos,this.endPos,this.geneName,e.geneTypes[this.geneTypeIndex].geneType],o=[],i=0,a=0;a<n.length;++a)if(this.currentDonorContributions.has(n[a])){var s=this.currentDonorContributions.get(n[a]);i+=s.length;for(var l=[],c=0;c<s.length;++c)l.push(t.metadata[s[c]].donor);l.length>0?o.push(l.join(",")):o.push("")}else o.push("");return i>0?(r.push(i),r.concat(o)):[]}}],[{key:"generalHeaderExport",value:function(e,t){for(var n=["Gene Chromosome","Gene Start","Gene End","Gene Name","Gene Type","Total Recurrence"],r=0;r<t.length;++r)n.push(e.variantTypes[t[r]].variantType+" Donors");return n}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.VariantRecurrenceEntryGene=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.geneId=parseInt(t.Gene),this.contributions=new Map,n.forEach(function(e){var n=e.toString();if(""!==t[n]){var o=[];t[n].split(",").forEach(function(e){o.push(parseInt(e))}),r.contributions.set(e,o)}}),this.isValid=this.contributions.size>0}return r(e,[{key:"getIndex",value:function(){return this.geneId}}]),e}()},function(e,t){function n(e,t,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(e,t,n)}n.prototype.insert=function(e,t){for(var n=this._queue.length,r=n;r--;){var o=this._priorities[r];"desc"===this._sorting?t>o&&(n=r):t<o&&(n=r)}this._insertAt(e,t,n)},n.prototype.remove=function(e){for(var t=this._queue.length;t--;)if(e===this._queue[t]){this._queue.splice(t,1),this._priorities.splice(t,1);break}},n.prototype.forEach=function(e){this._queue.forEach(e)},n.prototype.getElements=function(){return this._queue},n.prototype.getElementPriority=function(e){return this._priorities[e]},n.prototype.getPriorities=function(){return this._priorities},n.prototype.getElementsWithPriorities=function(){for(var e=[],t=0,n=this._queue.length;t<n;t++)e.push([this._queue[t],this._priorities[t]]);return e},n.prototype._init=function(e,t,n){if(e&&t){if(this._queue=[],this._priorities=[],e.length!==t.length)throw new Error("Arrays must have the same length");for(var r=0;r<e.length;r++)this.insert(e[r],t[r])}n&&(this._sorting=n)},n.prototype._insertAt=function(e,t,n){this._queue.length===n?(this._queue.push(e),this._priorities.push(t)):(this._queue.splice(n,0,e),this._priorities.splice(n,0,t))},void 0!==e&&e.exports&&(e.exports=n)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e){this.getCost=(()=>this.Elements.map(e=>e.DistanceFromMedoid).reduce((e,t)=>e+t,0)),this.findBestMedoidIdx=(e=>this.Elements.map(t=>this.calcCostForGivenElementAsMedoid(t,e)).reduce((e,t,n,r)=>t.CostIfMadeMedoid<r[e].CostIfMadeMedoid?n:e,0)),this.calcCostForGivenElementAsMedoid=((e,t)=>({CostIfMadeMedoid:new r({Elements:this.Elements.map(n=>({DistanceFromMedoid:t(n.Element,e.Element),Element:n.Element})),Medoid:e.Element}).getCost(),Element:e})),this.Elements=e.Elements,this.Medoid=e.Medoid}}t.Cluster=r},function(e,t,n){"use strict";e.exports=function(e,t){var n,r=t.length,o=e;for(n=0;n<r;n++){if("object"!=typeof o||null===o||!o.hasOwnProperty(t[n]))return;o=o[t[n]]}return o}},function(e,t,n){"use strict";e.exports=function(){return{sep:"."}}},function(e,t,n){"use strict";var r=n(5),o=n(42);e.exports=function(e,t){return o(t)?t.hasOwnProperty("sep")&&(e.sep=t.sep,!r(e.sep))?new TypeError("deepGet()::invalid option. Key path separator must be a string primitive. Option: `"+e.sep+"`."):null:new TypeError("deepGet()::invalid input argument. Options argument must be an object. Value: `"+t+"`.")}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var o,i,a=t.length,s=!1,l=e;for(i=0;i<a&&(o=t[i],"object"==typeof l&&null!==l);i++){if(!l.hasOwnProperty(o)){if(!n)break;l[o]={}}i===a-1?(l[o]="function"==typeof r?r(l[o]):r,s=!0):l=l[o]}return s}},function(e,t,n){"use strict";e.exports=function(){return{create:!1,sep:"."}}},function(e,t,n){"use strict";var r=n(5),o=n(42),i=n(72);e.exports=function(e,t){return o(t)?t.hasOwnProperty("create")&&(e.create=t.create,!i(e.create))?new TypeError("deepSet()::invalid option. Create option must be a boolean primitive. Option: `"+e.create+"`."):t.hasOwnProperty("sep")&&(e.sep=t.sep,!r(e.sep))?new TypeError("deepSet()::invalid option. Key path separator must be a string primitive. Option: `"+e.sep+"`."):null:new TypeError("deepSet()::invalid input argument. Options argument must be an object. Value: `"+t+"`.")}},function(e,t,n){"use strict";e.exports=function(e){return!0===e||!1===e}},function(e,t,n){"use strict";e.exports=["int8","uint8","uint8_clamped","int16","uint16","int32","uint32","float32","float64"]},function(e,t,n){"use strict";var r=n(10),o=n(27),i=n(193),a=n(192);e.exports=function(e,t){var n;if(arguments.length>1){if(!o(t))throw new TypeError("invalid input argument. Level must be a nonnegative integer. Value: `"+t+"`.");if(0===t)return e}else t=i;return n=r(e)?[]:{},a(e,n,[e],[n],t)}},function(e,t,n){"use strict";var r=n(85),o=n(74);e.exports=function(){var e,t;return(t={}).type="Matrix",t.dtype=this.dtype,t.shape=o(this.shape),t.offset=this.offset,t.strides=o(this.strides),e=Object.getOwnPropertyDescriptor(this,"data"),t.raw=e.writable&&e.configurable&&e.enumerable,t.data=r(this.data,"generic"),t}},function(e,t,n){"use strict";e.exports=function(){var e,t,n,r=this.shape[0],o=this.shape[1],i=this.strides[0],a=this.strides[1],s=r-1,l=o-1,c="";for(t=0;t<r;t++){for(e=this.offset+t*i,n=0;n<o;n++)c+=this.data[e+n*a],n<l&&(c+=",");t<s&&(c+=";")}return c}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var o,i,a,s,l=e.strides[0],c=e.strides[1],A=r.strides[0],u=r.strides[1],h=t.length,d=n.length,f=e.offset,p=r.offset;if(r.shape[0]!==h||r.shape[1]!==d)throw new Error("invalid input argument. The dimensions given by the row and column indices do not match the value matrix dimensions.");for(a=0;a<h;a++)for(o=f+t[a]*l,i=p+a*A,s=0;s<d;s++)e.data[o+n[s]*c]=r.data[i+s*u]}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var o,i,a,s=e.strides[0],l=e.strides[1],c=t.length,A=n.length,u=e.offset;for(i=0;i<c;i++)for(o=u+t[i]*s,a=0;a<A;a++)e.data[o+n[a]*l]=r}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){var i,a,s,l,c=e.strides[0],A=e.strides[1],u=t.length,h=n.length,d=e.offset;for(a=0;a<u;a++)for(i=d+t[a]*c,s=0;s<h;s++)l=i+n[s]*A,e.data[l]=r.call(o,e.data[l],t[a],n[s],l)}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,o,i,a,s,l,c,A=e.strides[0],u=e.strides[1],h=n.strides[0],d=n.strides[1],f=t.length,p=e.offset,g=n.offset;if(n.length!==f)throw new Error("invalid input argument. Number of indices does not match the number of elements in the value matrix.");for(r=A<0?-1:1,o=h<0?-1:1,c=0;c<f;c++)s=t[c]%A,i=r*(t[c]-s),a=o*(c-(l=c%h)),e.data[p+i+s*u]=n.data[g+a+l*d]}},function(e,t,n){"use strict";e.exports=function(e,t,n,r){var o,i,a,s,l,c,A=e.strides[0],u=e.strides[1],h=t.length,d=e.offset;for(o=A<0?-1:1,c=0;c<h;c++)a=t[c]%A,i=(s=o*(t[c]-a))/A,l=d+s+a*u,e.data[l]=n.call(r,e.data[l],i,a,l)}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r,o,i,a,s=e.strides[0],l=e.strides[1],c=t.length,A=e.offset;for(r=s<0?-1:1,a=0;a<c;a++)i=t[a]%s,o=r*(t[a]-i),e.data[A+o+i*l]=n}},function(e,t,n){"use strict";var r=n(84),o=n(204);e.exports=function(e){var t;if(null===e)return"null";switch(t=typeof e){case"undefined":case"boolean":case"number":case"string":case"function":case"symbol":return t}return t=r(e),o(t)||("Buffer"===t||"ArrayBuffer"===t?"binary":"generic")}},function(e,t,n){"use strict";var r=Object.prototype.toString;e.exports=function(e){var t;return null===e?"null":"object"==(t=typeof e)?function(e){var t=r.call(e).slice(8,-1);return"Object"===t&&e.constructor?function(e){return e.name?e.name:/^\s*function\s*([^\(]*)/im.exec(e.toString())[1]}(e.constructor):t}(e):t}},function(e,t,n){"use strict";var r=n(46),o=n(84),i=n(208),a=n(206);e.exports=function(e,t){var n,s,l,c;if(!r(e))throw new TypeError("invalid input argument. First argument must be an array-like object. Value: `"+e+"`.");if(null===(n=a("string"==typeof t?t:i(o(t)))))throw new Error("invalid input argument. Unrecognized/unsupported type to which to cast. Value: `"+t+"`.");if(s=e.length,"generic"===t&&s>64e3){for(l=new n(64e3),c=0;c<64e3;c++)l[c]=e[c];for(c=64e3;c<s;c++)l.push(e[c])}else for(l=new n(s),c=0;c<s;c++)l[c]=e[c];return l}},function(e,t,n){"use strict";var r=n(10),o=n(209);e.exports=function(e,t){var n,i;if(!r(e))throw new TypeError("contains()::invalid input argument. First argument must be an array. Value: `"+e+"`.");if(n=e.length,o(t)){for(i=0;i<n;i++)if(o(e[i]))return!0;return!1}for(i=0;i<n;i++)if(e[i]===t)return!0;return!1}},function(e,t,n){"use strict";e.exports=function(e){return("number"==typeof e||"[object Number]"===Object.prototype.toString.call(e))&&e.valueOf()==e.valueOf()}},function(e,t,n){"use strict";e.exports=4294967295},function(e,t,n){"use strict";e.exports=function(e,t,n){var o=e*t,i=r*e,a=i-(i-e),s=e-a,l=r*t,c=l-(l-t),A=t-c,u=s*A-(o-a*c-s*c-a*A);return n?(n[0]=u,n[1]=o,n):[u,o]};var r=+(Math.pow(2,27)+1)},function(e,t,n){"use strict";var r=n(89),o=n(225),i=n(224),a=n(222);function s(e,t){for(var n=new Array(e.length-1),r=1;r<e.length;++r)for(var o=n[r-1]=new Array(e.length-1),i=0,a=0;i<e.length;++i)i!==t&&(o[a++]=e[r][i]);return n}function l(e){return 1&e?"-":""}function c(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",c(e.slice(0,t)),",",c(e.slice(t)),")"].join("")}function A(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],n=0;n<e.length;++n)t.push(["scale(",c(A(s(e,n))),",",l(n),e[0][n],")"].join(""));return t}function u(e){for(var t=[],n=[],l=function(e){for(var t=new Array(e),n=0;n<e;++n){t[n]=new Array(e);for(var r=0;r<e;++r)t[n][r]=["m",r,"[",e-n-1,"]"].join("")}return t}(e),u=[],h=0;h<e;++h)0==(1&h)?t.push.apply(t,A(s(l,h))):n.push.apply(n,A(s(l,h))),u.push("m"+h);var d=c(t),f=c(n),p="orientation"+e+"Exact",g=["function ",p,"(",u.join(),"){var p=",d,",n=",f,",d=sub(p,n);return d[d.length-1];};return ",p].join("");return new Function("sum","prod","scale","sub",g)(o,r,i,a)}var h=u(3),d=u(4),f=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,n){var r,o=(e[1]-n[1])*(t[0]-n[0]),i=(e[0]-n[0])*(t[1]-n[1]),a=o-i;if(o>0){if(i<=0)return a;r=o+i}else{if(!(o<0))return a;if(i>=0)return a;r=-(o+i)}var s=3.3306690738754716e-16*r;return a>=s||a<=-s?a:h(e,t,n)},function(e,t,n,r){var o=e[0]-r[0],i=t[0]-r[0],a=n[0]-r[0],s=e[1]-r[1],l=t[1]-r[1],c=n[1]-r[1],A=e[2]-r[2],u=t[2]-r[2],h=n[2]-r[2],f=i*c,p=a*l,g=a*s,m=o*c,v=o*l,y=i*s,b=A*(f-p)+u*(g-m)+h*(v-y),I=7.771561172376103e-16*((Math.abs(f)+Math.abs(p))*Math.abs(A)+(Math.abs(g)+Math.abs(m))*Math.abs(u)+(Math.abs(v)+Math.abs(y))*Math.abs(h));return b>I||-b>I?b:d(e,t,n,r)}];!function(){for(;f.length<=5;)f.push(u(f.length));for(var t=[],n=["slow"],r=0;r<=5;++r)t.push("a"+r),n.push("o"+r);var o=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=5;++r)o.push("case ",r,":return o",r,"(",t.slice(0,r).join(),");");o.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(o.join(""));var i=Function.apply(void 0,n);for(e.exports=i.apply(void 0,[function(e){var t=f[e.length];return t||(t=f[e.length]=u(e.length)),t.apply(void 0,e)}].concat(f)),r=0;r<=5;++r)e.exports[r]=f[r]}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.CsrSparseMatrix=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[],this.indices=[],this.indptr=[],this.dim0=0,this.dim1=0}return r(e,[{key:"addCooData",value:function(e){e.has_canonical_format||e.eliminate_zeros(),e.sum_duplicates();var t=e.data.length,n=e.dim0;this.indptr=new Array(n+1).fill(0);for(var r=0;r<t;++r)this.indptr[e.row[r]]+=1;for(var o=0,i=0;o<n;++o){var a=this.indptr[o];this.indptr[o]=i,i+=a}this.indptr[n]=t;for(var s=0;s<t;++s){var l=e.row[s],c=this.indptr[l];this.indices[c]=e.col[s],this.data[c]=e.data[s],this.indptr[l]+=1}for(var A=0,u=0;A<=n;A++){var h=this.indptr[A];this.indptr[A]=u,u=h}this.dim0=e.dim0,this.dim1=e.dim1}},{key:"todense",value:function(){for(var e=[],t=0;t<this.dim0;++t){e.push(new Array(this.dim1).fill(0));for(var n=this.indptr[t];n<this.indptr[t+1];++n)e[t][this.indices[n]]+=this.data[n]}return e}}]),e}()},function(e,t,n){"use strict";var r=n(11);t.name="algorithm07",t.factory=function(e,t,n,o){var i=e.DenseMatrix,a=function(e,t,n,r,o){for(var i=e._values,a=e._index,s=e._ptr,l=s[t],c=s[t+1];l<c;l++){var A=a[l];n[A]=o,r[A]=i[l]}};return function(e,t,n){var s=e._size,l=e._datatype,c=t._size,A=t._datatype;if(s.length!==c.length)throw new r(s.length,c.length);if(s[0]!==c[0]||s[1]!==c[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+c+")");var u,h,d,f=s[0],p=s[1],g=0,m=n;"string"==typeof l&&l===A&&(u=l,g=o.convert(0,u),m=o.find(n,[u,u]));var v=[];for(h=0;h<f;h++)v[h]=[];var y=new i({data:v,size:[f,p],datatype:u}),b=[],I=[],x=[],w=[];for(d=0;d<p;d++){var C=d+1;for(a(e,d,x,b,C),a(t,d,w,I,C),h=0;h<f;h++){var E=x[h]===C?b[h]:g,S=w[h]===C?I[h]:g;v[h][d]=m(E,S)}}return y}}},function(e,t,n){"use strict";var r=n(6).nearlyEqual,o=n(40);t.name="smaller",t.factory=function(e,t,i,a){var s=i(n(15)),l=i(n(39)),c=i(n(92)),A=i(n(53)),u=i(n(30)),h=i(n(24)),d=n(17),f=a("smaller",{"boolean, boolean":function(e,t){return e<t},"number, number":function(e,n){return e<n&&!r(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.lt(n)&&!o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return-1===e.compare(t)},"Complex, Complex":function(e,t){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return f(e.value,t.value)},"string, string":function(e,t){return e<t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,f);break;default:n=l(t,e,f,!0)}break;default:switch(t.storage()){case"sparse":n=l(e,t,f,!1);break;default:n=u(e,t,f)}}return n},"Array, Array":function(e,t){return f(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return f(s(e),t)},"Matrix, Array":function(e,t){return f(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=A(e,t,f,!1);break;default:n=h(e,t,f,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=A(t,e,f,!0);break;default:n=h(t,e,f,!0)}return n},"Array, any":function(e,t){return h(s(e),t,f,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+d.operators.smaller+"${args[1]}\\right)"},f}},function(e,t,n){"use strict";var r=n(7).hasOwnProperty;function o(e,t){return!(!e||"object"!=typeof e||!r(s,t)&&(t in Object.prototype||t in Function.prototype))}function i(e,t){return!(!e||"function"!=typeof e[t]||r(e,t)&&e.__proto__&&t in e.__proto__||!r(l,t)&&(t in Object.prototype||t in Function.prototype))}function a(e){return"object"==typeof e&&e&&e.constructor===Object}var s={length:!0,name:!0},l={toString:!0,valueOf:!0,toLocaleString:!0};t.getSafeProperty=function(e,t){if(a(e)&&o(e,t))return e[t];if("function"==typeof e[t]&&i(e,t))throw new Error('Cannot access method "'+t+'" as a property');throw new Error('No access to property "'+t+'"')},t.setSafeProperty=function(e,t,n){if(a(e)&&o(e,t))return e[t]=n;throw new Error('No access to property "'+t+'"')},t.isSafeProperty=o,t.validateSafeMethod=function(e,t){if(!i(e,t))throw new Error('No access to method "'+t+'"')},t.isSafeMethod=i,t.isPlainObject=a},function(e,t,n){"use strict";var r=n(29),o=n(11),i=(n(94).getSafeProperty,n(94).setSafeProperty,r.string),a=r.array,s=r.object,l=r.number,c=Array.isArray,A=l.isNumber,u=l.isInteger,h=i.isString,d=a.validateIndex;t.name="DenseMatrix",t.path="type",t.factory=function(e,t,l,f){var p=l(n(47));function g(t,n){if(!(this instanceof g))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!h(n))throw new Error("Invalid datatype: "+n);if(e.isMatrix(t))"DenseMatrix"===t.type?(this._data=s.clone(t._data),this._size=s.clone(t._size),this._datatype=n||t._datatype):(this._data=t.toArray(),this._size=t.size(),this._datatype=n||t._datatype);else if(t&&c(t.data)&&c(t.size))this._data=t.data,this._size=t.size,this._datatype=n||t.datatype;else if(c(t))this._data=function e(t){for(var n=0,r=t.length;n<r;n++){var o=t[n];c(o)?t[n]=e(o):o&&!0===o.isMatrix&&(t[n]=e(o.valueOf()))}return t}(t),this._size=a.size(this._data),a.validate(this._data,this._size),this._datatype=n;else{if(t)throw new TypeError("Unsupported type of data ("+r.types.type(t)+")");this._data=[],this._size=[0],this._datatype=n}}g.prototype=new p,g.prototype.type="DenseMatrix",g.prototype.isDenseMatrix=!0,g.prototype.storage=function(){return"dense"},g.prototype.datatype=function(){return this._datatype},g.prototype.create=function(e,t){return new g(e,t)},g.prototype.subset=function(t,n,r){switch(arguments.length){case 1:return function(t,n){if(!e.isIndex(n))throw new TypeError("Invalid index");if(n.isScalar())return t.get(n.min());var r=n.size();if(r.length!=t._size.length)throw new o(r.length,t._size.length);for(var i=n.min(),a=n.max(),s=0,l=t._size.length;s<l;s++)d(i[s],t._size[s]),d(a[s],t._size[s]);return new g(function e(t,n,r,o){var i=o===r-1,a=n.dimension(o);return i?a.map(function(e){return d(e,t.length),t[e]}).valueOf():a.map(function(i){d(i,t.length);var a=t[i];return e(a,n,r,o+1)}).valueOf()}(t._data,n,r.length,0),t._datatype)}(this,t);case 2:case 3:return function(t,n,r,i){if(!n||!0!==n.isIndex)throw new TypeError("Invalid index");var l,c=n.size(),A=n.isScalar();if(e.isMatrix(r)?(l=r.size(),r=r.valueOf()):l=a.size(r),A){if(0!==l.length)throw new TypeError("Scalar expected");t.set(n.min(),r,i)}else{if(c.length<t._size.length)throw new o(c.length,t._size.length,"<");if(l.length<c.length){for(var u=0,h=0;1===c[u]&&1===l[u];)u++;for(;1===c[u];)h++,u++;r=a.unsqueeze(r,c.length,h,l)}if(!s.deepEqual(c,l))throw new o(c,l,">");v(t,n.max().map(function(e){return e+1}),i);var f=c.length;!function e(t,n,r,o,i){var a=i===o-1,s=n.dimension(i);a?s.forEach(function(e,n){d(e),t[e]=r[n[0]]}):s.forEach(function(a,s){d(a),e(t[a],n,r[s[0]],o,i+1)})}(t._data,n,r,f,0)}return t}(this,t,n,r);default:throw new SyntaxError("Wrong number of arguments")}},g.prototype.get=function(e){if(!c(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);for(var t=0;t<e.length;t++)d(e[t],this._size[t]);for(var n=this._data,r=0,i=e.length;r<i;r++){var a=e[r];d(a,n.length),n=n[a]}return n},g.prototype.set=function(e,t,n){if(!c(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new o(e.length,this._size.length,"<");var r,i,a;v(this,e.map(function(e){return e+1}),n);var s=this._data;for(r=0,i=e.length-1;r<i;r++)a=e[r],d(a,s.length),s=s[a];return a=e[e.length-1],d(a,s.length),s[a]=t,this},g.prototype.resize=function(e,t,n){if(!c(e))throw new TypeError("Array expected");var r=n?this.clone():this;return m(r,e,t)};var m=function(e,t,n){if(0===t.length){for(var r=e._data;c(r);)r=r[0];return r}return e._size=t.slice(0),e._data=a.resize(e._data,e._size,n),e};function v(e,t,n){for(var r=e._size.slice(0),o=!1;r.length<t.length;)r.push(0),o=!0;for(var i=0,a=t.length;i<a;i++)t[i]>r[i]&&(r[i]=t[i],o=!0);o&&m(e,r,n)}return g.prototype.reshape=function(e,t){var n=t?this.clone():this;return n._data=a.reshape(n._data,e),n._size=e.slice(0),n},g.prototype.clone=function(){return new g({data:s.clone(this._data),size:s.clone(this._size),datatype:this._datatype})},g.prototype.size=function(){return this._size.slice(0)},g.prototype.map=function(e){var t=this,n=function(r,o){return c(r)?r.map(function(e,t){return n(e,o.concat(t))}):e(r,o,t)};return new g({data:n(this._data,[]),size:s.clone(this._size),datatype:this._datatype})},g.prototype.forEach=function(e){var t=this,n=function(r,o){c(r)?r.forEach(function(e,t){n(e,o.concat(t))}):e(r,o,t)};n(this._data,[])},g.prototype.toArray=function(){return s.clone(this._data)},g.prototype.valueOf=function(){return this._data},g.prototype.format=function(e){return i.format(this._data,e)},g.prototype.toString=function(){return i.format(this._data)},g.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},g.prototype.diagonal=function(t){if(t){if(e.isBigNumber(t)&&(t=t.toNumber()),!A(t)||!u(t))throw new TypeError("The parameter k must be an integer number")}else t=0;for(var n=t>0?t:0,r=t<0?-t:0,o=this._size[0],i=this._size[1],a=Math.min(o-r,i-n),s=[],l=0;l<a;l++)s[l]=this._data[l+r][l+n];return new g({data:s,size:[a],datatype:this._datatype})},g.diagonal=function(t,n,r,o,i){if(!c(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(e.isBigNumber(t)&&(t=t.toNumber()),!A(t)||!u(t)||t<1)throw new Error("Size values must be positive integers");return t}),r){if(e.isBigNumber(r)&&(r=r.toNumber()),!A(r)||!u(r))throw new TypeError("The parameter k must be an integer number")}else r=0;o&&h(i)&&(o=f.convert(o,i));var s,l=r>0?r:0,d=r<0?-r:0,p=t[0],m=t[1],v=Math.min(p-d,m-l);if(c(n)){if(n.length!==v)throw new Error("Invalid value array length");s=function(e){return n[e]}}else if(e.isMatrix(n)){var y=n.size();if(1!==y.length||y[0]!==v)throw new Error("Invalid matrix length");s=function(e){return n.get([e])}}else s=function(){return n};o||(o=e.isBigNumber(s(0))?new e.BigNumber(0):0);var b=[];if(t.length>0){b=a.resize(b,t,o);for(var I=0;I<v;I++)b[I+d][I+l]=s(I)}return new g({data:b,size:[p,m]})},g.fromJSON=function(e){return new g(e)},g.prototype.swapRows=function(e,t){if(!(A(e)&&u(e)&&A(t)&&u(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return d(e,this._size[0]),d(t,this._size[0]),g._swapRows(e,t,this._data),this},g._swapRows=function(e,t,n){var r=n[e];n[e]=n[t],n[t]=r},e.Matrix._storage.dense=g,e.Matrix._storage.default=g,g},t.lazy=!1},function(e,t,n){var r=n(97);function o(e){this.centroids=e||[]}o.prototype.randomCentroids=function(e,t){var n=e.slice(0);return n.sort(function(){return Math.round(Math.random())-.5}),n.slice(0,t)},o.prototype.classify=function(e,t){var n=1/0,o=0;"string"==typeof(t=t||"euclidean")&&(t=r[t]);for(var i=0;i<this.centroids.length;i++){var a=t(e,this.centroids[i]);a<n&&(n=a,o=i)}return o},o.prototype.cluster=function(e,t,n,o,i){t=t||Math.max(2,Math.ceil(Math.sqrt(e.length/2))),"string"==typeof(n=n||"euclidean")&&(n=r[n]),this.centroids=this.randomCentroids(e,t);for(var a=new Array(e.length),s=new Array(t),l=0,c=!0;c;){for(var A=0;A<e.length;A++)a[A]=this.classify(e[A],n);c=!1;for(var u=0;u<t;u++){var h=[];for(A=0;A<a.length;A++)a[A]==u&&h.push(e[A]);if(h.length){for(var d=this.centroids[u],f=new Array(d.length),p=0;p<d.length;p++){var g=0;for(A=0;A<h.length;A++)g+=h[A][p];f[p]=g/h.length,f[p]!=d[p]&&(c=!0)}this.centroids[u]=f,s[u]=h}}i&&l++%o==0&&i(s)}return s},o.prototype.toJSON=function(){return JSON.stringify(this.centroids)},o.prototype.fromJSON=function(e){return this.centroids=JSON.parse(e),this},e.exports=o,e.exports.kmeans=function(e,t){return(new o).cluster(e,t)}},function(e,t){e.exports={euclidean:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(t[r]-e[r],2);return Math.sqrt(n)},manhattan:function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.abs(t[r]-e[r]);return n},max:function(e,t){for(var n=0,r=0;r<e.length;r++)n=Math.max(n,Math.abs(t[r]-e[r]));return n}}},function(e,t){t.log1p=function(e){if(e<=-1)throw new RangeError("Argument mustbe greater than -1.0");return Math.abs(e)>1e-4?Math.log(1+e):(-.5*e+1)*e};var n=[0,0,.693147180559945,1.791759469228055,3.178053830347946,4.787491742782046,6.579251212010101,8.525161361065415,10.60460290274525,12.801827480081469,15.104412573075516,17.502307845873887,19.987214495661885,22.55216385312342,25.191221182738683,27.899271383840894,30.671860106080675,33.50507345013689,36.39544520803305,39.339884187199495,42.335616460753485,45.38013889847691,48.47118135183523,51.60667556776438,54.78472939811232,58.00360522298052,61.261701761002,64.55753862700632,67.88974313718153,71.257038967168,74.65823634883016,78.0922235533153,81.55795945611503,85.05446701758152,88.58082754219768,92.13617560368708,95.7196945421432,99.33061245478743,102.96819861451381,106.63176026064345,110.32063971475739,114.03421178146169,117.77188139974506,121.53308151543864,125.31727114935688,129.12393363912724,132.9525750356163,136.80272263732635,140.67392364823425,144.5657439463449,148.47776695177302,152.40959258449735,156.3608363030788,160.33112821663093,164.32011226319517,168.32744544842765,172.35279713916282,176.39584840699737,180.45629141754378,184.5338288614495,188.6281734236716,192.7390472878449,196.86618167288998,201.00931639928157,205.1681994826412,209.34258675253682,213.53224149456327,217.73693411395425,221.95644181913036,226.19054832372757,230.43904356577693,234.70172344281826,238.97838956183435,243.26884900298273,247.5729140961869,251.8904022097232,256.2211355500095,260.5649409718632,264.9216497985528,269.2910976510198,273.6731242856937,278.0675734403661,282.4742926876304,286.893133295427,291.3239500942703,295.7666013507606,300.2209486470141,304.6868567656687,309.1641935801469,313.652829949879,318.1526396202093,322.6634991267262,327.1852877037752,331.7178871969285,336.26118197919845,340.81505887079896,345.37940706226686,349.95411804077025,354.5390855194408,359.13420536957534,363.73937555556347,368.3544960724047,372.979468885689,377.61419787391867,382.25858877306,386.91254912321756,391.5759882173296,396.2488170517915,400.93094827891576,405.6222961611449,410.3227765269373,415.0323067282496,419.7508055995448,424.4781934182571,429.21439186665157,433.95932399501487,438.71291418612117,443.47508812091894,448.2457727453846,453.0248962384961,457.8123879812781,462.6081785268749,467.4121995716081,472.2243839269805,477.0446654925856,481.8729792298879,486.70926113683936,491.553448223298,496.4054784872176,501.26529089157924,506.13282534203483,511.00802266523607,515.8908245878225,520.7811737160442,525.679013515995,530.5842882944336,535.4969431801695,540.4169241059977,545.344177791155,550.2786517242856,555.220294146895,560.1690540372731,565.1248810948744,570.0877257251342,575.0575390247102,580.0342727671308,585.0178793888392,590.0083119756179,595.005524249382,600.0094705553274,605.0201058494238,610.0373856862387,615.0612662070849,620.0917041284774,625.1286567308911,630.1720818478102,635.2219378550598,640.2781836604081,645.340778693435,650.4096828956552,655.4848567108891,660.5662610758735,665.653857411106,670.7476076119127,675.8474740397369,680.9534195136375,686.065407301994,691.1834011144108,696.307365093814,701.4372638087372,706.5730622457875,711.71472580229,716.8622202791034,722.0155118736013,727.1745671728158,732.3393531467393,737.5098371417774,742.6859868743512,747.8677704246434,753.0551562304842,758.2481130813743,763.4466101126402,768.650616799717,773.8601029525585,779.0750387101674,784.2953945352457,789.521141208959,794.7522498258135,799.9886917886435,805.2304388037031,810.4774628758636,815.7297363039102,820.9872316759379,826.2499218648428,831.5177800239063,836.7907795824699,842.0688942417005,847.3520979704384,852.6403650011331,857.9336698258575,863.2319871924054,868.5352921004646,873.8435597978657,879.1567657769076,884.4748857707518,889.7978957498902,895.1257719186799,900.4584907119453,905.7960287916463,911.1383630436112,916.4854705743288,921.8373287078049,927.1939149824767,932.5552071481862,937.9211831632081,943.2918211913357,948.6670995990198,954.0469969525604,959.4314920153495,964.8205637451659,970.2141912915183,975.6123539930362,981.0150313749084,986.4222031463686,991.8338491982234,997.2499496004278,1002.6704845997003,1008.0954346171817,1013.5247802461362,1018.9585022496902,1024.3965815586134,1029.8389992691355,1035.2857366408016,1040.7367750943674,1046.192096209725,1051.6516817238692,1057.115513528895,1062.58357367003,1068.0558443437014,1073.5323078956328,1079.012946818975,1084.4977437524656,1089.9866814786224,1095.4797429219627,1100.976911147256,1106.4781693578009,1111.983500893733,1117.492889230361,1123.0063179765261,1128.5237708729908,1134.045231790853,1139.5706847299848,1145.100113817496,1150.6335033062237,1156.1708375732424];t.logFactorial=function(e){if(e<0)throw new Error("Argument may not be negative.");if(e>254){var t=e+1;return(t-.5)*Math.log(t)-t+.5*Math.log(2*Math.PI)+1/(12*t)}return n[e]}},function(e,t){var n=.5772156649015329,r=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],o=[-30.840230011973897,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.25967555349];function i(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<.001)return 1/(e*(1+n*e));if(e<12){var t=e,i=0,a=t<1;a?t+=1:t-=i=Math.floor(t)-1;for(var s=0,c=1,A=t-1,u=0;u<8;u++)s=(s+r[u])*A,c=c*A+o[u];var h=s/c+1;if(a)h/=t-1;else for(u=0;u<i;u++)h*=t++;return h}return e>171.624?1/0:Math.exp(l(e))}t.gamma=i;var a=[1/12,-1/360,1/1260,-1/1680,1/1188,-691/360360,1/156,-3617/122400],s=.9189385332046728;function l(e){if(e<=0)throw new RangeError("Argument must be positive.");if(e<12)return Math.log(Math.abs(i(e)));for(var t=1/(e*e),n=a[7],r=6;r>=0;r--)n*=t,n+=a[r];var o=n/e;return(e-.5)*Math.log(e)-e+s+o}t.logGamma=l},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l,c=[],A=!1,u=-1;function h(){A&&l&&(A=!1,l.length?c=l.concat(c):u=-1,c.length&&d())}function d(){if(!A){var e=s(h);A=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,A=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||A||s(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";(function(e){var r=n(289),o=n(288),i=n(287);function a(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=h(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),o=(e=s(e,r)).write(t,n);return o!==r&&(e=e.slice(0,o)),e}(e,t,n):function(e,t){if(l.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function A(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(A(t),e=s(e,t<0?0:0|d(t)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return O(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return L(e).length;default:if(r)return O(e).length;t=(""+t).toLowerCase(),r=!0}}function p(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,o){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(o)return-1;n=e.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof t&&(t=l.from(t,r)),l.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,o);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,o){var i,a=1,s=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,l/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var A=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===A?0:i-A)){if(-1===A&&(A=i),i-A+1===l)return A*a}else-1!==A&&(i-=i-A),A=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var u=!0,h=0;h<l;h++)if(c(e,i+h)!==c(t,h)){u=!1;break}if(u)return i}return-1}function v(e,t,n,r){n=Number(n)||0;var o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function y(e,t,n,r){return j(O(t,e.length-n),e,n,r)}function b(e,t,n,r){return j(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function I(e,t,n,r){return b(e,t,n,r)}function x(e,t,n,r){return j(L(t),e,n,r)}function w(e,t,n,r){return j(function(e,t){for(var n,r,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function E(e,t,n){n=Math.min(e.length,n);for(var r=[],o=t;o<n;){var i,a,s,l,c=e[o],A=null,u=c>239?4:c>223?3:c>191?2:1;if(o+u<=n)switch(u){case 1:c<128&&(A=c);break;case 2:128==(192&(i=e[o+1]))&&(l=(31&c)<<6|63&i)>127&&(A=l);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(l=(15&c)<<12|(63&i)<<6|63&a)>2047&&(l<55296||l>57343)&&(A=l);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&l<1114112&&(A=l)}null===A?(A=65533,u=1):A>65535&&(A-=65536,r.push(A>>>10&1023|55296),A=56320|1023&A),r.push(A),o+=u}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=S));return n}(r)}t.Buffer=l,t.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,n){return c(null,e,t,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,n){return function(e,t,n,r){return A(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=l.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){var a=e[n];if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,o),o+=a.length}return r},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)p(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)p(this,t,t+3),p(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)p(this,t,t+7),p(this,t+1,t+6),p(this,t+2,t+5),p(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?E(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return B(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return M(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,n,r,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),t<0||n>e.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&t>=n)return 0;if(r>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,o>>>=0,this===e)return 0;for(var i=o-r,a=n-t,s=Math.min(i,a),c=this.slice(r,o),A=e.slice(t,n),u=0;u<s;++u)if(c[u]!==A[u]){i=c[u],a=A[u];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},l.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},l.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},l.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return v(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return I(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function M(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function B(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=t;i<n;++i)o+=F(e[i]);return o}function D(e,t,n){for(var r=e.slice(t,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function Q(e,t,n,r,o,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function T(e,t,n,r){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-n,2);o<i;++o)e[n+o]=(t&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function G(e,t,n,r){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-n,4);o<i;++o)e[n+o]=t>>>8*(r?o:3-o)&255}function R(e,t,n,r,o,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function _(e,t,n,r,i){return i||R(e,0,n,4),o.write(e,t,n,r,23,4),n+4}function V(e,t,n,r,i){return i||R(e,0,n,8),o.write(e,t,n,r,52,8),n+8}l.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;n=new l(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+e]}return n},l.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r},l.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e+--t],o=1;t>0&&(o*=256);)r+=this[e+--t]*o;return r},l.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=this[e],o=1,i=0;++i<t&&(o*=256);)r+=this[e+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*t)),r},l.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var r=t,o=1,i=this[e+--r];r>0&&(o*=256);)i+=this[e+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),o.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),o.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),o.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),o.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||Q(this,e,t,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[t]=255&e;++i<n&&(o*=256);)this[t+i]=e/o&255;return t+n},l.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||Q(this,e,t,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+n},l.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):T(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):T(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):G(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):G(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Q(this,e,t,n,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<n&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var o=Math.pow(2,8*n-1);Q(this,e,t,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+n},l.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):T(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):T(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):G(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||Q(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):G(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,n){return _(this,e,t,!0,n)},l.prototype.writeFloatBE=function(e,t,n){return _(this,e,t,!1,n)},l.prototype.writeDoubleLE=function(e,t,n){return V(this,e,t,!0,n)},l.prototype.writeDoubleBE=function(e,t,n){return V(this,e,t,!1,n)},l.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var o,i=r-n;if(this===e&&n<t&&t<r)for(o=i-1;o>=0;--o)e[o+t]=this[o+n];else if(i<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},l.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var a=l.isBuffer(e)?e:O(new l(e,r).toString()),s=a.length;for(i=0;i<n-t;++i)this[i+t]=a[i%s]}return this};var N=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function O(e,t){var n;t=t||1/0;for(var r=e.length,o=null,i=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function L(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(N,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function j(e,t,n,r){for(var o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}}).call(this,n(101))},function(e,t,n){var r=n(52);Misc=function(){},Misc.erf=function(e){var t,n=0,r=0;do{n+=t=Math.pow(-1,r)*Math.pow(e,2*r+1)/this.fac(r)/(2*r+1),r++}while(Math.abs(t)>1e-12);return 2*n/Math.sqrt(Math.PI)},Misc.gamma=function(e){var t=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*this.gamma(1-e));for(var n=t[0],r=7+(e-=1)+.5,o=1;o<t.length;o++)n+=t[o]/(e+o);return Math.sqrt(2*Math.PI)*Math.pow(r,e+.5)*Math.exp(-r)*n},Misc.beta=function(e,t){return this.gamma(e)*this.gamma(t)/this.gamma(e+t)},Misc.ibeta=function(e,t,n){return r.Numeric.adaptiveSimpson(function(e){return Math.pow(e,t-1)*Math.pow(1-e,n-1)},0,e,1e-12,10)},Misc.rbeta=function(e,t,n){return this.ibeta(e,t,n)/this.beta(t,n)},Misc.fac=function(e){for(var t=1,n=2;n<=e;n++)t*=n;return t},e.exports.Misc=Misc},function(e,t){Matrix=function(e){this.elements=e},Matrix.prototype.rows=function(){return this.elements.length},Matrix.prototype.cols=function(){return this.elements[0].length},Matrix.prototype.dot=function(e){for(var t=[],n=0;n<this.rows();n++){t[n]=[];for(var r=0;r<e.cols();r++){for(var o=0,i=0;i<this.cols();i++)o+=this.elements[n][i]*e.elements[i][r];t[n][r]=o}}return new Matrix(t)},e.exports.Matrix=Matrix},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StatsTests=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(113),i=n(1),a=n(304),s=n(294),l=n(276);t.StatsTests=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,null,[{key:"KwTest",value:function(e,t,n,r){for(var a=[],s=0;s<e.length;++s){var l={expression:e[s],group:0,rank:1,tiedBlock:!1};a.push(l)}for(var c=0;c<t.length;++c){var A={expression:t[c],group:1,rank:1,tiedBlock:!1};a.push(A)}var u=a.length;a=a.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1});for(var h=!1,d=[],f=0;f<u;++f)a[f].rank=f+1,f>0&&a[f-1].expression===a[f].expression&&(a[f].tiedBlock=!0,h=!0),f<u-1&&a[f+1].expression===a[f].expression&&(a[f].tiedBlock=!0,h=!0),d.push(a[f]);for(var p=[],g=0,m=0;m<u;++m)a[m].tiedBlock?g+=1:0!==g&&(p.push(g),g=0);var v=Math.max.apply(Math,p);if(h){for(var y=0,b=[];y<Math.min(n,Math.max(1,2*v));){(0,i.shuff)(a),a=a.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1});for(var I=[],x=0;x<u;++x)a[x].rank=x+1,I.push(a[x]);for(var w=[0,0],C=0;C<u;++C)w[I[C].group]+=I[C].rank;var E=12/(u*(u+1))*(Math.pow(w[0],2)/e.length+Math.pow(w[1],2)/t.length)-3*(u+1);if(0!==E){var S=.5*E/1,M=(0,o.chiCdf)(S,r);if(Math.pow(10,-M)>.5)return M;b.push(M)}y+=1}return Math.min.apply(Math,b)}for(var k=[0,0],B=0;B<u;++B)k[d[B].group]+=d[B].rank;var D=12/(u*(u+1))*(Math.pow(k[0],2)/e.length+Math.pow(k[1],2)/t.length)-3*(u+1);if(0===D)return 0;var P=.5*D;return(0,o.chiCdf)(P,r)}},{key:"KsTest",value:function(e,t,n,r){var o=new a.Nonparametric.kolmogorovSmirnov(new a.Vector(e),new a.Vector(t));return-Math.log10(o.p)}},{key:"rbeta",value:function(e,t,n){var r=l.incBeta(e,t,n),o=l.logBeta(t,n);return Math.exp(Math.log(r)-o)}},{key:"TTest",value:function(t,n,r,o){var i=s(t,n,{varEqual:!0}),a=Math.abs(i.testValue()),l=i.freedom(),c=e.rbeta(l/(Math.pow(a,2)+l),l/2,.5);return-Math.log10(c)}},{key:"randint",value:function(e,t){return Math.floor(Math.random()*(t-e+1))+e}},{key:"cdfSync",value:function(t,n,r,o){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=t,s=n,l=r,c=o,A=s*(l/c),u=e._cdfSyncEasyCases(a,s,l,c,i);if(null!==u)return u;if(a<=A){var h=e.lnh0(s,l,c);return e._cdfSyncHardCase(h,a,n,r,o,i)}var d=e.lnhMax(s,l,c);return e._cdfSyncHardCase(d,a,n,r,o,i)}},{key:"_cdfSyncEasyCases",value:function(e,t,n,r,o){return 0===r||0===n||0===t?e>=0?o?1:0:o?0:1:r===n?e>=t?o?1:0:o?0:1:r===t?e>=n?o?1:0:o?0:1:e>=n||e>=t?o?1:0:e<0||e<t+n-r?o?0:1:null}},{key:"_cdfSyncHardCase",value:function(e,t,n,r,o,i){var a=0,s=e;if(t<=n*(r/o)){for(var l=0;l<=t;l++)a+=Math.exp(s),s=Math.log((r-l)*(n-l)/((l+1)*(o-r-n+l+1)))+s;return i?a:1-a}for(var c=Math.min(n,r);c>t;c--)a+=Math.exp(s),s=Math.log(c*(o-r-n+c)/((r-c+1)*(n-c+1)))+s;return i?1-a:a}},{key:"lnh0",value:function(t,n,r){var o=t,i=n,a=r;return e.lnFactorialFractionEval([a-i,a-o],[a,a-i-o])}},{key:"lnhMax",value:function(t,n,r){var o=t,i=n,a=r,s=Math.min(o,i);return e.lnFactorialFractionEval([i,a-s],[a,i-s])}},{key:"lnFactorialFractionEval",value:function(t,n){var r=e.factorialPrimes(t),o=e.factorialPrimes(n);for(var i in r)i in o&&(r[i]===o[i]?(r[i]=0,o[i]=0):r[i]>=o[i]?(r[i]-=o[i],o[i]=0):(o[i]-=r[i],r[i]=0));var a=0;for(var s in r)for(var l=1;l<=r[s];l++)a+=Math.log(+s);for(var c in o)for(var A=1;A<=o[c];A++)a-=Math.log(+c);return a}},{key:"factorialPrimes",value:function(t){var n={},r=void 0,o=Array.isArray(t)?t:[t],i=!0,a=!1,s=void 0;try{for(var l,c=o[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var A=l.value;for(var u in r=e._factorialPrimes(A))n[u]?n[u]+=r[u]:n[u]=r[u]}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}return n}},{key:"_factorialPrimes",value:function(t){if(0===t||1===t)return{};var n={},r=e.primesLessThanOrEqualTo(t),o=void 0,i=!0,a=!1,s=void 0;try{for(var l,c=r[Symbol.iterator]();!(i=(l=c.next()).done);i=!0)for(var A=l.value,u=1;(o=Math.pow(A,u))<=t;u++){var h=Math.floor(t/o);n[A]?n[A]+=h:n[A]=h}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}return n}},{key:"primesLessThanOrEqualTo",value:function(e){if(1===e)return[1];for(var t=[],n=Math.sqrt(e),r=2;r<=e;r++)t.push(!0);for(var o=2;o<n;o++)if(t[o-2])for(var i=o*o;i<=e;i+=o)t[i-2]=!1;for(var a=[],s=0;s<t.length;s++)t[s]&&a.push(s+2);return a}},{key:"lngamm",value:function(e){var t=0;return t+=1.659470187408462e-7/(e+7),t+=9934937113930748e-21/(e+6),t-=.1385710331296526/(e+5),t+=12.50734324009056/(e+4),t-=176.6150291498386/(e+3),t+=771.3234287757674/(e+2),t-=1259.139216722289/(e+1),t+=676.5203681218835/e,t+=.9999999999995183,Math.log(t)-5.581061466795328-e+(e-.5)*Math.log(e+6.5)}},{key:"lnfact",value:function(t){return t<=1?0:e.lngamm(t+1)}},{key:"lnbico",value:function(t,n){return e.lnfact(t)-e.lnfact(n)-e.lnfact(t-n)}},{key:"exact_nc",value:function(t,n,r,o,i){for(var a=t,s=t+r,l=n+o,c=t+n,A=Math.max(0,c-l),u=Math.min(c,s),h=[],d=A;d<=u;d++)h[d-A]=e.lnbico(s,d)+e.lnbico(l,c-d)+d*Math.log(i);var f=Math.max.apply(Math,h),p=h.map(function(e){return Math.exp(e-f)}).reduce(function(e,t){return e+t},0);p=Math.log(p);for(var g=0,m=a;m<=u;m++)g+=Math.exp(h[m-A]-f);return g=Math.log(g),Math.exp(g-p)}},{key:"fisherExactNonCentered",value:function(t,n){return e.exact_nc(t[0][0],t[0][1],t[1][0],t[1][1],n)}}]),e}()},function(e,t,n){"use strict";var r=n(11);t.name="algorithm05",t.factory=function(e,t,o,i){var a=o(n(25)),s=e.SparseMatrix;return function(e,t,n){var o=e._values,l=e._index,c=e._ptr,A=e._size,u=e._datatype,h=t._values,d=t._index,f=t._ptr,p=t._size,g=t._datatype;if(A.length!==p.length)throw new r(A.length,p.length);if(A[0]!==p[0]||A[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+A+") must match Matrix B ("+p+")");var m,v=A[0],y=A[1],b=a,I=0,x=n;"string"==typeof u&&u===g&&(m=u,b=i.find(a,[m,m]),I=i.convert(0,m),x=i.find(n,[m,m]));var w,C,E,S,M=o&&h?[]:void 0,k=[],B=[],D=new s({values:M,index:k,ptr:B,size:[v,y],datatype:m}),P=M?[]:void 0,Q=M?[]:void 0,T=[],G=[];for(C=0;C<y;C++){B[C]=k.length;var R=C+1;for(E=c[C],S=c[C+1];E<S;E++)w=l[E],k.push(w),T[w]=R,P&&(P[w]=o[E]);for(E=f[C],S=f[C+1];E<S;E++)T[w=d[E]]!==R&&k.push(w),G[w]=R,Q&&(Q[w]=h[E]);if(M)for(E=B[C];E<k.length;){var _=T[w=k[E]],V=G[w];if(_===R||V===R){var N=x(_===R?P[w]:I,V===R?Q[w]:I);b(N,I)?k.splice(E,1):(M.push(N),E++)}}}return B[y]=k.length,D}}},function(e,t,n){"use strict";var r=n(6).nearlyEqual,o=n(40);t.name="compare",t.factory=function(e,t,i,a){var s=i(n(15)),l=i(n(39)),c=i(n(106)),A=i(n(53)),u=i(n(30)),h=i(n(24)),d=a("compare",{"boolean, boolean":function(e,t){return e===t?0:e>t?1:-1},"number, number":function(e,n){return e===n||r(e,n,t.epsilon)?0:e>n?1:-1},"BigNumber, BigNumber":function(n,r){return n.eq(r)||o(n,r,t.epsilon)?new e.BigNumber(0):new e.BigNumber(n.cmp(r))},"Fraction, Fraction":function(t,n){return new e.Fraction(t.compare(n))},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return d(e.value,t.value)},"string, string":function(e,t){return e===t?0:e>t?1:-1},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,d);break;default:n=l(t,e,d,!0)}break;default:switch(t.storage()){case"sparse":n=l(e,t,d,!1);break;default:n=u(e,t,d)}}return n},"Array, Array":function(e,t){return d(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return d(s(e),t)},"Matrix, Array":function(e,t){return d(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=A(e,t,d,!1);break;default:n=h(e,t,d,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=A(t,e,d,!0);break;default:n=h(t,e,d,!0)}return n},"Array, any":function(e,t){return h(s(e),t,d,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,d,!0).valueOf()}});return d.toTex=void 0,d}},function(e,t,n){"use strict";t.name="algorithm10",t.factory=function(e,t,n,r){var o=e.DenseMatrix;return function(e,t,n,i){var a=e._values,s=e._index,l=e._ptr,c=e._size,A=e._datatype;if(!a)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u,h=c[0],d=c[1],f=n;"string"==typeof A&&(u=A,t=r.convert(t,u),f=r.find(n,[u,u]));for(var p=[],g=new o({data:p,size:[h,d],datatype:u}),m=[],v=[],y=0;y<d;y++){for(var b=y+1,I=l[y],x=l[y+1],w=I;w<x;w++){var C=s[w];m[C]=a[w],v[C]=b}for(var E=0;E<h;E++)0===y&&(p[E]=[]),v[E]===b?p[E][y]=i?f(t,m[E]):f(m[E],t):p[E][y]=t}return g}}},function(e,t,n){"use strict";var r=n(11);t.name="algorithm01",t.factory=function(e,t,n,o){var i=e.DenseMatrix;return function(e,t,n,a){var s=e._data,l=e._size,c=e._datatype,A=t._values,u=t._index,h=t._ptr,d=t._size,f=t._datatype;if(l.length!==d.length)throw new r(l.length,d.length);if(l[0]!==d[0]||l[1]!==d[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+d+")");if(!A)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var p,g,m=l[0],v=l[1],y="string"==typeof c&&c===f?c:void 0,b=y?o.find(n,[y,y]):n,I=[];for(p=0;p<m;p++)I[p]=[];var x=[],w=[];for(g=0;g<v;g++){for(var C=g+1,E=h[g],S=h[g+1],M=E;M<S;M++)x[p=u[M]]=a?b(A[M],s[p][g]):b(s[p][g],A[M]),w[p]=C;for(p=0;p<m;p++)w[p]===C?I[p][g]=x[p]:I[p][g]=s[p][g]}return new i({data:I,size:[m,v],datatype:y})}}},function(e,t,n){"use strict";var r=n(7).extend;t.name="add",t.factory=function(e,t,o,i){var a=o(n(15)),s=o(n(41)),l=n(17),c=o(n(109)),A=o(n(310)),u=o(n(108)),h=o(n(30)),d=o(n(24)),f=i("add",r({"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=A(e,t,s);break;default:n=c(t,e,s,!0)}break;default:switch(t.storage()){case"sparse":n=c(e,t,s,!1);break;default:n=h(e,t,s)}}return n},"Array, Array":function(e,t){return f(a(e),a(t)).valueOf()},"Array, Matrix":function(e,t){return f(a(e),t)},"Matrix, Array":function(e,t){return f(e,a(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=u(e,t,s,!1);break;default:n=d(e,t,s,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=u(t,e,s,!0);break;default:n=d(t,e,s,!0)}return n},"Array, any":function(e,t){return d(a(e),t,s,!1).valueOf()},"any, Array":function(e,t){return d(a(t),e,s,!0).valueOf()},"any, any":s,"Array | Matrix | any, Array | Matrix | any, ...any":function(e,t,n){for(var r=f(e,t),o=0;o<n.length;o++)r=f(r,n[o]);return r}},s.signatures));return f.toTex={2:"\\left(${args[0]}"+l.operators.add+"${args[1]}\\right)"},f}},function(e,t,n){"use strict";t.type=function(e){var t=typeof e;return"object"===t?null===e?"null":Array.isArray(e)?"Array":e instanceof Date?"Date":e instanceof RegExp?"RegExp":e instanceof Boolean?"boolean":e instanceof Number?"number":e instanceof String?"string":"Object":"function"===t?"Function":t}},function(e,t,n){var r=n(321);t.mixin=function(e){var t=new r;return e.on=t.on.bind(t),e.off=t.off.bind(t),e.once=t.once.bind(t),e.emit=t.emit.bind(t),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.trimeanFc=function(e,t){var n=i.quantileSeq(e,[.25,.5,.75]),r=i.quantileSeq(t,[.25,.5,.75]),o=(n[0]+2*n[1]+n[2])/4,a=(r[0]+2*r[1]+r[2])/4;return Math.log2(o)-Math.log2(a)},t.meanFc=function(e,t){var n=e.reduce(function(e,t){return e+t})/e.length,r=t.reduce(function(e,t){return e+t})/t.length;return Math.log2(n)-Math.log2(r)},t.pearsonCorrelation=a,t.spearmanCorrelation=function(e,t,n){for(var o=[],i=0;i<e.length;++i){var s={expression:e[i].expression,donorIndex:e[i].donorIndex,rank:1,tiedBlock:!1};o.push(s)}for(var l=[],c=0;c<t.length;++c){var A={expression:t[c].expression,donorIndex:t[c].donorIndex,rank:1,tiedBlock:!1};l.push(A)}o=o.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1}),l=l.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1});for(var u=!1,h=0;h<o.length;++h)o[h].rank=h+1,h>0&&o[h-1].expression===o[h].expression&&(o[h].tiedBlock=!0,u=!0),h<o.length-1&&o[h+1].expression===o[h].expression&&(o[h].tiedBlock=!0,u=!0);for(var d=0;d<l.length;++d)l[d].rank=d+1,d>0&&l[d-1].expression===l[d].expression&&(l[d].tiedBlock=!0,u=!0),d<l.length-1&&l[d+1].expression===l[d].expression&&(l[d].tiedBlock=!0,u=!0);for(var f=[],p=0,g=0;g<o.length;++g)o[g].tiedBlock?p+=1:0!==p&&(f.push(p),p=0);for(var m=[],v=0,y=0;y<l.length;++y)l[y].tiedBlock?v+=1:0!==v&&(m.push(v),v=0);if(u){for(var b=Math.max(Math.max.apply(Math,f),Math.max.apply(Math,m)),I=0,x=[];I<Math.min(n,Math.max(1,2*b));){(0,r.shuff)(o),o=o.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1}),(0,r.shuff)(l),l=l.sort(function(e,t){return e.expression<t.expression?-1:e.expression>t.expression?1:-1});for(var w=0;w<o.length;++w)o[w].rank=w+1;for(var C=0;C<o.length;++C)l[C].rank=C+1;x.push(a(o,l,"rank")),I+=1}return(x=x.sort(function(e,t){return Math.pow(e,2)<Math.pow(t,2)?-1:Math.pow(e,2)>Math.pow(t,2)?1:-1}))[x.length-1]}return a(o,l,"rank")},t.chiCdf=function(e,t){var n=0,r=1,i=1,a=e,s=0,l=0,c=0;for(Number.MAX_VALUE;c<t&&!(Math.abs((i-s)/i)<1e-6);)s=i,i=e*(n=i+((l+=1)-e)*n)+l*i,n/=a=e*(r=a+(l-e)*r)+l*a,r/=a,i/=a,a=1,c+=1;return Math.max(0,-(.5*Math.log(e)-e-o(.5)+Math.log(i)))};var r=n(1),o=n(325).log,i=n(18).create();function a(e,t,n){for(var r=e.sort(function(e,t){return e.donorIndex<t.donorIndex?-1:e.donorIndex>t.donorIndex?1:-1}),o=t.sort(function(e,t){return e.donorIndex<t.donorIndex?-1:e.donorIndex>t.donorIndex?1:-1}),i=e.length,a=[],s=[],l=[],c=0;c<i;c++)a.push(r[c][n]*o[c][n]),s.push(r[c][n]*r[c][n]),l.push(o[c][n]*o[c][n]);for(var A=0,u=0,h=0,d=0,f=0,p=0;p<i;p++)A+=r[p][n],u+=o[p][n],h+=a[p],d+=s[p],f+=l[p];var g=i*h-A*u,m=i*d-A*A,v=i*f-u*u,y=Math.sqrt(m*v);return Math.min(.99,g/y)}i.import(n(59)),i.import(n(57))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.SingleDonorVariantContribution=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.donorIndex=t,this.variantType=n,this.compressedVariantTypes=[n],this.phenotypeExpression=r,this.donorIndexOnPlot=null,this.targetCoOccupancy=null,this.orderInLoc=0,this.stroke=null,this.fill=null,this.cx=null,this.cy=null,this.outerRadius=null,this.startAngle=0,this.endAngle=2*Math.PI,this.uniqueLoc=-1}return r(e,[{key:"hoverText",value:function(e,t){var n=this.compressedVariantTypes.filter(function(e){return e<57}).map(function(t){return e.variantTypes[t].variantType});return t.metadata[this.donorIndex].donor+(n.length>0?":":"")+" "+n.join(",")}},{key:"calculatePlottingParameters",value:function(e,t,n,r){this.uniqueLoc=e.uniqueLoc,this.fill=e.colourId,this.stroke=this.fill,this.cx=n(this.donorIndexOnPlot),this.cy=r(this.phenotypeExpression),this.outerRadius=t,0===e.locationInPhenotypePlots||(1===e.locationInPhenotypePlots?2===this.targetCoOccupancy&&(8===this.variantType||44===this.variantType||45===this.variantType||46===this.variantType||47===this.variantType?this.endAngle=Math.PI:16!==this.variantType&&17!==this.variantType&&18!==this.variantType&&19!==this.variantType||(this.startAngle=Math.PI)):2===e.locationInPhenotypePlots?1===this.targetCoOccupancy?this.outerRadius=.5*t:2===this.targetCoOccupancy?(this.outerRadius=t*(1-1/Math.sqrt(2)),0===this.orderInLoc?this.cy-=.5*t*Math.sqrt(2):this.cy+=.5*t*Math.sqrt(2)):3===this.targetCoOccupancy?(this.outerRadius=t*(1-1/Math.sqrt(2)),0===this.orderInLoc?this.cy-=.5*t*Math.sqrt(2):1===this.orderInLoc?(this.cx-=.5*t,this.cy+=.5*t):(this.cx+=.5*t,this.cy+=.5*t)):4===this.targetCoOccupancy&&(this.outerRadius=t*(1-1/Math.sqrt(2)),0===this.orderInLoc?(this.cx-=.5*t,this.cy-=.5*t):1===this.orderInLoc?(this.cx+=.5*t,this.cy-=.5*t):2===this.orderInLoc?(this.cx-=.5*t,this.cy+=.5*t):(this.cx+=.5*t,this.cy+=.5*t)):3===e.locationInPhenotypePlots?1===this.targetCoOccupancy?(this.outerRadius=.5*t,this.cx+=t+this.outerRadius):2===this.targetCoOccupancy&&(this.outerRadius=.25*t,this.cx+=t+this.outerRadius,0===this.orderInLoc?this.cy-=this.outerRadius:1===this.orderInLoc&&(this.cy+=this.outerRadius)):4===e.locationInPhenotypePlots?(this.outerRadius=.5*t,this.cy+=t+this.outerRadius,1===this.targetCoOccupancy||2===this.targetCoOccupancy&&(0===this.orderInLoc||1===this.orderInLoc&&(this.outerRadius=.5*t*.5))):5===e.locationInPhenotypePlots?1===this.targetCoOccupancy?(this.outerRadius=.5*t,this.cx-=t+this.outerRadius):2===this.targetCoOccupancy&&(this.outerRadius=.25*t,this.cx-=t+this.outerRadius,0===this.orderInLoc?this.cy-=this.outerRadius:1===this.orderInLoc&&(this.cy+=this.outerRadius)):6===e.locationInPhenotypePlots&&(this.outerRadius=.5*t,this.cy-=t+this.outerRadius))}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SinglePhenotypeExpression=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),i=n(13),a=n(114),s=n(117),l=n(1);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.SinglePhenotypeExpression=function(){function t(n,r,o,a,l,A,u,h,d,f,p,g,m){var v=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,y=this,b=arguments.length>14&&void 0!==arguments[14]?arguments[14]:null,I=arguments.length>15&&void 0!==arguments[15]?arguments[15]:1;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=n,this.references=r,this.cohortMetadata=o,this.selectionManager=a,this.fontManager=m,this.volcanoMode=l,this.svMaxTadOffset=d,this.offIndelMaxTadOffset=f,this.blacklistedVariantTypes=new Set,this.currentRelevantVariants=[],this.currentRelevantVariantDescriptionRoot="",this.currentRelevantVariantIndex=0,this.plotSupportGroup=null,this.determineBlacklistedVariants(),this.bioId=u,this.bioId2=h,this.geneIds=[u],this.geneIds2=[h],this.expressionPhenotype=A,this.circleClassNameAnchor=this.expressionPhenotype+"ExpressionCirclesAnchor",this.circleClassNameTarget=this.expressionPhenotype+"ExpressionCirclesTarget",this.circleGroupNameAnchor=this.expressionPhenotype+"CircleGroupAnchor",this.circleGroupNameTarget=this.expressionPhenotype+"CircleGroupTarget",this.plotSupportGroupName=this.expressionPhenotype+"PlotSupportGroup",this.expressionFrame=this.expressionPhenotype+"ExpressionFrame",this.targetLocationID=this.expressionPhenotype+"ExpressionContent",this.group1Index=p,this.group2Index=g,this.uniqueGroup1Donors=new Set([].concat(c(this.selectionManager.registeredSubcohorts.get(this.group1Index))).filter(function(e){return!y.selectionManager.registeredSubcohorts.get(y.group2Index).has(e)})),this.uniqueGroup2Donors=new Set([].concat(c(this.selectionManager.registeredSubcohorts.get(this.group2Index))).filter(function(e){return!y.selectionManager.registeredSubcohorts.get(y.group1Index).has(e)})),0===this.uniqueGroup1Donors.size&&0!==this.uniqueGroup2Donors.size?this.uniqueGroup1Donors=this.selectionManager.registeredSubcohorts.get(this.group1Index):0!==this.uniqueGroup1Donors.size&&0===this.uniqueGroup2Donors.size&&(this.uniqueGroup2Donors=this.selectionManager.registeredSubcohorts.get(this.group2Index)),"rppa"===this.expressionPhenotype&&(this.geneIds=this.references.rppaAntibodies[u].geneIds,null!==h&&(this.geneIds2=this.references.rppaAntibodies[h].geneIds)),this.numDonors=this.cohortMetadata[this.expressionPhenotype+"ExpressionAvailable"],this.magFactor=1.25,this.numDonors>100?this.magFactor=.5:this.numDonors>50&&(this.magFactor=.75),this.magFactor*=I,this.baseRadius=7.25*this.magFactor,this.tracerStroke=3*this.magFactor,this.currentWidth=e("#mainSide").width(),this.viewBoxChunks=[.1*-this.currentWidth,5e-5*-this.currentWidth,1.2*this.currentWidth,1.2*this.currentWidth],this.svgSize="100%",this.svg=null,this.targetWidth=null,this.xScale=null,this.yScale=null,this.yScale2=null,this.volcanoMode&&this.volcanoModeDefinitions(),this.viewBox=this.viewBoxChunks.map(function(e){return e.toString()}).join(" "),e("#"+this.targetLocationID).empty(),this.maxExpression=0,this.minExpression=1e10,this.maxExpression2=0,this.minExpression2=1e10,this.expressions=new Map,this.expressions2=new Map,this.variantExistence=new Map,this.variantExistence2=new Map,this.singleDonorVariantContributions=[],this.singleDonorVariantContributionsBg=[],this.singleDonorVariantContributions2=[],this.sortingHelperMapper=new Map,this.xAxisHelper=[],this.variantFetcher=null,this.variantFetcher2=null;var x=(0,i.queue)();v||-1===u?-1===u?(this.singleDonorVariantContributions=this.generateContributionObjects(null,null,!1,!0),this.singleDonorVariantContributions.forEach(function(e){e.phenotypeExpression>y.maxExpression&&(y.maxExpression=e.phenotypeExpression),e.phenotypeExpression<y.minExpression&&(y.minExpression=e.phenotypeExpression)})):v.forEach(function(e){y.singleDonorVariantContributions.push(e),e.phenotypeExpression>y.maxExpression&&(y.maxExpression=e.phenotypeExpression),e.phenotypeExpression<y.minExpression&&(y.minExpression=e.phenotypeExpression)}):(x.defer(function(e){y.getExpressionData(!0,e)}),x.defer(function(e){y.getVariantExistenceData(!0,e)})),this.volcanoMode||-1===u||(this.variantFetcher=new s.VariantFetcher(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.geneIds),x.defer(function(e){y.variantFetcher.getVariantDataForPhenotypePlotsFromGeneId(y.svMaxTadOffset,y.offIndelMaxTadOffset,e)})),null!==h&&(b||-1===h?-1===h?(this.singleDonorVariantContributions2=this.generateContributionObjects(null,null,!0,!0),this.singleDonorVariantContributions2.forEach(function(e){e.phenotypeExpression>y.maxExpression2&&(y.maxExpression2=e.phenotypeExpression),e.phenotypeExpression<y.minExpression2&&(y.minExpression2=e.phenotypeExpression)})):b.forEach(function(e){y.singleDonorVariantContributions2.push(e),e.phenotypeExpression>y.maxExpression2&&(y.maxExpression2=e.phenotypeExpression),e.phenotypeExpression<y.minExpression2&&(y.minExpression2=e.phenotypeExpression)}):(x.defer(function(e){y.getExpressionData(!1,e)}),x.defer(function(e){y.getVariantExistenceData(!1,e)})),this.volcanoMode||-1===h||(this.variantFetcher2=new s.VariantFetcher(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.geneIds2),x.defer(function(e){y.variantFetcher2.getVariantDataForPhenotypePlotsFromGeneId(y.svMaxTadOffset,y.offIndelMaxTadOffset,e)})));var w=this;x.awaitAll(function(e){if(w.preparePlot(),!v&&-1!==u){if(0===w.expressions.size)return;if(null!==h&&0===w.expressions2.size)return;w.singleDonorVariantContributions=w.generateContributionObjects(w.expressions,w.variantExistence,!1,null===u)}for(var t=0;t<w.singleDonorVariantContributions.length;++t)w.singleDonorVariantContributions[t].calculatePlottingParameters(w.references.variantTypes[w.singleDonorVariantContributions[t].variantType],w.baseRadius,w.xScale,w.yScale);if(null!==h){b||-1===h||(w.singleDonorVariantContributions2=w.generateContributionObjects(w.expressions2,w.variantExistence2,!0,null===h));for(var n=0;n<w.singleDonorVariantContributions2.length;++n)w.singleDonorVariantContributions2[n].calculatePlottingParameters(w.references.variantTypes[w.singleDonorVariantContributions2[n].variantType],w.baseRadius,w.xScale,w.yScale2)}w.drawPlotSupporters(),w.plotSingleExpression()})}return r(t,[{key:"convertToFullMode",value:function(){this.references.currentCohort.singlePhenotypePlotManager.reset(),this.references.currentCohort.singlePhenotypePlotManager.setGroup1(this.group1Index),this.references.currentCohort.singlePhenotypePlotManager.setGroup2(this.group2Index),this.references.currentCohort.singlePhenotypePlotManager.setSvMaxTadOffset(this.svMaxTadOffset),this.references.currentCohort.singlePhenotypePlotManager.setOffIndelMaxTadOffset(this.offIndelMaxTadOffset),this.references.currentCohort.singlePhenotypePlotManager.setSingleDonorVariantContributions(this.singleDonorVariantContributions),this.references.currentCohort.singlePhenotypePlotManager.setSingleDonorVariantContributions2(this.singleDonorVariantContributions2),e("#phenotypeExpressionContentPane").parent().addClass("active").siblings().removeClass("active"),e("#phenotypeExpressionContent").addClass("active").siblings().removeClass("active"),(0,l.switchElements)(["volcanoControls","selectorControlsCollapseControl","volcanoSpecificGeneSelectorControls","geneSelectorMarkers","cytobandSelectorMarkers","gotoGeneVariants","gotoCytoband","geneSelectorControlsForMarkedGenesVolcanoSpecific","volcanoSpecificCytobandSelectorControls"],["svgDownloader","svDescriptionPaneControl","midSizedSvDescriptionPaneControl","vdjSvDescriptionPaneControl","smallVariantDescriptionPaneControl","selectorControlsCollapseControl","singlePhenotypeExpressionControls","singlePhenotypeViewSpecificCytobandSelectorControls","singlePhenotypeViewSpecificGeneSelectorControls","singlePhenotypeViewSpecificAntibodySelectorControls"]),this.fontManager.setAvailableFontSettings("singlePhenotypeExpression"),e('.nav-tabs a[href="#controlsPane"]').tab("show"),"gene"===this.expressionPhenotype?(this.references.currentCohort.singlePhenotypePlotManager.geneId=this.bioId,this.references.currentCohort.singlePhenotypePlotManager.gene2Id=this.bioId2,this.references.currentCohort.singlePhenotypePlotManager.plotSingleGeneExpression()):"rppa"===this.expressionPhenotype&&(this.references.currentCohort.singlePhenotypePlotManager.rppaId=this.bioId,this.references.currentCohort.singlePhenotypePlotManager.rppa2Id=this.bioId2,this.references.currentCohort.singlePhenotypePlotManager.plotSingleRppaExpression())}},{key:"determineBlacklistedVariants",value:function(){this.blacklistedVariantTypes=new Set([20,21,27,28,49,50,51,55,56,57,58,59]),2===this.svMaxTadOffset?this.blacklistedVariantTypes.add(47):1===this.svMaxTadOffset?(this.blacklistedVariantTypes.add(46),this.blacklistedVariantTypes.add(47)):0===this.svMaxTadOffset?(this.blacklistedVariantTypes.add(45),this.blacklistedVariantTypes.add(46),this.blacklistedVariantTypes.add(47)):-1===this.svMaxTadOffset&&(this.blacklistedVariantTypes.add(44),this.blacklistedVariantTypes.add(45),this.blacklistedVariantTypes.add(46),this.blacklistedVariantTypes.add(47)),2===this.offIndelMaxTadOffset?this.blacklistedVariantTypes.add(19):1===this.offIndelMaxTadOffset?(this.blacklistedVariantTypes.add(18),this.blacklistedVariantTypes.add(19)):0===this.offIndelMaxTadOffset?(this.blacklistedVariantTypes.add(17),this.blacklistedVariantTypes.add(18),this.blacklistedVariantTypes.add(19)):-1===this.offIndelMaxTadOffset&&(this.blacklistedVariantTypes.add(16),this.blacklistedVariantTypes.add(17),this.blacklistedVariantTypes.add(18),this.blacklistedVariantTypes.add(19))}},{key:"volcanoModeDefinitions",value:function(){this.expressionFrame=this.expressionFrame+"Volcano",this.circleClassNameAnchor=this.circleClassNameAnchor+"Volcano",this.circleClassNameTarget=this.circleClassNameTarget+"Volcano",this.circleGroupNameAnchor=this.circleGroupNameAnchor+"Volcano",this.circleGroupNameTarget=this.circleGroupNameTarget+"Volcano",this.plotSupportGroupName=this.plotSupportGroupName+"Volcano",this.targetLocationID=this.targetLocationID+"Volcano",this.currentWidth=e("#rightSide").width(),this.viewBoxChunks=[.04*-this.currentWidth,.03*-this.currentWidth,.93*this.currentWidth,1.1*this.currentWidth],this.baseRadius=.4*this.baseRadius,this.tracerStroke=.4*this.tracerStroke}},{key:"getExpressionData",value:function(t,n){var r=this,o=this.expressionPhenotype;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:r.expressionPhenotype+"Expressions",columnsToSelect:"*",keyColumn:o,keysToSearchRaw:t?r.bioId:r.bioId2},error:function(e){console.error(e)},success:function(e){if(e.length>0){var i=e[0];t?Object.keys(i).forEach(function(e,t){if(e!==o&&"varianceRank"!==e){var n=parseInt(e),a=+i[e];r.expressions.set(n,a),a>r.maxExpression&&(r.maxExpression=a),a<r.minExpression&&(r.minExpression=a)}}):Object.keys(i).forEach(function(e,t){if(e!==o&&"varianceRank"!==e){var n=parseInt(e),a=+i[e];r.expressions2.set(n,a),a>r.maxExpression2&&(r.maxExpression2=a),a<r.minExpression2&&(r.minExpression2=a)}})}n()}})}},{key:"getVariantExistenceData",value:function(t,n){var r=this;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:"geneRecurrence",columnsToSelect:"*",keyColumn:"Gene",keysToSearchRaw:t?r.geneIds.join(","):r.geneIds2.join(",")},error:function(e){console.error(e)},success:function(e){e.forEach(function(e){t?Object.keys(e).forEach(function(t,n){if("Gene"!==t){var o=parseInt(t);r.blacklistedVariantTypes.has(o)||""!==e[t]&&e[t].split(",").map(function(e){return parseInt(e)}).forEach(function(e){r.variantExistence.has(e)||r.variantExistence.set(e,[]),r.variantExistence.get(e).push(o)})}}):Object.keys(e).forEach(function(t,n){if("Gene"!==t){var o=parseInt(t);r.blacklistedVariantTypes.has(o)||""!==e[t]&&e[t].split(",").map(function(e){return parseInt(e)}).forEach(function(e){r.variantExistence2.has(e)||r.variantExistence2.set(e,[]),r.variantExistence2.get(e).push(o)})}})}),n()}})}},{key:"generateContributionObjects",value:function(e,t,n,r){var o=this,i=[],s=[];if(r){var l=this.references.genes.get(-1).expressions;if(0===l.size)return;l.forEach(function(e,t,n){s.push([e,t])}),i=this.references.genes.get(-1).singleDonorVariantContributions}else{if(0===e.size)return;e.forEach(function(e,n,r){s.push([e,n]),o.cohortMetadata.anyVariantAvailableDonors.has(n)?(t.has(n)&&t.get(n).forEach(function(t){i.push(new a.SingleDonorVariantContribution(n,t,e))}),i.push(new a.SingleDonorVariantContribution(n,63,e))):i.push(new a.SingleDonorVariantContribution(n,62,e))})}if(!n){s=s.sort(function(e,t){return e[0]<t[0]?-1:e[0]>t[0]?1:e[1]<t[1]?-1:e[1]>t[1]?1:-1});for(var c=0;c<s.length;++c)this.sortingHelperMapper.set(s[c][1],c)}for(var A=0;A<i.length;++A)i[A].donorIndexOnPlot=this.sortingHelperMapper.get(i[A].donorIndex)+1;for(var u=[],h=new Set,d=0;d<i.length;++d){var f=i[d].donorIndexOnPlot-1;h.has(f)||(u[f]=new Map,h.add(f));var p=this.references.variantTypes[i[d].variantType].locationInPhenotypePlots;u[f].has(p)||u[f].set(p,[]),u[f].get(p).push(i[d])}for(var g=[],m=0;m<u.length;++m){if(g.push(new Map),u[m].has(1)){for(var v=u[m].get(1),y=!1,b=0;b<v.length;++b)if(8===v[b].variantType){y=!0;break}if(y){for(var I=[],x=0;x<v.length;++x)44!==v[x].variantType&&45!==v[x].variantType&&46!==v[x].variantType&&47!==v[x].variantType&&I.push(v[x]);g[m].set(1,I)}}if(u[m].has(2)&&u[m].get(2).length>4){for(var w=u[m].get(2),C=[],E=0;E<w.length;++E)5!==this.references.variantTypes[w[E].variantType].uniqueLoc&&C.push(w[E]);g[m].set(2,C)}for(var S=0;S<7;++S)u[m].has(S)&&(g[m].has(S)||g[m].set(S,u[m].get(S)))}for(var M=[],k=function(e){g[e].forEach(function(t,n,r){var i=0;t.forEach(function(e){i+=1});for(var a=new Map,s=0;s<g[e].get(n).length;++s){g[e].get(n)[s].targetCoOccupancy=i;var l=o.references.variantTypes[g[e].get(n)[s].variantType].uniqueLoc;a.has(l)||a.set(l,[]),a.get(l).push(g[e].get(n)[s])}for(var c=Array.from(a.keys()),A=0;A<c.length;++A){if(a.get(c[A]).length>1)for(var u=1;u<a.get(c[A]).length;++u)a.get(c[A])[0].compressedVariantTypes.push(a.get(c[A])[u].variantType);M.push(a.get(c[A])[0])}})},B=0;B<g.length;++B)k(B);var D=this;M.sort(function(e,t){var n=D.references.variantTypes[e.variantType],r=D.references.variantTypes[t.variantType];return e.donorIndexOnPlot<t.donorIndexOnPlot?-1:e.donorIndexOnPlot>t.donorIndexOnPlot?1:n.locationInPhenotypePlots<r.locationInPhenotypePlots?-1:n.locationInPhenotypePlots>r.locationInPhenotypePlots?1:n.variantTypeIndex<r.variantTypeIndex?-1:n.variantTypeIndex>r.variantTypeIndex?1:-1}),i.length=0;for(var P=-1,Q=-1,T=-1,G=-1,R=0;R<M.length;++R){var _=this.references.variantTypes[M[R].variantType];M[R].donorIndexOnPlot!==P&&(P=M[R].donorIndexOnPlot);var V=_.locationInPhenotypePlots;V===Q&&M[R].donorIndexOnPlot===T||(T=M[R].donorIndexOnPlot,G=0,Q=V),M[R].orderInLoc=G,G+=1,i.push(M[R])}return i}},{key:"preparePlot",value:function(){this.targetSvgID=this.targetLocationID+"Svg",this.svg=(0,o.select)("#"+this.targetLocationID).classed("svg-container",!0).append("svg").classed("container-fluid",!0).classed("wrap",!0).classed("svg-content-responsive",!0).attr("viewBox",this.viewBox).attr("id",this.targetSvgID).attr("preserveAspectRatio","none").attr("width",this.svgSize).attr("height",this.svgSize),this.targetWidth=.99*e("#"+this.targetSvgID).width(),this.xScale=(0,o.scaleLinear)().domain([0,this.numDonors]).range([0,.95*this.targetWidth]),this.yScale=(0,o.scaleLinear)().domain([Math.min(0,this.minExpression),Math.min(1.02*this.maxExpression,this.maxExpression+.5)]).range([this.targetWidth,.05*this.targetWidth]),this.yScale2=(0,o.scaleLinear)().domain([Math.min(0,this.minExpression2),Math.min(1.02*this.maxExpression2,this.maxExpression2+.5)]).range([this.targetWidth,.05*this.targetWidth])}},{key:"drawPlotSupporters",value:function(){var t=this;null!==this.plotSupportGroup&&e("#"+this.plotSupportGroupName).remove();var n=Math.abs(this.xScale(this.numDonors+.25)-this.xScale(0));this.plotSupportGroup=this.svg.append("g").attr("id",this.plotSupportGroupName),this.plotSupportGroup.append("rect").attr("x",0).attr("y",0).attr("height",this.targetWidth).attr("width",n).style("stroke","Black").style("fill","none").style("stroke-width",1),0!==this.group1Index&&0!==this.group2Index&&(this.singleDonorVariantContributions.forEach(function(e){var n={};n.donorIndex=e.donorIndex,n.donorIndexOnPlot=e.donorIndexOnPlot,t.singleDonorVariantContributionsBg.push(n)}),this.plotSupportGroup.selectAll("."+this.circleClassNameAnchor+"SelectionBackgrounds").data(this.singleDonorVariantContributionsBg).enter().append("rect").attr("class",this.circleClassNameAnchor+"SelectionBackgrounds").style("stroke","none").style("fill",function(e){return t.uniqueGroup1Donors.has(e.donorIndex)?"#ffe6e6":t.uniqueGroup2Donors.has(e.donorIndex)?"#cce6ff":"none"}).attr("x",function(e){return t.xScale(e.donorIndexOnPlot-.5)}).attr("y","0").attr("width",function(e){return t.xScale(e.donorIndexOnPlot+.5)-t.xScale(e.donorIndexOnPlot-.5)}).attr("height",this.targetWidth));var r=this.fontManager.fontTree.get("singlePhenotypeExpressionFontTargetSelector").get("expressionQuantityLabels").generateFontCssText(),i=this.fontManager.fontTree.get("singlePhenotypeExpressionFontTargetSelector").get("expressionQuantityTitle").generateFontCssText(),a=this.fontManager.fontTree.get("singlePhenotypeExpressionFontTargetSelector").get("donorLabels").generateFontCssText();this.plotSupportGroup.append("g").attr("class","axis axis--y").call((0,o.axisLeft)(this.yScale).tickSize(4)).selectAll("text").attr("y",0).attr("dy",".1em").style("font",r).style("color",null!==this.bioId2?"blue":"black"),null!==this.bioId2&&this.plotSupportGroup.append("g").attr("class","axis axis--y").call((0,o.axisRight)(this.yScale2).tickSize(4)).selectAll("text").attr("y",0).attr("x",this.xScale(this.numDonors+.28)).attr("dy",".1em").style("font",r).style("color","red"),this.volcanoMode||this.plotSupportGroup.append("text").attr("transform","rotate(-90)").attr("y",0-n/20).attr("x",0-n/2).attr("dy","1em").style("text-anchor","middle").style("font",i).text(this.cohortMetadata[this.expressionPhenotype+"ExpressionQuantity"]);var s=-1;this.xAxisHelper.length=0;for(var l=0;l<this.singleDonorVariantContributions.length;++l)this.singleDonorVariantContributions[l].donorIndexOnPlot!==s&&(this.xAxisHelper.push(this.singleDonorVariantContributions[l].donorIndex),s=this.singleDonorVariantContributions[l].donorIndexOnPlot);this.plotSupportGroup.append("g").attr("class","axis axis--x").call((0,o.axisBottom)(this.xScale).tickValues(Array(this.xAxisHelper.length).fill().map(function(e,t){return t+1})).tickFormat(function(e,n){return t.cohortMetadata.metadata[t.xAxisHelper[n]].donor})).attr("transform","translate(0,"+this.targetWidth+")").selectAll("text").attr("y",0).attr("x",15).attr("dy",".05em").attr("transform","rotate(90)").style("text-anchor","start").style("font",a);var c=this.fontManager.fontTree.get("singlePhenotypeExpressionFontTargetSelector").get("title");this.plotSupportGroup.append("rect").attr("x",0).attr("y",0).attr("height",1.01*c.fontSize).attr("width",n).style("stroke","none").style("fill","White");var A=(0,o.path)();A.moveTo(5,2),A.lineTo(n,2),this.plotSupportGroup.append("path").attr("id",this.expressionFrame).attr("d",A),this.plotSupportGroup.append("text").append("textPath").attr("class","markerText").attr("href","#"+this.expressionFrame).attr("id",this.expressionPhenotype+"Title").style("dominant-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("display","inline").style("font",c.generateFontCssText()).html(this.generateHtmlTitle()),this.plotPhenotypeTracers()}},{key:"addOverlays",value:function(){if(this.group1Index!==this.group2Index){this.expressionPhenotype;var e=document.getElementById(""+this.targetSvgID).getBoundingClientRect(),t=document.getElementById(this.expressionPhenotype+"ExpressionContentGroup1Label").getBoundingClientRect(),n=this.plotSupportGroup.append("g");n.append("rect").attr("x",t.x-e.x).attr("y",t.y-e.y).attr("height",t.height).attr("width",t.width).style("stroke","none").style("fill","#ffe6e6");var r=this.fontManager.fontTree.get("singlePhenotypeExpressionFontTargetSelector").get("title").generateFontCssText();n.append("text").text(this.selectionManager.registeredSubcohortNames.get(this.group1Index)).attr("x",t.x-e.x).attr("y",t.y-e.y).attr("dx",t.width/2).attr("dy",t.height/2).attr("text-anchor","middle").attr("dominant-baseline","central").style("font",r);var o=document.getElementById(this.expressionPhenotype+"ExpressionContentGroup2Label").getBoundingClientRect(),i=this.plotSupportGroup.append("g");i.append("rect").attr("x",o.x-e.x).attr("y",o.y-e.y).attr("height",o.height).attr("width",o.width).style("stroke","none").style("fill","#cce6ff"),i.append("text").text(this.selectionManager.registeredSubcohortNames.get(this.group2Index)).attr("x",o.x-e.x).attr("y",o.y-e.y).attr("dx",o.width/2).attr("dy",o.height/2).attr("text-anchor","middle").attr("dominant-baseline","central").style("font",r)}}},{key:"generateHtmlTitle",value:function(){var e=this,t=['<a style="text-decoration:none">'+this.cohortMetadata.cohortName+":</a>"];return"gene"===this.expressionPhenotype?(t.push(this.references.genes.get(this.bioId).getGeneCardsLinkPlain()),null!==this.bioId2&&(t.push('<a fill="blue" style="text-decoration:none">(-)</a>'),t.push("vs"),t.push(this.references.genes.get(this.bioId2).getGeneCardsLinkPlain()),t.push('<a fill="red" style="text-decoration:none">(-)</a>'))):"rppa"===this.expressionPhenotype&&(t.push('<a style="text-decoration:none">'+this.references.rppaAntibodies[this.bioId].rppaName+":</a>("+this.geneIds.map(function(t){return e.references.genes.get(t).getGeneCardsLinkPlain()}).join(",")+")"),null!==this.bioId2&&(t.push('<a fill="blue" style="text-decoration:none">(-)</a>'),t.push("vs"),t.push('<a style="text-decoration:none">'+this.references.rppaAntibodies[this.bioId2].rppaName+":</a>("+this.geneIds.map(function(t){return e.references.genes.get(t).getGeneCardsLinkPlain()}).join(",")+")"),t.push('<a fill="red" style="text-decoration:none">(-)</a>'))),this.group1Index!==this.group2Index&&(t.push('(<a fill="#ffb3b3" id="'+this.expressionPhenotype+'ExpressionContentGroup1Label" style="text-decoration:none">'+this.selectionManager.registeredSubcohortNames.get(this.group1Index)+"</a>)"),t.push('(<a fill="#80c1ff" id="'+this.expressionPhenotype+'ExpressionContentGroup2Label" style="text-decoration:none">'+this.selectionManager.registeredSubcohortNames.get(this.group2Index)+"</a>)")),t.join(" ")}},{key:"generateTextTitle",value:function(){var e=[this.cohortMetadata.cohortName];return"gene"===this.expressionPhenotype?(e.push(this.references.genes.get(this.bioId).geneName),null!==this.bioId2&&(e.push("(BlueLines)"),e.push("vs"),e.push(this.references.genes.get(this.bioId2).geneName),e.push("(RedLines)"))):"rppa"===this.expressionPhenotype&&(e.push(""+this.references.rppaAntibodies[this.bioId].rppaName),null!==this.bioId2&&(e.push("(BlueLines)"),e.push("vs"),e.push(""+this.references.rppaAntibodies[this.bioId2].rppaName),e.push("(RedLines)"))),this.group1Index!==this.group2Index&&e.push("("+this.selectionManager.registeredSubcohortNames.get(this.group1Index)+")-("+this.selectionManager.registeredSubcohortNames.get(this.group2Index)+")"),e.join("_")}},{key:"plotSingleExpression",value:function(){var e=this;this.circleGroupAnchor=this.svg.append("g").attr("id",this.circleGroupNameAnchor),this.circleGroupAnchor.selectAll("."+this.circleClassNameAnchor).data(this.singleDonorVariantContributions).enter().append("path").attr("class",this.circleClassNameAnchor).style("stroke",function(t){return e.references.colours[t.stroke]}).style("fill",function(t){return e.references.colours[t.fill]}).attr("d",function(e){return 62===e.variantType?(0,o.symbol)().type(function(){return o.symbols[1]}).size(function(){return 20*Math.pow(e.outerRadius,2)/9})():(0,o.arc)().innerRadius(0).outerRadius(e.outerRadius).startAngle(e.startAngle).endAngle(e.endAngle)()}).attr("transform",function(e){return 62===e.variantType?"translate("+e.cx+","+e.cy+") rotate(45)":"translate("+e.cx+","+e.cy+")"}).append("svg:title").text(function(t){return t.hoverText(e.references,e.cohortMetadata)}),null!==this.bioId2&&(this.circleGroupTarget=this.svg.append("g").attr("id",this.circleGroupNameTarget),this.circleGroupTarget.selectAll("."+this.circleClassNameTarget).data(this.singleDonorVariantContributions2).enter().append("path").attr("class",this.circleClassNameTarget).style("stroke",function(t){return e.references.colours[t.stroke]}).style("fill",function(t){return e.references.colours[t.fill]}).attr("d",function(e){return(0,o.arc)().innerRadius(0).outerRadius(e.outerRadius).startAngle(e.startAngle).endAngle(e.endAngle)()}).attr("transform",function(e){return"translate("+e.cx+","+e.cy+")"}).append("svg:title").text(function(t){return t.hoverText(e.references,e.cohortMetadata)})),this.volcanoMode||(-1!==this.bioId&&this.circleGroupAnchor.on("click",function(){if(!e.commonSettings.interactionLock){e.commonSettings.fastLock(),e.currentRelevantVariants.length=0;var n=(0,o.select)(o.event.target).datum();62===n.variantType||63===n.variantType?(0,l.clearAnnotations)():(e.currentRelevantVariantDescriptionRoot=t.determineTargetFromUniqueLoc(n.uniqueLoc),""!==e.currentRelevantVariantDescriptionRoot&&(e.variantFetcher.variantsForPhenotypePlots.get(e.bioId).get(n.uniqueLoc).get(n.donorIndex).forEach(function(t){e.currentRelevantVariants.push(t)}),e.currentRelevantVariants.length>0&&e.enableRelevantVariantControls()),e.addTmpDonorTracer(n.donorIndexOnPlot)),e.commonSettings.fastRelease()}}),null!==this.bioId2&&-1!==this.bioId2&&this.circleGroupTarget.on("click",function(){if(!e.commonSettings.interactionLock){e.commonSettings.fastLock(),e.currentRelevantVariants.length=0;var n=(0,o.select)(o.event.target).datum();62===n.variantType||63===n.variantType?(0,l.clearAnnotations)():(e.currentRelevantVariantDescriptionRoot=t.determineTargetFromUniqueLoc(n.uniqueLoc),""!==e.currentRelevantVariantDescriptionRoot&&(e.variantFetcher.variantsForPhenotypePlots.get(e.bioId).get(n.uniqueLoc).get(n.donorIndex).forEach(function(t){e.currentRelevantVariants.push(t)}),e.currentRelevantVariants.length>0&&e.enableRelevantVariantControls()),e.addTmpDonorTracer(n.donorIndexOnPlot)),e.commonSettings.fastRelease()}}))}},{key:"addTmpDonorTracer",value:function(t){var n=e("#tmpDonorTracer");n.remove(),this.plotSupportGroup.append("rect").style("stroke",this.references.colours[14]).style("fill","none").attr("id","tmpDonorTracer").attr("x",this.xScale(t-.5)).attr("y","0").attr("width",this.xScale(t+.5)-this.xScale(t-.5)).attr("height",this.targetWidth),(n=e("#tmpDonorTracer")).on("click",function(){n.remove()}),n.on("contextmenu",function(){o.event.preventDefault(),n.remove()})}},{key:"enableRelevantVariantControls",value:function(){var t=this;this.currentRelevantVariantIndex=0,e("#"+this.currentRelevantVariantDescriptionRoot+"SweepLeft").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),t.sweepLeft(),t.commonSettings.releaseLock())}),e("#"+this.currentRelevantVariantDescriptionRoot+"SweepRight").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),t.sweepRight(),t.commonSettings.releaseLock())}),e("#"+this.currentRelevantVariantDescriptionRoot+"DescriptionPaneControl").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),t.goToEntry(t.currentRelevantVariantIndex),t.commonSettings.releaseLock())}),this.goToEntry(this.currentRelevantVariantIndex)}},{key:"sweepLeft",value:function(){0!==this.currentRelevantVariantIndex?this.currentRelevantVariantIndex-=1:this.currentRelevantVariantIndex=this.currentRelevantVariants.length-1,this.goToEntry(this.currentRelevantVariantIndex)}},{key:"sweepRight",value:function(){this.currentRelevantVariantIndex!==this.currentRelevantVariants.length-1?this.currentRelevantVariantIndex+=1:this.currentRelevantVariantIndex=0,this.goToEntry(this.currentRelevantVariantIndex)}},{key:"goToEntry",value:function(t){this.currentRelevantVariantIndex=t;var n=this.currentRelevantVariants[this.currentRelevantVariantIndex].annotate(this.references,this.cohortMetadata);e("#"+this.currentRelevantVariantDescriptionRoot+"DescriptionPaneControl").css("display","inline"),e("#"+this.currentRelevantVariantDescriptionRoot+"Description").html(n),e("#"+this.currentRelevantVariantDescriptionRoot+"Counter").html(this.currentRelevantVariantIndex+1+"/"+this.currentRelevantVariants.length),e('.nav-tabs a[href="#'+this.currentRelevantVariantDescriptionRoot+'DescriptionPane"]').tab("show")}},{key:"plotPhenotypeTracers",value:function(){if(null!==this.bioId2&&this.bioId!==this.bioId2){for(var e=[],t=0;t<this.singleDonorVariantContributions.length;++t)62!==this.singleDonorVariantContributions[t].variantType&&63!==this.singleDonorVariantContributions[t].variantType&&8!==this.singleDonorVariantContributions[t].variantType||e.push({x:this.singleDonorVariantContributions[t].cx,y:this.singleDonorVariantContributions[t].cy});e=e.sort(function(e,t){return e.x<t.x?-1:1});for(var n=[],r=0;r<this.singleDonorVariantContributions2.length;++r)62!==this.singleDonorVariantContributions2[r].variantType&&63!==this.singleDonorVariantContributions2[r].variantType&&8!==this.singleDonorVariantContributions2[r].variantType||n.push({x:this.singleDonorVariantContributions2[r].cx,y:this.singleDonorVariantContributions2[r].cy});n=n.sort(function(e,t){return e.x<t.x?-1:1});var i=(0,o.line)().x(function(e){return e.x}).y(function(e){return e.y});this.plotSupportGroup.datum(e).append("path").style("fill","none").style("stroke","blue").style("stroke-width",this.tracerStroke).attr("d",i),this.plotSupportGroup.datum(n).append("path").style("fill","none").style("stroke","red").style("stroke-width",this.tracerStroke).attr("d",i)}}},{key:"savePhenotypeSvg",value:function(){(0,l.saveSvg)(this.targetSvgID,this.generateTextTitle()+"_"+this.expressionPhenotype+"Expression.svg")}}],[{key:"determineTargetFromUniqueLoc",value:function(e){return 8===e?"smallVariant":13===e?"smallVariant":1===e?"sv":9===e?"smallVariant":3===e?"smallVariant":2===e?"smallVariant":13===e?"smallVariant":4===e?"smallVariant":6===e?"smallVariant":5===e?"smallVariant":7===e?"smallVariant":6===e?"smallVariant":14===e?"smallVariant":""}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.VariantEntrySnv=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t.VariantEntrySnv=function(){function t(e,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.snvIndex=parseInt(e.snvIndex),"CENSORED"!==e.pos&&(this.startChrIndex=parseInt(e.chrIndex),this.endChrIndex=this.startChrIndex,this.startPos=parseInt(e.pos),this.endPos=this.startPos,this.ref=e.ref,this.alt=e.alt),"."!==e.gene&&(this.geneIds=[],e.gene.split(",").forEach(function(e){var t=parseInt(e);n.genes.has(t)&&r.geneIds.push(t)})),this.clonality=1,this.eventTypeIndex=parseInt(e.smallVarType),this.eventTypeVizIndex=n.variantTypes[this.eventTypeIndex].variantVizTypeIndex,this.donorIndex=parseInt(e.donor)}return r(t,[{key:"getIndex",value:function(){return this.snvIndex}},{key:"setIndex",value:function(e){this.snvIndex=e}},{key:"clickListener",value:function(t,n){e("#smallVariantDescriptionPaneControl").css("display","inline"),e("#smallVariantDescription").html(this.annotate(t,n))}},{key:"annotate",value:function(e,t){var n="This is a "+this.ref+">"+this.alt+" "+e.variantTypes[this.eventTypeIndex].variantType+" in donor "+t.metadata[this.donorIndex].donor,r=""+(0,o.getGenomeBrowserLink)(this.startChrIndex+":"+this.startPos+"-"+this.endPos),i="The "+e.variantTypes[this.eventTypeIndex].variantType+" at "+r+" is intergenic,";if(this.hasOwnProperty("geneIds")&&this.geneIds.length>0){i="The "+e.variantTypes[this.eventTypeIndex].variantType+" at "+r+" is on ";for(var a=0;a<this.geneIds.length;++a)i+=""+e.genes.get(this.geneIds[a]).getGeneCardsLink(),a<this.geneIds.length-1&&(i+=", ")}return[n,i,""].join("<br />")}},{key:"textExport",value:function(e,t){var n=[e.chromosomes[this.startChrIndex].chromosomeName,this.startPos,this.ref,this.alt,e.variantTypes[this.eventTypeIndex].variantType];if(this.hasOwnProperty("geneIds")){for(var r=[],o=0;o<this.geneIds.length;++o)r.push(this.geneIds[o].geneName);n.push(r.join(","))}else n.push("NA");return n.push(t.metadata[this.donorIndex].donor),n}}],[{key:"generalHeaderExport",value:function(){return["chromosome","pos","REF","ALT","SNV Type","Genes","Donor"]}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.VariantFetcher=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(13),i=n(120),a=n(116);t.VariantFetcher=function(){function t(e,n,r,o,i){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.selectionManager=o,this.geneIds=i,this.variantsForPhenotypePlots=new Map,this.variantsForVariantPlots=new Map,this.offIndels=new Map,this.directIndels=new Map,this.directSnvs=new Map,this.Svs=new Map,this.VdjSvs=new Map,this.MidsizeSvs=new Map,this.MidsizeDirectHitSvs=new Map,this.geneIds.forEach(function(e){var t=new Map;a.references.variantTypes.forEach(function(e){for(var n=new Map,r=0;r<a.cohortMetadata.metadata.length;++r)n.set(r,[]);t.set(e.uniqueLoc,n)}),a.variantsForPhenotypePlots.set(e,t);var n=new Map;n.set("svData",[]),n.set("midSizedSvData",[]),n.set("vdjSvData",[]),n.set("smallVariantData",[]),a.variantsForVariantPlots.set(e,n),a.offIndels.set(e,[]),a.directIndels.set(e,[]),a.directSnvs.set(e,[]),a.Svs.set(e,[]),a.VdjSvs.set(e,[]),a.MidsizeSvs.set(e,[]),a.MidsizeDirectHitSvs.set(e,[])})}return r(t,[{key:"getVariantDataForPhenotypePlotsFromGeneId",value:function(e,t,n){var r=this,i=(0,o.queue)(),a=[];this.geneIds.forEach(function(e){0!==e&&a.push(e)}),this.geneIds=a,this.geneIds.forEach(function(n){var o=r.references.genes.get(n).tadIndices;i.defer(function(t){r.getSvs(o,n,e,0,t)}),i.defer(function(t){r.getVdjSvs(o,n,e,0,t)}),i.defer(function(e){r.getMidsizedSvs(o,n,t,0,e)}),i.defer(function(e){r.getMidsizedDirectHitSvs(o,n,0,e)}),i.defer(function(e){r.getOffIndels(o,n,t,0,e)}),i.defer(function(e){r.getDirectIndels(n,0,e)}),i.defer(function(e){r.getDirectSnvs(n,0,e)})});var s=this;i.awaitAll(function(e){s.geneIds.forEach(function(e){s.Svs.get(e).forEach(function(t){s.variantsForPhenotypePlots.get(e).get(1).get(t.donorIndex).push(t)}),s.VdjSvs.get(e).forEach(function(t){s.variantsForPhenotypePlots.get(e).get(1).get(t.donorIndex).push(t)}),s.MidsizeSvs.get(e).forEach(function(t){s.variantsForPhenotypePlots.get(e).get(2).get(t.donorIndex).push(t)}),s.MidsizeDirectHitSvs.get(e).forEach(function(t){s.variantsForPhenotypePlots.get(e).get(1).get(t.donorIndex).push(t)}),s.directSnvs.get(e).forEach(function(t){var n=t.donorIndex,r=s.references.variantTypes[t.eventTypeIndex].uniqueLoc;s.variantsForPhenotypePlots.get(e).get(r).get(n).push(t)}),s.offIndels.get(e).forEach(function(t){var n=t.donorIndex;s.variantsForPhenotypePlots.get(e).get(2).get(n).push(t)}),s.directIndels.get(e).forEach(function(t){var n=t.donorIndex,r=s.references.variantTypes[t.eventTypeIndex].uniqueLoc;s.variantsForPhenotypePlots.get(e).get(r).get(n).push(t)})}),n()})}},{key:"getVariantDataForVariantPlotsFromTadIndices",value:function(e,t,n,r,i){var a=this,s=(0,o.queue)();s.defer(function(t){a.getSvs(e,0,n,r,t)}),s.defer(function(t){a.getVdjSvs(e,0,n,r,t)}),s.defer(function(n){a.getMidsizedSvs(e,0,t,r,n)}),s.awaitAll(function(){a.Svs.get(0).forEach(function(e){a.variantsForVariantPlots.get(0).get("svData").push(e)}),a.VdjSvs.get(0).forEach(function(e){a.variantsForVariantPlots.get(0).get("vdjSvData").push(e)}),a.MidsizeSvs.get(0).forEach(function(e){a.variantsForVariantPlots.get(0).get("midSizedSvData").push(e)}),i()})}},{key:"getSmallVariantDataForVariantPlotsFromTadIndices",value:function(e,t,n,r,i){var a=this,s=(0,o.queue)();s.defer(function(n){a.getOffIndels(e,0,t,r,n)}),new Set(e).forEach(function(e){a.references.tads[e].geneIndices.forEach(function(e){a.directIndels.set(e,[]),a.directSnvs.set(e,[]),s.defer(function(t){a.getDirectIndels(e,r,t)}),s.defer(function(t){a.getDirectSnvs(e,r,t)})})}),s.awaitAll(function(){a.offIndels.get(0).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)}),new Set(e).forEach(function(e){a.references.tads[e].geneIndices.forEach(function(e){a.directIndels.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)}),a.directSnvs.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)})})}),i()})}},{key:"getVariantDataForVariantPlotsFromCytobandIndex",value:function(e,t,n){for(var r=[],o=this.references.cytobands[e].firstTadIndex;o<=this.references.cytobands[e].lastTadIndex;++o)r.push(o);this.getVariantDataForVariantPlotsFromTadIndices(r,0,0,t,n)}},{key:"getSmallVariantDataForVariantPlotsFromCytobandIndex",value:function(e,t,n){for(var r=this.references.cytobands[e],o=[],i=r.firstTadIndex;i<=r.lastTadIndex;++i)o.push(i);this.getSmallVariantDataForVariantPlotsFromTadIndices(o,0,0,t,n)}},{key:"getVariantDataForVariantPlotsFromGeneId",value:function(e,t,n,r,i){var a=this,s=(0,o.queue)(),l=this.references.genes.get(e).tadIndices;s.defer(function(t){a.getSvs(l,e,n,r,t)}),s.defer(function(t){a.getVdjSvs(l,e,n,r,t)}),s.defer(function(n){a.getMidsizedSvs(l,e,t,r,n)}),s.awaitAll(function(){a.Svs.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("svData").push(e)}),a.VdjSvs.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("vdjSvData").push(e)}),a.MidsizeSvs.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("midSizedSvData").push(e)}),i()})}},{key:"getSmallVariantDataForVariantPlotsFromGeneId",value:function(e,t,n,r,i){var a=this,s=(0,o.queue)(),l=this.references.genes.get(e).tadIndices;s.defer(function(n){a.getOffIndels(l,e,t,r,n)}),s.defer(function(t){a.getDirectIndels(e,r,t)}),s.defer(function(t){a.getDirectSnvs(e,r,t)}),s.awaitAll(function(){a.offIndels.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)}),a.directIndels.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)}),a.directSnvs.get(e).forEach(function(e){a.variantsForVariantPlots.get(0).get("smallVariantData").push(e)}),i()})}},{key:"getOffIndels",value:function(t,n,r,o,a){var s=this;-1===r&&a();var l=this,c=new Set;t.forEach(function(e){s.references.tads[e].offset0IndelIndices.forEach(function(e){c.add(e)}),r>0&&s.references.tads[e].offset1IndelIndices.forEach(function(e){c.add(e)}),r>1&&s.references.tads[e].offset2IndelIndices.forEach(function(e){c.add(e)}),r>2&&s.references.tads[e].offset3IndelIndices.forEach(function(e){c.add(e)})}),0===c.size?a():e.ajax({url:l.commonSettings.baseUrl+"/php/getDataFromDbPOST.php",type:"POST",dataType:"json",data:{cohort:l.cohortMetadata.cohortName,suffix:"cohortAllIndels",columnsToSelect:"*",keyColumn:"indelIndex",keysToSearchRaw:Array.from(c).sort().join(",")},error:function(e){console.error(e)},success:function(e){e.forEach(function(e){var t=new i.VariantEntryIndel(e,l.references);l.selectionManager.registeredSubcohorts.get(o).has(t.donorIndex)&&l.offIndels.get(n).push(t)}),a()}})}},{key:"getDirectIndels",value:function(t,n,r){var o=this;e.ajax({url:o.commonSettings.baseUrl+"/php/getDataFromDbLIKE.php",type:"GET",dataType:"json",data:{cohort:o.cohortMetadata.cohortName,suffix:"cohortAllIndels",columnsToSelect:"*",keyColumn:"gene",keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){e.forEach(function(e){var r=new i.VariantEntryIndel(e,o.references);o.selectionManager.registeredSubcohorts.get(n).has(r.donorIndex)&&r.hasOwnProperty("geneIds")&&new Set(r.geneIds).has(t)&&o.directIndels.get(t).push(r)}),r()}})}},{key:"getDirectSnvs",value:function(t,n,r){var o=this;e.ajax({url:o.commonSettings.baseUrl+"/php/getDataFromDbLIKE.php",type:"GET",dataType:"json",data:{cohort:o.cohortMetadata.cohortName,suffix:"cohortAllSnvs",columnsToSelect:"*",keyColumn:"gene",keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){e.forEach(function(e){var r=new a.VariantEntrySnv(e,o.references);o.selectionManager.registeredSubcohorts.get(n).has(r.donorIndex)&&r.hasOwnProperty("geneIds")&&new Set(r.geneIds).has(t)&&o.directSnvs.get(t).push(r)}),r()}})}},{key:"getSvs",value:function(e,t,n,r,o){var i=this;-1===n&&o();var a=new Set;e.forEach(function(e){i.references.tads[e].offset0SvIndices.forEach(function(e){a.add(e)}),n>0&&i.references.tads[e].offset1SvIndices.forEach(function(e){a.add(e)}),n>1&&i.references.tads[e].offset2SvIndices.forEach(function(e){a.add(e)}),n>2&&i.references.tads[e].offset3SvIndices.forEach(function(e){a.add(e)})}),a.forEach(function(e){var n=i.references.currentCohort.cohortData.Svs[e];i.selectionManager.registeredSubcohorts.get(r).has(n.donorIndex)&&i.Svs.get(t).push(n)}),o()}},{key:"getVdjSvs",value:function(e,t,n,r,o){var i=this;-1===n&&o();var a=new Set;e.forEach(function(e){i.references.tads[e].offset0VdjSvIndices.forEach(function(e){a.add(e)}),n>0&&i.references.tads[e].offset1VdjSvIndices.forEach(function(e){a.add(e)}),n>1&&i.references.tads[e].offset2VdjSvIndices.forEach(function(e){a.add(e)}),n>2&&i.references.tads[e].offset3VdjSvIndices.forEach(function(e){a.add(e)})}),a.forEach(function(e){var n=i.references.currentCohort.cohortData.VdjSvs[e];i.selectionManager.registeredSubcohorts.get(r).has(n.donorIndex)&&i.VdjSvs.get(t).push(n)}),o()}},{key:"getMidsizedSvs",value:function(e,t,n,r,o){var i=this;-1===n&&o();var a=new Set;e.forEach(function(e){i.references.tads[e].offset0MidSvIndices.forEach(function(e){a.add(e)}),n>0&&i.references.tads[e].offset1MidSvIndices.forEach(function(e){a.add(e)}),n>1&&i.references.tads[e].offset2MidSvIndices.forEach(function(e){a.add(e)}),n>2&&i.references.tads[e].offset3MidSvIndices.forEach(function(e){a.add(e)})}),a.forEach(function(e){var n=i.references.currentCohort.cohortData.midSizedSvs[e];i.selectionManager.registeredSubcohorts.get(r).has(n.donorIndex)&&i.MidsizeSvs.get(t).push(n)}),o()}},{key:"getMidsizedDirectHitSvs",value:function(e,t,n,r){var o=this,i=new Set;e.forEach(function(e){o.references.tads[e].offset0MidSvIndices.forEach(function(e){i.add(e)})}),i.forEach(function(e){var r=o.references.currentCohort.cohortData.midSizedSvs[e];o.selectionManager.registeredSubcohorts.get(n).has(r.donorIndex)&&r.hasOwnProperty("directHits")&&r.directHits.has(t)&&o.MidsizeDirectHitSvs.get(t).push(r)}),r()}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TadEntry=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.TadEntry=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tadIndex=parseInt(t.tadIndex),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.startPos=parseInt(t.startPos),this.endPos=parseInt(t.endPos),this.cytobandIndices=[],t.cytobandIndices.split(";").forEach(function(e){n.cytobandIndices.push(parseInt(e))}),this.geneIndices=[],"-1"!==t.geneIndices&&"0"!==t.geneIndices&&t.geneIndices.split(";").forEach(function(e){n.geneIndices.push(parseInt(e))}),this.offset0SvIndices=[],this.offset1SvIndices=[],this.offset2SvIndices=[],this.offset3SvIndices=[],this.offset0VdjSvIndices=[],this.offset1VdjSvIndices=[],this.offset2VdjSvIndices=[],this.offset3VdjSvIndices=[],this.offset0MidSvIndices=[],this.offset1MidSvIndices=[],this.offset2MidSvIndices=[],this.offset3MidSvIndices=[],this.offset0IndelIndices=[],this.offset1IndelIndices=[],this.offset2IndelIndices=[],this.offset3IndelIndices=[],this.svDonorContributorIndicesOffset0=new Set([]),this.svDonorContributorIndicesOffset1=new Set([]),this.svDonorContributorIndicesOffset2=new Set([]),this.svDonorContributorIndicesOffset3=new Set([]),this.indelDonorContributorIndicesOffset0=new Set([]),this.indelDonorContributorIndicesOffset1=new Set([]),this.indelDonorContributorIndicesOffset2=new Set([]),this.indelDonorContributorIndicesOffset3=new Set([]),this.cnvLossDonorContributorIndices=new Set([]),this.cnvGainDonorContributorIndices=new Set([]),this.lohDonorContributorIndices=new Set([]),this.cnnLohDonorContributorIndices=new Set([]),this.cnvLossFocalDonorContributorIndices=new Set([]),this.cnvGainFocalDonorContributorIndices=new Set([]),this.lohFocalDonorContributorIndices=new Set([]),this.cnnLohFocalDonorContributorIndices=new Set([])}return r(e,[{key:"resetCohortContributions",value:function(){this.offset0SvIndices.length=0,this.offset1SvIndices.length=0,this.offset2SvIndices.length=0,this.offset3SvIndices.length=0,this.offset0MidSvIndices.length=0,this.offset1MidSvIndices.length=0,this.offset2MidSvIndices.length=0,this.offset3MidSvIndices.length=0,this.offset0IndelIndices.length=0,this.offset1IndelIndices.length=0,this.offset2IndelIndices.length=0,this.offset3IndelIndices.length=0,this.svDonorContributorIndicesOffset0.clear(),this.svDonorContributorIndicesOffset1.clear(),this.svDonorContributorIndicesOffset2.clear(),this.svDonorContributorIndicesOffset3.clear(),this.indelDonorContributorIndicesOffset0.clear(),this.indelDonorContributorIndicesOffset1.clear(),this.indelDonorContributorIndicesOffset2.clear(),this.indelDonorContributorIndicesOffset3.clear(),this.cnvLossDonorContributorIndices.clear(),this.cnvGainDonorContributorIndices.clear(),this.lohDonorContributorIndices.clear(),this.cnnLohDonorContributorIndices.clear(),this.cnvLossFocalDonorContributorIndices.clear(),this.cnvGainFocalDonorContributorIndices.clear(),this.lohFocalDonorContributorIndices.clear(),this.cnnLohFocalDonorContributorIndices.clear()}},{key:"printTadRange",value:function(e){return e.chromosomes[this.chromosomeIndex].chromosomeName+":"+this.startPos+"-"+this.endPos}},{key:"printCytobandHits",value:function(e){for(var t=[],n=0;n<this.cytobandIndices.length;++n)t.push(e.cytobands[this.cytobandIndices[n]].cytobandName);return t.join(",")}},{key:"annotate",value:function(e,t,n,r){for(var a=this,s="",l=0;l<this.cytobandIndices.length;++l)s+=(0,o.searchInPubMed)(t.cytobands[this.cytobandIndices[l]].cytobandName,e.diseaseNameAlternatives),l<this.cytobandIndices.length-1&&(s+=" and ");var c=new Set,A=new Set;r.forEach(function(e){a[e].forEach(function(e){n.has(e)?(c.add(e),A.delete(e)):c.has(e)||A.add(e)})});var u="TAD #"+this.tadIndex+" on "+s+" spans the region ",h=this.printTadRange(t);u+=(0,o.getGenomeBrowserLink)(h)+" containing the genes:",u+="<br />";for(var d=0;d<this.geneIndices.length;++d)u+=t.genes.get(this.geneIndices[d]).getGeneCardsLink(),d<this.geneIndices.length-1&&(u+=", ");u+="<br />";var f=[].concat(i(this.svDonorContributorIndicesOffset0)).filter(function(e){return c.has(e)}),p=[].concat(i(this.svDonorContributorIndicesOffset1)).filter(function(e){return c.has(e)}),g=[].concat(i(this.svDonorContributorIndicesOffset2)).filter(function(e){return c.has(e)}),m=[].concat(i(this.svDonorContributorIndicesOffset3)).filter(function(e){return c.has(e)});if((f.length>0||p.length>0||g.length>0||m.length>0)&&(u+="The following donors in this cohort have SVs that affect this TAD:",u+="<br />"),f.length>0){u+="Direct TAD Hits ("+f.length+"):";for(var v=0;v<f.length;++v)u+=e.metadata[f[v]].donor,v<f.length-1&&(u+=", ");u+="<br />"}if(p.length>0){u+="1-TAD offset ("+p.length+"):";for(var y=0;y<p.length;++y)u+=e.metadata[p[y]].donor,y<p.length-1&&(u+=", ");u+="<br />"}if(g.length>0){u+="2-TAD offset ("+g.length+"):";for(var b=0;b<g.length;++b)u+=e.metadata[g[b]].donor,b<g.length-1&&(u+=", ");u+="<br />"}if(m.length>0){u+="3-TAD offset ("+m.length+"):";for(var I=0;I<m.length;++I)u+=e.metadata[m[I]].donor,I<m.length-1&&(u+=", ");u+="<br />"}var x=[].concat(i(this.cnvLossDonorContributorIndices)).filter(function(e){return c.has(e)});if(x.length>0){u+="The following "+x.length+" donor"+(x.length>1?"s":"")+" in this cohort "+(x.length>1?"have":"has")+" loss CNVs affecting this TAD:",u+="<br />";for(var w=0;w<x.length;++w)u+=e.metadata[x[w]].donor,w<x.length-1&&(u+=", ");u+="<br />"}var C=[].concat(i(this.cnvGainDonorContributorIndices)).filter(function(e){return c.has(e)});if(C.length>0){u+="The following "+C.length+" donor"+(C.length>1?"s":"")+" in this cohort "+(C.length>1?"have":"has")+" gain CNVs affecting this TAD:",u+="<br />";for(var E=0;E<C.length;++E)u+=e.metadata[C[E]].donor,E<C.length-1&&(u+=", ");u+="<br />"}var S=[].concat(i(this.lohDonorContributorIndices)).filter(function(e){return c.has(e)});if(S.length>0){u+="The following "+S.length+" donor"+(S.length>1?"s":"")+" in this cohort "+(S.length>1?"have":"has")+" LOH on this TAD:",u+="<br />";for(var M=0;M<S.length;++M)u+=e.metadata[S[M]].donor,M<S.length-1&&(u+=", ")}return[u,c]}},{key:"getGenomeBrowserLink",value:function(){return'<a href="https://genome.ucsc.edu/cgi-bin/hgTracks?org=human&db=hg19&position=chr'+this.chromosomeIndex+":"+this.startPos+"-"+this.endPos+'" target="_blank">'+this.tadIndex+"</a>"}},{key:"getIndex",value:function(){return this.tadIndex}},{key:"textExportCnv",value:function(e,t){var n=[];n.push(t.chromosomes[this.chromosomeIndex].chromosomeName),n.push(this.startPos),n.push(this.endPos);for(var r=[],o=0;o<this.cytobandIndices.length;++o)r.push(t.cytobands[this.cytobandIndices[o]].cytobandName);if(n.push(r.join(",")),n.push(this.cnvGainDonorContributorIndices.size),n.push(this.cnvLossDonorContributorIndices.size),n.push(this.lohDonorContributorIndices.size),this.cnvGainDonorContributorIndices.size+this.cnvLossDonorContributorIndices.size+this.lohDonorContributorIndices.size===0)return[];var a=new Set([].concat(i(this.lohDonorContributorIndices),i(this.cnvLossDonorContributorIndices)));n.push(a.size);var s=[];this.cnvGainDonorContributorIndices.forEach(function(t){s.push(e.metadata[t].donor)}),n.push(s.join(","));var l=[];this.cnvLossDonorContributorIndices.forEach(function(t){l.push(e.metadata[t].donor)}),n.push(l.join(","));var c=[];this.lohDonorContributorIndices.forEach(function(t){c.push(e.metadata[t].donor)}),n.push(c.join(","));var A=[];return a.forEach(function(t){A.push(e.metadata[t].donor)}),n.push(A.join(",")),n}},{key:"textExportSv",value:function(e,t,n){var r=[];r.push(t.chromosomes[this.chromosomeIndex].chromosomeName),r.push(this.startPos),r.push(this.endPos);for(var o=[],i=0;i<this.cytobandIndices.length;++i)o.push(t.cytobands[this.cytobandIndices[i]].cytobandName);r.push(o.join(","));var a=this.svDonorContributorIndicesOffset0.size;if(n>=1&&(a+=this.svDonorContributorIndicesOffset1.size),n>=2&&(a+=this.svDonorContributorIndicesOffset2.size),n>=3&&(a+=this.svDonorContributorIndicesOffset3.size),0===a)return[];r.push(a);var s=[];this.svDonorContributorIndicesOffset0.forEach(function(t){s.push(e.metadata[t].donor)}),r.push(s.join(","));var l=[];this.svDonorContributorIndicesOffset1.forEach(function(t){l.push(e.metadata[t].donor)}),r.push(l.join(","));var c=[];this.svDonorContributorIndicesOffset2.forEach(function(t){c.push(e.metadata[t].donor)}),r.push(c.join(","));var A=[];return this.svDonorContributorIndicesOffset3.forEach(function(t){A.push(e.metadata[t].donor)}),r.push(A.join(",")),r}},{key:"textExportIndel",value:function(e,t,n){var r=[];r.push(t.chromosomes[this.chromosomeIndex].chromosomeName),r.push(this.startPos),r.push(this.endPos);for(var o=[],i=0;i<this.cytobandIndices.length;++i)o.push(t.cytobands[this.cytobandIndices[i]].cytobandName);r.push(o.join(","));var a=this.indelDonorContributorIndicesOffset0.size;if(n>=1&&(a+=this.indelDonorContributorIndicesOffset1.size),n>=2&&(a+=this.indelDonorContributorIndicesOffset2.size),n>=3&&(a+=this.indelDonorContributorIndicesOffset3.size),0===a)return[];r.push(a);var s=[];this.indelDonorContributorIndicesOffset0.forEach(function(t){s.push(e.metadata[t].donor)}),r.push(s.join(","));var l=[];this.indelDonorContributorIndicesOffset1.forEach(function(t){l.push(e.metadata[t].donor)}),r.push(l.join(","));var c=[];this.indelDonorContributorIndicesOffset2.forEach(function(t){c.push(e.metadata[t].donor)}),r.push(c.join(","));var A=[];return this.indelDonorContributorIndicesOffset3.forEach(function(t){A.push(e.metadata[t].donor)}),r.push(A.join(",")),r}}],[{key:"generalHeaderExportCnv",value:function(){return["TAD Chromosome","TAD Start","TAD End","Cytobands","Gain Recurrence","Loss Recurrence","LOH Recurrence","Loss/LOH Recurrence","Donors with Gains","Donors with Losses","Donors with LOH","Donors with Loss/LOH"]}},{key:"generalHeaderExportSv",value:function(){return["TAD Chromosome","TAD Start","TAD End","Cytobands","Total Shown Recurrence","Donors with Direct SV Hits on the TAD","Donors with SV Hits On 1-Offset Neighbors","Donors with SV Hits On 2-Offset Neighbors","Donors with SV Hits On 3-Offset Neighbors"]}},{key:"generalHeaderExportIndel",value:function(){}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.VariantEntrySv=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t.VariantEntrySv=function(){function t(n,r){var o=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n.hasOwnProperty("svIndex")?this.svIndex=parseInt(n.svIndex):n.hasOwnProperty("midSvIndex")&&(this.svIndex=parseInt(n.midSvIndex)),this.startChrIndex=parseInt(n.startChrIndex),this.endChrIndex=parseInt(n.endChrIndex),this.startPos=parseInt(n.startPos),this.endPos=parseInt(n.endPos),this.eventScore=parseInt(n.eventScore),this.eventTypeIndex=parseInt(n.eventType),this.clonality=+n.clonality,"_"!==n.source1&&(this.source1=n.source1),"_"!==n.source2&&(this.source2=n.source2),"."!==n.overhang1&&(this.overhang1=n.overhang1),"."!==n.overhang2&&(this.overhang2=n.overhang2),this.startCytobandIndex=parseInt(n.startCytobandIndex),this.endCytobandIndex=parseInt(n.endCytobandIndex),"."!==n.gene1){for(var i=n.gene1.split(","),a=[],s=0;s<i.length;++s){var l=i[s].split("_");if(!isNaN(l[0])){var c=parseInt(l[0]);if(r.genes.has(c))if(2===l.length)if("e"===l[1].charAt(0)){var A=parseInt(l[1].replace("exon",""));a.push([c,"e",A])}else if("i"===l[1].charAt(0)){var u=parseInt(l[1].replace("intron",""));a.push([c,"i",u])}else"5"===l[1].charAt(0)&&a.push([c,"p",0]);else a.push([c,"",0])}}a.length>0&&(this.gene1Info=a)}if("."!==n.gene2){for(var h=n.gene2.split(","),d=[],f=0;f<h.length;++f){var p=h[f].split("_");if(!isNaN(p[0])){var g=parseInt(p[0]);if(r.genes.has(g))if(2===p.length)if("e"===p[1].charAt(0)){var m=parseInt(p[1].replace("exon",""));d.push([g,"e",m])}else if("i"===p[1].charAt(0)){var v=parseInt(p[1].replace("intron",""));d.push([g,"i",v])}else"5"===p[1].charAt(0)&&d.push([g,"p",0]);else d.push([g,"",0])}}d.length>0&&(this.gene2Info=d)}var y=new Set;n.directHits.split(",").forEach(function(t){if(e.isNumeric(t)){var n=parseInt(t);r.genes.has(n)&&y.add(n)}}),y.length>0&&(this.directHits=y),"-1"!==n.nearestGeneUpstream1&&(this.nearestGeneUpstream1Ids=[],n.nearestGeneUpstream1.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestGeneUpstream1Ids.push(t)}),this.nearestGeneUpstreamDistance1=parseInt(n.nearestGeneUpstreamDistance1)),"-1"!==n.nearestCancerGeneUpstream1&&(this.nearestCancerGeneUpstream1Ids=[],n.nearestCancerGeneUpstream1.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestCancerGeneUpstream1Ids.push(t)}),this.nearestCancerGeneUpstreamDistance1=parseInt(n.nearestCancerGeneUpstreamDistance1)),"-1"!==n.nearestGeneDownstream1&&(this.nearestGeneDownstream1Ids=[],n.nearestGeneDownstream1.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestGeneDownstream1Ids.push(parseInt(t))}),this.nearestGeneDownstreamDistance1=parseInt(n.nearestGeneDownstreamDistance1)),"-1"!==n.nearestCancerGeneDownstream1&&(this.nearestCancerGeneDownstream1Ids=[],n.nearestCancerGeneDownstream1.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestCancerGeneDownstream1Ids.push(parseInt(t))}),this.nearestCancerGeneDownstreamDistance1=parseInt(n.nearestCancerGeneDownstreamDistance1)),"-1"!==n.nearestGeneUpstream2&&(this.nearestGeneUpstream2Ids=[],n.nearestGeneUpstream2.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestGeneUpstream2Ids.push(parseInt(t))}),this.nearestGeneUpstreamDistance2=parseInt(n.nearestGeneUpstreamDistance2)),"-1"!==n.nearestCancerGeneUpstream2&&(this.nearestCancerGeneUpstream2Ids=[],n.nearestCancerGeneUpstream2.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestCancerGeneUpstream2Ids.push(parseInt(t))}),this.nearestCancerGeneUpstreamDistance2=parseInt(n.nearestCancerGeneUpstreamDistance2)),"-1"!==n.nearestGeneDownstream2&&(this.nearestGeneDownstream2Ids=[],n.nearestGeneDownstream2.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestGeneDownstream2Ids.push(parseInt(t))}),this.nearestGeneDownstreamDistance2=parseInt(n.nearestGeneDownstreamDistance2)),"-1"!==n.nearestCancerGeneDownstream2&&(this.nearestCancerGeneDownstream2Ids=[],n.nearestCancerGeneDownstream2.split(",").forEach(function(e){var t=parseInt(e);r.genes.has(t)&&o.nearestCancerGeneDownstream2Ids.push(parseInt(t))}),this.nearestCancerGeneDownstreamDistance2=parseInt(n.nearestCancerGeneDownstreamDistance2)),-1!==parseInt(n.startFragileSiteIndex)&&(this.startFragileSiteIndex=parseInt(n.startFragileSiteIndex)),-1!==parseInt(n.endFragileSiteIndex)&&(this.endFragileSiteIndex=parseInt(n.endFragileSiteIndex)),"."!==n.dbSuperEntries1&&(this.dbSuperEntryIds1=[],n.dbSuperEntries1.split(",").forEach(function(e){o.dbSuperEntryIds1.push(parseInt(e))})),"."!==n.dbSuperEntries2&&(this.dbSuperEntryIds2=[],n.dbSuperEntries2.split(",").forEach(function(e){o.dbSuperEntryIds2.push(parseInt(e))})),-1!==parseInt(n.preRemapStartChrIndex)&&(this.preRemapStartChrIndex=parseInt(n.preRemapStartChrIndex),this.preRemapStartPos=parseInt(n.preRemapStartPos)),-1!==parseInt(n.preRemapEndChrIndex)&&(this.preRemapEndChrIndex=parseInt(n.preRemapEndChrIndex),this.preRemapEndPos=parseInt(n.preRemapEndPos)),this.tadIndicesOffset0=[],"."!==n.tadIndicesOffset0&&n.tadIndicesOffset0.split(";").forEach(function(e){o.tadIndicesOffset0.push(parseInt(e))}),this.tadIndicesOffset1=[],"."!==n.tadIndicesOffset1&&n.tadIndicesOffset1.split(";").forEach(function(e){o.tadIndicesOffset1.push(parseInt(e))}),this.tadIndicesOffset2=[],"."!==n.tadIndicesOffset2&&n.tadIndicesOffset2.split(";").forEach(function(e){o.tadIndicesOffset2.push(parseInt(e))}),this.tadIndicesOffset3=[],"."!==n.tadIndicesOffset3&&n.tadIndicesOffset3.split(";").forEach(function(e){o.tadIndicesOffset3.push(parseInt(e))}),this.maxRecurrence=parseInt(n.maxRecurrence),this.donorIndex=parseInt(n.donor),this.vdjGrade=-1,this.assignVdjTargets(r,0,!1),this.eventTypeVizIndex=this.eventTypeIndex,this.parentVdjIndex=-1}return r(t,[{key:"assignVdjTargets",value:function(e,t,n){if(6===this.eventTypeIndex||7===this.eventTypeIndex){this.vdjGrade=t;var r=this.estimateVdjTarget(e,n);6!==this.eventTypeIndex&&7!==this.eventTypeIndex||(this.vdjTargets=e.mapKnownVdjTargets(r))}}},{key:"transformToVdjSv",value:function(e,t,n,r){this.parentVdjIndex=e.svIndex,-1===t&&(this.eventTypeIndex=7,this.eventTypeVizIndex=7),1===t&&(this.eventTypeIndex=6,this.eventTypeVizIndex=6),this.assignVdjTargets(r,n,!0)}},{key:"getEventHeight",value:function(){var e=1,t=Math.abs(this.endPos-this.startPos),n=this.startChrIndex===this.endChrIndex&&t<9e6,r=!n&&this.startChrIndex===this.endChrIndex&&t<18e6;if(n||r){if(6===this.eventTypeIndex||7===this.eventTypeIndex)return.5;n?e=.15:r&&(e=.35)}return e}},{key:"estimateVdjTarget",value:function(e,t){var n=void 0,r=void 0,o=void 0,i=void 0,a=void 0,s=void 0,l=void 0;if(7===this.eventTypeIndex){if(!t){if(void 0!==this.gene2Info)for(var c=0;c<this.gene2Info.length;++c)if(e.genes.has(this.gene2Info[c][0])&&!e.genes.get(this.gene2Info[c][0]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1];if(void 0!==this.nearestGeneUpstream2Ids)for(var A=0;A<this.nearestGeneUpstream2Ids.length;++A)if(e.genes.has(this.nearestGeneUpstream2Ids[A])&&!e.genes.get(this.nearestGeneUpstream2Ids[A]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1];if(void 0!==this.nearestGeneDownstream2Ids)for(var u=0;u<this.nearestGeneDownstream2Ids.length;++u)if(e.genes.has(this.nearestGeneDownstream2Ids[u])&&!e.genes.get(this.nearestGeneDownstream2Ids[u]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1]}n=this.gene2Info,r=this.nearestGeneUpstream2Ids,o=this.nearestGeneUpstreamDistance2,i=this.nearestCancerGeneUpstream2Ids,a=this.nearestGeneDownstream2Ids,s=this.nearestGeneDownstreamDistance2,l=this.nearestCancerGeneDownstream2Ids}else if(6===this.eventTypeIndex){if(!t){if(void 0!==this.gene1Info)for(var h=0;h<this.gene1Info.length;++h)if(e.genes.has(this.gene1Info[h][0])&&!e.genes.get(this.gene1Info[h][0]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1];if(void 0!==this.nearestGeneUpstream1Ids)for(var d=0;d<this.nearestGeneUpstream1Ids.length;++d)if(e.genes.has(this.nearestGeneUpstream1Ids[d])&&!e.genes.get(this.nearestGeneUpstream1Ids[d]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1];if(void 0!==this.nearestGeneDownstream1Ids)for(var f=0;f<this.nearestGeneDownstream1Ids.length;++f)if(e.genes.has(this.nearestGeneDownstream1Ids[f])&&!e.genes.get(this.nearestGeneDownstream1Ids[f]).checkVdjTargetValidity())return this.eventTypeIndex=1,[-1]}n=this.gene1Info,r=this.nearestGeneUpstream1Ids,o=this.nearestGeneUpstreamDistance1,i=this.nearestCancerGeneUpstream1Ids,a=this.nearestGeneDownstream1Ids,s=this.nearestGeneDownstreamDistance1,l=this.nearestCancerGeneDownstream1Ids}if(void 0!==n)for(var p=0;p<n.length;++p)if(e.superVdjTargets.has(n[p][0]))return[n[p][0]];if(void 0!==r)for(var g=0;g<r.length;++g)if(e.superVdjTargets.has(r[g]))return[r[g]];if(void 0!==i)for(var m=0;m<i.length;++m)if(e.superVdjTargets.has(i[m]))return[i[m]];if(void 0!==a)for(var v=0;v<a.length;++v)if(e.superVdjTargets.has(a[v]))return[a[v]];if(void 0!==l)for(var y=0;y<l.length;++y)if(e.superVdjTargets.has(l[y]))return[l[y]];if(void 0!==n){var b=[];if(n.forEach(function(t){e.genes.get(t[0]).cancerGene&&b.push(t[0])}),b.length>0)return b;var I=[],x=[];if(n.forEach(function(t){e.genes.get(t[0]).isSecondClassVdjTarget()?x.push(t[0]):I.push(t[0])}),I.length>0)return I;if(x.length>0)return x}return o<=s?r:a}},{key:"annotate",value:function(e,n){var r="t("+this.startChrIndex+","+this.endChrIndex+")("+e.cytobands[this.startCytobandIndex].rawCytobandName+";"+e.cytobands[this.endCytobandIndex].rawCytobandName+")",i="This SV is a "+(this.vdjGrade>=0?"Grade "+this.vdjGrade:"")+" "+e.variantVizTypes[this.eventTypeIndex].variantDesc+" "+(0,o.searchInPubMed)(r,n.diseaseNameAlternatives)+" in donor "+n.metadata[this.donorIndex].donor;this.eventTypeIndex>5&&(i+=" with the predicted target"+(this.vdjTargets.length>1?"s":"")+" ",this.vdjTargets.forEach(function(t){i+=""+e.genes.get(t).getGeneCardsLink()}));var a="",s=[];this.startChrIndex!==this.endChrIndex?(a=this.startChrIndex+":"+this.startPos+"-"+this.endChrIndex+":"+this.endPos,s.push((0,o.getGenomeBrowserLink)(e.chromosomes[this.startChrIndex].chromosomeName+":"+Math.max(0,this.startPos-1e6)+"-"+Math.min(e.chromosomes[this.startChrIndex].chromosomeSize,this.startPos+1e6))),s.push((0,o.getGenomeBrowserLink)(e.chromosomes[this.endChrIndex].chromosomeName+":"+Math.max(0,this.endPos-1e6)+"-"+Math.min(e.chromosomes[this.endChrIndex].chromosomeSize,this.endPos+1e6)))):(a=(0,o.getGenomeBrowserLink)(this.startChrIndex+":"+this.startPos+"-"+this.endChrIndex+":"+this.endPos)+" spanning "+Math.abs(this.endPos-this.startPos)+" bases",.15!==this.getEventHeight()?(s.push((0,o.getGenomeBrowserLink)(e.chromosomes[this.startChrIndex].chromosomeName+":"+Math.max(0,this.startPos-1e6)+"-"+Math.min(e.chromosomes[this.startChrIndex].chromosomeSize,this.startPos+1e6))),s.push((0,o.getGenomeBrowserLink)(e.chromosomes[this.endChrIndex].chromosomeName+":"+Math.max(0,this.endPos-1e6)+"-"+Math.min(e.chromosomes[this.endChrIndex].chromosomeSize,this.endPos+1e6)))):s.push((0,o.getGenomeBrowserLink)(e.chromosomes[this.startChrIndex].chromosomeName+":"+this.startPos+"-"+this.endPos))),a+=" with the possible regions of interest:";var l=s.join(", "),c='The SOPHIA "EventScore" is '+this.eventScore+" with the evidence:",A="_";this.hasOwnProperty("source1")&&(A=this.source1);var u="_";this.hasOwnProperty("source2")&&(u=this.source2);var h=A+"-"+u,d="_";this.hasOwnProperty("overhang1")&&(d=""+t.submitBlastSearch(this.overhang1));var f="_";this.hasOwnProperty("overhang2")&&(f=""+t.submitBlastSearch(this.overhang2));var p=d+"-"+f,g=(0,o.getGenomeBrowserLink)(e.chromosomes[this.startChrIndex].chromosomeName+":"+this.startPos),m=g+" is intergenic,";if(this.hasOwnProperty("gene1Info")){m=g+" is on ";for(var v=0;v<this.gene1Info.length;++v)m+=""+e.genes.get(this.gene1Info[v][0]).getGeneCardsLink(),"e"===this.gene1Info[v][1]?m+=" (exon "+this.gene1Info[v][2]+")":"i"===this.gene1Info[v][1]?m+=" (intron "+this.gene1Info[v][2]+")":"p"===this.gene1Info[v][1]&&(m+=" (5kbPromoter)"),v<this.gene1Info.length-1&&(m+=", ")}var y="is not on an annotated common fragile site";this.hasOwnProperty("startFragileSiteIndex")&&(y="is on the fragile site "+e.fragileSites[this.startFragileSiteIndex].getGeneCardsLink());var b="has no coding genes upstream";if(this.hasOwnProperty("nearestGeneUpstream1Ids")){b="has the nearest upstream coding gene"+(this.nearestGeneUpstream1Ids.length>1?"s":"")+" ";for(var I=0;I<this.nearestGeneUpstream1Ids.length;++I)b+=""+e.genes.get(this.nearestGeneUpstream1Ids[I]).getGeneCardsLink(),I<this.nearestGeneUpstream1Ids.length-1&&(m+=", ");b+=" "+Math.abs(this.nearestGeneUpstreamDistance1)+" bases away,"}var x="has no known cancer-related genes upstream";if(this.hasOwnProperty("nearestCancerGeneUpstream1Ids")){x="has the nearest upstream cancer-related gene"+(this.nearestCancerGeneUpstream1Ids.length>1?"s":"")+" ";for(var w=0;w<this.nearestCancerGeneUpstream1Ids.length;++w)x+=""+e.genes.get(this.nearestCancerGeneUpstream1Ids[w]).getGeneCardsLink(),w<this.nearestCancerGeneUpstream1Ids.length-1&&(x+=", ");x+=" "+Math.abs(this.nearestCancerGeneUpstreamDistance1)+" bases away,"}var C="has no coding genes downstream";if(this.hasOwnProperty("nearestGeneDownstream1Ids")){C="has the nearest downstream coding gene"+(this.nearestGeneDownstream1Ids.length>1?"s":"")+" ";for(var E=0;E<this.nearestGeneDownstream1Ids.length;++E)C+=""+e.genes.get(this.nearestGeneDownstream1Ids[E]).getGeneCardsLink(),E<this.nearestGeneDownstream1Ids.length-1&&(m+=", ");C+=" "+Math.abs(this.nearestGeneDownstreamDistance1)+" bases away,"}var S="has no known cancer-related genes downstream";if(this.hasOwnProperty("nearestCancerGeneDownstream1Ids")){S="has the nearest downstream cancer-related gene"+(this.nearestCancerGeneDownstream1Ids.length>1?"s":"")+" ";for(var M=0;M<this.nearestCancerGeneDownstream1Ids.length;++M)S+=""+e.genes.get(this.nearestCancerGeneDownstream1Ids[M]).getGeneCardsLink(),M<this.nearestCancerGeneDownstream1Ids.length-1&&(S+=", ");S+=" "+Math.abs(this.nearestCancerGeneDownstreamDistance1)+" bases away,"}var k="is on no dbSUPER entries";if(this.hasOwnProperty("dbSuperEntryIds1")){k="is on the dbSUPER entries ";for(var B=this.dbSuperEntryIds1,D=0;D<B.length;++D)k+=t.getDbSuperLink(B[D]),D<B.length-1&&(k+=", ")}var P=[m,y,b,x,C,S,k,""],Q=(0,o.getGenomeBrowserLink)(e.chromosomes[this.endChrIndex].chromosomeName+":"+this.endPos),T=Q+" is intergenic,";if(this.hasOwnProperty("gene2Info")){T=Q+" is on ";for(var G=0;G<this.gene2Info.length;++G)T+=""+e.genes.get(this.gene2Info[G][0]).getGeneCardsLink(),"e"===this.gene2Info[G][1]?T+=" (exon "+this.gene2Info[G][2]+")":"i"===this.gene2Info[G][1]?T+=" (intron "+this.gene2Info[G][2]+")":"p"===this.gene2Info[G][1]&&(T+=" (5kbPromoter)"),G<this.gene2Info.length-1&&(T+=", ")}var R="is not on an annotated common fragile site";this.hasOwnProperty("endFragileSiteIndex")&&(R="is on the fragile site "+e.fragileSites[this.endFragileSiteIndex].getGeneCardsLink());var _="has no coding genes upstream";if(this.hasOwnProperty("nearestGeneUpstream2Ids")){_="has the nearest upstream coding gene"+(this.nearestGeneUpstream2Ids.length>1?"s":"")+" ";for(var V=0;V<this.nearestGeneUpstream2Ids.length;++V)_+=""+e.genes.get(this.nearestGeneUpstream2Ids[V]).getGeneCardsLink(),V<this.nearestGeneUpstream2Ids.length-1&&(m+=", ");_+=" "+Math.abs(this.nearestGeneUpstreamDistance2)+" bases away,"}var N="has no known cancer-related genes upstream";if(this.hasOwnProperty("nearestCancerGeneUpstream2Ids")){N="has the nearest upstream cancer-related gene"+(this.nearestCancerGeneUpstream2Ids.length>1?"s":"")+" ";for(var F=0;F<this.nearestCancerGeneUpstream2Ids.length;++F)N+=""+e.genes.get(this.nearestCancerGeneUpstream2Ids[F]).getGeneCardsLink(),F<this.nearestCancerGeneUpstream2Ids.length-1&&(N+=", ");N+=" "+Math.abs(this.nearestCancerGeneUpstreamDistance2)+" bases away,"}var O="has no coding genes downstream";if(this.hasOwnProperty("nearestGeneDownstream2Ids")){O="has the nearest downstream coding gene"+(this.nearestGeneDownstream2Ids.length>1?"s":"")+" ";for(var L=0;L<this.nearestGeneDownstream2Ids.length;++L)O+=""+e.genes.get(this.nearestGeneDownstream2Ids[L]).getGeneCardsLink(),L<this.nearestGeneDownstream2Ids.length-1&&(m+=", ");O+=" "+Math.abs(this.nearestGeneDownstreamDistance2)+" bases away,"}var j="has no known cancer-related genes downstream";if(this.hasOwnProperty("nearestCancerGeneDownstream2Ids")){j="has the nearest downstream cancer-related gene"+(this.nearestCancerGeneDownstream2Ids.length>1?"s":"")+" ";for(var z=0;z<this.nearestCancerGeneDownstream2Ids.length;++z)j+=""+e.genes.get(this.nearestCancerGeneDownstream2Ids[z]).getGeneCardsLink(),z<this.nearestCancerGeneDownstream2Ids.length-1&&(j+=", ");j+=" "+Math.abs(this.nearestCancerGeneDownstreamDistance2)+" bases away,"}var H="is on no dbSUPER entries";if(this.hasOwnProperty("dbSuperEntryIds2")){H="is on the dbSUPER entries ";for(var U=this.dbSuperEntryIds2,Y=0;Y<U.length;++Y)H+=t.getDbSuperLink(U[Y]),Y<U.length-1&&(H+=", ")}for(var X=[T,R,_,N,O,j,H,""],q=new Set,K=new Set,Z=new Set,W=new Set,J=new Set,$=0;$<this.tadIndicesOffset0.length;++$)for(var ee=0;ee<e.tads[this.tadIndicesOffset0[$]].geneIndices.length;++ee)K.add(e.tads[this.tadIndicesOffset0[$]].geneIndices[ee]),q.add(e.tads[this.tadIndicesOffset0[$]].geneIndices[ee]);for(var te=0;te<this.tadIndicesOffset1.length;++te)for(var ne=0;ne<e.tads[this.tadIndicesOffset1[te]].geneIndices.length;++ne)q.has(e.tads[this.tadIndicesOffset1[te]].geneIndices[ne])||(q.add(e.tads[this.tadIndicesOffset1[te]].geneIndices[ne]),Z.add(e.tads[this.tadIndicesOffset1[te]].geneIndices[ne]));for(var re=0;re<this.tadIndicesOffset2.length;++re)for(var oe=0;oe<e.tads[this.tadIndicesOffset2[re]].geneIndices.length;++oe)q.has(e.tads[this.tadIndicesOffset2[re]].geneIndices[oe])||(q.add(e.tads[this.tadIndicesOffset2[re]].geneIndices[oe]),W.add(e.tads[this.tadIndicesOffset2[re]].geneIndices[oe]));for(var ie=0;ie<this.tadIndicesOffset3.length;++ie)for(var ae=0;ae<e.tads[this.tadIndicesOffset3[ie]].geneIndices.length;++ae)q.has(e.tads[this.tadIndicesOffset3[ie]].geneIndices[ae])||J.add(e.tads[this.tadIndicesOffset3[ie]].geneIndices[ae]);var se="";if(0!==this.tadIndicesOffset0.length){se="The SV directly hits the TAD"+(this.tadIndicesOffset0.length>1?"s":"")+": ";for(var le=0;le<this.tadIndicesOffset0.length;++le)se+=e.tads[this.tadIndicesOffset0[le]].getGenomeBrowserLink(),le<this.tadIndicesOffset0.length-1&&(se+=", ");se+="<br />containing the genes:<br />";for(var ce=Array.from(K).sort(),Ae=0;Ae<ce.length;++Ae)se+=e.genes.get(ce[Ae]).getGeneCardsLink(),Ae<ce.length-1&&(se+=", ")}var ue="";if(0!==this.tadIndicesOffset1.length){ue="The SV indirectly hits the TAD"+(this.tadIndicesOffset1.length>1?"s":"")+" up to 1 TAD away: ";for(var he=0;he<this.tadIndicesOffset1.length;++he)ue+=e.tads[this.tadIndicesOffset1[he]].getGenomeBrowserLink(),he<this.tadIndicesOffset1.length-1&&(ue+=", ");ue+="<br />containing the genes:<br />";for(var de=Array.from(Z).sort(),fe=0;fe<de.length;++fe)ue+=e.genes.get(de[fe]).getGeneCardsLink(),fe<de.length-1&&(ue+=", ")}var pe="";if(0!==this.tadIndicesOffset2.length){pe="The SV indirectly hits the TAD"+(this.tadIndicesOffset2.length>1?"s":"")+" up to 2 TADs away: ";for(var ge=0;ge<this.tadIndicesOffset2.length;++ge)pe+=e.tads[this.tadIndicesOffset2[ge]].getGenomeBrowserLink(),ge<this.tadIndicesOffset2.length-1&&(pe+=", ");pe+="<br />containing the genes:<br />";for(var me=Array.from(W).sort(),ve=0;ve<me.length;++ve)pe+=e.genes.get(me[ve]).getGeneCardsLink(),ve<me.length-1&&(pe+=", ")}var ye="";if(0!==this.tadIndicesOffset3.length){ye="The SV indirectly hits the TAD"+(this.tadIndicesOffset3.length>1?"s":"")+" up to 3 TADs away: ";for(var be=0;be<this.tadIndicesOffset3.length;++be)ye+=e.tads[this.tadIndicesOffset3[be]].getGenomeBrowserLink(),be<this.tadIndicesOffset3.length-1&&(ye+=", ");ye+="<br />containing the genes:<br />";for(var Ie=Array.from(J).sort(),xe=0;xe<Ie.length;++xe)ye+=e.genes.get(Ie[xe]).getGeneCardsLink(),xe<Ie.length-1&&(ye+=", ")}return[i,a,l,c,h,p,""].concat(P).concat(X).concat([se,ue,pe,ye]).join("<br />")}},{key:"getIndex",value:function(){return this.svIndex}},{key:"setIndex",value:function(e){this.svIndex=e}},{key:"getVdjLabel",value:function(e,t,n){if(0===this.vdjTargets.length)return"?";var r=[];return null===t?this.vdjTargets.forEach(function(t){r.push(e.genes.get(t).geneName)}):this.vdjTargets.forEach(function(o){if(t.has(o)){var i=0;t.get(o).forEach(function(e,t,r){e<=n&&(i+=1)}),r.push(e.genes.get(o).geneName+" ("+i+")")}}),r.join(";")}},{key:"svSimilarity",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e5;return-1===t?this.startChrIndex===e.startChrIndex&&Math.abs(this.startPos-e.startPos)<=n?[!0,-1]:this.startChrIndex===e.endChrIndex&&Math.abs(this.startPos-e.endPos)<=n?[!0,1]:[!1,0]:0===t?this.startChrIndex===e.startChrIndex&&Math.abs(this.startPos-e.startPos)<=n?[!0,-1]:this.startChrIndex===e.endChrIndex&&Math.abs(this.startPos-e.endPos)<=n?[!0,1]:this.endChrIndex===e.startChrIndex&&Math.abs(this.endPos-e.startPos)<=n?[!0,-1]:this.endChrIndex===e.endChrIndex&&Math.abs(this.endPos-e.endPos)<=n?[!0,1]:[!1,0]:1===t?this.endChrIndex===e.startChrIndex&&Math.abs(this.endPos-e.startPos)<=n?[!0,-1]:this.endChrIndex===e.endChrIndex&&Math.abs(this.endPos-e.endPos)<=n?[!0,1]:[!1,0]:[!1,0]}},{key:"textExport",value:function(e,t){var n=[e.chromosomes[this.startChrIndex].chromosomeName,this.startPos,this.startPos+1,e.chromosomes[this.endChrIndex].chromosomeName,this.endPos,this.endPos+1,this.eventScore,e.variantVizTypes[this.eventTypeIndex].variantDesc,this.clonality,this.source1,this.source2,this.overhang1,this.overhang2,e.cytobands[this.startCytobandIndex].cytobandName,e.cytobands[this.endCytobandIndex].cytobandName];if(this.hasOwnProperty("startFragileSiteIndex")?n.push(e.fragileSites[this.startFragileSiteIndex].fragileSiteNames.join(",")):n.push("NA"),this.hasOwnProperty("endFragileSiteIndex")?n.push(e.fragileSites[this.endFragileSiteIndex].fragileSiteNames.join(",")):n.push("NA"),this.hasOwnProperty("dbSuperEntryIds1")){for(var r=[],i=0;i<this.dbSuperEntryIds1.length;++i)r.push((0,o.padSE)(this.dbSuperEntryIds1[i]));n.push(r.join(","))}else n.push("NA");if(this.hasOwnProperty("dbSuperEntryIds2")){for(var a=[],s=0;s<this.dbSuperEntryIds2.length;++s)a.push((0,o.padSE)(this.dbSuperEntryIds2[s]));n.push(a.join(","))}else n.push("NA");if(this.hasOwnProperty("vdjTargets")){for(var l=[],c=0;c<this.vdjTargets.length;++c)l.push(e.genes.get(this.vdjTargets[c]).geneName);n.push(l.join(","))}else n.push("NA");if(this.hasOwnProperty("gene1Info")){for(var A=[],u=[],h=0;h<this.gene1Info.length;++h){var d="",f=e.genes.get(this.gene1Info[h][0]);d+=f.geneName,"e"===this.gene1Info[h][1]?d+=" (exon "+this.gene1Info[h][2]+")":"i"===this.gene1Info[h][1]?d+=" (intron "+this.gene1Info[h][2]+")":"p"===this.gene1Info[h][1]&&(d+=" (5kbPromoter)"),A.push(d),f.cancerGene&&u.push(d)}n.push(A.join(",")),u.length>0?n.push(u.join(",")):n.push("NA")}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestGeneUpstream1Ids")){for(var p=[],g=0;g<this.nearestGeneUpstream1Ids.length;++g)p.push(""+e.genes.get(this.nearestGeneUpstream1Ids[g]).geneName);n.push(p.join(",")),n.push(this.nearestGeneUpstreamDistance1)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestCancerGeneUpstream1Ids")){for(var m=[],v=0;v<this.nearestCancerGeneUpstream1Ids.length;++v)m.push(""+e.genes.get(this.nearestCancerGeneUpstream1Ids[v]).geneName);n.push(m.join(",")),n.push(this.nearestCancerGeneUpstreamDistance1)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestGeneDownstream1Ids")){for(var y=[],b=0;b<this.nearestGeneDownstream1Ids.length;++b)y.push(""+e.genes.get(this.nearestGeneDownstream1Ids[b]).geneName);n.push(y.join(",")),n.push(this.nearestGeneDownstreamDistance1)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestCancerGeneDownstream1Ids")){for(var I=[],x=0;x<this.nearestCancerGeneDownstream1Ids.length;++x)I.push(""+e.genes.get(this.nearestCancerGeneDownstream1Ids[x]).geneName);n.push(I.join(",")),n.push(this.nearestCancerGeneDownstreamDistance1)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("gene2Info")){for(var w=[],C=[],E=0;E<this.gene2Info.length;++E){var S="",M=e.genes.get(this.gene2Info[E][0]);S+=M.geneName,"e"===this.gene2Info[E][1]?S+=" (exon "+this.gene2Info[E][2]+")":"i"===this.gene2Info[E][1]?S+=" (intron "+this.gene2Info[E][2]+")":"p"===this.gene2Info[E][1]&&(S+=" (5kbPromoter)"),w.push(S),M.cancerGene&&C.push(S)}n.push(w.join(",")),C.length>0?n.push(C.join(",")):n.push("NA")}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestGeneUpstream2Ids")){for(var k=[],B=0;B<this.nearestGeneUpstream2Ids.length;++B)k.push(""+e.genes.get(this.nearestGeneUpstream2Ids[B]).geneName);n.push(k.join(",")),n.push(this.nearestGeneUpstreamDistance2)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestCancerGeneUpstream2Ids")){for(var D=[],P=0;P<this.nearestCancerGeneUpstream2Ids.length;++P)D.push(""+e.genes.get(this.nearestCancerGeneUpstream2Ids[P]).geneName);n.push(D.join(",")),n.push(this.nearestCancerGeneUpstreamDistance2)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestGeneDownstream2Ids")){for(var Q=[],T=0;T<this.nearestGeneDownstream2Ids.length;++T)Q.push(""+e.genes.get(this.nearestGeneDownstream2Ids[T]).geneName);n.push(Q.join(",")),n.push(this.nearestGeneDownstreamDistance2)}else n.push("NA"),n.push("NA");if(this.hasOwnProperty("nearestCancerGeneDownstream2Ids")){for(var G=[],R=0;R<this.nearestCancerGeneDownstream2Ids.length;++R)G.push(""+e.genes.get(this.nearestCancerGeneDownstream2Ids[R]).geneName);n.push(G.join(",")),n.push(this.nearestCancerGeneDownstreamDistance2)}else n.push("NA"),n.push("NA");n.push(t.metadata[this.donorIndex].donor);for(var _=0;_<n.length;++_)void 0===n[_]&&(n[_]="NA");return n}}],[{key:"submitBlastSearch",value:function(e){return'<a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?QUERY='+e.replace("|","")+'&DATABASE=nt&PROGRAM=blastn&CMD=Put&FILTER=F" target="_blank" style="font-size: 10px; text-decoration: none">'+e+"</a>"}},{key:"getDbSuperLink",value:function(e){var t=(0,o.padSE)(e);return'<a href="http://bioinfo.au.tsinghua.edu.cn/dbsuper/details.php?se_id='+t+'" target="_blank">'+t+"</a>"}},{key:"generalHeaderExport",value:function(){return["chr1","start1","end1","chr2","start2","end2","eventScore","eventType","clonalityEstimate","source1","source2","overhang1","overhang2","cytoband1","cytoband2","fragileSites1","fragileSites2","dbSuperEntries1","dbSuperEntries2","gene1","cancerGene1","nearestGeneUpstream1","nearestGeneUpstreamDistance1","nearestcancerGeneUpstream1","nearestcancerGeneUpstreamDistance1","nearestGeneDownstream1","nearestGeneDownstreamDistance1","nearestcancerGeneDownstream1","nearestcancerGeneDownstreamDistance1","gene2","cancerGene2","nearestGeneUpstream2","nearestGeneUpstreamDistance2","nearestcancerGeneUpstream2","nearestcancerGeneUpstreamDistance2","nearestGeneDownstream2","nearestGeneDownstreamDistance2","nearestcancerGeneDownstream2","nearestcancerGeneDownstreamDistance2","vdjTargetEstimates","Donor"]}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantEntryIndel=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t.VariantEntryIndel=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indelIndex=parseInt(t.indelIndex),"CENSORED"!==t.pos&&(this.startChrIndex=parseInt(t.chrIndex),this.endChrIndex=this.startChrIndex,this.startPos=parseInt(t.pos),this.endPos=this.startPos),this.ref=t.ref,this.alt=t.alt,"."!==t.gene&&(this.geneIds=[],t.gene.split(",").forEach(function(e){var t=parseInt(e);n.genes.has(t)&&r.geneIds.push(t)})),t.hasOwnProperty("tadIndicesOffset0")&&"."!==t.tadIndicesOffset0&&(this.tadIndicesOffset0=[],t.tadIndicesOffset0.split(";").forEach(function(e){r.tadIndicesOffset0.push(parseInt(e))})),t.hasOwnProperty("tadIndicesOffset1")&&"."!==t.tadIndicesOffset1&&(this.tadIndicesOffset1=[],t.tadIndicesOffset1.split(";").forEach(function(e){r.tadIndicesOffset1.push(parseInt(e))})),t.hasOwnProperty("tadIndicesOffset2")&&"."!==t.tadIndicesOffset2&&(this.tadIndicesOffset2=[],t.tadIndicesOffset2.split(";").forEach(function(e){r.tadIndicesOffset2.push(parseInt(e))})),t.hasOwnProperty("tadIndicesOffset3")&&"."!==t.tadIndicesOffset3&&(this.tadIndicesOffset3=[],t.tadIndicesOffset3.split(";").forEach(function(e){r.tadIndicesOffset3.push(parseInt(e))})),this.clonality=1,this.eventTypeIndex=parseInt(t.smallVarType),this.eventTypeVizIndex=n.variantTypes[this.eventTypeIndex].variantVizTypeIndex,this.donorIndex=parseInt(t.donor)}return r(e,[{key:"getIndex",value:function(){return this.indelIndex}},{key:"setIndex",value:function(e){this.indelIndex=e}},{key:"annotate",value:function(e,t){var n="This is a "+this.ref+">"+this.alt+" "+e.variantTypes[this.eventTypeIndex].variantType+" in donor "+t.metadata[this.donorIndex].donor,r=""+(0,o.getGenomeBrowserLink)(this.startChrIndex+":"+this.startPos+"-"+this.endPos),i="The "+e.variantTypes[this.eventTypeIndex].variantType+" at "+r+" is intergenic,";if(this.hasOwnProperty("geneIds")&&this.geneIds.length>0){i="The "+e.variantTypes[this.eventTypeIndex].variantType+" at "+r+" is on ";for(var a=0;a<this.geneIds.length;++a)i+=""+e.genes.get(this.geneIds[a]).getGeneCardsLink(),a<this.geneIds.length-1&&(i+=", ")}var s="",l="",c="",A="",u=new Set;if(this.hasOwnProperty("tadIndicesOffset0")){for(var h=new Set,d=0;d<this.tadIndicesOffset0.length;++d)for(var f=0;f<e.tads[this.tadIndicesOffset0[d]].geneIndices.length;++f)h.add(e.tads[this.tadIndicesOffset0[d]].geneIndices[f]),u.add(e.tads[this.tadIndicesOffset0[d]].geneIndices[f]);if(0!==this.tadIndicesOffset0.length){s="The "+e.variantTypes[this.eventTypeIndex].variantType+" directly hits the TAD"+(this.tadIndicesOffset0.length>1?"s":"")+": ";for(var p=0;p<this.tadIndicesOffset0.length;++p)s+=e.tads[this.tadIndicesOffset0[p]].getGenomeBrowserLink(),p<this.tadIndicesOffset0.length-1&&(s+=", ");s+="<br />containing the genes:<br />";for(var g=Array.from(h).sort(),m=0;m<g.length;++m)s+=e.genes.get(g[m]).getGeneCardsLink(),m<g.length-1&&(s+=", ")}}if(this.hasOwnProperty("tadIndicesOffset1")){for(var v=new Set,y=0;y<this.tadIndicesOffset1.length;++y)for(var b=0;b<e.tads[this.tadIndicesOffset1[y]].geneIndices.length;++b)u.has(e.tads[this.tadIndicesOffset1[y]].geneIndices[b])||(u.add(e.tads[this.tadIndicesOffset1[y]].geneIndices[b]),v.add(e.tads[this.tadIndicesOffset1[y]].geneIndices[b]));if(0!==this.tadIndicesOffset1.length){l="The "+e.variantTypes[this.eventTypeIndex].variantType+" indirectly hits the TAD"+(this.tadIndicesOffset1.length>1?"s":"")+" up to 1 TAD away: ";for(var I=0;I<this.tadIndicesOffset1.length;++I)l+=e.tads[this.tadIndicesOffset1[I]].getGenomeBrowserLink(),I<this.tadIndicesOffset1.length-1&&(l+=", ");l+="<br />containing the genes:<br />";for(var x=Array.from(v).sort(),w=0;w<x.length;++w)l+=e.genes.get(x[w]).getGeneCardsLink(),w<x.length-1&&(l+=", ")}}if(this.hasOwnProperty("tadIndicesOffset2")){for(var C=new Set,E=0;E<this.tadIndicesOffset2.length;++E)for(var S=0;S<e.tads[this.tadIndicesOffset2[E]].geneIndices.length;++S)u.has(e.tads[this.tadIndicesOffset2[E]].geneIndices[S])||(u.add(e.tads[this.tadIndicesOffset2[E]].geneIndices[S]),C.add(e.tads[this.tadIndicesOffset2[E]].geneIndices[S]));if(0!==this.tadIndicesOffset2.length){c="The "+e.variantTypes[this.eventTypeIndex].variantType+" indirectly hits the TAD"+(this.tadIndicesOffset2.length>1?"s":"")+" up to 2 TADs away: ";for(var M=0;M<this.tadIndicesOffset2.length;++M)c+=e.tads[this.tadIndicesOffset2[M]].getGenomeBrowserLink(),M<this.tadIndicesOffset2.length-1&&(c+=", ");c+="<br />containing the genes:<br />";for(var k=Array.from(C).sort(),B=0;B<k.length;++B)c+=e.genes.get(k[B]).getGeneCardsLink(),B<k.length-1&&(c+=", ")}}if(this.hasOwnProperty("tadIndicesOffset3")){for(var D=new Set,P=0;P<this.tadIndicesOffset3.length;++P)for(var Q=0;Q<e.tads[this.tadIndicesOffset3[P]].geneIndices.length;++Q)u.has(e.tads[this.tadIndicesOffset3[P]].geneIndices[Q])||D.add(e.tads[this.tadIndicesOffset3[P]].geneIndices[Q]);if(0!==this.tadIndicesOffset3.length){A="The "+e.variantTypes[this.eventTypeIndex].variantType+" indirectly hits the TAD"+(this.tadIndicesOffset3.length>1?"s":"")+" up to 3 TADs away: ";for(var T=0;T<this.tadIndicesOffset3.length;++T)A+=e.tads[this.tadIndicesOffset3[T]].getGenomeBrowserLink(),T<this.tadIndicesOffset3.length-1&&(A+=", ");A+="<br />containing the genes:<br />";for(var G=Array.from(D).sort(),R=0;R<G.length;++R)A+=e.genes.get(G[R]).getGeneCardsLink(),R<G.length-1&&(A+=", ")}}return[n,i,""].concat([s,l,c,A]).join("<br />")}},{key:"textExport",value:function(e,t){var n=[e.chromosomes[this.startChrIndex].chromosomeName,this.startPos,this.ref,this.alt,e.variantTypes[this.eventTypeIndex].variantType];if(this.hasOwnProperty("geneIds")){for(var r=[],o=0;o<this.geneIds.length;++o)r.push(this.geneIds[o].geneName);n.push(r.join(","))}else n.push("NA");return n.push(t.metadata[this.donorIndex].donor),n}}],[{key:"generalHeaderExport",value:function(){return["chromosome","pos","REF","ALT","SNV Type","Genes","Donor"]}}]),e}()},function(e,t,n){"use strict";n.r(t);var r=Math.PI,o=2*r,i=o-1e-6;function a(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s(){return new a}a.prototype=s.prototype={constructor:a,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,o,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+o)+","+(this._y1=+i)},arcTo:function(e,t,n,o,i){e=+e,t=+t,n=+n,o=+o,i=+i;var a=this._x1,s=this._y1,l=n-e,c=o-t,A=a-e,u=s-t,h=A*A+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6)if(Math.abs(u*l-c*A)>1e-6&&i){var d=n-a,f=o-s,p=l*l+c*c,g=d*d+f*f,m=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((r-Math.acos((p+h-g)/(2*m*v)))/2),b=y/v,I=y/m;Math.abs(b-1)>1e-6&&(this._+="L"+(e+b*A)+","+(t+b*u)),this._+="A"+i+","+i+",0,0,"+ +(u*d>A*f)+","+(this._x1=e+I*l)+","+(this._y1=t+I*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t)},arc:function(e,t,n,a,s,l){e=+e,t=+t;var c=(n=+n)*Math.cos(a),A=n*Math.sin(a),u=e+c,h=t+A,d=1^l,f=l?a-s:s-a;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+h:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-h)>1e-6)&&(this._+="L"+u+","+h),n&&(f<0&&(f=f%o+o),f>i?this._+="A"+n+","+n+",0,1,"+d+","+(e-c)+","+(t-A)+"A"+n+","+n+",0,1,"+d+","+(this._x1=u)+","+(this._y1=h):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=r)+","+d+","+(this._x1=e+n*Math.cos(s))+","+(this._y1=t+n*Math.sin(s))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var l=s;n.d(t,"path",function(){return l})},function(e,t,n){"use strict";n.r(t);var r=Array.prototype.slice,o=function(e){return e},i=1,a=2,s=3,l=4,c=1e-6;function A(e){return"translate("+(e+.5)+",0)"}function u(e){return"translate(0,"+(e+.5)+")"}function h(){return!this.__axis}function d(e,t){var n=[],d=null,f=null,p=6,g=6,m=3,v=e===i||e===l?-1:1,y=e===l||e===a?"x":"y",b=e===i||e===s?A:u;function I(r){var A=null==d?t.ticks?t.ticks.apply(t,n):t.domain():d,u=null==f?t.tickFormat?t.tickFormat.apply(t,n):o:f,I=Math.max(p,0)+m,x=t.range(),w=+x[0]+.5,C=+x[x.length-1]+.5,E=(t.bandwidth?function(e){var t=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}:function(e){return function(t){return+e(t)}})(t.copy()),S=r.selection?r.selection():r,M=S.selectAll(".domain").data([null]),k=S.selectAll(".tick").data(A,t).order(),B=k.exit(),D=k.enter().append("g").attr("class","tick"),P=k.select("line"),Q=k.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),k=k.merge(D),P=P.merge(D.append("line").attr("stroke","#000").attr(y+"2",v*p)),Q=Q.merge(D.append("text").attr("fill","#000").attr(y,v*I).attr("dy",e===i?"0em":e===s?"0.71em":"0.32em")),r!==S&&(M=M.transition(r),k=k.transition(r),P=P.transition(r),Q=Q.transition(r),B=B.transition(r).attr("opacity",c).attr("transform",function(e){return isFinite(e=E(e))?b(e):this.getAttribute("transform")}),D.attr("opacity",c).attr("transform",function(e){var t=this.parentNode.__axis;return b(t&&isFinite(t=t(e))?t:E(e))})),B.remove(),M.attr("d",e===l||e==a?"M"+v*g+","+w+"H0.5V"+C+"H"+v*g:"M"+w+","+v*g+"V0.5H"+C+"V"+v*g),k.attr("opacity",1).attr("transform",function(e){return b(E(e))}),P.attr(y+"2",v*p),Q.attr(y,v*I).text(u),S.filter(h).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===a?"start":e===l?"end":"middle"),S.each(function(){this.__axis=E})}return I.scale=function(e){return arguments.length?(t=e,I):t},I.ticks=function(){return n=r.call(arguments),I},I.tickArguments=function(e){return arguments.length?(n=null==e?[]:r.call(e),I):n.slice()},I.tickValues=function(e){return arguments.length?(d=null==e?null:r.call(e),I):d&&d.slice()},I.tickFormat=function(e){return arguments.length?(f=e,I):f},I.tickSize=function(e){return arguments.length?(p=g=+e,I):p},I.tickSizeInner=function(e){return arguments.length?(p=+e,I):p},I.tickSizeOuter=function(e){return arguments.length?(g=+e,I):g},I.tickPadding=function(e){return arguments.length?(m=+e,I):m},I}function f(e){return d(i,e)}function p(e){return d(a,e)}function g(e){return d(s,e)}function m(e){return d(l,e)}n.d(t,"axisTop",function(){return f}),n.d(t,"axisRight",function(){return p}),n.d(t,"axisBottom",function(){return g}),n.d(t,"axisLeft",function(){return m})},function(e,t,n){"use strict";n.r(t);var r=n(2),o={value:function(){}};function i(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new a(r)}function a(e){this._=e}function s(e,t){for(var n,r=0,o=e.length;r<o;++r)if((n=e[r]).name===t)return n.value}function l(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=o,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}a.prototype=i.prototype={constructor:a,on:function(e,t){var n,r=this._,o=function(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(e+"",r),i=-1,a=o.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<a;)if(n=(e=o[i]).type)r[n]=l(r[n],e.name,t);else if(null==t)for(n in r)r[n]=l(r[n],e.name,null);return this}for(;++i<a;)if((n=(e=o[i]).type)&&(n=s(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new a(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,o)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],o=0,i=r.length;o<i;++o)r[o].value.apply(t,n)}};var c,A,u=i,h=0,d=0,f=0,p=1e3,g=0,m=0,v=0,y="object"==typeof performance&&performance.now?performance:Date,b="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function I(){return m||(b(x),m=y.now()+v)}function x(){m=0}function w(){this._call=this._time=this._next=null}function C(e,t,n){var r=new w;return r.restart(e,t,n),r}function E(){m=(g=y.now())+v,h=d=0;try{!function(){I(),++h;for(var e,t=c;t;)(e=m-t._time)>=0&&t._call.call(null,e),t=t._next;--h}()}finally{h=0,function(){for(var e,t,n=c,r=1/0;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:c=t);A=e,M(r)}(),m=0}}function S(){var e=y.now(),t=e-g;t>p&&(v-=t,g=e)}function M(e){h||(d&&(d=clearTimeout(d)),e-m>24?(e<1/0&&(d=setTimeout(E,e-y.now()-v)),f&&(f=clearInterval(f))):(f||(g=y.now(),f=setInterval(S,p)),h=1,b(E)))}w.prototype=C.prototype={constructor:w,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?I():+n)+(null==t?0:+t),this._next||A===this||(A?A._next=this:c=this,A=this),this._call=e,this._time=n,M()},stop:function(){this._call&&(this._call=null,this._time=1/0,M())}};var k=function(e,t,n){var r=new w;return t=null==t?0:+t,r.restart(function(n){r.stop(),e(n+t)},t,n),r},B=u("start","end","interrupt"),D=[],P=0,Q=1,T=2,G=3,R=4,_=5,V=6,N=function(e,t,n,r,o,i){var a=e.__transition;if(a){if(n in a)return}else e.__transition={};!function(e,t,n){var r,o=e.__transition;function i(l){var c,A,u,h;if(n.state!==Q)return s();for(c in o)if((h=o[c]).name===n.name){if(h.state===G)return k(i);h.state===R?(h.state=V,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[c]):+c<t&&(h.state=V,h.timer.stop(),delete o[c])}if(k(function(){n.state===G&&(n.state=R,n.timer.restart(a,n.delay,n.time),a(l))}),n.state=T,n.on.call("start",e,e.__data__,n.index,n.group),n.state===T){for(n.state=G,r=new Array(u=n.tween.length),c=0,A=-1;c<u;++c)(h=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++A]=h);r.length=A+1}}function a(t){for(var o=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=_,1),i=-1,a=r.length;++i<a;)r[i].call(null,o);n.state===_&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var r in n.state=V,n.timer.stop(),delete o[t],o)return;delete e.__transition}o[t]=n,n.timer=C(function(e){n.state=Q,n.timer.restart(i,n.delay,n.time),n.delay<=e&&i(e-n.delay)},0,n.time)}(e,n,{name:t,index:r,group:o,on:B,tween:D,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:P})};function F(e,t){var n=L(e,t);if(n.state>P)throw new Error("too late; already scheduled");return n}function O(e,t){var n=L(e,t);if(n.state>T)throw new Error("too late; already started");return n}function L(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var j=function(e,t){var n,r,o,i=e.__transition,a=!0;if(i){for(o in t=null==t?null:t+"",i)(n=i[o]).name===t?(r=n.state>T&&n.state<_,n.state=V,n.timer.stop(),r&&n.on.call("interrupt",e,e.__data__,n.index,n.group),delete i[o]):a=!1;a&&delete e.__transition}},z=n(4);function H(e,t,n){var r=e._id;return e.each(function(){var e=O(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return L(e,r).value[t]}}var U=n(3),Y=function(e,t){var n;return("number"==typeof t?z.b:t instanceof U.a?z.c:(n=Object(U.a)(t))?(t=n,z.c):z.e)(e,t)},X=r.selection.prototype.constructor,q=0;function K(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function Z(e){return Object(r.selection)().transition(e)}function W(){return++q}var J=r.selection.prototype;K.prototype=Z.prototype={constructor:K,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Object(r.selector)(e));for(var o=this._groups,i=o.length,a=new Array(i),s=0;s<i;++s)for(var l,c,A=o[s],u=A.length,h=a[s]=new Array(u),d=0;d<u;++d)(l=A[d])&&(c=e.call(l,l.__data__,d,A))&&("__data__"in l&&(c.__data__=l.__data__),h[d]=c,N(h[d],t,n,d,h,L(l,n)));return new K(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Object(r.selectorAll)(e));for(var o=this._groups,i=o.length,a=[],s=[],l=0;l<i;++l)for(var c,A=o[l],u=A.length,h=0;h<u;++h)if(c=A[h]){for(var d,f=e.call(c,c.__data__,h,A),p=L(c,n),g=0,m=f.length;g<m;++g)(d=f[g])&&N(d,t,n,g,f,p);a.push(f),s.push(c)}return new K(a,s,t,n)},filter:function(e){"function"!=typeof e&&(e=Object(r.matcher)(e));for(var t=this._groups,n=t.length,o=new Array(n),i=0;i<n;++i)for(var a,s=t[i],l=s.length,c=o[i]=[],A=0;A<l;++A)(a=s[A])&&e.call(a,a.__data__,A,s)&&c.push(a);return new K(o,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,o=n.length,i=Math.min(r,o),a=new Array(r),s=0;s<i;++s)for(var l,c=t[s],A=n[s],u=c.length,h=a[s]=new Array(u),d=0;d<u;++d)(l=c[d]||A[d])&&(h[d]=l);for(;s<r;++s)a[s]=t[s];return new K(a,this._parents,this._name,this._id)},selection:function(){return new X(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=W(),r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)if(a=s[c]){var A=L(a,t);N(a,e,n,c,s,{time:A.time+A.delay+A.duration,delay:0,duration:A.duration,ease:A.ease})}return new K(r,this._parents,e,n)},call:J.call,nodes:J.nodes,node:J.node,size:J.size,empty:J.empty,each:J.each,on:function(e,t){var n=this._id;return arguments.length<2?L(this.node(),n).on.on(e):this.each(function(e,t,n){var r,o,i=(t+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})?F:O;return function(){var a=i(this,e),s=a.on;s!==r&&(o=(r=s).copy()).on(t,n),a.on=o}}(n,e,t))},attr:function(e,t){var n=Object(r.namespace)(e),o="transform"===n?z.g:Y;return this.attrTween(e,"function"==typeof t?(n.local?function(e,t,n){var r,o,i;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttributeNS(e.space,e.local))===s?null:a===r&&s===o?i:i=t(r=a,o=s);this.removeAttributeNS(e.space,e.local)}}:function(e,t,n){var r,o,i;return function(){var a,s=n(this);if(null!=s)return(a=this.getAttribute(e))===s?null:a===r&&s===o?i:i=t(r=a,o=s);this.removeAttribute(e)}})(n,o,H(this,"attr."+e,t)):null==t?(n.local?function(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function(e){return function(){this.removeAttribute(e)}})(n):(n.local?function(e,t,n){var r,o;return function(){var i=this.getAttributeNS(e.space,e.local);return i===n?null:i===r?o:o=t(r=i,n)}}:function(e,t,n){var r,o;return function(){var i=this.getAttribute(e);return i===n?null:i===r?o:o=t(r=i,n)}})(n,o,t+""))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var o=Object(r.namespace)(e);return this.tween(n,(o.local?function(e,t){function n(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttributeNS(e.space,e.local,r(t))}}return n._value=t,n}:function(e,t){function n(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttribute(e,r(t))}}return n._value=t,n})(o,t))},style:function(e,t,n){var o="transform"==(e+="")?z.f:Y;return null==t?this.styleTween(e,function(e,t){var n,o,i;return function(){var a=Object(r.style)(this,e),s=(this.style.removeProperty(e),Object(r.style)(this,e));return a===s?null:a===n&&s===o?i:i=t(n=a,o=s)}}(e,o)).on("end.style."+e,function(e){return function(){this.style.removeProperty(e)}}(e)):this.styleTween(e,"function"==typeof t?function(e,t,n){var o,i,a;return function(){var s=Object(r.style)(this,e),l=n(this);return null==l&&(this.style.removeProperty(e),l=Object(r.style)(this,e)),s===l?null:s===o&&l===i?a:a=t(o=s,i=l)}}(e,o,H(this,"style."+e,t)):function(e,t,n){var o,i;return function(){var a=Object(r.style)(this,e);return a===n?null:a===o?i:i=t(o=a,n)}}(e,o,t+""),n)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function(e,t,n){function r(){var r=this,o=t.apply(r,arguments);return o&&function(t){r.style.setProperty(e,o(t),n)}}return r._value=t,r}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(H(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,o=L(this.node(),n).tween,i=0,a=o.length;i<a;++i)if((r=o[i]).name===e)return r.value;return null}return this.each((null==t?function(e,t){var n,r;return function(){var o=O(this,e),i=o.tween;if(i!==n)for(var a=0,s=(r=n=i).length;a<s;++a)if(r[a].name===t){(r=r.slice()).splice(a,1);break}o.tween=r}}:function(e,t,n){var r,o;if("function"!=typeof n)throw new Error;return function(){var i=O(this,e),a=i.tween;if(a!==r){o=(r=a).slice();for(var s={name:t,value:n},l=0,c=o.length;l<c;++l)if(o[l].name===t){o[l]=s;break}l===c&&o.push(s)}i.tween=o}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){F(this,e).delay=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){F(this,e).delay=t}})(t,e)):L(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function(e,t){return function(){O(this,e).duration=+t.apply(this,arguments)}}:function(e,t){return t=+t,function(){O(this,e).duration=t}})(t,e)):L(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!=typeof t)throw new Error;return function(){O(this,e).ease=t}}(t,e)):L(this.node(),t).ease}},function e(t){function n(e){return Math.pow(e,t)}return t=+t,n.exponent=e,n}(3),function e(t){function n(e){return 1-Math.pow(1-e,t)}return t=+t,n.exponent=e,n}(3),function e(t){function n(e){return((e*=2)<=1?Math.pow(e,t):2-Math.pow(2-e,t))/2}return t=+t,n.exponent=e,n}(3),Math.PI,function e(t){function n(e){return e*e*((t+1)*e-t)}return t=+t,n.overshoot=e,n}(1.70158),function e(t){function n(e){return--e*e*((t+1)*e+t)+1}return t=+t,n.overshoot=e,n}(1.70158),function e(t){function n(e){return((e*=2)<1?e*e*((t+1)*e-t):(e-=2)*e*((t+1)*e+t)+2)/2}return t=+t,n.overshoot=e,n}(1.70158);var $=2*Math.PI,ee=(function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=$);function o(e){return t*Math.pow(2,10*--e)*Math.sin((r-e)/n)}return o.amplitude=function(t){return e(t,n*$)},o.period=function(n){return e(t,n)},o}(1,.3),function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=$);function o(e){return 1-t*Math.pow(2,-10*(e=+e))*Math.sin((e+r)/n)}return o.amplitude=function(t){return e(t,n*$)},o.period=function(n){return e(t,n)},o}(1,.3),function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=$);function o(e){return((e=2*e-1)<0?t*Math.pow(2,10*e)*Math.sin((r-e)/n):2-t*Math.pow(2,-10*e)*Math.sin((r+e)/n))/2}return o.amplitude=function(t){return e(t,n*$)},o.period=function(n){return e(t,n)},o}(1,.3),{time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}});function te(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return ee.time=I(),ee;return n}r.selection.prototype.interrupt=function(e){return this.each(function(){j(this,e)})},r.selection.prototype.transition=function(e){var t,n;e instanceof K?(t=e._id,e=e._name):(t=W(),(n=ee).time=I(),e=null==e?null:e+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var a,s=r[i],l=s.length,c=0;c<l;++c)(a=s[c])&&N(a,e,t,c,s,n||te(a,t));return new K(r,this._parents,e,t)};var ne=[null],re=function(e,t){var n,r,o=e.__transition;if(o)for(r in t=null==t?null:t+"",o)if((n=o[r]).state>Q&&n.name===t)return new K([[e]],ne,t,+r);return null};n.d(t,"transition",function(){return Z}),n.d(t,"active",function(){return re}),n.d(t,"interrupt",function(){return j})},function(e,t,n){"use strict";n.r(t);var r=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},o=function(e){return 1===e.length&&(e=function(e){return function(t,n){return r(e(t),n)}}(e)),{left:function(t,n,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){var i=r+o>>>1;e(t[i],n)<0?r=i+1:o=i}return r},right:function(t,n,r,o){for(null==r&&(r=0),null==o&&(o=t.length);r<o;){var i=r+o>>>1;e(t[i],n)>0?o=i:r=i+1}return r}}},i=o(r),a=i.right,s=(i.left,a),l=function(e){return null===e?NaN:+e},c=Array.prototype,A=(c.slice,c.map,function(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var r=-1,o=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(o);++r<o;)i[r]=e+r*n;return i}),u=Math.sqrt(50),h=Math.sqrt(10),d=Math.sqrt(2),f=function(e,t,n){var r,o,i,a,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((r=t<e)&&(o=e,e=t,t=o),0===(a=p(e,t,n))||!isFinite(a))return[];if(a>0)for(e=Math.ceil(e/a),t=Math.floor(t/a),i=new Array(o=Math.ceil(t-e+1));++s<o;)i[s]=(e+s)*a;else for(e=Math.floor(e*a),t=Math.ceil(t*a),i=new Array(o=Math.ceil(e-t+1));++s<o;)i[s]=(e-s)/a;return r&&i.reverse(),i};function p(e,t,n){var r=(t-e)/Math.max(0,n),o=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,o);return o>=0?(i>=u?10:i>=h?5:i>=d?2:1)*Math.pow(10,o):-Math.pow(10,-o)/(i>=u?10:i>=h?5:i>=d?2:1)}function g(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),o=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/o;return i>=u?o*=10:i>=h?o*=5:i>=d&&(o*=2),t<e?-o:o}var m=function(e,t,n){if(null==n&&(n=l),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,o=(r-1)*t,i=Math.floor(o),a=+n(e[i],i,e);return a+(+n(e[i+1],i+1,e)-a)*(o-i)}};function v(){}function y(e,t){var n=new v;if(e instanceof v)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,o=-1,i=e.length;if(null==t)for(;++o<i;)n.set(o,e[o]);else for(;++o<i;)n.set(t(r=e[o],o,e),r)}else if(e)for(var a in e)n.set(a,e[a]);return n}v.prototype=y.prototype={constructor:v,has:function(e){return"$"+e in this},get:function(e){return this["$"+e]},set:function(e,t){return this["$"+e]=t,this},remove:function(e){var t="$"+e;return t in this&&delete this[t]},clear:function(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)"$"===t[0]&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)"$"===t[0]&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)"$"===t[0]&&++e;return e},empty:function(){for(var e in this)if("$"===e[0])return!1;return!0},each:function(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var b=y;function I(){}var x=b.prototype;I.prototype=function(e,t){var n=new I;if(e instanceof I)e.each(function(e){n.add(e)});else if(e){var r=-1,o=e.length;if(null==t)for(;++r<o;)n.add(e[r]);else for(;++r<o;)n.add(t(e[r],r,e))}return n}.prototype={constructor:I,has:x.has,add:function(e){return this["$"+(e+="")]=e,this},remove:x.remove,clear:x.clear,values:x.keys,size:x.size,empty:x.empty,each:x.each};var w=Array.prototype,C=w.map,E=w.slice,S={name:"implicit"};function M(e){var t=b(),n=[],r=S;function o(o){var i=o+"",a=t.get(i);if(!a){if(r!==S)return r;t.set(i,a=n.push(o))}return e[(a-1)%e.length]}return e=null==e?[]:E.call(e),o.domain=function(e){if(!arguments.length)return n.slice();n=[],t=b();for(var r,i,a=-1,s=e.length;++a<s;)t.has(i=(r=e[a])+"")||t.set(i,n.push(r));return o},o.range=function(t){return arguments.length?(e=E.call(t),o):e.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return M().domain(n).range(e).unknown(r)},o}function k(){var e,t,n=M().unknown(void 0),r=n.domain,o=n.range,i=[0,1],a=!1,s=0,l=0,c=.5;function u(){var n=r().length,u=i[1]<i[0],h=i[u-0],d=i[1-u];e=(d-h)/Math.max(1,n-s+2*l),a&&(e=Math.floor(e)),h+=(d-h-e*(n-s))*c,t=e*(1-s),a&&(h=Math.round(h),t=Math.round(t));var f=A(n).map(function(t){return h+e*t});return o(u?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),u()):r()},n.range=function(e){return arguments.length?(i=[+e[0],+e[1]],u()):i.slice()},n.rangeRound=function(e){return i=[+e[0],+e[1]],a=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(a=!!e,u()):a},n.padding=function(e){return arguments.length?(s=l=Math.max(0,Math.min(1,e)),u()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),u()):s},n.paddingOuter=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),u()):l},n.align=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),u()):c},n.copy=function(){return k().domain(r()).range(i).round(a).paddingInner(s).paddingOuter(l).align(c)},u()}function B(){return function e(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return e(n())},t}(k().paddingInner(1))}var D=n(4),P=function(e){return function(){return e}},Q=function(e){return+e},T=[0,1];function G(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:P(t)}function R(e,t,n,r){var o=e[0],i=e[1],a=t[0],s=t[1];return i<o?(o=n(i,o),a=r(s,a)):(o=n(o,i),a=r(a,s)),function(e){return a(o(e))}}function _(e,t,n,r){var o=Math.min(e.length,t.length)-1,i=new Array(o),a=new Array(o),l=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<o;)i[l]=n(e[l],e[l+1]),a[l]=r(t[l],t[l+1]);return function(t){var n=s(e,t,1,o)-1;return a[n](i[n](t))}}function V(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function N(e,t){var n,r,o,i=T,a=T,s=D.a,l=!1;function c(){return n=Math.min(i.length,a.length)>2?_:R,r=o=null,A}function A(t){return(r||(r=n(i,a,l?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:r(e)}}}(e):e,s)))(+t)}return A.invert=function(e){return(o||(o=n(a,i,G,l?function(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=0?t:e>=1?n:r(e)}}}(t):t)))(+e)},A.domain=function(e){return arguments.length?(i=C.call(e,Q),c()):i.slice()},A.range=function(e){return arguments.length?(a=E.call(e),c()):a.slice()},A.rangeRound=function(e){return a=E.call(e),s=D.d,c()},A.clamp=function(e){return arguments.length?(l=!!e,c()):l},A.interpolate=function(e){return arguments.length?(s=e,c()):s},c()}var F=n(12),O=function(e,t,n){var r,o=e[0],i=e[e.length-1],a=g(o,i,null==t?10:t);switch((n=Object(F.formatSpecifier)(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(o),Math.abs(i));return null!=n.precision||isNaN(r=Object(F.precisionPrefix)(a,s))||(n.precision=r),Object(F.formatPrefix)(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=Object(F.precisionRound)(a,Math.max(Math.abs(o),Math.abs(i))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=Object(F.precisionFixed)(a))||(n.precision=r-2*("%"===n.type))}return Object(F.format)(n)};function L(e){var t=e.domain;return e.ticks=function(e){var n=t();return f(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return O(t(),e,n)},e.nice=function(n){null==n&&(n=10);var r,o=t(),i=0,a=o.length-1,s=o[i],l=o[a];return l<s&&(r=s,s=l,l=r,r=i,i=a,a=r),(r=p(s,l,n))>0?r=p(s=Math.floor(s/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=p(s=Math.ceil(s*r)/r,l=Math.floor(l*r)/r,n)),r>0?(o[i]=Math.floor(s/r)*r,o[a]=Math.ceil(l/r)*r,t(o)):r<0&&(o[i]=Math.ceil(s*r)/r,o[a]=Math.floor(l*r)/r,t(o)),e},e}function j(){var e=N(G,D.b);return e.copy=function(){return V(e,j())},L(e)}function z(){var e=[0,1];function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=C.call(n,Q),t):e.slice()},t.copy=function(){return z().domain(e)},L(t)}var H=function(e,t){var n,r=0,o=(e=e.slice()).length-1,i=e[r],a=e[o];return a<i&&(n=r,r=o,o=n,n=i,i=a,a=n),e[r]=t.floor(i),e[o]=t.ceil(a),e};function U(e,t){return(t=Math.log(t/e))?function(n){return Math.log(n/e)/t}:P(t)}function Y(e,t){return e<0?function(n){return-Math.pow(-t,n)*Math.pow(-e,1-n)}:function(n){return Math.pow(t,n)*Math.pow(e,1-n)}}function X(e){return isFinite(e)?+("1e"+e):e<0?0:e}function q(e){return 10===e?X:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function K(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function Z(e){return function(t){return-e(-t)}}function W(){var e=N(U,Y).domain([1,10]),t=e.domain,n=10,r=K(10),o=q(10);function i(){return r=K(n),o=q(n),t()[0]<0&&(r=Z(r),o=Z(o)),e}return e.base=function(e){return arguments.length?(n=+e,i()):n},e.domain=function(e){return arguments.length?(t(e),i()):t()},e.ticks=function(e){var i,a=t(),s=a[0],l=a[a.length-1];(i=l<s)&&(h=s,s=l,l=h);var c,A,u,h=r(s),d=r(l),p=null==e?10:+e,g=[];if(!(n%1)&&d-h<p){if(h=Math.round(h)-1,d=Math.round(d)+1,s>0){for(;h<d;++h)for(A=1,c=o(h);A<n;++A)if(!((u=c*A)<s)){if(u>l)break;g.push(u)}}else for(;h<d;++h)for(A=n-1,c=o(h);A>=1;--A)if(!((u=c*A)<s)){if(u>l)break;g.push(u)}}else g=f(h,d,Math.min(d-h,p)).map(o);return i?g.reverse():g},e.tickFormat=function(t,i){if(null==i&&(i=10===n?".0e":","),"function"!=typeof i&&(i=Object(F.format)(i)),t===1/0)return i;null==t&&(t=10);var a=Math.max(1,n*t/e.ticks().length);return function(e){var t=e/o(Math.round(r(e)));return t*n<n-.5&&(t*=n),t<=a?i(e):""}},e.nice=function(){return t(H(t(),{floor:function(e){return o(Math.floor(r(e)))},ceil:function(e){return o(Math.ceil(r(e)))}}))},e.copy=function(){return V(e,W().base(n))},e}function J(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)}function $(){var e=1,t=N(function(t,n){return(n=J(n,e)-(t=J(t,e)))?function(r){return(J(r,e)-t)/n}:P(n)},function(t,n){return n=J(n,e)-(t=J(t,e)),function(r){return J(t+n*r,1/e)}}),n=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,n(n())):e},t.copy=function(){return V(t,$().exponent(e))},L(t)}function ee(){return $().exponent(.5)}function te(){var e=[],t=[],n=[];function o(){var r=0,o=Math.max(1,t.length);for(n=new Array(o-1);++r<o;)n[r-1]=m(e,r/o);return i}function i(e){if(!isNaN(e=+e))return t[s(n,e)]}return i.invertExtent=function(r){var o=t.indexOf(r);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},i.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,i=0,a=t.length;i<a;++i)null==(n=t[i])||isNaN(n=+n)||e.push(n);return e.sort(r),o()},i.range=function(e){return arguments.length?(t=E.call(e),o()):t.slice()},i.quantiles=function(){return n.slice()},i.copy=function(){return te().domain(e).range(t)},i}function ne(){var e=0,t=1,n=1,r=[.5],o=[0,1];function i(e){if(e<=e)return o[s(r,e,0,n)]}function a(){var o=-1;for(r=new Array(n);++o<n;)r[o]=((o+1)*t-(o-n)*e)/(n+1);return i}return i.domain=function(n){return arguments.length?(e=+n[0],t=+n[1],a()):[e,t]},i.range=function(e){return arguments.length?(n=(o=E.call(e)).length-1,a()):o.slice()},i.invertExtent=function(i){var a=o.indexOf(i);return a<0?[NaN,NaN]:a<1?[e,r[0]]:a>=n?[r[n-1],t]:[r[a-1],r[a]]},i.copy=function(){return ne().domain([e,t]).range(o)},L(i)}function re(){var e=[.5],t=[0,1],n=1;function r(r){if(r<=r)return t[s(e,r,0,n)]}return r.domain=function(o){return arguments.length?(e=E.call(o),n=Math.min(e.length,t.length-1),r):e.slice()},r.range=function(o){return arguments.length?(t=E.call(o),n=Math.min(e.length,t.length-1),r):t.slice()},r.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]},r.copy=function(){return re().domain(e).range(t)},r}var oe=new Date,ie=new Date;function ae(e,t,n,r){function o(t){return e(t=new Date(+t)),t}return o.floor=o,o.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},o.round=function(e){var t=o(e),n=o.ceil(e);return e-t<n-e?t:n},o.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},o.range=function(n,r,i){var a,s=[];if(n=o.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return s;do{s.push(a=new Date(+n)),t(n,i),e(n)}while(a<n&&n<r);return s},o.filter=function(n){return ae(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(o.count=function(t,r){return oe.setTime(+t),ie.setTime(+r),e(oe),e(ie),Math.floor(n(oe,ie))},o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?o.filter(r?function(t){return r(t)%e==0}:function(t){return o.count(0,t)%e==0}):o:null}),o}var se=ae(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});se.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?ae(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):se:null};var le=se,ce=(se.range,6e4),Ae=6048e5,ue=ae(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),he=ue,de=(ue.range,ae(function(e){e.setTime(Math.floor(e/ce)*ce)},function(e,t){e.setTime(+e+t*ce)},function(e,t){return(t-e)/ce},function(e){return e.getMinutes()})),fe=de,pe=(de.range,ae(function(e){var t=e.getTimezoneOffset()*ce%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()})),ge=pe,me=(pe.range,ae(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ce)/864e5},function(e){return e.getDate()-1})),ve=me;function ye(e){return ae(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ce)/Ae})}me.range;var be=ye(0),Ie=ye(1),xe=ye(2),we=ye(3),Ce=ye(4),Ee=ye(5),Se=ye(6),Me=(be.range,Ie.range,xe.range,we.range,Ce.range,Ee.range,Se.range,ae(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),ke=Me,Be=(Me.range,ae(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));Be.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ae(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var De=Be,Pe=(Be.range,ae(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*ce)},function(e,t){return(t-e)/ce},function(e){return e.getUTCMinutes()})),Qe=Pe,Te=(Pe.range,ae(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),Ge=Te,Re=(Te.range,ae(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1})),_e=Re;function Ve(e){return ae(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Ae})}Re.range;var Ne=Ve(0),Fe=Ve(1),Oe=Ve(2),Le=Ve(3),je=Ve(4),ze=Ve(5),He=Ve(6),Ue=(Ne.range,Fe.range,Oe.range,Le.range,je.range,ze.range,He.range,ae(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),Ye=Ue,Xe=(Ue.range,ae(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));Xe.every=function(e){return isFinite(e=Math.floor(e))&&e>0?ae(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var qe=Xe;function Ke(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ze(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function We(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}Xe.range;var Je,$e,et,tt,nt={"-":"",_:" ",0:"0"},rt=/^\s*\d+/,ot=/^%/,it=/[\\^$*+?|[\]().{}]/g;function at(e,t,n){var r=e<0?"-":"",o=(r?-e:e)+"",i=o.length;return r+(i<n?new Array(n-i+1).join(t)+o:o)}function st(e){return e.replace(it,"\\$&")}function lt(e){return new RegExp("^(?:"+e.map(st).join("|")+")","i")}function ct(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function At(e,t,n){var r=rt.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function ut(e,t,n){var r=rt.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function ht(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function dt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function ft(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function pt(e,t,n){var r=rt.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function gt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function mt(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function vt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function yt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function bt(e,t,n){var r=rt.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function It(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function xt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function wt(e,t,n){var r=rt.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Ct(e,t,n){var r=rt.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Et(e,t,n){var r=rt.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function St(e,t,n){var r=ot.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Mt(e,t,n){var r=rt.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function kt(e,t,n){var r=rt.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function Bt(e,t){return at(e.getDate(),t,2)}function Dt(e,t){return at(e.getHours(),t,2)}function Pt(e,t){return at(e.getHours()%12||12,t,2)}function Qt(e,t){return at(1+ve.count(De(e),e),t,3)}function Tt(e,t){return at(e.getMilliseconds(),t,3)}function Gt(e,t){return Tt(e,t)+"000"}function Rt(e,t){return at(e.getMonth()+1,t,2)}function _t(e,t){return at(e.getMinutes(),t,2)}function Vt(e,t){return at(e.getSeconds(),t,2)}function Nt(e){var t=e.getDay();return 0===t?7:t}function Ft(e,t){return at(be.count(De(e),e),t,2)}function Ot(e,t){var n=e.getDay();return e=n>=4||0===n?Ce(e):Ce.ceil(e),at(Ce.count(De(e),e)+(4===De(e).getDay()),t,2)}function Lt(e){return e.getDay()}function jt(e,t){return at(Ie.count(De(e),e),t,2)}function zt(e,t){return at(e.getFullYear()%100,t,2)}function Ht(e,t){return at(e.getFullYear()%1e4,t,4)}function Ut(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+at(t/60|0,"0",2)+at(t%60,"0",2)}function Yt(e,t){return at(e.getUTCDate(),t,2)}function Xt(e,t){return at(e.getUTCHours(),t,2)}function qt(e,t){return at(e.getUTCHours()%12||12,t,2)}function Kt(e,t){return at(1+_e.count(qe(e),e),t,3)}function Zt(e,t){return at(e.getUTCMilliseconds(),t,3)}function Wt(e,t){return Zt(e,t)+"000"}function Jt(e,t){return at(e.getUTCMonth()+1,t,2)}function $t(e,t){return at(e.getUTCMinutes(),t,2)}function en(e,t){return at(e.getUTCSeconds(),t,2)}function tn(e){var t=e.getUTCDay();return 0===t?7:t}function nn(e,t){return at(Ne.count(qe(e),e),t,2)}function rn(e,t){var n=e.getUTCDay();return e=n>=4||0===n?je(e):je.ceil(e),at(je.count(qe(e),e)+(4===qe(e).getUTCDay()),t,2)}function on(e){return e.getUTCDay()}function an(e,t){return at(Fe.count(qe(e),e),t,2)}function sn(e,t){return at(e.getUTCFullYear()%100,t,2)}function ln(e,t){return at(e.getUTCFullYear()%1e4,t,4)}function cn(){return"+0000"}function An(){return"%"}function un(e){return+e}function hn(e){return Math.floor(+e/1e3)}Je=function(e){var t=e.dateTime,n=e.date,r=e.time,o=e.periods,i=e.days,a=e.shortDays,s=e.months,l=e.shortMonths,c=lt(o),A=ct(o),u=lt(i),h=ct(i),d=lt(a),f=ct(a),p=lt(s),g=ct(s),m=lt(l),v=ct(l),y={a:function(e){return a[e.getDay()]},A:function(e){return i[e.getDay()]},b:function(e){return l[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:Bt,e:Bt,f:Gt,H:Dt,I:Pt,j:Qt,L:Tt,m:Rt,M:_t,p:function(e){return o[+(e.getHours()>=12)]},Q:un,s:hn,S:Vt,u:Nt,U:Ft,V:Ot,w:Lt,W:jt,x:null,X:null,y:zt,Y:Ht,Z:Ut,"%":An},b={a:function(e){return a[e.getUTCDay()]},A:function(e){return i[e.getUTCDay()]},b:function(e){return l[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Yt,e:Yt,f:Wt,H:Xt,I:qt,j:Kt,L:Zt,m:Jt,M:$t,p:function(e){return o[+(e.getUTCHours()>=12)]},Q:un,s:hn,S:en,u:tn,U:nn,V:rn,w:on,W:an,x:null,X:null,y:sn,Y:ln,Z:cn,"%":An},I={a:function(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=f[r[0].toLowerCase()],n+r[0].length):-1},A:function(e,t,n){var r=u.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.m=v[r[0].toLowerCase()],n+r[0].length):-1},B:function(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(e,n,r){return C(e,t,n,r)},d:yt,e:yt,f:Et,H:It,I:It,j:bt,L:Ct,m:vt,M:xt,p:function(e,t,n){var r=c.exec(t.slice(n));return r?(e.p=A[r[0].toLowerCase()],n+r[0].length):-1},Q:Mt,s:kt,S:wt,u:ut,U:ht,V:dt,w:At,W:ft,x:function(e,t,r){return C(e,n,t,r)},X:function(e,t,n){return C(e,r,t,n)},y:gt,Y:pt,Z:mt,"%":St};function x(e,t){return function(n){var r,o,i,a=[],s=-1,l=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++s<c;)37===e.charCodeAt(s)&&(a.push(e.slice(l,s)),null!=(o=nt[r=e.charAt(++s)])?r=e.charAt(++s):o="e"===r?" ":"0",(i=t[r])&&(r=i(n,o)),a.push(r),l=s+1);return a.push(e.slice(l,s)),a.join("")}}function w(e,t){return function(n){var r,o,i=We(1900);if(C(i,e,n+="",0)!=n.length)return null;if("Q"in i)return new Date(i.Q);if("p"in i&&(i.H=i.H%12+12*i.p),"V"in i){if(i.V<1||i.V>53)return null;"w"in i||(i.w=1),"Z"in i?(r=(o=(r=Ze(We(i.y))).getUTCDay())>4||0===o?Fe.ceil(r):Fe(r),r=_e.offset(r,7*(i.V-1)),i.y=r.getUTCFullYear(),i.m=r.getUTCMonth(),i.d=r.getUTCDate()+(i.w+6)%7):(r=(o=(r=t(We(i.y))).getDay())>4||0===o?Ie.ceil(r):Ie(r),r=ve.offset(r,7*(i.V-1)),i.y=r.getFullYear(),i.m=r.getMonth(),i.d=r.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),o="Z"in i?Ze(We(i.y)).getUTCDay():t(We(i.y)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(o+5)%7:i.w+7*i.U-(o+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Ze(i)):t(i)}}function C(e,t,n,r){for(var o,i,a=0,s=t.length,l=n.length;a<s;){if(r>=l)return-1;if(37===(o=t.charCodeAt(a++))){if(o=t.charAt(a++),!(i=I[o in nt?t.charAt(a++):o])||(r=i(e,n,r))<0)return-1}else if(o!=n.charCodeAt(r++))return-1}return r}return y.x=x(n,y),y.X=x(r,y),y.c=x(t,y),b.x=x(n,b),b.X=x(r,b),b.c=x(t,b),{format:function(e){var t=x(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=w(e+="",Ke);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=w(e,Ze);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),$e=Je.format,Je.parse,et=Je.utcFormat,tt=Je.utcParse,Date.prototype.toISOString||et("%Y-%m-%dT%H:%M:%S.%LZ"),+new Date("2000-01-01T00:00:00.000Z")||tt("%Y-%m-%dT%H:%M:%S.%LZ");var dn=1e3,fn=60*dn,pn=60*fn,gn=24*pn,mn=7*gn,vn=30*gn,yn=365*gn;function bn(e){return new Date(e)}function In(e){return e instanceof Date?+e:+new Date(+e)}function xn(e,t,n,r,i,a,s,l,c){var A=N(G,D.b),u=A.invert,h=A.domain,d=c(".%L"),f=c(":%S"),p=c("%I:%M"),m=c("%I %p"),v=c("%a %d"),y=c("%b %d"),b=c("%B"),I=c("%Y"),x=[[s,1,dn],[s,5,5*dn],[s,15,15*dn],[s,30,30*dn],[a,1,fn],[a,5,5*fn],[a,15,15*fn],[a,30,30*fn],[i,1,pn],[i,3,3*pn],[i,6,6*pn],[i,12,12*pn],[r,1,gn],[r,2,2*gn],[n,1,mn],[t,1,vn],[t,3,3*vn],[e,1,yn]];function w(o){return(s(o)<o?d:a(o)<o?f:i(o)<o?p:r(o)<o?m:t(o)<o?n(o)<o?v:y:e(o)<o?b:I)(o)}function E(t,n,r,i){if(null==t&&(t=10),"number"==typeof t){var a=Math.abs(r-n)/t,s=o(function(e){return e[2]}).right(x,a);s===x.length?(i=g(n/yn,r/yn,t),t=e):s?(i=(s=x[a/x[s-1][2]<x[s][2]/a?s-1:s])[1],t=s[0]):(i=Math.max(g(n,r,t),1),t=l)}return null==i?t:t.every(i)}return A.invert=function(e){return new Date(u(e))},A.domain=function(e){return arguments.length?h(C.call(e,In)):h().map(bn)},A.ticks=function(e,t){var n,r=h(),o=r[0],i=r[r.length-1],a=i<o;return a&&(n=o,o=i,i=n),n=(n=E(e,o,i,t))?n.range(o,i+1):[],a?n.reverse():n},A.tickFormat=function(e,t){return null==t?w:c(t)},A.nice=function(e,t){var n=h();return(e=E(e,n[0],n[n.length-1],t))?h(H(n,e)):A},A.copy=function(){return V(A,xn(e,t,n,r,i,a,s,l,c))},A}var wn=function(){return xn(De,ke,be,ve,ge,fe,he,le,$e).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},Cn=function(){return xn(qe,Ye,Ne,_e,Ge,Qe,he,le,et).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])};function En(e){var t=0,n=1,r=1,o=!1;function i(n){var i=(n-t)*r;return e(o?Math.max(0,Math.min(1,i)):i)}return i.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],r=t===n?0:1/(n-t),i):[t,n]},i.clamp=function(e){return arguments.length?(o=!!e,i):o},i.interpolator=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return En(e).domain([t,n]).clamp(o)},L(i)}function Sn(e){var t=0,n=.5,r=1,o=1,i=1,a=!1;function s(t){var r=.5+((t=+t)-n)*(t<n?o:i);return e(a?Math.max(0,Math.min(1,r)):r)}return s.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],r=+e[2],o=t===n?0:.5/(n-t),i=n===r?0:.5/(r-n),s):[t,n,r]},s.clamp=function(e){return arguments.length?(a=!!e,s):a},s.interpolator=function(t){return arguments.length?(e=t,s):e},s.copy=function(){return Sn(e).domain([t,n,r]).clamp(a)},L(s)}n.d(t,"scaleBand",function(){return k}),n.d(t,"scalePoint",function(){return B}),n.d(t,"scaleIdentity",function(){return z}),n.d(t,"scaleLinear",function(){return j}),n.d(t,"scaleLog",function(){return W}),n.d(t,"scaleOrdinal",function(){return M}),n.d(t,"scaleImplicit",function(){return S}),n.d(t,"scalePow",function(){return $}),n.d(t,"scaleSqrt",function(){return ee}),n.d(t,"scaleQuantile",function(){return te}),n.d(t,"scaleQuantize",function(){return ne}),n.d(t,"scaleThreshold",function(){return re}),n.d(t,"scaleTime",function(){return wn}),n.d(t,"scaleUtc",function(){return Cn}),n.d(t,"scaleSequential",function(){return En}),n.d(t,"scaleDiverging",function(){return Sn})},,function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantTypeEntry=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.variantTypeIndex=t.variantTypeIndex,this.variantType=t.variantType,this.colourId=parseInt(t.colourId),this.locationInPhenotypePlots=parseInt(t.locationInPhenotypePlots),this.superGroupName=t.superGroupName,this.uniqueLoc=parseInt(t.uniqueLoc),this.variantVizTypeIndex=parseInt(t.variantVizTypeIndex)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReactomeEntry=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reactomePathwayId=parseInt(t.reactomePathwayId),this.reactomePathwayName=t.reactomePathwayName}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.FragileSiteEntry=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fragileSiteIndex=parseInt(t.fragileSiteIndex),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.startPos=parseInt(t.startPos),this.endPos=parseInt(t.endPos),this.fragileSiteNames=t.fragileSiteNames.split(",")}return r(e,[{key:"getGeneCardsLink",value:function(){for(var e="",t=0;t<this.fragileSiteNames.length;++t)e+='<a href="https://www.genecards.org/cgi-bin/carddisp.pl?gene='+this.fragileSiteNames[t]+'#aliases_descriptions" target="_blank">'+this.fragileSiteNames[t]+"</a>",t<this.fragileSiteNames.length-1&&(e+=", ");return e}}]),e}()},,function(e,t,n){},function(e,t){!function(){var t=function(e,n){var r=this;this.isOpened=!1,this.input=o(e),this.input.setAttribute("autocomplete","off"),this.input.setAttribute("aria-autocomplete","list"),n=n||{},function(e,t,n){for(var r in t){var o=t[r],i=e.input.getAttribute("data-"+r.toLowerCase());"number"==typeof o?e[r]=parseInt(i):!1===o?e[r]=null!==i:o instanceof Function?e[r]=null:e[r]=i,e[r]||0===e[r]||(e[r]=r in n?n[r]:o)}}(this,{minChars:2,maxItems:10,autoFirst:!1,data:t.DATA,filter:t.FILTER_CONTAINS,sort:!1!==n.sort&&t.SORT_BYLENGTH,item:t.ITEM,replace:t.REPLACE},n),this.index=-1,this.container=o.create("div",{className:"awesomplete",around:e}),this.ul=o.create("ul",{hidden:"hidden",inside:this.container}),this.status=o.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container}),this._events={input:{input:this.evaluate.bind(this),blur:this.close.bind(this,{reason:"blur"}),keydown:function(e){var t=e.keyCode;r.opened&&(13===t&&r.selected?(e.preventDefault(),r.select()):27===t?r.close({reason:"esc"}):38!==t&&40!==t||(e.preventDefault(),r[38===t?"previous":"next"]()))}},form:{submit:this.close.bind(this,{reason:"submit"})},ul:{mousedown:function(e){var t=e.target;if(t!==this){for(;t&&!/li/i.test(t.nodeName);)t=t.parentNode;t&&0===e.button&&(e.preventDefault(),r.select(t,e.target))}}}},o.bind(this.input,this._events.input),o.bind(this.input.form,this._events.form),o.bind(this.ul,this._events.ul),this.input.hasAttribute("list")?(this.list="#"+this.input.getAttribute("list"),this.input.removeAttribute("list")):this.list=this.input.getAttribute("data-list")||n.list||[],t.all.push(this)};function n(e){var t=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};this.label=t.label||t.value,this.value=t.value}t.prototype={set list(e){if(Array.isArray(e))this._list=e;else if("string"==typeof e&&e.indexOf(",")>-1)this._list=e.split(/\s*,\s*/);else if((e=o(e))&&e.children){var t=[];r.apply(e.children).forEach(function(e){if(!e.disabled){var n=e.textContent.trim(),r=e.value||n,o=e.label||n;""!==r&&t.push({label:o,value:r})}}),this._list=t}document.activeElement===this.input&&this.evaluate()},get selected(){return this.index>-1},get opened(){return this.isOpened},close:function(e){this.opened&&(this.ul.setAttribute("hidden",""),this.isOpened=!1,this.index=-1,o.fire(this.input,"awesomplete-close",e||{}))},open:function(){this.ul.removeAttribute("hidden"),this.isOpened=!0,this.autoFirst&&-1===this.index&&this.goto(0),o.fire(this.input,"awesomplete-open")},destroy:function(){o.unbind(this.input,this._events.input),o.unbind(this.input.form,this._events.form);var e=this.container.parentNode;e.insertBefore(this.input,this.container),e.removeChild(this.container),this.input.removeAttribute("autocomplete"),this.input.removeAttribute("aria-autocomplete");var n=t.all.indexOf(this);-1!==n&&t.all.splice(n,1)},next:function(){var e=this.ul.children.length;this.goto(this.index<e-1?this.index+1:e?0:-1)},previous:function(){var e=this.ul.children.length,t=this.index-1;this.goto(this.selected&&-1!==t?t:e-1)},goto:function(e){var t=this.ul.children;this.selected&&t[this.index].setAttribute("aria-selected","false"),this.index=e,e>-1&&t.length>0&&(t[e].setAttribute("aria-selected","true"),this.status.textContent=t[e].textContent,this.ul.scrollTop=t[e].offsetTop-this.ul.clientHeight+t[e].clientHeight,o.fire(this.input,"awesomplete-highlight",{text:this.suggestions[this.index]}))},select:function(e,t){if(e?this.index=o.siblingIndex(e):e=this.ul.children[this.index],e){var n=this.suggestions[this.index];o.fire(this.input,"awesomplete-select",{text:n,origin:t||e})&&(this.replace(n),this.close({reason:"select"}),o.fire(this.input,"awesomplete-selectcomplete",{text:n}))}},evaluate:function(){var e=this,t=this.input.value;t.length>=this.minChars&&this._list.length>0?(this.index=-1,this.ul.innerHTML="",this.suggestions=this._list.map(function(r){return new n(e.data(r,t))}).filter(function(n){return e.filter(n,t)}),!1!==this.sort&&(this.suggestions=this.suggestions.sort(this.sort)),this.suggestions=this.suggestions.slice(0,this.maxItems),this.suggestions.forEach(function(n){e.ul.appendChild(e.item(n,t))}),0===this.ul.children.length?this.close({reason:"nomatches"}):this.open()):this.close({reason:"nomatches"})}},t.all=[],t.FILTER_CONTAINS=function(e,t){return RegExp(o.regExpEscape(t.trim()),"i").test(e)},t.FILTER_STARTSWITH=function(e,t){return RegExp("^"+o.regExpEscape(t.trim()),"i").test(e)},t.SORT_BYLENGTH=function(e,t){return e.length!==t.length?e.length-t.length:e<t?-1:1},t.ITEM=function(e,t){var n=""===t.trim()?e:e.replace(RegExp(o.regExpEscape(t.trim()),"gi"),"<mark>$&</mark>");return o.create("li",{innerHTML:n,"aria-selected":"false"})},t.REPLACE=function(e){this.input.value=e.value},t.DATA=function(e){return e},Object.defineProperty(n.prototype=Object.create(String.prototype),"length",{get:function(){return this.label.length}}),n.prototype.toString=n.prototype.valueOf=function(){return""+this.label};var r=Array.prototype.slice;function o(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function i(e,t){return r.call((t||document).querySelectorAll(e))}function a(){i("input.awesomplete").forEach(function(e){new t(e)})}o.create=function(e,t){var n=document.createElement(e);for(var r in t){var i=t[r];if("inside"===r)o(i).appendChild(n);else if("around"===r){var a=o(i);a.parentNode.insertBefore(n,a),n.appendChild(a)}else r in n?n[r]=i:n.setAttribute(r,i)}return n},o.bind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.addEventListener(t,r)})}},o.unbind=function(e,t){if(e)for(var n in t){var r=t[n];n.split(/\s+/).forEach(function(t){e.removeEventListener(t,r)})}},o.fire=function(e,t,n){var r=document.createEvent("HTMLEvents");for(var o in r.initEvent(t,!0,!0),n)r[o]=n[o];return e.dispatchEvent(r)},o.regExpEscape=function(e){return e.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")},o.siblingIndex=function(e){for(var t=0;e=e.previousElementSibling;t++);return t},"undefined"!=typeof Document&&("loading"!==document.readyState?a():document.addEventListener("DOMContentLoaded",a)),t.$=o,t.$$=i,"undefined"!=typeof self&&(self.Awesomplete=t),"object"==typeof e&&e.exports&&(e.exports=t)}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeneTypeEntry=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.geneTypeIndex=parseInt(t.geneTypeIndex),this.geneType=t.geneType,this.geneSupertype=t.geneSupertype}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RppaAntibodyEntry=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rppaId=parseInt(t.rppaId),this.rppaName=t.rppaName,this.geneIds=[],t.geneIds.split(",").forEach(function(e){n.geneIds.push(parseInt(e))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantVizTypeEntry=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.variantVizTypeIndex=t.variantTypeIndex,this.variantDesc=t.variantDesc,this.colourId=parseInt(t.colourId)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.ChromosomeArmEntry=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chromosomeArmIndex=parseInt(t.chromosomeArmIndex),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.startPos=parseInt(t.startPos),this.endPos=parseInt(t.endPos),this.chromosomeArmSize=this.endPos-this.startPos,this.chromosomeArmName=t.chromosomeArmName,this.firstTadIndex=parseInt(t.firstTadIndex),this.lastTadIndex=parseInt(t.lastTadIndex),this.firstCytobandIndex=parseInt(t.firstCytobandIndex),this.lastCytobandIndex=parseInt(t.lastCytobandIndex),this.coefficientInit=+t.coefficientInit,this.coefficient=this.coefficientInit,this.cnvLossDonorContributorIndices=new Set([]),this.cnvGainDonorContributorIndices=new Set([]),this.lohDonorContributorIndices=new Set([]),this.cnnLohDonorContributorIndices=new Set([])}return r(e,[{key:"assessChromosomeArmLevelCnvEffects",value:function(e){for(var t=this,n=0,r=new Map([]),o=new Map([]),i=new Map([]),a=new Map([]),s=function(t){var s=e.tads[t];n+=s.endPos-s.startPos,s.cnvLossDonorContributorIndices.forEach(function(e){r.has(e)||r.set(e,new Set),r.get(e).add(s.tadIndex)}),s.cnvGainDonorContributorIndices.forEach(function(e){o.has(e)||o.set(e,new Set),o.get(e).add(s.tadIndex)}),s.lohDonorContributorIndices.forEach(function(e){i.has(e)||i.set(e,new Set),i.get(e).add(s.tadIndex)}),s.cnnLohDonorContributorIndices.forEach(function(e){a.has(e)||a.set(e,new Set),a.get(e).add(s.tadIndex)})},l=this.firstTadIndex;l<=this.lastTadIndex;++l)s(l);r.forEach(function(r,o,i){var a=0;r.forEach(function(t){a+=e.tads[t].endPos-e.tads[t].startPos}),a/n>.33&&t.cnvLossDonorContributorIndices.add(o)}),o.forEach(function(r,o,i){var a=0;r.forEach(function(t){a+=e.tads[t].endPos-e.tads[t].startPos}),a/n>.33&&t.cnvGainDonorContributorIndices.add(o)}),i.forEach(function(r,o,i){var a=0;r.forEach(function(t){a+=e.tads[t].endPos-e.tads[t].startPos}),a/n>.33&&t.lohDonorContributorIndices.add(o)}),a.forEach(function(r,o,i){var a=0;r.forEach(function(t){a+=e.tads[t].endPos-e.tads[t].startPos}),a/n>.33&&t.cnnLohDonorContributorIndices.add(o)})}},{key:"getGeneIndices",value:function(e){for(var t=new Set,n=this.firstTadIndex;n<=this.lastTadIndex;++n)e.tads[n].geneIndices.forEach(function(e){t.add(e)});return Array.from(t)}},{key:"launchDefaultDb",value:function(){window.open("https://www.ncbi.nlm.nih.gov/pubmed?term=Chr"+this.chromosomeArmName,"_blank")}},{key:"getMidAngle",value:function(e){return e.genomicTheta(this.chromosomeIndex,.5*(this.startPos+this.endPos))}},{key:"resetCoefficient",value:function(){this.coefficient=this.coefficientInit}},{key:"resetCohortContributions",value:function(){this.coefficient=this.coefficientInit,this.cnvLossDonorContributorIndices.clear(),this.cnvGainDonorContributorIndices.clear(),this.lohDonorContributorIndices.clear(),this.cnnLohDonorContributorIndices.clear()}},{key:"getIndex",value:function(){return this.chromosomeArmIndex}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.ChromosomeEntry=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.chromosomeName=t.chrName,this.chromosomeSize=parseInt(t.chrSize),this.gapSize=parseInt(t.gapSize),this.startPos=0,this.endPos=this.chromosomeSize,this.firstCytobandIndex=parseInt(t.firstCytobandIndex),this.lastCytobandIndex=parseInt(t.lastCytobandIndex),this.firstChromosomeArmIndex=parseInt(t.firstChromosomeArmIndex),this.lastChromosomeArmIndex=parseInt(t.lastChromosomeArmIndex),this.coefficientInit=+t.coefficientInit,this.daughterCoefficients=new Map,this.coefficient=this.coefficientInit,this.resetCoefficient()}return r(e,[{key:"getFullSize",value:function(){return this.chromosomeSize*this.coefficient+this.gapSize}},{key:"resetCoefficient",value:function(){this.coefficient=this.coefficientInit,this.daughterCoefficients.clear(),this.daughterCoefficients.set(this.firstChromosomeArmIndex,this.coefficientInit),this.daughterCoefficients.set(this.lastChromosomeArmIndex,this.coefficientInit)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CytobandEntry=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1);t.CytobandEntry=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cytobandIndex=parseInt(t.cytobandIndex),this.chromosomeIndex=parseInt(t.chromosomeIndex),this.startPos=parseInt(t.startPos),this.endPos=parseInt(t.endPos),this.cytobandSize=this.endPos-this.startPos,this.colourIndex=parseInt(t.colourIndex),this.cytobandName=t.cytobandName;var n=!1;this.rawCytobandName="";for(var r=0;r<this.cytobandName.length;++r)n||"q"!==this.cytobandName.charAt(r)&&"p"!==this.cytobandName.charAt(r)||(n=!0),n&&(this.rawCytobandName+=t.cytobandName.charAt(r));0===this.rawCytobandName.length&&(this.rawCytobandName=this.cytobandName),this.chromosomeArmIndex=parseInt(t.chromosomeArmIndex),this.firstTadIndex=parseInt(t.firstTadIndex),this.lastTadIndex=parseInt(t.lastTadIndex),this.gapSize=parseInt(t.gapSize),this.coefficientInit=+t.coefficientInit,this.coefficient=this.coefficientInit,this.vdjSvDonorContributorIndices=new Set,this.svDonorContributorIndices=new Set,this.cnvLossDonorContributorIndices=new Set,this.cnvGainDonorContributorIndices=new Set,this.lohDonorContributorIndices=new Set,this.cnnLohDonorContributorIndices=new Set,this.cnvLossFocalDonorContributorIndices=new Set,this.cnvGainFocalDonorContributorIndices=new Set,this.lohFocalDonorContributorIndices=new Set,this.cnnLohFocalDonorContributorIndices=new Set}return r(e,[{key:"getGeneIndices",value:function(e){for(var t=new Set,n=this.firstTadIndex;n<=this.lastTadIndex;++n)e.tads[n].geneIndices.forEach(function(e){t.add(e)});return Array.from(t)}},{key:"launchDefaultDb",value:function(){window.open("https://www.ncbi.nlm.nih.gov/pubmed?term="+this.cytobandName,"_blank")}},{key:"getMidAngle",value:function(e){return e.genomicTheta(this.chromosomeIndex,.5*(this.startPos+this.endPos))}},{key:"resetCoefficient",value:function(){this.coefficient=this.coefficientInit}},{key:"getFullSize",value:function(){return this.cytobandSize*this.coefficient+this.gapSize}},{key:"resetCohortContributions",value:function(){this.coefficient=this.coefficientInit,this.vdjSvDonorContributorIndices.clear(),this.svDonorContributorIndices.clear(),this.cnvLossDonorContributorIndices.clear(),this.cnvGainDonorContributorIndices.clear(),this.lohDonorContributorIndices.clear(),this.cnnLohDonorContributorIndices.clear(),this.cnvLossFocalDonorContributorIndices.clear(),this.cnvGainFocalDonorContributorIndices.clear(),this.lohFocalDonorContributorIndices.clear(),this.cnnLohFocalDonorContributorIndices.clear()}},{key:"getIndex",value:function(){return this.cytobandIndex}},{key:"annotate",value:function(e,t){var n="The Cytoband "+(0,o.searchInPubMed)(this.cytobandName,t.diseaseNameAlternatives)+" spans the region ",r=e.chromosomes[this.chromosomeIndex].chromosomeName+":"+this.startPos+"-"+this.endPos;n+=(0,o.getGenomeBrowserLink)(r)+" containing the genes:",n+="<br />";for(var i=this.getGeneIndices(e),a=0;a<i.length;++a)n+=e.genes.get(i[a]).getGeneCardsLink(),a<i.length-1&&(n+=", ");return n+"<br />"}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.References=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(138),i=n(137),a=n(136),s=n(135),l=n(118),c=n(134),A=n(62),u=n(133),h=n(13),d=n(1);n(132),n(131);var f=n(129),p=n(128),g=n(127);t.References=function(){function t(){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.baseUrl=window.location.protocol+"//"+window.location.host+"/"+window.location.pathname.split("/")[1],this.genes=new Map,this.geneBatchInfo=new Map,this.reactomePathways=new Map,this.tads=[],this.cytobands=[],this.chromosomes=[],this.chromosomeArms=[],this.fragileSites=[],this.cumulativeSizesWithGapsCytobands=[],this.totalGenomeSizeWithGapsCytobands=0,this.geneTypes=[],this.variantTypes=[],this.variantVizTypes=[],this.colours=[],this.comparisonTypes=[],this.comparisonTypesReverse=new Map,this.rppaAntibodies=[],this.currentCohort=null,this.chrosomeArmInputAwesomplete=new Awesomplete(document.getElementById("chromosomeArmSelector")),this.cytobandInputAwesomplete=new Awesomplete(document.getElementById("cytobandSelector")),this.geneInputAwesomplete=new Awesomplete(document.getElementById("geneSelector")),this.rppaInputAwesomplete=new Awesomplete(document.getElementById("antibodySelector")),this.rppaInputAwesompleteCurrentRppa=-1,this.chromosomeArmInputAwesompleteCurrentChromosomeArm=-1,this.cytobandInputAwesompleteCurrentCytoband=-1,this.geneInputAwesompleteCurrentGene=-1,this.offsetRadians=0;var r=(0,h.queue)();r.defer(function(e){n.fetchChromosomeData(e)}),r.defer(function(e){n.fetchChromosomeArmData(e)}),r.defer(function(e){n.fetchFragileSiteData(e)}),r.defer(function(e){n.fetchReactomePathwayData(e)}),r.defer(function(e){n.fetchColourData(e)}),r.defer(function(e){n.fetchComparisonTypeData(e)}),r.defer(function(e){n.fetchCytobandData(e)}),r.defer(function(e){n.fetchGeneData(e)}),r.defer(function(e){n.fetchGeneTypeData(e)}),r.defer(function(e){n.fetchRppaAntibodyData(e)}),r.defer(function(e){n.fetchTadData(e)}),r.defer(function(e){n.fetchVariantTypeData(e)}),r.defer(function(e){n.fetchVariantVizTypeData(e)}),r.awaitAll(function(){e("#cohortTitle").html("<p>&darr; Select Cohort &darr;</p>"),e("#cohortSelectorGroup").css("display","inline")}),this.superVdjTargets=new Set([136997,137265,110092,109685,113916,180953,171791,166407,135363,162367,187621,100721,213231,182512,120217,134323,188428]),this.knownVdjTargetMapping=new Map([[225559,182158],[223727,113851],[246363,139318],[165805,198707],[133641,198707],[197872,134323],[128563,161036],[212993,136997],[253573,136997],[249859,136997],[249375,136997],[250400,136997],[112685,137265],[112679,137265],[172927,110092],[162341,110092],[149716,110092],[259854,110092],[284713,110092],[168924,109685],[156853,156860],[145012,113916],[196683,136244],[217372,112029],[230773,138081],[213132,113916],[234238,113916],[223401,113916],[224187,113916],[236864,113916],[256433,139193],[136197,106588],[81913,171791],[204717,172005],[135837,143322],[182831,183454],[215946,101152],[216141,101152],[216195,101152],[166405,166407],[214265,114062]])}return r(t,[{key:"assessCurrentCumulativeSizes",value:function(){var e=this;this.totalGenomeSizeWithGapsCytobands=0,this.cytobands.forEach(function(t){e.totalGenomeSizeWithGapsCytobands+=t.getFullSize(),e.cumulativeSizesWithGapsCytobands[t.cytobandIndex]=e.totalGenomeSizeWithGapsCytobands})}},{key:"fetchCytobandData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refCytobands",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){var r=[];e.forEach(function(e){var t=new o.CytobandEntry(e);n.cytobands[t.cytobandIndex]=t,t.chromosomeIndex>0&&r.push({label:t.cytobandName+" | "+t.getIndex(),value:t.cytobandIndex})}),r.sort(),n.cytobandInputAwesomplete.list=r,n.cytobandInputAwesomplete.maxItems=20,n.cytobandInputAwesomplete.filter=Awesomplete.FILTER_STARTSWITH,n.assessCurrentCumulativeSizes(),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchChromosomeData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refChromosomes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new i.ChromosomeEntry(e);n.chromosomes[t.chromosomeIndex]=t}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchChromosomeArmData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refChromosomeArms",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(r){var o=[];r.forEach(function(e){var t=new a.ChromosomeArmEntry(e);n.chromosomeArms[t.chromosomeArmIndex]=t,t.chromosomeIndex>0&&t.chromosomeIndex<25&&o.push({label:t.chromosomeArmName+" | "+t.getIndex(),value:t.chromosomeArmIndex})}),o.sort(),n.chrosomeArmInputAwesomplete.list=o,n.chrosomeArmInputAwesomplete.maxItems=20,n.chrosomeArmInputAwesomplete.filter=Awesomplete.FILTER_STARTSWITH;for(var i=47;i>=1;--i){var s=i%2==1?"p":"q",l=n.chromosomeArms[i].chromosomeIndex;e("#chromosomeArmSizeControls").prepend('<div class="input-group"><label for="armcoeff'+i+'" class="col-form-label" id="armcoeff'+i+'Label">'+l+s+': </label> <input type="number" id="armcoeff'+i+'" name="armcoeff'+i+'" data-provide="slider" data-slider-min="0" data-slider-max="27" data-slider-step="1" data-slider-value="7" data-slider-tooltip="hide" data-slider-orientation="horizontal"></div><br/>')}t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchFragileSiteData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refFragileSites",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new f.FragileSiteEntry(e);n.fragileSites[t.fragileSiteIndex]=t}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchReactomePathwayData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refReactomePathways",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new p.ReactomeEntry(e);n.reactomePathways.set(t.reactomePathwayId,t)}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchVariantVizTypeData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refVariantVizTypes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new s.VariantVizTypeEntry(e);n.variantVizTypes[t.variantVizTypeIndex]=t}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchVariantTypeData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refVariantTypes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){n.variantTypes[e.variantTypeIndex]=new g.VariantTypeEntry(e)}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchTadData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refTads",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new l.TadEntry(e);n.tads[t.tadIndex]=t}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchGeneData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refGenes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){var r=[];e.forEach(function(e){var t=new A.GeneEntry(e),o=t.batch;n.geneBatchInfo.has(o)||n.geneBatchInfo.set(o,[]),n.geneBatchInfo.get(o).push(t.geneId),n.genes.set(t.geneId,t),r.push({label:t.geneName+" | "+(0,d.padENSG)(t.geneId),value:t.geneId})}),r.sort(),n.geneInputAwesomplete.list=r,n.geneInputAwesomplete.maxItems=80,n.geneInputAwesomplete.filter=Awesomplete.FILTER_STARTSWITH,t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchRppaAntibodyData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refRppaAntibodies",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){var r=[];e.forEach(function(e){var t=new c.RppaAntibodyEntry(e);n.rppaAntibodies[t.rppaId]=t,r.push({label:""+t.rppaName,value:t.rppaId})}),r.sort(),n.rppaInputAwesomplete.list=r,n.rppaInputAwesomplete.maxItems=80,n.rppaInputAwesomplete.filter=Awesomplete.FILTER_STARTSWITH,t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchGeneTypeData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refGeneTypes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new u.GeneTypeEntry(e);n.geneTypes[t.geneTypeIndex]=t}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchColourData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refColours",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){n.colours[e.colourIndex]=e.colour}),t(null,null)},error:function(e){console.error(e)}})}},{key:"fetchComparisonTypeData",value:function(t){var n=this;e.ajax({url:n.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:"references",suffix:"refComparisonTypes",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){n.comparisonTypes[parseInt(e.comparisonTypeIndex)]=e.comparisonType,n.comparisonTypesReverse.set(e.comparisonType,parseInt(e.comparisonTypeIndex))}),t(null,null)},error:function(e){console.error(e)}})}},{key:"registerCohort",value:function(e){this.currentCohort=e}},{key:"resetCohortContributions",value:function(){var e=this;this.currentCohort=null,this.offsetRadians=0,this.chromosomeArms.forEach(function(e){e.resetCohortContributions()}),this.tads.forEach(function(e){e.resetCohortContributions()}),this.cytobands.forEach(function(e){e.resetCohortContributions()}),Array.from(this.genes.keys()).forEach(function(t){e.genes.get(t).resetCohortContributions()})}},{key:"emitCytobandClick",value:function(e){this.currentCohort.selectCytoband(e)}},{key:"emitTadClick",value:function(e,t){this.currentCohort.selectTad(e,t)}},{key:"emitGeneClick",value:function(e,t){this.currentCohort.selectGeneRecurrence(e,t)}},{key:"emitGeneLabel",value:function(e){this.currentCohort.wheelManager.addGeneLabel(e)}},{key:"genomicTheta",value:function(e,t){if(0===e)return.5*Math.PI;for(var n=this.chromosomes[e].firstCytobandIndex;t>this.cytobands[n].endPos;)n+=1;return(.5+(this.cumulativeSizesWithGapsCytobands[n-1]+this.cytobands[n].coefficient*(t-this.cytobands[n].startPos))/this.totalGenomeSizeWithGapsCytobands*2)*Math.PI+this.offsetRadians}},{key:"mapKnownVdjTargets",value:function(e){if(void 0===e)return[];for(var t=new Set,n=0;n<e.length;++n){var r=e[n];if(this.superVdjTargets.has(r))return[r];this.knownVdjTargetMapping.has(r)?t.add(this.knownVdjTargetMapping.get(r)):t.add(r)}return Array.from(t)}},{key:"tracerMultiCleanup",value:function(){this.currentCohort.vizManager.tracerCleanup()}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";function r(e,t){return e-t}t.sum=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t},t.max=function(e){for(var t=e[0],n=e.length,r=1;r<n;r++)e[r]>t&&(t=e[r]);return t},t.min=function(e){for(var t=e[0],n=e.length,r=1;r<n;r++)e[r]<t&&(t=e[r]);return t},t.minMax=function(e){for(var t=e[0],n=e[0],r=e.length,o=1;o<r;o++)e[o]<t&&(t=e[o]),e[o]>n&&(n=e[o]);return{min:t,max:n}},t.arithmeticMean=function(e){for(var t=0,n=e.length,r=0;r<n;r++)t+=e[r];return t/n},t.mean=t.arithmeticMean,t.geometricMean=function(e){for(var t=1,n=e.length,r=0;r<n;r++)t*=e[r];return Math.pow(t,1/n)},t.logMean=function(e){for(var t=0,n=e.length,r=0;r<n;r++)t+=Math.log(e[r]);return t/n},t.grandMean=function(e,t){for(var n=0,r=0,o=e.length,i=0;i<o;i++)n+=t[i]*e[i],r+=t[i];return n/r},t.truncatedMean=function(e,t,n){void 0===n&&(n=!1),n||(e=[].concat(e).sort(r));for(var o=e.length,i=Math.floor(o*t),a=0,s=i;s<o-i;s++)a+=e[s];return a/(o-2*i)},t.harmonicMean=function(e){for(var t=0,n=e.length,r=0;r<n;r++){if(0===e[r])throw new RangeError("value at index "+r+"is zero");t+=1/e[r]}return n/t},t.contraHarmonicMean=function(e){for(var t=0,n=0,r=e.length,o=0;o<r;o++)t+=e[o]*e[o],n+=e[o];if(n<0)throw new RangeError("sum of values is negative");return t/n},t.median=function(e,t){void 0===t&&(t=!1),t||(e=[].concat(e).sort(r));var n=e.length,o=Math.floor(n/2);return n%2==0?.5*(e[o-1]+e[o]):e[o]},t.variance=function(e,n){void 0===n&&(n=!0);for(var r=t.mean(e),o=0,i=e.length,a=0;a<i;a++){var s=e[a]-r;o+=s*s}return n?o/(i-1):o/i},t.standardDeviation=function(e,n){return Math.sqrt(t.variance(e,n))},t.standardError=function(e){return t.standardDeviation(e)/Math.sqrt(e.length)},t.robustMeanAndStdev=function(e){var t=0,n=e.length,o=0;for(o=0;o<n;o++)t+=e[o];t/=n;var i=new Array(n);for(o=0;o<n;o++)i[o]=Math.abs(e[o]-t);return i.sort(r),{mean:t,stdev:n%2==1?i[(n-1)/2]/.6745:.5*(i[n/2]+i[n/2-1])/.6745}},t.quartiles=function(e,n){void 0===n&&(n=!1),n||(e=[].concat(e).sort(r));var o=e.length/4;return{q1:e[Math.ceil(o)-1],q2:t.median(e,!0),q3:e[Math.ceil(3*o)-1]}},t.pooledStandardDeviation=function(e,n){return Math.sqrt(t.pooledVariance(e,n))},t.pooledVariance=function(e,n){void 0===n&&(n=!0);for(var r=0,o=0,i=e.length,a=0;a<i;a++){var s=e[a],l=t.variance(s);r+=(s.length-1)*l,o+=n?s.length-1:s.length}return r/o},t.mode=function(e){var t,n=e.length,r=new Array(n);for(t=0;t<n;t++)r[t]=0;var o=new Array(n),i=0;for(t=0;t<n;t++){var a=o.indexOf(e[t]);a>=0?r[a]++:(o[i]=e[t],r[i]=1,i++)}var s=0,l=0;for(t=0;t<i;t++)r[t]>s&&(s=r[t],l=t);return o[l]},t.covariance=function(e,n,r){void 0===r&&(r=!0);var o=t.mean(e),i=t.mean(n);if(e.length!==n.length)throw"Vectors do not have the same dimensions";for(var a=0,s=e.length,l=0;l<s;l++)a+=(e[l]-o)*(n[l]-i);return r?a/(s-1):a/s},t.skewness=function(e,n){void 0===n&&(n=!0);for(var r=t.mean(e),o=0,i=0,a=e.length,s=0;s<a;s++){var l=e[s]-r;o+=l*l,i+=l*l*l}var c=o/a,A=i/a/Math.pow(c,1.5);return n?Math.sqrt(a*(a-1))/(a-2)*A:A},t.kurtosis=function(e,n){void 0===n&&(n=!0);for(var r=t.mean(e),o=e.length,i=0,a=0,s=0;s<o;s++){var l=e[s]-r;i+=l*l,a+=l*l*l*l}var c=i/o,A=a/o;if(n){var u=i/(o-1);return o*(o+1)/((o-1)*(o-2)*(o-3))*(a/(u*u))-(o-1)*(o-1)/((o-2)*(o-3))*3}return A/(c*c)-3},t.entropy=function(e,t){void 0===t&&(t=0);for(var n=0,r=e.length,o=0;o<r;o++)n+=e[o]*Math.log(e[o]+t);return-n},t.weightedMean=function(e,t){for(var n=0,r=e.length,o=0;o<r;o++)n+=e[o]*t[o];return n},t.weightedStandardDeviation=function(e,n){return Math.sqrt(t.weightedVariance(e,n))},t.weightedVariance=function(e,n){for(var r=t.weightedMean(e,n),o=0,i=e.length,a=0,s=0,l=0;l<i;l++){var c=e[l]-r,A=n[l];o+=A*(c*c),s+=A,a+=A*A}return o*(s/(s*s-a))},t.center=function(e,n){void 0===n&&(n=!1);var r=e;n||(r=[].concat(e));for(var o=t.mean(r),i=r.length,a=0;a<i;a++)r[a]-=o},t.standardize=function(e,n,r){void 0===n&&(n=t.standardDeviation(e)),void 0===r&&(r=!1);for(var o=e.length,i=r?e:new Array(o),a=0;a<o;a++)i[a]=e[a]/n;return i},t.cumulativeSum=function(e){var t=e.length,n=new Array(t);n[0]=e[0];for(var r=1;r<t;r++)n[r]=n[r-1]+e[r];return n}},function(e,t,n){"use strict";var r=n(140);function o(e,t){return e-t}t.max=function(e){for(var t=-1/0,n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)e[n][r]>t&&(t=e[n][r]);return t},t.min=function(e){for(var t=1/0,n=0;n<e.length;n++)for(var r=0;r<e[n].length;r++)e[n][r]<t&&(t=e[n][r]);return t},t.minMax=function(e){for(var t=1/0,n=-1/0,r=0;r<e.length;r++)for(var o=0;o<e[r].length;o++)e[r][o]<t&&(t=e[r][o]),e[r][o]>n&&(n=e[r][o]);return{min:t,max:n}},t.entropy=function(e,t){void 0===t&&(t=0);for(var n=0,r=e.length,o=e[0].length,i=0;i<r;i++)for(var a=0;a<o;a++)n+=e[i][a]*Math.log(e[i][a]+t);return-n},t.mean=function(e,t){void 0===t&&(t=0);var n,r,o,i,a=e.length,s=e[0].length;if(-1===t){for(n=[0],r=a*s,o=0;o<a;o++)for(i=0;i<s;i++)n[0]+=e[o][i];n[0]/=r}else if(0===t)for(n=new Array(s),r=a,i=0;i<s;i++){for(n[i]=0,o=0;o<a;o++)n[i]+=e[o][i];n[i]/=r}else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(a),r=s,i=0;i<a;i++){for(n[i]=0,o=0;o<s;o++)n[i]+=e[i][o];n[i]/=r}}return n},t.sum=function(e,t){void 0===t&&(t=0);var n,r,o,i=e.length,a=e[0].length;if(-1===t)for(n=[0],r=0;r<i;r++)for(o=0;o<a;o++)n[0]+=e[r][o];else if(0===t)for(n=new Array(a),o=0;o<a;o++)for(n[o]=0,r=0;r<i;r++)n[o]+=e[r][o];else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(i),o=0;o<i;o++)for(n[o]=0,r=0;r<a;r++)n[o]+=e[o][r]}return n},t.product=function(e,t){void 0===t&&(t=0);var n,r,o,i=e.length,a=e[0].length;if(-1===t)for(n=[1],r=0;r<i;r++)for(o=0;o<a;o++)n[0]*=e[r][o];else if(0===t)for(n=new Array(a),o=0;o<a;o++)for(n[o]=1,r=0;r<i;r++)n[o]*=e[r][o];else{if(1!==t)throw new Error("Invalid dimension");for(n=new Array(i),o=0;o<i;o++)for(n[o]=1,r=0;r<a;r++)n[o]*=e[o][r]}return n},t.standardDeviation=function(e,n,r){for(var o=t.variance(e,n,r),i=o.length,a=0;a<i;a++)o[a]=Math.sqrt(o[a]);return o},t.variance=function(e,n,r){void 0===r&&(r=!0),n=n||t.mean(e);var o=e.length;if(0===o)return[];for(var i=e[0].length,a=new Array(i),s=0;s<i;s++){for(var l=0,c=0,A=0,u=0;u<o;u++)l+=A=e[u][s]-n[s],c+=A*A;a[s]=r?(c-l*l/o)/(o-1):(c-l*l/o)/o}return a},t.median=function(e){for(var t=e.length,n=e[0].length,r=new Array(n),i=0;i<n;i++){for(var a=new Array(t),s=0;s<t;s++)a[s]=e[s][i];a.sort(o);var l=a.length;r[i]=l%2==0?.5*(a[l/2]+a[l/2-1]):a[Math.floor(l/2)]}return r},t.mode=function(e){var t,n,r=e.length,o=e[0].length,i=new Array(o);for(t=0;t<o;t++){for(var a=new Array(r),s=0;s<r;s++)a[s]=0;var l=new Array(r),c=0;for(n=0;n<r;n++){var A=l.indexOf(e[n][t]);A>=0?a[A]++:(l[c]=e[n][t],a[c]=1,c++)}var u=0,h=0;for(n=0;n<c;n++)a[n]>u&&(u=a[n],h=n);i[t]=l[h]}return i},t.skewness=function(e,n){void 0===n&&(n=!0);for(var r=t.mean(e),o=e.length,i=r.length,a=new Array(i),s=0;s<i;s++){for(var l=0,c=0,A=0;A<o;A++){var u=e[A][s]-r[s];l+=u*u,c+=u*u*u}var h=l/o,d=c/o/Math.pow(h,1.5);if(n){var f=Math.sqrt(o*(o-1)),p=o-2;a[s]=f/p*d}else a[s]=d}return a},t.kurtosis=function(e,n){void 0===n&&(n=!0);for(var r=t.mean(e),o=e.length,i=e[0].length,a=new Array(i),s=0;s<i;s++){for(var l=0,c=0,A=0;A<o;A++){var u=e[A][s]-r[s];l+=u*u,c+=u*u*u*u}var h=l/o,d=c/o;if(n){var f=l/(o-1),p=o*(o+1)/((o-1)*(o-2)*(o-3)),g=c/(f*f),m=(o-1)*(o-1)/((o-2)*(o-3));a[s]=p*g-3*m}else a[s]=d/(h*h)-3}return a},t.standardError=function(e){for(var n=e.length,r=t.standardDeviation(e),o=r.length,i=new Array(o),a=Math.sqrt(n),s=0;s<o;s++)i[s]=r[s]/a;return i},t.covariance=function(e,n){return t.scatter(e,void 0,n)},t.scatter=function(e,n,r){void 0===r&&(r=0),void 0===n&&(0===r?n=e.length-1:1===r&&(n=e[0].length-1));var o=t.mean(e,r),i=e.length;if(0===i)return[[]];var a,s,l,c,A,u=e[0].length;if(0===r){for(a=new Array(u),s=0;s<u;s++)a[s]=new Array(u);for(s=0;s<u;s++)for(l=s;l<u;l++){for(c=0,A=0;A<i;A++)c+=(e[A][l]-o[l])*(e[A][s]-o[s]);c/=n,a[s][l]=c,a[l][s]=c}}else{if(1!==r)throw new Error("Invalid dimension");for(a=new Array(i),s=0;s<i;s++)a[s]=new Array(i);for(s=0;s<i;s++)for(l=s;l<i;l++){for(c=0,A=0;A<u;A++)c+=(e[l][A]-o[l])*(e[s][A]-o[s]);c/=n,a[s][l]=c,a[l][s]=c}}return a},t.correlation=function(e){var n,r,o=t.mean(e),i=t.standardDeviation(e,!0,o),a=t.zScores(e,o,i),s=e.length,l=e[0].length,c=new Array(l);for(n=0;n<l;n++)c[n]=new Array(l);for(n=0;n<l;n++)for(r=n;r<l;r++){for(var A=0,u=0,h=a.length;u<h;u++)A+=a[u][r]*a[u][n];A/=s-1,c[n][r]=A,c[r][n]=A}return c},t.zScores=function(e,n,r){return n=n||t.mean(e),void 0===r&&(r=t.standardDeviation(e,!0,n)),t.standardize(t.center(e,n,!1),r,!0)},t.center=function(e,n,r){n=n||t.mean(e);var o,i,a,s=e,l=e.length;if(!r)for(s=new Array(l),o=0;o<l;o++)s[o]=new Array(e[o].length);for(o=0;o<l;o++){var c=s[o];for(i=0,a=c.length;i<a;i++)c[i]=e[o][i]-n[i]}return s},t.standardize=function(e,n,r){void 0===n&&(n=t.standardDeviation(e));var o,i,a,s=e,l=e.length;if(!r)for(s=new Array(l),o=0;o<l;o++)s[o]=new Array(e[o].length);for(o=0;o<l;o++){var c=s[o],A=e[o];for(i=0,a=c.length;i<a;i++)0===n[i]||isNaN(n[i])||(c[i]=A[i]/n[i])}return s},t.weightedVariance=function(e,n){var r=t.mean(e),o=e.length;if(0===o)return[];for(var i=e[0].length,a=new Array(i),s=0;s<i;s++){for(var l=0,c=0,A=0,u=0;u<o;u++){var h=e[u][s]-r[s],d=n[u];l+=d*(h*h),A+=d,c+=d*d}a[s]=l*(A/(A*A-c))}return a},t.weightedMean=function(e,t,n){void 0===n&&(n=0);var o=e.length;if(0===o)return[];var i,a,s,l,c,A,u=e[0].length;if(0===n){for(i=new Array(u),a=0;a<u;a++)i[a]=0;for(a=0;a<o;a++)for(A=e[a],c=t[a],l=0;l<u;l++)i[l]+=A[l]*c}else{if(1!==n)throw new Error("Invalid dimension");for(i=new Array(o),a=0;a<o;a++)i[a]=0;for(l=0;l<o;l++)for(A=e[l],c=t[l],a=0;a<u;a++)i[l]+=A[a]*c}var h=r.sum(t);if(0!==h)for(a=0,s=i.length;a<s;a++)i[a]/=h;return i},t.weightedCovariance=function(e,n,r,o){o=o||0,r=r||t.weightedMean(e,n,o);for(var i=0,a=0,s=0,l=n.length;s<l;s++)i+=n[s],a+=n[s]*n[s];var c=i/(i*i-a);return t.weightedScatter(e,n,r,c,o)},t.weightedScatter=function(e,n,r,o,i){i=i||0,r=r||t.weightedMean(e,n,i),void 0===o&&(o=1);var a=e.length;if(0===a)return[[]];var s,l,c,A,u,h=e[0].length;if(0===i){for(s=new Array(h),l=0;l<h;l++)s[l]=new Array(h);for(l=0;l<h;l++)for(c=l;c<h;c++){for(u=0,A=0;A<a;A++)u+=n[A]*(e[A][c]-r[c])*(e[A][l]-r[l]);s[l][c]=u*o,s[c][l]=u*o}}else{if(1!==i)throw new Error("Invalid dimension");for(s=new Array(a),l=0;l<a;l++)s[l]=new Array(a);for(l=0;l<a;l++)for(c=l;c<a;c++){for(u=0,A=0;A<h;A++)u+=n[A]*(e[c][A]-r[c])*(e[l][A]-r[l]);s[l][c]=u*o,s[c][l]=u*o}}return s}},function(e,t,n){"use strict";const r=n(31),o=r.Matrix,i=r.EVD,a=r.SVD,s=n(141),l=s.mean,c=s.standardDeviation,A={isCovarianceMatrix:!1,center:!0,scale:!1};class u{constructor(e,t){if(!0===e){const e=t;return this.center=e.center,this.scale=e.scale,this.means=e.means,this.stdevs=e.stdevs,this.U=o.checkMatrix(e.U),void(this.S=e.S)}if(t=Object.assign({},A,t),this.center=!1,this.scale=!1,this.means=null,this.stdevs=null,t.isCovarianceMatrix)this._computeFromCovarianceMatrix(e);else if("boolean"==typeof t.useCovarianceMatrix?t.useCovarianceMatrix:e.length>e[0].length){const n=(e=this._adjust(e,t)).transposeView().mmul(e).div(e.rows-1);this._computeFromCovarianceMatrix(n)}else{e=this._adjust(e,t);var n=new a(e,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=n.rightSingularVectors;const o=n.diagonal,i=new Array(o.length);for(var r=0;r<o.length;r++)i[r]=o[r]*o[r]/(e.length-1);this.S=i}}static load(e){if("PCA"!==e.name)throw new RangeError("Invalid model: "+e.name);return new u(!0,e)}predict(e,t={}){const{nComponents:n=this.U.columns}=t;e=new o(e),this.center&&(e.subRowVector(this.means),this.scale&&e.divRowVector(this.stdevs));var r=e.mmul(this.U);return r.subMatrix(0,r.rows-1,0,n-1)}getExplainedVariance(){for(var e=0,t=0;t<this.S.length;t++)e+=this.S[t];return this.S.map(t=>t/e)}getCumulativeVariance(){for(var e=this.getExplainedVariance(),t=1;t<e.length;t++)e[t]+=e[t-1];return e}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(e=>Math.sqrt(e))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S}}_adjust(e,t){if(this.center=!!t.center,this.scale=!!t.scale,e=new o(e),this.center){const t=l(e),r=this.scale?c(e,t,!0):null;if(this.means=t,e.subRowVector(t),this.scale){for(var n=0;n<r.length;n++)if(0===r[n])throw new RangeError("Cannot scale the dataset (standard deviation is zero at index "+n);this.stdevs=r,e.divRowVector(r)}}return e}_computeFromCovarianceMatrix(e){const t=new i(e,{assumeSymmetric:!0});this.U=t.eigenvectorMatrix;for(var n=0;n<this.U.length;n++)this.U[n].reverse();this.S=t.realEigenvalues.reverse()}}e.exports=u},function(e,t,n){"use strict";var r=r||{REVISION:"ALPHA"};!function(e){var t=function(e,t){if(!e)throw t||"Assertion failed"},n=function(e,t,n){return e.hasOwnProperty(t)?e[t]:n},r=!1,o=0,i=function(e,t){return e+function e(){if(r)return r=!1,o;var t=2*Math.random()-1,n=2*Math.random()-1,i=t*t+n*n;if(0==i||i>1)return e();var a=Math.sqrt(-2*Math.log(i)/i);return o=n*a,r=!0,t*a}()*t},a=function(e){if(void 0===e||isNaN(e))return[];if("undefined"==typeof ArrayBuffer){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t}return new Float64Array(e)},s=function(e,t,n){for(var r=void 0!==n,o=new Array(e*t).fill(0),a=0;a<e;a++)for(var s=0;s<t;s++){o[a*t+s]=r?n:i(0,1e-4)}return o},l=function(e,n,r){var o=Math.sqrt(e.length),i=Math.floor(o);t(i===o,"D should have square number of elements.");for(var s=Math.log(n),l=a(i*i),c=a(i),A=0;A<i;A++){for(var u=-1/0,h=1/0,d=1,f=!1,p=0;!f;){for(var g=0,m=0;m<i;m++){var v=Math.exp(-e[A*i+m]*d);A===m&&(v=0),c[m]=v,g+=v}var y=0;for(m=0;m<i;m++)v=0==g?0:c[m]/g,c[m]=v,v>1e-7&&(y-=v*Math.log(v));y>s?(u=d,h===1/0?d*=2:d=(d+h)/2):(h=d,u===-1/0?d/=2:d=(d+u)/2),p++,Math.abs(y-s)<r&&(f=!0),p>=50&&(f=!0)}for(m=0;m<i;m++)l[A*i+m]=c[m]}var b=a(i*i),I=2*i;for(A=0;A<i;A++)for(m=0;m<i;m++)b[A*i+m]=Math.max((l[A*i+m]+l[m*i+A])/I,1e-100);return b};function c(e){return e>0?1:e<0?-1:0}var A=function(e){e=e||{},this.perplexity=n(e,"perplexity",30),this.earlyExaggeration=n(e,"earlyExaggeration",12),this.lateExaggeration=n(e,"lateExaggeration",1.5),this.iterationsEarlyExaggeration=n(e,"iterationsEarlyExaggeration",100),this.iterationsLateExaggeration=n(e,"iterationsLateExaggeration",250),this.dim=n(e,"dim",2),this.epsilon=n(e,"epsilon",10),this.maxIter=n(e,"maxIter",1e3),this.alpha=n(e,"alpha",1),this.df=1/this.alpha,this.iter=0,this.itersWithoutProgress=0,this.minCost=Number.MAX_VALUE};A.prototype={initDataRaw:function(e){var n=e.length,r=e[0].length;t(n>0," X is empty? You must have some data!"),t(r>0," X[0] is empty? Where is the data?");var o=function(e,t,n){for(var r=a(t*t),o=0;o<t;o++)for(var i=o+1;i<t;i++){for(var s=0,l=0;l<n;l++){var c=e[o][l]-e[i][l];s+=c*c}r[o*t+i]=s,r[i*t+o]=s}return r}(e,n,r);this.P=l(o,this.perplexity,1e-4),this.N=n,this.NN=n*n,this.Qu=a(this.NN),this.Q=a(this.NN),this.grad=new Array(n*this.dim).fill(0),this.initSolution()},initDataDist:function(e){var n=e.length;t(n>0," X is empty? You must have some data!");for(var r=a(n*n),o=0;o<n;o++)for(var i=o+1;i<n;i++){var s=e[o][i];r[o*n+i]=s,r[i*n+o]=s}this.P=l(r,this.perplexity,1e-4),this.N=n,this.initSolution()},initSolution:function(){this.Y=s(this.N,this.dim),this.gains=s(this.N,this.dim,1),this.ystep=s(this.N,this.dim,0),this.iter=0},getSolution:function(){for(var e=[],t=0;t<this.N;++t){e.push(new Array(this.dim).fill(0));for(var n=0;n<this.dim;++n)e[t][n]=this.Y[t*this.dim+n]}return e},step:function(){for(var e=this.costGrad(),t=a(this.dim),n=0;n<this.N;n++)for(var r=0;r<this.dim;r++){var o=n*this.dim+r,i=this.ystep[o],s=this.gains[o],l=c(this.grad[o])===c(i)?.8*s:s+.2;l<.01&&(l=.01),this.gains[o]=l;var A=(this.iter<this.iterationsEarlyExaggeration||this.lateExaggeration>1&&this.maxIter-this.iter<this.iterationsLateExaggeration?.5:.8)*i-this.epsilon*l*this.grad[o];this.ystep[o]=A,this.Y[o]+=A,t[r]+=this.Y[o]}for(var u=0;u<this.N;u++)for(var h=0;h<this.dim;h++){var d=u*this.dim+h;this.Y[d]-=t[h]/this.N}if(300===this.iter)this.minCost=e;else if(this.iter>300&&(e<this.minCost?(this.minCost=e,this.itersWithoutProgress=0):this.itersWithoutProgress+=1,this.iter%100==0&&this.itersWithoutProgress>100))return Number.MAX_VALUE;return this.iter+=1,e},costGrad:function(){for(var e=0,t=0;t<this.N;t++)for(var n=t+1;n<this.N;n++){for(var r=0,o=0;o<this.dim;o++){var i=this.Y[t*this.dim+o]-this.Y[n*this.dim+o];r+=i*i}var a=1/Math.pow(1+this.df*r,this.alpha);this.Qu[t*this.N+n]=a,this.Qu[n*this.N+t]=a,e+=2*a}for(var s=0;s<this.NN;s++)this.Q[s]=Math.max(this.Qu[s]/e,1e-100);var l=0,c=1;this.iter<this.iterationsEarlyExaggeration?c=this.earlyExaggeration:this.maxIter-this.iter<this.iterationsLateExaggeration&&(c=this.lateExaggeration);for(var A=0;A<this.N;A++){for(var u=0;u<this.dim;u++){var h=A*this.dim+u;this.grad[h]=0}for(var d=0;d<this.N;d++){var f=A*this.N+d;l+=-this.P[f]*Math.log(this.Q[f]);for(var p=4*(c*this.P[f]-this.Q[f])*Math.pow(this.Qu[f],this.df),g=0;g<this.dim;g++){var m=A*this.dim+g;this.grad[m]+=p*(this.Y[m]-this.Y[d*this.dim+g])}}}return l},cleanup:function(){this.Y.length=0,this.grad.length=0,this.P=null,this.Q=null,this.Qu=null}},e.tSNE=A}(r),function(t){void 0===e||void 0===e.exports?window.tsnejs=t:e.exports=t}(r)},function(e,t,n){if(void 0!==e&&e.exports)var r=n(64);function o(e,t,n,r){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(e,t,n,r)}o.prototype.run=function(e,t,n,o){this._init(e,t,n,o);for(var i=0,a=this.dataset.length;i<a;i++)if(1!==this._processed[i]){this._processed[i]=1,this.clusters.push([i]);var s=this.clusters.length-1;this._orderedList.push(i);var l=new r(null,null,"asc"),c=this._regionQuery(i);void 0!==this._distanceToCore(i)&&(this._updateQueue(i,c,l),this._expandCluster(s,l))}return this.clusters},o.prototype.getReachabilityPlot=function(){for(var e=[],t=0,n=this._orderedList.length;t<n;t++){var r=this._orderedList[t],o=this._reachability[r];e.push([r,o])}return e},o.prototype._init=function(e,t,n,r){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}t&&(this.epsilon=t),n&&(this.minPts=n),r&&(this.distance=r)},o.prototype._updateQueue=function(e,t,n){var r=this;this._coreDistance=this._distanceToCore(e),t.forEach(function(t){if(void 0===r._processed[t]){var o=r.distance(r.dataset[e],r.dataset[t]),i=Math.max(r._coreDistance,o);void 0===r._reachability[t]?(r._reachability[t]=i,n.insert(t,i)):i<r._reachability[t]&&(r._reachability[t]=i,n.remove(t),n.insert(t,i))}})},o.prototype._expandCluster=function(e,t){for(var n=t.getElements(),r=0,o=n.length;r<o;r++){var i=n[r];if(void 0===this._processed[i]){var a=this._regionQuery(i);this._processed[i]=1,this.clusters[e].push(i),this._orderedList.push(i),void 0!==this._distanceToCore(i)&&(this._updateQueue(i,a,t),this._expandCluster(e,t))}}},o.prototype._distanceToCore=function(e){for(var t=this.epsilon,n=0;n<t;n++)if(this._regionQuery(e,n).length>=this.minPts)return n},o.prototype._regionQuery=function(e,t){t=t||this.epsilon;for(var n=[],r=0,o=this.dataset.length;r<o;r++)this.distance(this.dataset[e],this.dataset[r])<t&&n.push(r);return n},o.prototype._euclideanDistance=function(e,t){for(var n=0,r=Math.min(e.length,t.length);r--;)n+=(e[r]-t[r])*(e[r]-t[r]);return Math.sqrt(n)},void 0!==e&&e.exports&&(e.exports=o)},function(e,t){function n(e,t,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(e,t,n)}n.prototype.init=function(e,t,n){this.assignments=[],this.centroids=[],void 0!==e&&(this.dataset=e),void 0!==t&&(this.k=t),void 0!==n&&(this.distance=n)},n.prototype.run=function(e,t){this.init(e,t);for(var n=this.dataset.length,r=0;r<this.k;r++)this.centroids[r]=this.randomCentroid();for(var o=!0;o;){o=this.assign();for(var i=0;i<this.k;i++){for(var a=new Array(A),s=0,l=0;l<A;l++)a[l]=0;for(var c=0;c<n;c++){var A=this.dataset[c].length;if(i===this.assignments[c]){for(l=0;l<A;l++)a[l]+=this.dataset[c][l];s++}}if(s>0){for(l=0;l<A;l++)a[l]/=s;this.centroids[i]=a}else this.centroids[i]=this.randomCentroid(),o=!0}}return this.getClusters()},n.prototype.randomCentroid=function(){var e,t,n=this.dataset.length-1;do{t=Math.round(Math.random()*n),e=this.dataset[t]}while(this.centroids.indexOf(e)>=0);return e},n.prototype.assign=function(){for(var e,t=!1,n=this.dataset.length,r=0;r<n;r++)(e=this.argmin(this.dataset[r],this.centroids,this.distance))!=this.assignments[r]&&(this.assignments[r]=e,t=!0);return t},n.prototype.getClusters=function(){for(var e,t=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===t[e=this.assignments[n]]&&(t[e]=[]),t[e].push(n);return t},n.prototype.argmin=function(e,t,n){for(var r,o=Number.MAX_VALUE,i=0,a=t.length,s=0;s<a;s++)(r=n(e,t[s]))<o&&(o=r,i=s);return i},n.prototype.distance=function(e,t){for(var n=0,r=Math.min(e.length,t.length);r--;){var o=e[r]-t[r];n+=o*o}return Math.sqrt(n)},void 0!==e&&e.exports&&(e.exports=n)},function(e,t){function n(e,t,n,r){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(e,t,n,r)}n.prototype.run=function(e,t,n,r){this._init(e,t,n,r);for(var o=0;o<this._datasetLength;o++)if(1!==this._visited[o]){this._visited[o]=1;var i=this._regionQuery(o);if(i.length<this.minPts)this.noise.push(o);else{var a=this.clusters.length;this.clusters.push([]),this._addToCluster(o,a),this._expandCluster(a,i)}}return this.clusters},n.prototype._init=function(e,t,n,r){if(e){if(!(e instanceof Array))throw Error("Dataset must be of type array, "+typeof e+" given");this.dataset=e,this.clusters=[],this.noise=[],this._datasetLength=e.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}t&&(this.epsilon=t),n&&(this.minPts=n),r&&(this.distance=r)},n.prototype._expandCluster=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);o.length>=this.minPts&&(t=this._mergeArrays(t,o))}1!==this._assigned[r]&&this._addToCluster(r,e)}},n.prototype._addToCluster=function(e,t){this.clusters[t].push(e),this._assigned[e]=1},n.prototype._regionQuery=function(e){for(var t=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[e],this.dataset[n])<this.epsilon&&t.push(n);return t},n.prototype._mergeArrays=function(e,t){for(var n=t.length,r=0;r<n;r++){var o=t[r];e.indexOf(o)<0&&e.push(o)}return e},n.prototype._euclideanDistance=function(e,t){for(var n=0,r=Math.min(e.length,t.length);r--;)n+=(e[r]-t[r])*(e[r]-t[r]);return Math.sqrt(n)},void 0!==e&&e.exports&&(e.exports=n)},function(e,t,n){void 0!==e&&e.exports&&(e.exports={DBSCAN:n(146),KMEANS:n(145),OPTICS:n(144),PriorityQueue:n(64)})},function(e,t){var n;n=function(){class e{constructor(){this.epsMin=this.epsMin.bind(this),this.epsMax=this.epsMax.bind(this),this.mPtsMin=this.mPtsMin.bind(this),this.mPtsMax=this.mPtsMax.bind(this),this.distanceFn=this.distanceFn.bind(this),this.cluster=this.cluster.bind(this),this._expandClusterFuzzy=this._expandClusterFuzzy.bind(this)}epsMin(e){return e?(this._epsMin=e,this):this._epsMin}epsMax(e){return e?(this._epsMax=e,this):this._epsMax}mPtsMin(e){return e?(this._mPtsMin=e,this):this._mPtsMin}mPtsMax(e){return e?(this._mPtsMax=e,this):this._mPtsMax}distanceFn(e){return e?(this._distanceFn=e,this):this._distanceFn}cluster(e){var t,n,r,o,i,a,s,l;for(o=[],t=[],l=new Array(e.length).fill(!1),i=n=0,s=e.length;0<=s?0<=n&&n<s:0>=n&&n>s;i=n+=1)l[i]||(l[i]=!0,r=this._regionQuery(e,i),0===(a=this._muMinP(this._density(i,r,e)))?o.push({index:i,category:"NOISE",label:1}):t.push(this._expandClusterFuzzy(a,i,r,e,l)));return o.length>0&&t.push(o),t}_expandClusterFuzzy(e,t,n,r,o){var i,a,s,l,c,A,u,h,d;for(A of((s=[]).push({index:t,category:"CORE",label:e}),a=[],n))if(r[A],o[A]=!0,d=this._regionQuery(r,A),(u=this._muMinP(this._density(A,d,r)))>0){for(h of d)n.add(h);s.push({index:A,category:"CORE",label:u})}else a.push({index:A,category:"BORDER",label:Number.MAX_VALUE});for(i of a)for(l of s)(c=this._muDistance(r[i.index],r[l.index]))>0&&(i.label=Math.min(l.label,c,i.label));return s.push(...a),s}_regionQuery(e,t){var n,r,o,i,a;for(i=e[t],r=new Set,o=n=0,a=e.length;0<=a?0<=n&&n<a:0>=n&&n>a;o=n+=1)o!==t&&this._distanceFn(e[o],i)<=this._epsMax&&r.add(o);return r}_density(e,t,n){var r,o,i;for(r of(o=n[e],i=0,t))i+=this._muDistance(o,n[r]);return i}_muMinP(e){return e>=this._mPtsMax?1:e<=this._mPtsMin?0:(e-this._mPtsMin)/(this._mPtsMax-this._mPtsMin)}_muDistance(e,t){var n;return(n=this._distanceFn(e,t))<=this._epsMin?1:n>this._epsMax?0:(this._epsMax-n)/(this._epsMax-this._epsMin)}}return e.prototype._epsMin=void 0,e.prototype._epsMax=void 0,e.prototype._mPtsMin=void 0,e.prototype._mPtsMax=void 0,e.prototype._distanceFn=void 0,e}.call(this),e.exports=function(){return new n}},function(e,t,n){(function(){var n=this,r=n._,o={},i=Array.prototype,a=Object.prototype,s=Function.prototype,l=i.push,c=i.slice,A=i.concat,u=(i.unshift,a.toString),h=a.hasOwnProperty,d=i.forEach,f=i.map,p=i.reduce,g=i.reduceRight,m=i.filter,v=i.every,y=i.some,b=i.indexOf,I=i.lastIndexOf,x=Array.isArray,w=Object.keys,C=s.bind,E=function(e){return e instanceof E?e:this instanceof E?void(this._wrapped=e):new E(e)};void 0!==e&&e.exports&&(t=e.exports=E),t._=E,E.VERSION="1.4.2";var S=E.each=E.forEach=function(e,t,n){if(null!=e)if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===o)return}else for(var a in e)if(E.has(e,a)&&t.call(n,e[a],a,e)===o)return};E.map=E.collect=function(e,t,n){var r=[];return null==e?r:f&&e.map===f?e.map(t,n):(S(e,function(e,o,i){r[r.length]=t.call(n,e,o,i)}),r)},E.reduce=E.foldl=E.inject=function(e,t,n,r){var o=arguments.length>2;if(null==e&&(e=[]),p&&e.reduce===p)return r&&(t=E.bind(t,r)),o?e.reduce(t,n):e.reduce(t);if(S(e,function(e,i,a){o?n=t.call(r,n,e,i,a):(n=e,o=!0)}),!o)throw new TypeError("Reduce of empty array with no initial value");return n},E.reduceRight=E.foldr=function(e,t,n,r){var o=arguments.length>2;if(null==e&&(e=[]),g&&e.reduceRight===g)return r&&(t=E.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var i=e.length;if(i!==+i){var a=E.keys(e);i=a.length}if(S(e,function(s,l,c){l=a?a[--i]:--i,o?n=t.call(r,n,e[l],l,c):(n=e[l],o=!0)}),!o)throw new TypeError("Reduce of empty array with no initial value");return n},E.find=E.detect=function(e,t,n){var r;return M(e,function(e,o,i){if(t.call(n,e,o,i))return r=e,!0}),r},E.filter=E.select=function(e,t,n){var r=[];return null==e?r:m&&e.filter===m?e.filter(t,n):(S(e,function(e,o,i){t.call(n,e,o,i)&&(r[r.length]=e)}),r)},E.reject=function(e,t,n){var r=[];return null==e?r:(S(e,function(e,o,i){t.call(n,e,o,i)||(r[r.length]=e)}),r)},E.every=E.all=function(e,t,n){t||(t=E.identity);var r=!0;return null==e?r:v&&e.every===v?e.every(t,n):(S(e,function(e,i,a){if(!(r=r&&t.call(n,e,i,a)))return o}),!!r)};var M=E.some=E.any=function(e,t,n){t||(t=E.identity);var r=!1;return null==e?r:y&&e.some===y?e.some(t,n):(S(e,function(e,i,a){if(r||(r=t.call(n,e,i,a)))return o}),!!r)};E.contains=E.include=function(e,t){var n=!1;return null==e?n:b&&e.indexOf===b?-1!=e.indexOf(t):n=M(e,function(e){return e===t})},E.invoke=function(e,t){var n=c.call(arguments,2);return E.map(e,function(e){return(E.isFunction(t)?t:e[t]).apply(e,n)})},E.pluck=function(e,t){return E.map(e,function(e){return e[t]})},E.where=function(e,t){return E.isEmpty(t)?[]:E.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},E.max=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&E.isEmpty(e))return-1/0;var r={computed:-1/0};return S(e,function(e,o,i){var a=t?t.call(n,e,o,i):e;a>=r.computed&&(r={value:e,computed:a})}),r.value},E.min=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&E.isEmpty(e))return 1/0;var r={computed:1/0};return S(e,function(e,o,i){var a=t?t.call(n,e,o,i):e;a<r.computed&&(r={value:e,computed:a})}),r.value},E.shuffle=function(e){var t,n=0,r=[];return S(e,function(e){t=E.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return E.isFunction(e)?e:function(t){return t[e]}};E.sortBy=function(e,t,n){var r=k(t);return E.pluck(E.map(e,function(e,t,o){return{value:e,index:t,criteria:r.call(n,e,t,o)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index<t.index?-1:1}),"value")};var B=function(e,t,n,r){var o={},i=k(t);return S(e,function(t,a){var s=i.call(n,t,a,e);r(o,s,t)}),o};E.groupBy=function(e,t,n){return B(e,t,n,function(e,t,n){(E.has(e,t)?e[t]:e[t]=[]).push(n)})},E.countBy=function(e,t,n){return B(e,t,n,function(e,t,n){E.has(e,t)||(e[t]=0),e[t]++})},E.sortedIndex=function(e,t,n,r){for(var o=(n=null==n?E.identity:k(n)).call(r,t),i=0,a=e.length;i<a;){var s=i+a>>>1;n.call(r,e[s])<o?i=s+1:a=s}return i},E.toArray=function(e){return e?e.length===+e.length?c.call(e):E.values(e):[]},E.size=function(e){return e.length===+e.length?e.length:E.keys(e).length},E.first=E.head=E.take=function(e,t,n){return null==t||n?e[0]:c.call(e,0,t)},E.initial=function(e,t,n){return c.call(e,0,e.length-(null==t||n?1:t))},E.last=function(e,t,n){return null==t||n?e[e.length-1]:c.call(e,Math.max(e.length-t,0))},E.rest=E.tail=E.drop=function(e,t,n){return c.call(e,null==t||n?1:t)},E.compact=function(e){return E.filter(e,function(e){return!!e})};var D=function(e,t,n){return S(e,function(e){E.isArray(e)?t?l.apply(n,e):D(e,t,n):n.push(e)}),n};E.flatten=function(e,t){return D(e,t,[])},E.without=function(e){return E.difference(e,c.call(arguments,1))},E.uniq=E.unique=function(e,t,n,r){var o=n?E.map(e,n,r):e,i=[],a=[];return S(o,function(n,r){(t?r&&a[a.length-1]===n:E.contains(a,n))||(a.push(n),i.push(e[r]))}),i},E.union=function(){return E.uniq(A.apply(i,arguments))},E.intersection=function(e){var t=c.call(arguments,1);return E.filter(E.uniq(e),function(e){return E.every(t,function(t){return E.indexOf(t,e)>=0})})},E.difference=function(e){var t=A.apply(i,c.call(arguments,1));return E.filter(e,function(e){return!E.contains(t,e)})},E.zip=function(){for(var e=c.call(arguments),t=E.max(E.pluck(e,"length")),n=new Array(t),r=0;r<t;r++)n[r]=E.pluck(e,""+r);return n},E.object=function(e,t){for(var n={},r=0,o=e.length;r<o;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},E.indexOf=function(e,t,n){if(null==e)return-1;var r=0,o=e.length;if(n){if("number"!=typeof n)return e[r=E.sortedIndex(e,t)]===t?r:-1;r=n<0?Math.max(0,o+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<o;r++)if(e[r]===t)return r;return-1},E.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(I&&e.lastIndexOf===I)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var o=r?n:e.length;o--;)if(e[o]===t)return o;return-1},E.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),o=0,i=new Array(r);o<r;)i[o++]=e,e+=n;return i};var P=function(){};E.bind=function(e,t){var n,r;if(e.bind===C&&C)return C.apply(e,c.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return r=c.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,r.concat(c.call(arguments)));P.prototype=e.prototype;var o=new P,i=e.apply(o,r.concat(c.call(arguments)));return Object(i)===i?i:o}},E.bindAll=function(e){var t=c.call(arguments,1);return 0==t.length&&(t=E.functions(e)),S(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,t){var n={};return t||(t=E.identity),function(){var r=t.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},E.delay=function(e,t){var n=c.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},E.defer=function(e){return E.delay.apply(E,[e,1].concat(c.call(arguments,1)))},E.throttle=function(e,t){var n,r,o,i,a,s,l=E.debounce(function(){a=i=!1},t);return function(){return n=this,r=arguments,o||(o=setTimeout(function(){o=null,a&&(s=e.apply(n,r)),l()},t)),i?a=!0:(i=!0,s=e.apply(n,r)),l(),s}},E.debounce=function(e,t,n){var r,o;return function(){var i=this,a=arguments,s=n&&!r;return clearTimeout(r),r=setTimeout(function(){r=null,n||(o=e.apply(i,a))},t),s&&(o=e.apply(i,a)),o}},E.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},E.wrap=function(e,t){return function(){var n=[e];return l.apply(n,arguments),t.apply(this,n)}},E.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},E.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},E.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)E.has(e,n)&&(t[t.length]=n);return t},E.values=function(e){var t=[];for(var n in e)E.has(e,n)&&t.push(e[n]);return t},E.pairs=function(e){var t=[];for(var n in e)E.has(e,n)&&t.push([n,e[n]]);return t},E.invert=function(e){var t={};for(var n in e)E.has(e,n)&&(t[e[n]]=n);return t},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=function(e){return S(c.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},E.pick=function(e){var t={},n=A.apply(i,c.call(arguments,1));return S(n,function(n){n in e&&(t[n]=e[n])}),t},E.omit=function(e){var t={},n=A.apply(i,c.call(arguments,1));for(var r in e)E.contains(n,r)||(t[r]=e[r]);return t},E.defaults=function(e){return S(c.call(arguments,1),function(t){for(var n in t)null==e[n]&&(e[n]=t[n])}),e},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e};var Q=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof E&&(e=e._wrapped),t instanceof E&&(t=t._wrapped);var o=u.call(e);if(o!=u.call(t))return!1;switch(o){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var i=n.length;i--;)if(n[i]==e)return r[i]==t;n.push(e),r.push(t);var a=0,s=!0;if("[object Array]"==o){if(s=(a=e.length)==t.length)for(;a--&&(s=Q(e[a],t[a],n,r)););}else{var l=e.constructor,c=t.constructor;if(l!==c&&!(E.isFunction(l)&&l instanceof l&&E.isFunction(c)&&c instanceof c))return!1;for(var A in e)if(E.has(e,A)&&(a++,!(s=E.has(t,A)&&Q(e[A],t[A],n,r))))break;if(s){for(A in t)if(E.has(t,A)&&!a--)break;s=!a}}return n.pop(),r.pop(),s};E.isEqual=function(e,t){return Q(e,t,[],[])},E.isEmpty=function(e){if(null==e)return!0;if(E.isArray(e)||E.isString(e))return 0===e.length;for(var t in e)if(E.has(e,t))return!1;return!0},E.isElement=function(e){return!(!e||1!==e.nodeType)},E.isArray=x||function(e){return"[object Array]"==u.call(e)},E.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){E["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return!(!e||!E.has(e,"callee"))}),E.isFunction=function(e){return"function"==typeof e},E.isFinite=function(e){return E.isNumber(e)&&isFinite(e)},E.isNaN=function(e){return E.isNumber(e)&&e!=+e},E.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==u.call(e)},E.isNull=function(e){return null===e},E.isUndefined=function(e){return void 0===e},E.has=function(e,t){return h.call(e,t)},E.noConflict=function(){return n._=r,this},E.identity=function(e){return e},E.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},E.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};T.unescape=E.invert(T.escape);var G={escape:new RegExp("["+E.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(T.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(e){E[e]=function(t){return null==t?"":(""+t).replace(G[e],function(t){return T[e][t]})}}),E.result=function(e,t){if(null==e)return null;var n=e[t];return E.isFunction(n)?n.call(e):n},E.mixin=function(e){S(E.functions(e),function(t){var n=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),F.call(this,n.apply(E,e))}})};var R=0;E.uniqueId=function(e){var t=R++;return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var _=/(.)^/,V={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},N=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(e,t,n){n=E.defaults({},n,E.templateSettings);var r=new RegExp([(n.escape||_).source,(n.interpolate||_).source,(n.evaluate||_).source].join("|")+"|$","g"),o=0,i="__p+='";e.replace(r,function(t,n,r,a,s){i+=e.slice(o,s).replace(N,function(e){return"\\"+V[e]}),i+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":a?"';\n"+a+"\n__p+='":"",o=s+t.length}),i+="';\n",n.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var a=new Function(n.variable||"obj","_",i)}catch(e){throw e.source=i,e}if(t)return a(t,E);var s=function(e){return a.call(this,e,E)};return s.source="function("+(n.variable||"obj")+"){\n"+i+"}",s},E.chain=function(e){return E(e).chain()};var F=function(e){return this._chain?E(e).chain():e};E.mixin(E),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=i[e];E.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),S(["concat","join","slice"],function(e){var t=i[e];E.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},function(e,t,n){"use strict";(function(e){const r=n(149);function o(e,t){if(e.length!==t.length)return new Error("The vectors must have the same length");let n=0;for(let r=0,o=e.length;r<o;++r)n+=Math.pow(e[r]-t[r],2);return Math.sqrt(n)}class i{constructor(){this.centroidMoved=!0}initCluster(){this.cluster=[],this.clusterInd=[]}defineCentroid(e){if(this.centroidOld=this.centroid?this.centroid:[],this.centroid&&this.cluster.length>0)this.calculateCentroid();else{const t=Math.floor(Math.random()*e.indexes.length);if(this.centroidIndex=e.indexes[t],e.indexes.splice(t,1),this.centroid=[],r.isArray(e.v[this.centroidIndex]))for(let t=0,n=e.v[this.centroidIndex].length;t<n;++t)this.centroid[t]=e.v[this.centroidIndex][t];else this.centroid[0]=e.v[this.centroidIndex]}return this.centroidMoved=!r.isEqual(this.centroid,this.centroidOld),this}calculateCentroid(){this.centroid=[];for(let e=0;e<this.cluster.length;++e)for(let t=0,n=this.cluster[e].length;t<n;++t)this.centroid[t]=this.centroid[t]?this.centroid[t]+this.cluster[e][t]:this.cluster[e][t];for(let e=0,t=this.centroid.length;e<t;++e)this.centroid[e]=this.centroid[e]/this.cluster.length;return this}distanceObjects(e){this.distances||(this.distances=[]);for(let t=0,n=e.v.length;t<n;++t)this.distances[t]=e.distanceFunction(this.centroid,e.v[t]);return this}}class a{constructor(t,n,i){if(!i||!n||!t)throw new Error("Provide 3 arguments: vector, options, callback");if("function"!=typeof i)throw new Error("Provide a callback function");if(!n||!n.k||n.k<1)return i(new Error("Provide a correct number k of clusters"));if(n.distance&&("function"!=typeof n.distance||2!==n.distance.length))return i(new Error("options.distance must be a function with two arguments"));if(!r.isArray(t))return i(new Error("Provide an array of data"));if(this.options=n,this.v=this.checkV(t),this.k=this.options.k,this.distanceFunction=this.options.distance||o,this.v.length<this.k)return i(new Error("The number of points must be greater than\n      the number k of clusters"));this.initialize();const a=this;let s=-1;return function t(){if(0===s)return i(null,a.output());s=0;for(let e=0,t=a.groups.length;e<t;++e)a.groups[e].defineCentroid(a),a.groups[e].distanceObjects(a);a.clustering();for(let e=0,t=a.groups.length;e<t;++e)a.groups[e].centroidMoved&&s++;return e.nextTick(t)}()}checkV(e){let t=1;r.isArray(e[0])&&(t=e[0].length);for(let n=0,o=e.length;n<o;++n)if(r.isArray(e[n])){if(e[n].length!==t)throw new Error("All the elements must have the same dimension");for(let t=0,r=e[n].length;t<r;++t)if(e[n][t]=Number(e[n][t]),isNaN(e[n][t]))throw new Error("All the elements must be float type")}else{if(1!==t)throw new Error("All the elements must have the same dimension");if(e[n]=Number(e[n]),isNaN(e[n]))throw new Error("All the elements must be float type")}return e}initialize(){this.groups=[];for(let e=0,t=this.k;e<t;++e)this.groups[e]=new i(this);this.indexes=[];for(let e=0,t=this.v.length;e<t;++e)this.indexes[e]=e;return this}clustering(){for(let e=0,t=this.groups.length;e<t;++e)this.groups[e].initCluster();for(let e=0,t=this.v.length;e<t;++e){let t=this.groups[0].distances[e],n=0;for(let r=1,o=this.groups.length;r<o;++r)this.groups[r].distances[e]<t&&(t=this.groups[r].distances[e],n=r);this.groups[n].cluster.push(this.v[e]),this.groups[n].clusterInd.push(e)}return this}output(){const e=[];for(let t=0,n=this.groups.length;t<n;++t)e[t]=r.pick(this.groups[t],"centroid","cluster","clusterInd");return e}}t.clusterize=((e,t,n)=>new a(e,t,n)),t._class=a}).call(this,n(100))},function(e,t,n){"use strict";e.exports=n(150)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SinglePlotObject=function e(t,n,r,o,i,a,s,l,c,A,u,h,d,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.donorIndex=t,this.xPre=n,this.x=r,this.yPre=o,this.y=i,this.colourPre=a,this.colour=s,this.symbolPre=l,this.symbol=c,this.radiusPre=A,this.radius=u,this.stackedBarValuesPre=h.slice();var p=this.stackedBarValuesPre.length;this.stackedBarValuesPreCumulative=new Array(p).fill(0);for(var g=0;g<p;++g)for(var m=g;m<p;++m)this.stackedBarValuesPreCumulative[g]+=this.stackedBarValuesPre[m].value}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kGtElementArrLength="k must be less than the number of elements in the input array"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.distance=((e,t)=>{if(e.length!==t.length)throw new Error("the inputs must have the same dimension");const n=Array.from(e.keys()).map(n=>Math.pow(Math.abs(e[n]-t[n]),2)).reduce((e,t)=>e+t,0);return Math.sqrt(n)})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=n(154),o=n(153),i=n(65);class a{constructor(e,t,n){this.Elements=e,this.K=t,this.DistanceFn=n,this.OptimisationCompleted=!1,this.iterate=(()=>{this.IterationCount++,this.Clusters||this.allocateToClustersAroundCurrentMedoids();const e=this.Medoids,t=this.Clusters,n=this.calculateCurrentCost();let r=n;for(let e=0;e<this.Medoids.length;e++){const t=e=>0===this.Medoids.filter(t=>0===this.DistanceFn(e,t)).length;for(const n of this.Elements.filter(t)){const t=this.Medoids.slice();t[e]=n;const o=new a(this.Elements.slice(),this.K,this.DistanceFn);o.Medoids=t,o.allocateToClustersAroundCurrentMedoids();const i=o.calculateCurrentCost();i<r&&(r=i,this.Clusters=o.Clusters,this.Medoids=t)}}return this.calculateCurrentCost()<n||(this.Clusters=t,this.Medoids=e,this.OptimisationCompleted=!0,!1)}),this.getClusteredData=(()=>(this.OptimisationCompleted||this.runToCompletion(),this.Clusters.map(e=>e.Elements.map(e=>e.Element)))),this.runToCompletion=(()=>{for(;this.iterate(););}),this.allocateToClustersAroundCurrentMedoids=(()=>{this.Clusters=new Array,this.Medoids.forEach(e=>{this.Clusters.push(new i.Cluster({Elements:[],Medoid:e}))}),this.Elements.forEach((e,t)=>{const n=this.findDistances(this.Clusters.map(e=>e.Medoid),e),r=n.reduce((e,t,n,r)=>t<r[e]?n:e,0);this.Clusters[r].Elements.push({DistanceFromMedoid:n[r],Element:e})})}),this.calculateCurrentCost=(()=>this.Clusters.map(e=>e.getCost()).reduce((e,t)=>e+t,0)),this.findDistances=((e,t)=>e.map(e=>this.DistanceFn(e,t))),this.selectInitialMedoids=(()=>{if(this.K>=this.Elements.length)throw o.kGtElementArrLength;const e=[],t=(e,t)=>{for(const n of t)if(0===this.DistanceFn(n,e))return!1;return!0};let n=0;for(;n<this.Elements.length&&e.length<this.K;)t(this.Elements[n],e)&&e.push(this.Elements[n]),n++;return e}),this.DistanceFn=this.DistanceFn||r.distance,this.Medoids=this.selectInitialMedoids(),this.IterationCount=0}get OptimisationStarted(){return this.IterationCount>0}}a.clusterElements=((e,t,n)=>(a.getInstance(e,t,n),new Array)),a.getInstance=((e,t,n)=>new a(e,t,n)),t.Clusterer=a},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),r(n(65)),r(n(155))},function(e,t,n){"use strict";var r=n(58);t.name="sqrt",t.factory=function(e,t,n,o){var i=o("sqrt",{number:a,Complex:function(e){return e.sqrt()},BigNumber:function(e){return!e.isNegative()||t.predictable?e.sqrt():a(e.toNumber())},"Array | Matrix":function(e){return r(e,i,!0)},Unit:function(e){return e.pow(.5)}});function a(n){return n>=0||t.predictable?Math.sqrt(n):new e.Complex(n,0).sqrt()}return i.toTex={1:"\\sqrt{${args[0]}}"},i}},function(e,t,n){"use strict";t.name="std",t.factory=function(e,t,r,o){var i=r(n(157)),a=r(n(35)),s=o("std",{"Array | Matrix":l,"Array | Matrix, string":l,"...":function(e){return l(e)}});return s.toTex=void 0,s;function l(e,t){if(0==e.length)throw new SyntaxError("Function std requires one or more parameters (0 provided)");return i(a.apply(null,arguments))}}},function(e,t){!function(){"use strict";e.exports=function(e){if(!Array.isArray(e))throw new TypeError("stdev()::invalid input argument. Must provide an array.");var t=e.length,n=0,r=0,o=0,i=0;if(t<2)return 0;for(var a=0;a<t;a++)n+=1,r+=(i=e[a]-r)/n,o+=i*(e[a]-r);return Math.sqrt(o/(n-1))}}()},function(e,t){e.exports=function(e,t){var n,r=0;for(n=0;n<e.length;n++)r+=Math.pow(e[n]-t[n],2);return Math.sqrt(r)}},function(e,t,n){"use strict";var r=n(26);e.exports=function(e,t,n,o){var i,a,s=t.length;for(i=r(n,o),a=0;a<s;a++)e[a]=i(t[a]);return e}},function(e,t,n){"use strict";var r=n(26);e.exports=function(e,t,n,o){var i,a,s=t.length;if(e.length!==s)throw new Error("pdf()::invalid input arguments. Input and output matrices must be the same length.");for(i=r(n,o),a=0;a<s;a++)e.data[a]=i(t.data[a]);return e}},function(e,t,n){"use strict";var r=n(5),o=n(10),i=n(68),a=n(67),s=n(66);e.exports=function(e,t){var n,l,c,A=r(e);if(!A&&!o(e))throw new TypeError("deepGet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+e+"`.");if(l=a(),arguments.length>1&&(c=i(l,t)))throw c;return n=A?e.split(l.sep):e,function(e){if("object"==typeof e&&null!==e)return s(e,n)}}},function(e,t,n){"use strict";var r=n(5),o=n(10),i=n(68),a=n(67),s=n(66);e.exports=function(e,t,n){var l,c,A,u=r(t);if("object"==typeof e&&null!==e){if(!u&&!o(t))throw new TypeError("deepGet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+t+"`.");if(c=a(),arguments.length>2&&(A=i(c,n)))throw A;return l=u?t.split(c.sep):t,s(e,l)}},e.exports.factory=n(163)},function(e,t,n){"use strict";var r=n(5),o=n(10),i=n(71),a=n(70),s=n(69);e.exports=function(e,t){var n,l,c,A=r(e);if(!A&&!o(e))throw new TypeError("deepSet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+e+"`.");if(l=a(),arguments.length>1&&(c=i(l,t)))throw c;return n=A?e.split(l.sep):e,function(e,t){return"object"==typeof e&&null!==e&&s(e,n,l.create,t)}}},function(e,t,n){"use strict";var r=n(5),o=n(10),i=n(71),a=n(70),s=n(69);e.exports=function(e,t,n,l){var c,A,u,h=r(t);if("object"!=typeof e||null===e)return!1;if(!h&&!o(t))throw new TypeError("deepSet()::invalid input argument. Key path must be a string primitive or a key array. Value: `"+t+"`.");if(A=a(),arguments.length>3&&(u=i(A,l)))throw u;return c=h?t.split(A.sep):t,s(e,c,A.create,n)},e.exports.factory=n(165)},function(e,t,n){"use strict";var r=n(166).factory,o=n(164).factory,i=n(26);e.exports=function(e,t,n,a,s){var l,c,A,u,h,d=e.length,f={};if(arguments.length>4&&(f.sep=s),d)for(l=o(a,f),c=r(a,f),A=i(t,n),h=0;h<d;h++)u=l(e[h]),c(e[h],"number"==typeof u?A(u):NaN);return e}},function(e,t,n){"use strict";var r=n(26);e.exports=function(e,t,n,o,i){var a,s,l,c=t.length;for(a=r(n,o),l=0;l<c;l++)s=i(t[l],l),e[l]="number"==typeof s?a(s):NaN;return e}},function(e,t,n){"use strict";var r=n(26);e.exports=function(e,t,n,o){var i,a,s=t.length;for(i=r(n,o),a=0;a<s;a++)"number"==typeof t[a]?e[a]=i(t[a]):e[a]=NaN;return e}},function(e,t,n){"use strict";var r=Math.exp,o=Math.pow,i=Math.sqrt,a=Math.PI;e.exports=function(e,t,n){if(0===n)return e===t?Number.POSITIVE_INFINITY:0;var s=o(n,2);return 1/i(2*s*a)*r(-1/(2*s)*o(e-t,2))}},function(e,t,n){"use strict";var r=n(87);e.exports=function(e){return r(e)&&e>=0}},function(e,t,n){"use strict";var r=n(42),o=n(16),i=n(171),a=n(72),s=n(33),l=n(5);e.exports=function(e,t){return r(t)?t.hasOwnProperty("mu")&&(e.mu=t.mu,!o(e.mu))?new TypeError("pdf()::invalid option. `mu` parameter must be a number primitive. Option: `"+e.mu+"`."):t.hasOwnProperty("sigma")&&(e.sigma=t.sigma,!i(e.sigma))?new TypeError("pdf()::invalid option. `sigma` parameter must be a non-negative number. Option: `"+e.sigma+"`."):t.hasOwnProperty("copy")&&(e.copy=t.copy,!a(e.copy))?new TypeError("pdf()::invalid option. Copy option must be a boolean primitive. Option: `"+e.copy+"`."):t.hasOwnProperty("accessor")&&(e.accessor=t.accessor,!s(e.accessor))?new TypeError("pdf()::invalid option. Accessor must be a function. Option: `"+e.accessor+"`."):t.hasOwnProperty("path")&&(e.path=t.path,!l(e.path))?new TypeError("pdf()::invalid option. Key path option must be a string primitive. Option: `"+e.path+"`."):t.hasOwnProperty("sep")&&(e.sep=t.sep,!l(e.sep))?new TypeError("pdf()::invalid option. Separator option must be a string primitive. Option: `"+e.sep+"`."):t.hasOwnProperty("dtype")&&(e.dtype=t.dtype,!l(e.dtype))?new TypeError("pdf()::invalid option. Data type option must be a string primitive. Option: `"+e.dtype+"`."):null:new TypeError("pdf()::invalid input argument. Options argument must be an object. Value: `"+t+"`.")}},function(e,t,n){"use strict";var r=n(32),o=n(21);e.exports=function(e){var t,n,i,a,s,l,c,A,u,h,d,f,p,g,m;if(s=e.split(","),i=r(s[0],this.shape[0]),a=r(s[1],this.shape[1]),c=(t=i.length)*(n=a.length),d=new o[this.dtype](c),l=new this.constructor(d,this.dtype,[t,n],0,[n,1]),c)for(A=this.strides[0],u=this.strides[1],h=this.offset,g=0;g<t;g++)for(f=h+i[g]*A,p=g*n,m=0;m<n;m++)d[p+m]=this.data[f+a[m]*u];return l}},function(e,t,n){"use strict";var r=n(21);e.exports=function(e,t){var n,o,i,a,s,l,c,A,u,h,d,f,p,g,m,v;if(l=this.strides[0],c=this.strides[1],h=this.offset,arguments.length<2)for(m=(p=e).length,s=new r[this.dtype](m),i=new this.constructor(s,this.dtype,[1,m],0,[m,1]),a=l<0?-1:1,v=0;v<m;v++)g=p[v]%l,d=a*(p[v]-g),s[v]=this.data[h+d+g*c];else{if(null===e)for(n=this.shape[0],p=new Array(n),v=0;v<n;v++)p[v]=v;else n=e.length,p=e;if(null===t)for(o=this.shape[1],g=new Array(o),v=0;v<o;v++)g[v]=v;else o=t.length,g=t;for(s=new r[this.dtype](n*o),A=(i=new this.constructor(s,this.dtype,[n,o],0,[o,1])).strides[0],u=i.strides[1],m=0;m<n;m++)for(d=h+p[m]*l,f=m*A,v=0;v<o;v++)s[f+v*u]=this.data[d+g[v]*c]}return i}},function(e,t,n){"use strict";e.exports=function(e){var t,n;if(!(e<0&&(e+=this.length)<0))return t=e-(n=e%this.strides[0]),this.strides[0]<0&&(t=-t),this.data[this.offset+t+n*this.strides[1]]}},function(e,t,n){"use strict";e.exports=function(e,t){return this.data[this.offset+e*this.strides[0]+t*this.strides[1]]}},function(e,t,n){"use strict";var r=n(32);e.exports=function(e,t,n){var o,i,a,s,l,c,A,u,h,d,f,p,g,m,v,y,b,I,x;if(c=e.split(","),"function"==typeof t?a=t:"number"!=typeof t&&(A=t),s=r(c[0],this.shape[0]),l=r(c[1],this.shape[1]),o=s.length,i=l.length,!o||!i)return this;if(h=this.strides[0],d=this.strides[1],g=this.offset,a)for(u=arguments.length>2?n:this,b=0;b<o;b++)for(v=g+s[b]*h,I=0;I<i;I++)x=v+l[I]*d,this.data[x]=a.call(u,this.data[x],s[b],l[I],x);else if(A){if(o!==A.shape[0])throw new Error("invalid input arguments. Row subsequence does not match input matrix dimensions. Expected a ["+o+","+i+"] matrix and instead received a ["+A.shape.join(",")+"] matrix.");if(i!==A.shape[1])throw new Error("invalid input arguments. Column subsequence does not match input matrix dimensions. Expected a ["+o+","+i+"] matrix and instead received a ["+A.shape.join(",")+"] matrix.");for(f=A.strides[0],p=A.strides[1],m=A.offset,b=0;b<o;b++)for(v=g+s[b]*h,y=m+b*f,I=0;I<i;I++)this.data[v+l[I]*d]=A.data[y+I*p]}else for(b=0;b<o;b++)for(v=g+s[b]*h,I=0;I<i;I++)this.data[v+l[I]*d]=t;return this}},function(e,t,n){"use strict";var r=n(82),o=n(81),i=n(80),a=n(79),s=n(78),l=n(77);function c(e,t){var n,r;if(null===e)for(n=new Array(t),r=0;r<t;r++)n[r]=r;else n=e;return n}e.exports=function(){var e,t,n,A,u=arguments.length;for(e=new Array(u),A=0;A<u;A++)e[A]=arguments[A];return u<3?"function"==typeof e[1]?o(this,e[0],e[1]):"number"==typeof e[1]?r(this,e[0],e[1]):i(this,e[0],e[1]):3===u?"function"==typeof e[1]?o(this,e[0],e[1],e[2]):"function"==typeof e[2]?(t=c(e[0],this.shape[0]),n=c(e[1],this.shape[1]),a(this,t,n,e[2],this)):"number"==typeof e[2]?(t=c(e[0],this.shape[0]),n=c(e[1],this.shape[1]),s(this,t,n,e[2])):(t=c(e[0],this.shape[0]),n=c(e[1],this.shape[1]),l(this,t,n,e[2])):(t=c(e[0],this.shape[0]),n=c(e[1],this.shape[1]),a(this,t,n,e[2],e[3])),this}},function(e,t,n){"use strict";e.exports=function(e,t){var n,r;return e<0&&(e+=this.length)<0?this:(n=e-(r=e%this.strides[0]),this.strides[0]<0&&(n=-n),this.data[this.offset+n+r*this.strides[1]]=t,this)}},function(e,t,n){"use strict";e.exports=function(e,t,n){return(e=this.offset+e*this.strides[0]+t*this.strides[1])>=0&&(this.data[e]=n),this}},function(e,t,n){"use strict";function r(e,t,n,o,i){return this instanceof r?(this.dtype=t,this.shape=n,this.strides=i,this.offset=o,this.ndims=n.length,this.length=e.length,this.nbytes=e.byteLength,this.data=e,this):new r(e,t,n,o,i)}r.prototype.set=n(180),r.prototype.iset=n(179),r.prototype.mset=n(178),r.prototype.sset=n(177),r.prototype.get=n(176),r.prototype.iget=n(175),r.prototype.mget=n(174),r.prototype.sget=n(173),r.prototype.toString=n(76),r.prototype.toJSON=n(75),e.exports=r},function(e,t,n){"use strict";var r=n(5),o=n(86),i=n(83),a=n(181),s=n(21),l=n(73);e.exports=function(){var e,t,n,c,A,u;if(1===arguments.length?n=arguments[0]:2===arguments.length?r(arguments[1])?(n=arguments[0],e=arguments[1]):(c=arguments[0],n=arguments[1]):(c=arguments[0],n=arguments[1],e=arguments[2]),2!==(t=n.length))throw new Error("invalid input argument. Shape must be a 2-element array. Value: `"+n+"`.");for(A=1,u=0;u<t;u++)A*=n[u];if(c){if(!e&&(e=i(c),!o(l,e)))throw new TypeError("invalid input argument. Input data must be a valid type. Consult the documentation for a list of valid data types. Value: `"+c+"`.");if(A!==c.length)throw new Error("invalid input argument. Matrix shape does not match the input data length.")}else e||(e="float64"),c=new s[e](A);return new a(c,e,n,0,[n[1],1])}},function(e,t,n){"use strict";var r=n(43),o={Int8Array:null,Uint8Array:null,Uint8ClampedArray:null,Int16Array:null,Uint16Array:null,Int32Array:null,Uint32Array:null,Float32Array:null,Float64Array:null};!function(){var e,t,n=r(o),i=n.length;for(t=0;t<i;t++)e=n[t],o[e]=new Function("arr","return new "+e+"( arr );")}(),e.exports=o},function(e,t,n){"use strict";var r=n(46),o=n(28);e.exports=function(e,t,n){var i,a;if(!r(e))throw new TypeError("invalid input argument. First argument must be an array-like object. Value: `"+e+"`.");if(0===(i=e.length))return-1;if(3===arguments.length){if(!o(n))throw new TypeError("invalid input argument. `fromIndex` must be an integer. Value: `"+n+"`.");if(n>=0){if(n>=i)return-1;a=n}else(a=i+n)<0&&(a=0)}else a=0;if(t!=t){for(;a<i;a++)if(e[a]!=e[a])return a}else for(;a<i;a++)if(e[a]===t)return a;return-1}},function(e,t,n){"use strict";var r=Object.prototype.toString;e.exports=function(e){var t=r.call(e),n="[object Arguments]"===t;return n||(n="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===r.call(e.callee)),n}},function(e,t,n){"use strict";var r=n(74),o=n(43).shim();e.exports=function(e){var t,n,i,a,s;if(!(e instanceof Error))throw new TypeError("invalid input argument. Must provide an error object. Value: `"+e+"`.");for(a=new e.constructor(e.message),e.stack&&(a.stack=e.stack),e.code&&(a.code=e.code),e.errno&&(a.errno=e.errno),e.syscall&&(a.syscall=e.syscall),t=o(e),s=0;s<t.length;s++)i=t[s],(n=Object.getOwnPropertyDescriptor(e,i)).hasOwnProperty("value")&&(n.value=r(e[i])),Object.defineProperty(a,i,n);return a}},function(e,t,n){"use strict";e.exports=n(186)},function(e,t,n){"use strict";e.exports=/^\/((?:\\\/|[^\/])+)\/([imgy]*)$/},function(e,t,n){"use strict";var r=n(5),o=n(188);e.exports=function(e){if(!r(e))throw new TypeError("invalid input argument. Must provide a regular expression string. Value: `"+e+"`.");return(e=o.exec(e))?new RegExp(e[1],e[2]):null}},function(e,t,n){"use strict";var r=Object.prototype.toString;e.exports=function(e){var t;return null===e?"null":"object"==(t=typeof e)?function(e){var t=r.call(e).slice(8,-1);return"Object"!==t&&"Error"!==t||!e.constructor?t:function(e){if(e.name)return e.name;var t=/^\s*function\s*([^\(]*)/im.exec(e.toString());return t?t[1]:""}(e.constructor)}(e):t}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&null!==e&&(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";(function(t){var r=n(10),o=n(191),i=n(190),a=n(189),s=n(187),l=n(184),c=n(43),A=n(183);e.exports=function e(n,u,h,d,f){var p,g,m,v,y,b,I,x,w,C;if(f-=1,"object"!=typeof n||null===n)return n;if(o(n))return new t(n);if(n instanceof Error)return s(n);if("Date"===(m=i(n)))return new Date(+n);if("RegExp"===m)return a(n.toString());if("Set"===m)return new Set(n);if("Map"===m)return new Map(n);if("String"===m||"Boolean"===m||"Number"===m)return n.valueOf();if(y=A[m])return y(n);if("Array"!==m&&"Object"!==m)return"function"==typeof Object.freeze?function(t){var n,o,i,a,s,l,c=[],A=[];for(s=Object.create(Object.getPrototypeOf(t)),c.push(t),A.push(s),n=Object.getOwnPropertyNames(t),l=0;l<n.length;l++)o=n[l],(i=Object.getOwnPropertyDescriptor(t,o)).hasOwnProperty("value")&&(a=r(t[o])?[]:{},i.value=e(t[o],a,c,A,-1)),Object.defineProperty(s,o,i);return Object.isExtensible(t)||Object.preventExtensions(s),Object.isSealed(t)&&Object.seal(s),Object.isFrozen(t)&&Object.freeze(s),s}(n):{};if(g=c(n),f>0)for(p=m,C=0;C<g.length;C++)x=n[b=g[C]],m=i(x),"object"!=typeof x||null===x||"Array"!==m&&"Object"!==m||o(x)?"Object"===p?((v=Object.getOwnPropertyDescriptor(n,b)).hasOwnProperty("value")&&(v.value=e(x)),Object.defineProperty(u,b,v)):u[b]=e(x):-1===(w=l(h,x))?(I=r(x)?[]:{},h.push(x),d.push(I),"Array"===p?u[b]=e(x,I,h,d,f):((v=Object.getOwnPropertyDescriptor(n,b)).hasOwnProperty("value")&&(v.value=e(x,I,h,d,f)),Object.defineProperty(u,b,v))):u[b]=d[w];else if("Array"===m)for(C=0;C<g.length;C++)u[b=g[C]]=n[b];else for(C=0;C<g.length;C++)b=g[C],v=Object.getOwnPropertyDescriptor(n,b),Object.defineProperty(u,b,v);return Object.isExtensible(n)||Object.preventExtensions(u),Object.isSealed(n)&&Object.seal(u),Object.isFrozen(n)&&Object.freeze(u),u}}).call(this,n(102).Buffer)},function(e,t,n){"use strict";e.exports=Number.POSITIVE_INFINITY},function(e,t,n){"use strict";var r=n(5),o=n(32),i=n(21);e.exports=function(e){var t,n,a,s,l,c,A,u,h,d,f,p,g,m,v;if(!r(e))throw new TypeError("invalid input argument. Must provide a string primitive. Value: `"+e+"`.");if(2!==(l=e.split(",")).length)throw new Error("invalid input argument. Subsequence string must specify row and column subsequences. Value: `"+e+"`.");if(a=o(l[0],this.shape[0]),s=o(l[1],this.shape[1]),A=(t=a.length)*(n=s.length),f=new i[this.dtype](A),c=new this.constructor(f,this.dtype,[t,n],0,[n,1]),A)for(u=this.strides[0],h=this.strides[1],d=this.offset,m=0;m<t;m++)for(p=d+a[m]*u,g=m*n,v=0;v<n;v++)f[g+v]=this.data[p+s[v]*h];return c}},function(e,t,n){"use strict";var r=n(45),o=n(21);e.exports=function(e,t){var n,i,a,s,l,c,A,u,h,d,f,p,g,m,v,y;if(c=this.strides[0],A=this.strides[1],d=this.offset,arguments.length<2){if(!r(e))throw new TypeError("invalid input argument. Linear indices must be specified as a nonnegative integer array. Value: `"+e+"`.");for(g=[],y=0;y<e.length;y++)e[y]<this.length&&g.push(e[y]);for(v=g.length,l=new o[this.dtype](v),a=new this.constructor(l,this.dtype,[1,v],0,[v,1]),s=c<0?-1:1,y=0;y<v;y++)m=g[y]%c,f=s*(g[y]-m),l[y]=this.data[d+f+m*A]}else{if(n=this.shape[0],null===e)for(g=new Array(n),y=0;y<n;y++)g[y]=y;else{if(!r(e))throw new TypeError("invalid input argument. Row indices must be specified as a nonnegative integer array. Value: `"+e+"`.");for(g=[],y=0;y<e.length;y++)e[y]<n&&g.push(e[y])}if(i=this.shape[1],null===t)for(m=new Array(i),y=0;y<i;y++)m[y]=y;else{if(!r(t))throw new TypeError("invalid input argument. Column indices must be specified as a nonnegative integer array. Value: `"+t+"`.");for(m=[],y=0;y<t.length;y++)t[y]<i&&m.push(t[y])}for(n=g.length,i=m.length,l=new o[this.dtype](n*i),u=(a=new this.constructor(l,this.dtype,[n,i],0,[i,1])).strides[0],h=a.strides[1],v=0;v<n;v++)for(f=d+g[v]*c,p=v*u,y=0;y<i;y++)l[p+y*h]=this.data[f+m[y]*A]}return a}},function(e,t,n){"use strict";var r=n(28);e.exports=function(e){var t,n;if(!r(e))throw new TypeError("invalid input argument. Must provide a integer. Value: `"+e+"`.");if(!(e<0&&(e+=this.length)<0))return t=e-(n=e%this.strides[0]),this.strides[0]<0&&(t=-t),this.data[this.offset+t+n*this.strides[1]]}},function(e,t,n){"use strict";var r=n(27);e.exports=function(e,t){if(!r(e)||!r(t))throw new TypeError("invalid input argument. Indices must be nonnegative integers. Values: `["+e+","+t+"]`.");return this.data[this.offset+e*this.strides[0]+t*this.strides[1]]}},function(e,t,n){"use strict";var r=n(5),o=n(16),i=n(33),a=n(32);e.exports=function(e,t,n){var s,l,c,A,u,h,d,f,p,g,m,v,y,b,I,x,w,C,E;if(!r(e))throw new TypeError("invalid input argument. Must provide a string primitive. Value: `"+e+"`.");if(2!==(h=e.split(",")).length)throw new Error("invalid input argument. Subsequence string must specify row and column subsequences. Value: `"+e+"`.");if(i(t)?c=t:o(t)||(d=t),A=a(h[0],this.shape[0]),u=a(h[1],this.shape[1]),s=A.length,l=u.length,!s||!l)return this;if(p=this.strides[0],g=this.strides[1],y=this.offset,c)for(f=arguments.length>2?n:this,w=0;w<s;w++)for(I=y+A[w]*p,C=0;C<l;C++)E=I+u[C]*g,this.data[E]=c.call(f,this.data[E],A[w],u[C],E);else if(d){if(s!==d.shape[0])throw new Error("invalid input arguments. Row subsequence does not match input matrix dimensions. Expected a ["+s+","+l+"] matrix and instead received a ["+d.shape.join(",")+"] matrix.");if(l!==d.shape[1])throw new Error("invalid input arguments. Column subsequence does not match input matrix dimensions. Expected a ["+s+","+l+"] matrix and instead received a ["+d.shape.join(",")+"] matrix.");for(m=d.strides[0],v=d.strides[1],b=d.offset,w=0;w<s;w++)for(I=y+A[w]*p,x=b+w*m,C=0;C<l;C++)this.data[I+u[C]*g]=d.data[x+C*v]}else for(w=0;w<s;w++)for(I=y+A[w]*p,C=0;C<l;C++)this.data[I+u[C]*g]=t;return this}},function(e,t,n){"use strict";var r=n(33),o=n(44),i=n(16),a=n(45),s=n(82),l=n(81),c=n(80),A=n(79),u=n(78),h=n(77);function d(e,t){var n,r;if(null===e)for(n=new Array(t),r=0;r<t;r++)n[r]=r;else{if(!a(e))throw new TypeError("invalid input argument. Row and column indices must be arrays of nonnegative integers. Value: `"+e+"`.");for(n=[],r=0;r<e.length;r++)e[r]<t&&n.push(e[r])}return n}e.exports=function(){var e,t,n,f,p=arguments.length;for(e=new Array(p),f=0;f<p;f++)e[f]=arguments[f];if(p<3){if(!a(e[0]))throw new TypeError("invalid input argument. First argument must be an array of nonnegative integers. Value: `"+e[0]+"`.");r(e[1])?l(this,e[0],e[1]):i(e[1])||o(e[1])?s(this,e[0],e[1]):c(this,e[0],e[1])}else if(3===p)if(r(e[1])){if(!a(e[0]))throw new TypeError("invalid input argument. First argument must be an array of nonnegative integers. Value: `"+e[0]+"`.");l(this,e[0],e[1],e[2])}else r(e[2])?(t=d(e[0],this.shape[0]),n=d(e[1],this.shape[1]),A(this,t,n,e[2],this)):i(e[2])?(t=d(e[0],this.shape[0]),n=d(e[1],this.shape[1]),u(this,t,n,e[2])):(t=d(e[0],this.shape[0]),n=d(e[1],this.shape[1]),h(this,t,n,e[2]));else{if(!r(e[2]))throw new TypeError("invalid input argument. Callback argument must be a function. Value: `"+e[2]+"`.");t=d(e[0],this.shape[0]),n=d(e[1],this.shape[1]),A(this,t,n,e[2],e[3])}return this}},function(e,t,n){"use strict";var r=n(28),o=n(44),i=n(16);e.exports=function(e,t){var n,a;if(!r(e))throw new TypeError("invalid input argument. An index must be an integer. Value: `"+e+"`.");if(!i(t)&&!o(t))throw new TypeError("invalid input argument. An input value must be a number primitive. Value: `"+t+"`.");return e<0&&(e+=this.length)<0?this:(n=e-(a=e%this.strides[0]),this.strides[0]<0&&(n=-n),this.data[this.offset+n+a*this.strides[1]]=t,this)}},function(e,t,n){"use strict";var r=n(27),o=n(44),i=n(16);e.exports=function(e,t,n){if(!r(e)||!r(t))throw new TypeError("invalid input argument. Row and column indices must be nonnegative integers. Values: `["+e+","+t+"]`.");if(!i(n)&&!o(n))throw new TypeError("invalid input argument. An input value must be a number primitive. Value: `"+n+"`.");return(e=this.offset+e*this.strides[0]+t*this.strides[1])>=0&&(this.data[e]=n),this}},function(e,t,n){"use strict";function r(e,t,n,o,i){return this instanceof r?(Object.defineProperty(this,"dtype",{value:t,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"shape",{value:n,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"strides",{value:i,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"offset",{value:o,configurable:!1,enumerable:!0,writable:!0}),Object.defineProperty(this,"ndims",{value:n.length,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"length",{value:e.length,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"nbytes",{value:e.byteLength,configurable:!1,enumerable:!0,writable:!1}),Object.defineProperty(this,"data",{value:e,configurable:!1,enumerable:!0,writable:!1}),this):new r(e,t,n,o,i)}r.prototype.set=n(201),r.prototype.iset=n(200),r.prototype.mset=n(199),r.prototype.sset=n(198),r.prototype.get=n(197),r.prototype.iget=n(196),r.prototype.mget=n(195),r.prototype.sget=n(194),r.prototype.toString=n(76),r.prototype.toJSON=n(75),e.exports=r},function(e,t,n){"use strict";e.exports={Int8Array:"int8",Uint8Array:"uint8",Uint8ClampedArray:"uint8_clamped",Int16Array:"int16",Uint16Array:"uint16",Int32Array:"int32",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"generic"}},function(e,t,n){"use strict";var r=n(203);e.exports=function(e){return r[e]||null}},function(e,t,n){"use strict";var r={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,generic:Array};e.exports=r},function(e,t,n){"use strict";var r=n(205);e.exports=function(e){return r[e]||null}},function(e,t,n){"use strict";e.exports={Int8Array:"int8",Uint8Array:"uint8",Uint8ClampedArray:"uint8_clamped",Int16Array:"int16",Uint16Array:"uint16",Int32Array:"int32",Uint32Array:"uint32",Float32Array:"float32",Float64Array:"float64",Array:"generic"}},function(e,t,n){"use strict";var r=n(207);e.exports=function(e){return r[e]||null}},function(e,t,n){"use strict";e.exports=function(e){return"number"==typeof e&&e!=e}},function(e,t,n){"use strict";var r=n(87);e.exports=function(e){return r(e)&&e%1==0}},function(e,t,n){"use strict";var r=n(5),o=n(45),i=n(86),a=n(10),s=n(85),l=n(83),c=n(202),A=n(21),u=n(73);e.exports=function(){var e,t,n,h,d,f,p,g;if(1===arguments.length?(n=arguments[0],d=2):2===arguments.length?r(arguments[1])?(n=arguments[0],e=arguments[1],d=23):(h=arguments[0],n=arguments[1],d=12):(h=arguments[0],n=arguments[1],e=arguments[2],d=123),!o(n))throw new TypeError("invalid input argument. A matrix shape must be an array of nonnegative integers. Value: `"+n+"`.");if(2!==(t=n.length))throw new Error("invalid input argument. Shape must be a 2-element array. Value: `"+n+"`.");if(123===d||23===d){if(!i(u,e))throw new TypeError("invalid input argument. Unrecognized/unsupported data type. Value: `"+e+"`.")}else e="float64";for(f=1,g=0;g<t;g++)f*=n[g];if(123===d||12===d){if(p=l(h),!i(u,p)&&!a(h))throw new TypeError("invalid input argument. Input data must be a valid type. Consult the documentation for a list of valid data types. Value: `"+h+"`.");if(f!==h.length)throw new Error("invalid input argument. Matrix shape does not match the input data length.");123===d&&p!==e||"generic"===p?h=s(h,e):e=p}else h=new A[e](f);return new c(h,e,n,0,[n[1],1])}},function(e,t,n){"use strict";e.exports=n(211),e.exports.raw=n(182)},function(e,t,n){"use strict";var r={int8:Int8Array,uint8:Uint8Array,uint8_clamped:Uint8ClampedArray,int16:Int16Array,uint16:Uint16Array,int32:Int32Array,uint32:Uint32Array,float32:Float32Array,float64:Float64Array,generic:Array};e.exports=r},function(e,t,n){"use strict";var r=n(213);e.exports=function(e){return r[e]||null}},function(e,t,n){"use strict";e.exports=function(e){return null!==e&&"object"==typeof e&&"object"==typeof e.data&&"object"==typeof e.shape&&"number"==typeof e.offset&&"object"==typeof e.strides&&"string"==typeof e.dtype&&"number"==typeof e.length}},function(e,t,n){"use strict";var r=n(28),o=n(88);e.exports=function(e){return null!==e&&"object"==typeof e&&r(e.length)&&e.length>=0&&e.length<=o&&"number"==typeof e.BYTES_PER_ELEMENT&&"number"==typeof e.byteOffset&&"number"==typeof e.byteLength}},function(e,t,n){"use strict";var r=n(16),o=n(46),i=n(216),a=n(215),s=n(214),l=n(212),c=n(172),A=n(170),u=n(169),h=n(168),d=n(167),f=n(162),p=n(161);e.exports=function(e,t){var n,g,m,v,y,b={};if(arguments.length>1&&(g=c(b,t)))throw g;if(b.mu=void 0!==b.mu?b.mu:0,b.sigma=void 0!==b.sigma?b.sigma:1,r(e))return A(e,b.mu,b.sigma);if(a(e)){if(!1!==b.copy){if(v=b.dtype||"float64",null===(n=s(v)))throw new Error("pdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+v+"`.");y=new n(e.length),m=l(y,e.shape,v)}else m=e;return f(m,e,b.mu,b.sigma)}if(i(e)){if(!1===b.copy)m=e;else{if(v=b.dtype||"float64",null===(n=s(v)))throw new Error("pdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+v+"`.");m=new n(e.length)}return p(m,e,b.mu,b.sigma)}if(o(e)){if(b.path)return b.sep=b.sep||".",d(e,b.mu,b.sigma,b.path,b.sep);if(!1===b.copy)m=e;else if(b.dtype){if(null===(n=s(b.dtype)))throw new TypeError("pdf()::invalid option. Data type option does not have a corresponding array constructor. Option: `"+b.dtype+"`.");m=new n(e.length)}else m=new Array(e.length);return b.accessor?h(m,e,b.mu,b.sigma,b.accessor):u(m,e,b.mu,b.sigma)}return NaN}},function(e,t,n){"use strict";var r=n(217),o=n(160),i=n(159),a=n(10),s=n(33),l={};function c(e,t,n,r){return e((r-n)/t)}function A(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function u(e){return function(t){return!1===a(t)?e(t):t.map(function(t){return e(t)})}}l.fun={gaussian:function(e){return r(e)},boxcar:function(e){return Math.abs(e)<=1?.5:0},epanechnikov:function(e){return Math.abs(e)<=1?.75*(1-e*e):0},tricube:function(e){return Math.abs(e)<=1?70/81*function(e){var t=1-Math.pow(Math.abs(e),3);return Math.pow(t,3)}(e):0}},l.silverman=function(e){var t=4*Math.pow(i(e),5)/(3*e.length);return Math.pow(t,.2)},l.density=function(e,t,n){if(n<=0)throw new RangeError("Bandwidth has to be a positive number.");if(!1===s(t))throw new TypeError("Kernel function has to be supplied.");n=n||.5;var r=e,o=e.length,i=c.bind(null,t,n);return u(function(e){return A(r.map(function(t){return i(e,t)}))/(o*n)})},l.regression=function(e,t,n,r){if((r=r||.5)<0)throw new RangeError("Bandwidth has to be a positive number.");if(!t)throw new TypeError("Numeric y must be supplied. For density estimationuse .density() function");if(!1===s(n))throw new TypeError("Kernel function has to be supplied.");var o=e,i=t,a=c.bind(null,n,r);return u(function(e){var t=o.map(function(t){return a(e,t)});return A(t.map(function(e,t){return e*i[t]}))/A(t)})},l.multipleRegression=function(e,t,n,r){if(r<=0)throw new RangeError("Bandwidth has to be a positive number.");if(!t)throw new TypeError("Numeric y must be supplied. For density estimationuse .density() function");if(!1===s(n))throw new TypeError("Kernel function has to be supplied.");if(!1===a(e)||!1===a(e[0]))throw new TypeError("Xs has to be a two-dimensional array");r=r||.5;var i=e,l=t,c=e[0].length,u=function(e,t,n,r){return e(o(r,n)/t)}.bind(null,n,r);return function(e){return function(t){if(!0===a(t))return!1===a(t[0])?e(t):t.map(function(t){return e(t)});throw new TypeError("Parameter expects array")}}(function(e){if(!1===a(e)||e.length!==c)throw new TypeError("Argument has to be array of length "+c);var t=i.map(function(t){return u(e,t)});return A(t.map(function(e,t){return e*l[t]}))/A(t)})},e.exports=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateKde=function(e){for(var t=function(e){var t=function(e){var t=e.length;return i.std(e)*Math.pow(4/(3*t),.2)}(e),n=l(e,t),r=.9;n>0&&(r=1.1);for(var o=t*r,a=l(e,o);a*n>0;)n=a,a=l(e,o=(t=o)*r);return t+(o-t)*Math.abs(n)/(Math.abs(n)+Math.abs(a))}(e),n=(0,r.density)(e,r.fun.gaussian,t),a=Number.MAX_VALUE,s=Number.MIN_VALUE,c=e.length,A=0;A<c;++A){var u=e[A];u<a&&(a=u),u>s&&(s=u)}for(var h=(0,o.linspace)(a,s+1e-4,1e3),d=n(h),f=Number.MIN_VALUE,p=0;p<1e3;++p){var g=d[p];g>f&&(f=g)}return[h,d,f]};var r=n(218),o=n(1),i=n(18).create();function a(e){return s(e,0,1)}function s(e,t,n){for(var r=e.length,o=function(e,t,n){for(var r=e.length,o=[],i=0;i<r;++i)o.push(-.5*Math.log(2*Math.PI)-Math.log(n)-.5*Math.pow(e[i]-t,2)/Math.pow(n,2));return o}(e,t,n),i=[],a=0;a<r;++a)i.push(Math.exp(o[a]));return i}function l(e,t){for(var n=e.length,r=function(e){for(var t=a(e),n=e.length,r=[],o=0;o<n;++o){var i=e[o];r.push((Math.pow(i,6)-15*Math.pow(i,4)+45*Math.pow(i,2)-15)*t[o])}return r},o=function(e){for(var t=a(e),n=e.length,r=[],o=0;o<n;++o){var i=e[o];r.push((Math.pow(i,4)-6*Math.pow(i,2)+3)*t[o])}return r},l=i.quantileSeq(e,[.25,.75]),c=l[1]-l[0],A=.92*c*Math.pow(n,-1/7),u=.912*c*Math.pow(n,-1/9),h=[],d=[],f=0;f<n;++f)h.push(e.slice());for(var p=0;p<n;++p){d.push(new Array(n).fill(0));for(var g=0;g<n;++g)d[p][g]=h[g][p]}for(var m=0;m<n;++m)for(var v=0;v<n;++v)h[m][v]-=d[m][v];for(var y=0,b=0;b<n;++b){for(var I=h[b].slice(),x=0;x<n;++x)I[x]/=u;r(I).forEach(function(e){y+=e})}y=-y/(n*(n-1)*Math.pow(u,7));for(var w=0,C=0;C<n;++C){for(var E=h[C].slice(),S=0;S<n;++S)E[S]/=A;o(E).forEach(function(e){w+=e})}w/=n*(n-1)*Math.pow(A,5);for(var M=1.357*Math.pow(Math.abs(w/y),1/7)*Math.pow(t,5/7),k=0,B=0;B<n;++B){for(var D=h[B].slice(),P=0;P<n;++P)D[P]/=M;o(D).forEach(function(e){k+=e})}return k/=n*(n-1)*Math.pow(M,5),Math.pow(s([0],0,Math.sqrt(2))[0]/(n*Math.abs(k)),.2)-t}i.import(n(59)),i.import(n(57)),i.import(n(158))},function(e,t){e.exports=function(e,t){for(var n=e[0],r=e[1],o=!1,i=0,a=t.length-1;i<t.length;a=i++){var s=t[i][0],l=t[i][1],c=t[a][0],A=t[a][1];l>r!=A>r&&n<(c-s)*(r-l)/(A-l)+s&&(o=!o)}return o}},function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||o,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function o(e,t){return e<t?-1:e>t?1:0}e.exports=r,e.exports.default=r,r.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var o=e-1>>1,i=t[o];if(n(r,i)>=0)break;t[e]=i,e=o}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,o=t[e];e<r;){var i=1+(e<<1),a=i+1,s=t[i];if(a<this.length&&n(t[a],s)<0&&(i=a,s=t[a]),n(s,o)>=0)break;t[e]=s,e=i}t[e]=o}}},function(e,t,n){"use strict";e.exports=function(e,t){var n=0|e.length,r=0|t.length;if(1===n&&1===r)return function(e,t){var n=e+t,r=n-e,o=e-(n-r)+(t-r);return o?[o,n]:[n]}(e[0],-t[0]);var o,i,a=new Array(n+r),s=0,l=0,c=0,A=Math.abs,u=e[l],h=A(u),d=-t[c],f=A(d);h<f?(i=u,(l+=1)<n&&(h=A(u=e[l]))):(i=d,(c+=1)<r&&(f=A(d=-t[c]))),l<n&&h<f||c>=r?(o=u,(l+=1)<n&&(h=A(u=e[l]))):(o=d,(c+=1)<r&&(f=A(d=-t[c])));for(var p,g,m=o+i,v=m-o,y=i-v,b=y,I=m;l<n&&c<r;)h<f?(o=u,(l+=1)<n&&(h=A(u=e[l]))):(o=d,(c+=1)<r&&(f=A(d=-t[c]))),(y=(i=b)-(v=(m=o+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p;for(;l<n;)(y=(i=b)-(v=(m=(o=u)+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p,(l+=1)<n&&(u=e[l]);for(;c<r;)(y=(i=b)-(v=(m=(o=d)+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p,(c+=1)<r&&(d=-t[c]);return b&&(a[s++]=b),I&&(a[s++]=I),s||(a[s++]=0),a.length=s,a}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=e+t,o=r-e,i=t-o,a=e-(r-o);return n?(n[0]=a+i,n[1]=r,n):[a+i,r]}},function(e,t,n){"use strict";var r=n(89),o=n(223);e.exports=function(e,t){var n=e.length;if(1===n){var i=r(e[0],t);return i[0]?i:[i[1]]}var a=new Array(2*n),s=[.1,.1],l=[.1,.1],c=0;r(e[0],t,s),s[0]&&(a[c++]=s[0]);for(var A=1;A<n;++A){r(e[A],t,l);var u=s[1];o(u,l[0],s),s[0]&&(a[c++]=s[0]);var h=l[1],d=s[1],f=h+d,p=d-(f-h);s[1]=f,p&&(a[c++]=p)}return s[1]&&(a[c++]=s[1]),0===c&&(a[c++]=0),a.length=c,a}},function(e,t,n){"use strict";e.exports=function(e,t){var n=0|e.length,r=0|t.length;if(1===n&&1===r)return function(e,t){var n=e+t,r=n-e,o=e-(n-r)+(t-r);return o?[o,n]:[n]}(e[0],t[0]);var o,i,a=new Array(n+r),s=0,l=0,c=0,A=Math.abs,u=e[l],h=A(u),d=t[c],f=A(d);h<f?(i=u,(l+=1)<n&&(h=A(u=e[l]))):(i=d,(c+=1)<r&&(f=A(d=t[c]))),l<n&&h<f||c>=r?(o=u,(l+=1)<n&&(h=A(u=e[l]))):(o=d,(c+=1)<r&&(f=A(d=t[c])));for(var p,g,m=o+i,v=m-o,y=i-v,b=y,I=m;l<n&&c<r;)h<f?(o=u,(l+=1)<n&&(h=A(u=e[l]))):(o=d,(c+=1)<r&&(f=A(d=t[c]))),(y=(i=b)-(v=(m=o+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p;for(;l<n;)(y=(i=b)-(v=(m=(o=u)+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p,(l+=1)<n&&(u=e[l]);for(;c<r;)(y=(i=b)-(v=(m=(o=d)+i)-o))&&(a[s++]=y),b=I-((p=I+m)-(g=p-I))+(m-g),I=p,(c+=1)<r&&(d=t[c]);return b&&(a[s++]=b),I&&(a[s++]=I),s||(a[s++]=0),a.length=s,a}},function(e,t,n){"use strict";e.exports=function(e){var t=e.length;if(t<3){for(var n=new Array(t),o=0;o<t;++o)n[o]=o;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:n}var i=new Array(t);for(o=0;o<t;++o)i[o]=o;i.sort(function(t,n){return e[t][0]-e[n][0]||e[t][1]-e[n][1]});var a=[i[0],i[1]],s=[i[0],i[1]];for(o=2;o<t;++o){for(var l=i[o],c=e[l],A=a.length;A>1&&r(e[a[A-2]],e[a[A-1]],c)<=0;)A-=1,a.pop();for(a.push(l),A=s.length;A>1&&r(e[s[A-2]],e[s[A-1]],c)>=0;)A-=1,s.pop();s.push(l)}n=new Array(s.length+a.length-2);for(var u=0,h=(o=0,a.length);o<h;++o)n[u++]=a[o];for(var d=s.length-2;d>0;--d)n[u++]=s[d];return n};var r=n(90)[3]},function(e,t,n){e.exports=function(){"use strict";function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function t(e,t){return e<t?-1:e>t?1:0}return function(n,r,o,i,a){!function t(n,r,o,i,a){for(;i>o;){if(i-o>600){var s=i-o+1,l=r-o+1,c=Math.log(s),A=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*A*(s-A)/s)*(l-s/2<0?-1:1);t(n,r,Math.max(o,Math.floor(r-l*A/s+u)),Math.min(i,Math.floor(r+(s-l)*A/s+u)),a)}var h=n[r],d=o,f=i;for(e(n,o,r),a(n[i],h)>0&&e(n,o,i);d<f;){for(e(n,d,f),d++,f--;a(n[d],h)<0;)d++;for(;a(n[f],h)>0;)f--}0===a(n[o],h)?e(n,o,f):e(n,++f,i),f<=r&&(o=f+1),r<=f&&(i=f-1)}}(n,r,o||0,i||n.length-1,a||t)}}()},function(e,t,n){"use strict";e.exports=o,e.exports.default=o;var r=n(227);function o(e,t){if(!(this instanceof o))return new o(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function i(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function a(e,t){s(e,0,e.children.length,t,e)}function s(e,t,n,r,o){o||(o=m(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i,a=t;a<n;a++)i=e.children[a],l(o,e.leaf?r(i):i);return o}function l(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function A(e,t){return e.minY-t.minY}function u(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function h(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function f(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),o=Math.min(e.maxX,t.maxX),i=Math.min(e.maxY,t.maxY);return Math.max(0,o-n)*Math.max(0,i-r)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function g(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function m(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(e,t,n,o,i){for(var a,s=[t,n];s.length;)(n=s.pop())-(t=s.pop())<=o||(a=t+Math.ceil((n-t)/o/2)*o,r(e,a,t,n,i),s.push(t,a,a,n))}o.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!g(e,t))return n;for(var o,i,a,s,l=[];t;){for(o=0,i=t.children.length;o<i;o++)a=t.children[o],g(e,s=t.leaf?r(a):a)&&(t.leaf?n.push(a):p(e,s)?this._all(a,n):l.push(a));t=l.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!g(e,t))return!1;for(var r,o,i,a,s=[];t;){for(r=0,o=t.children.length;r<o;r++)if(i=t.children[r],g(e,a=t.leaf?n(i):i)){if(t.leaf||p(e,a))return!0;s.push(i)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var o=this.data;this.data=r,r=o}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(e,t){if(!e)return this;for(var n,r,o,a,s=this.data,l=this.toBBox(e),c=[],A=[];s||c.length;){if(s||(s=c.pop(),r=c[c.length-1],n=A.pop(),a=!0),s.leaf&&-1!==(o=i(e,s.children,t)))return s.children.splice(o,1),c.push(s),this._condense(c),this;a||s.leaf||!p(s,l)?r?(n++,s=r.children[n],a=!1):s=null:(c.push(s),A.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:c,compareMinY:A,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var o,i=n-t+1,s=this._maxEntries;if(i<=s)return a(o=m(e.slice(t,n+1)),this.toBBox),o;r||(r=Math.ceil(Math.log(i)/Math.log(s)),s=Math.ceil(i/Math.pow(s,r-1))),(o=m([])).leaf=!1,o.height=r;var l,c,A,u,h=Math.ceil(i/s),d=h*Math.ceil(Math.sqrt(s));for(v(e,t,n,d,this.compareMinX),l=t;l<=n;l+=d)for(v(e,l,A=Math.min(l+d-1,n),h,this.compareMinY),c=l;c<=A;c+=h)u=Math.min(c+h-1,A),o.children.push(this._build(e,c,u,r-1));return a(o,this.toBBox),o},_chooseSubtree:function(e,t,n,r){for(var o,i,a,s,l,c,A,h;r.push(t),!t.leaf&&r.length-1!==n;){for(A=h=1/0,o=0,i=t.children.length;o<i;o++)l=u(a=t.children[o]),(c=d(e,a)-l)<h?(h=c,A=l<A?l:A,s=a):c===h&&l<A&&(A=l,s=a);t=s||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,o=n?e:r(e),i=[],a=this._chooseSubtree(o,this.data,t,i);for(a.children.push(e),l(a,o);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(o,i,t)},_split:function(e,t){var n=e[t],r=n.children.length,o=this._minEntries;this._chooseSplitAxis(n,o,r);var i=this._chooseSplitIndex(n,o,r),s=m(n.children.splice(i,n.children.length-i));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=m([e,t]),this.data.height=e.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,o,i,a,l,c,A,h;for(c=A=1/0,r=t;r<=n-t;r++)a=f(o=s(e,0,r,this.toBBox),i=s(e,r,n,this.toBBox)),l=u(o)+u(i),a<c?(c=a,h=r,A=l<A?l:A):a===c&&l<A&&(A=l,h=r);return h},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:c,o=e.leaf?this.compareMinY:A;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,o)&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var o,i,a=this.toBBox,c=s(e,0,t,a),A=s(e,n-t,n,a),u=h(c)+h(A);for(o=t;o<n-t;o++)i=e.children[o],l(c,e.leaf?a(i):i),u+=h(c);for(o=n-t-1;o>=t;o--)i=e.children[o],l(A,e.leaf?a(i):i),u+=h(A);return u},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)l(t[r],e)},_condense:function(e){for(var t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children).splice(t.indexOf(e[n]),1):this.clear():a(e[n],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},function(e,t,n){"use strict";var r=n(228),o=n(226),i=n(221),a=n(220),s=n(90)[3];function l(e,t,n){t=Math.max(0,void 0===t?2:t),n=n||0;for(var i,s=function(e){for(var t=e[0],n=e[0],r=e[0],i=e[0],s=0;s<e.length;s++){var l=e[s];l[0]<t[0]&&(t=l),l[0]>r[0]&&(r=l),l[1]<n[1]&&(n=l),l[1]>i[1]&&(i=l)}var c=[t,n,r,i],A=c.slice();for(s=0;s<e.length;s++)a(e[s],c)||A.push(e[s]);var u=o(A),h=[];for(s=0;s<u.length;s++)h.push(A[u[s]]);return h}(e),l=r(16,["[0]","[1]","[0]","[1]"]).load(e),A=[],u=0;u<s.length;u++){var h=s[u];l.remove(h),i=g(h,i),A.push(i)}var d=r(16);for(u=0;u<A.length;u++)d.insert(p(A[u]));for(var f=t*t,v=n*n;A.length;){var y=A.shift(),b=y.p,I=y.next.p,x=m(b,I);if(!(x<v)){var w=x/f;(h=c(l,y.prev.p,b,I,y.next.next.p,w,d))&&Math.min(m(h,b),m(h,I))<=w&&(A.push(y),A.push(g(h,y)),l.remove(h),d.remove(y),d.insert(p(y)),d.insert(p(y.next)))}}y=i;var C=[];do{C.push(y.p),y=y.next}while(y!==i);return C.push(y.p),C}function c(e,t,n,r,o,a,s){for(var l=new i(null,A),c=e.data;c;){for(var h=0;h<c.children.length;h++){var f=c.children[h],p=c.leaf?v(f,n,r):u(n,r,f);p>a||l.push({node:f,dist:p})}for(;l.length&&!l.peek().node.children;){var g=l.pop(),m=g.node,y=v(m,t,n),b=v(m,r,o);if(g.dist<y&&g.dist<b&&d(n,m,s)&&d(r,m,s))return m}(c=l.pop())&&(c=c.node)}return null}function A(e,t){return e.dist-t.dist}function u(e,t,n){if(h(e,n)||h(t,n))return 0;var r=y(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var o=y(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(0===o)return 0;var i=y(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===i)return 0;var a=y(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===a?0:Math.min(r,o,i,a)}function h(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function d(e,t,n){for(var r=Math.min(e[0],t[0]),o=Math.min(e[1],t[1]),i=Math.max(e[0],t[0]),a=Math.max(e[1],t[1]),s=n.search({minX:r,minY:o,maxX:i,maxY:a}),l=0;l<s.length;l++)if(f(s[l].p,s[l].next.p,e,t))return!1;return!0}function f(e,t,n,r){return e!==r&&t!==n&&s(e,t,n)>0!=s(e,t,r)>0&&s(n,r,e)>0!=s(n,r,t)>0}function p(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function g(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function m(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function v(e,t,n){var r=t[0],o=t[1],i=n[0]-r,a=n[1]-o;if(0!==i||0!==a){var s=((e[0]-r)*i+(e[1]-o)*a)/(i*i+a*a);s>1?(r=n[0],o=n[1]):s>0&&(r+=i*s,o+=a*s)}return(i=e[0]-r)*i+(a=e[1]-o)*a}function y(e,t,n,r,o,i,a,s){var l,c,A,u,h=n-e,d=r-t,f=a-o,p=s-i,g=e-o,m=t-i,v=h*h+d*d,y=h*f+d*p,b=f*f+p*p,I=h*g+d*m,x=f*g+p*m,w=v*b-y*y,C=w,E=w;0===w?(c=0,C=1,u=x,E=b):(u=v*x-y*I,(c=y*x-b*I)<0?(c=0,u=x,E=b):c>C&&(c=C,u=x+y,E=b)),u<0?(u=0,-I<0?c=0:-I>v?c=C:(c=-I,C=v)):u>E&&(u=E,-I+y<0?c=0:-I+y>v?c=C:(c=-I+y,C=v)),l=0===c?0:c/C;var S=(1-(A=0===u?0:u/E))*o+A*a-((1-l)*e+l*n),M=(1-A)*i+A*s-((1-l)*t+l*r);return S*S+M*M}e.exports=l,e.exports.default=l},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.FlexiblePlotModule=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=n(8),s=function(e){return e&&e.__esModule?e:{default:e}}(n(229)),l=n(219),c=n(38),A=n(156),u=n(152),h=n(18).create();h.import(n(59)),h.import(n(57)),h.import(n(35));var d=[Math.PI,20/9,1,2,10*Math.tan(Math.PI/10)/(3-Math.pow(Math.tan(Math.PI/10),2)),3*Math.sqrt(3)/4,9*(1+1/Math.sqrt(3))*(1/Math.pow(2*Math.sqrt(3)+1,2))],f=n(151),p=n(148),g=n(147);t.FlexiblePlotModule=function(){function t(e,n,r,o,i,a,s,l,c,A,u,h){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.selectionManager=o,this.fontManager=i,this.parentFlexiblePlotManager=a,this.columnIds=this.parentFlexiblePlotManager.columnIds,this.panelIndex=l.panelIndex,this.svgStartX=l.svgStartX,this.svgWidth=l.svgWidth,this.svgEndX=this.svgStartX+this.svgWidth,this.svgStartY=l.svgStartY,this.svgHeight=l.svgHeight,this.svgEndY=this.svgStartY+this.svgHeight,this.xAxisColumn=l.xAxisColumn,this.yAxisColumn=l.yAxisColumn,this.colourColumn=l.colourColumn,this.symbolColumn=l.symbolColumn,this.radiusColumn=l.radiusColumn,this.stackedBarNumericColumns=l.stackedBarNumericColumns,this.stackedBarplotMode=(void 0===this.xAxisColumn||void 0===this.yAxisColumn)&&this.stackedBarNumericColumns.length>0,this.leftMostColumn=l.leftMostColumn,this.rightMostColumn=l.rightMostColumn,this.bottomRow=l.bottomRow,this.topRow=l.topRow,this.includedHoverColumns=[],this.refreshHoverColumns(),this.includedLabelColumns=[],this.refreshLabelColumns(),this.forcedAllColourVals=this.parentFlexiblePlotManager.forcedAllColourVals,this.forcedColourValsReverseMapper=this.parentFlexiblePlotManager.forcedColourValsReverseMapper,this.forcedAllSymbolVals=this.parentFlexiblePlotManager.forcedAllSymbolVals,this.forcedSymbolValsReverseMapper=this.parentFlexiblePlotManager.forcedSymbolValsReverseMapper,this.forcedMinX=c,this.forcedMaxX=A,this.forcedMinY=u,this.forcedMaxY=h,this.markedDonors=new Set,this.directMarkedDonors=new Set,this.missingDonors=new Set,this.svgDataGroup=null,this.svgStackedBarsGroup=null,this.svgPlotSupportGroup=null,this.svgPremarkerGroup=null,this.svgMarkerGroup=null,this.svgSubcohortShadeGroup=null,this.svgSubcohortPremarkerGroup=null,this.svgSubcohortMarkerGroup=null,this.currentSubcohortIndex=s,this.validIndicesSet=new Set,this.validIndices=[],this.subcohortShades=new Map,this.xScale=null,this.yScale=null,this.minX=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.minY=Number.MAX_VALUE,this.maxY=Number.MIN_VALUE,this.colourScale=null,this.usedColumnsInStackedBar=new Map,this.colourScaleStackedBar=null,this.colourScaleType=null,this.radiusScale=null,this.minRadius=null,this.maxRadius=null,this.baseSize=null,this.minColour=null,this.maxColour=null,this.plotData=[],this.donorIndexToPlotData=new Map,this.symbolReverseMapper=new Map,this.colourReverseMapper=new Map,this.samplesPerCategory=new Map,this.allXvals=new Map,this.allYvals=new Map,this.stackedBarValsPerDonor=new Map,this.totalsPerDonorMap=new Map,this.allColourVals=new Map,this.allSymbolVals=new Map,this.allRadiusVals=new Map,this.xAxisType=this.cohortMetadata.metadataDataTypes.get(this.xAxisColumn),this.yAxisType=this.cohortMetadata.metadataDataTypes.get(this.yAxisColumn),this.cleanup(),this.reset()}return o(t,[{key:"refreshHoverColumns",value:function(){var t=this;this.includedHoverColumns.length=0,this.includedHoverColumns=[this.xAxisColumn,this.yAxisColumn],""!==this.colourColumn&&this.includedHoverColumns.push(this.colourColumn),""!==this.symbolColumn&&this.includedHoverColumns.push(this.symbolColumn),""!==this.radiusColumn&&this.includedHoverColumns.push(this.radiusColumn),this.columnIds.forEach(function(n,r,o){e("#includeInHover_"+r).is(":checked")&&t.includedHoverColumns.push(n)})}},{key:"refreshLabelColumns",value:function(){var t=this;this.includedLabelColumns.length=0,this.columnIds.forEach(function(n,r,o){e("#includeInLabel_"+r).is(":checked")&&t.includedLabelColumns.push(n)})}},{key:"cleanupMetadataColumn",value:function(e){return(e===this.xAxisColumn||e===this.yAxisColumn||e===this.colourColumn||e===this.symbolColumn||e===this.radiusColumn)&&(this.cleanup(),!0)}},{key:"reset",value:function(){this.cleanup(),this.determineValidDonors(),this.addSvgElementGroups(),this.preparePlotScales(),this.preparePlotData(),this.addPlotSupporters(),this.addSubcohortShades(),this.addPlotDataPoints(),this.remarkDonors()}},{key:"cleanup",value:function(){e("#subcohortShades_p"+this.panelIndex).remove(),e("#subcohortMarkers_p"+this.panelIndex).remove(),e("#subcohortPremarkers_p"+this.panelIndex).remove(),e("#donorMarkers_p"+this.panelIndex).remove(),e("#donorPremarkers_p"+this.panelIndex).remove(),e("#flexibleData_p"+this.panelIndex).remove(),e("#flexiblePlotSupportGroup_p"+this.panelIndex).remove(),e("#flexibleStackedBars_p"+this.panelIndex).remove()}},{key:"determineValidDonors",value:function(){this.missingDonors.clear(),this.validIndicesSet=this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex),this.validIndices=[];for(var e=0;e<this.cohortMetadata.metadata.length;++e)this.validIndicesSet.has(e)?this.validIndices.push(e):this.missingDonors.add(this.cohortMetadata.metadata[e].index)}},{key:"adjustDefaultSymbolSize",value:function(e){var t=this;this.baseSize=e,this.remarkDonors(),this.svgDataGroup.selectAll(".flexibleDataPoints").attr("d",(0,a.symbol)().type(function(e){return a.symbols[e.symbol]}).size(function(e){return t.baseSize*Math.pow(e.radius,2)*d[e.symbol]}))}},{key:"emitSelectedDonorsFromSvgCoordinates",value:function(e,t,n,r){for(var o=[],i=this.plotData.length,a=0;a<i;++a){var s=this.plotData[a].x;if(e<=s&&s<=t){var l=this.plotData[a].y;if(n<=l&&l<=r){var c=this.plotData[a].donorIndex;o.push(c),this.directMarkedDonors.add(c)}}}return o}},{key:"preparePlotScales",value:function(){this.stackedBarplotMode?this.prepareXYColourScalesStackedBarplot():this.prepareXYScales(),this.prepareColourScale(),this.prepareSymbolScale(),this.prepareRadiusScale()}},{key:"prepareXYScales",value:function(){for(var e=0,t=0,n=0;n<this.validIndices.length;++n){var r=this.validIndices[n],o=this.cohortMetadata.metadata[r][this.xAxisColumn],i=this.cohortMetadata.metadata[r][this.yAxisColumn],s=this.commonSettings.undefinedValues.has(o),l=this.commonSettings.undefinedValues.has(i);s&&l||"numeric"===this.xAxisType&&s||"numeric"===this.yAxisType&&l||(this.allXvals.has(o)||("numeric"===this.xAxisType?this.allXvals.set(o,e):this.allXvals.set(o,e+.5),e++),this.allYvals.has(i)||("numeric"===this.yAxisType?this.allYvals.set(i,t):this.allYvals.set(i,t+.5),t++))}if("numeric"!==this.xAxisType&&"numeric"===this.yAxisType)for(var c=0;c<this.validIndices.length;++c){var A=this.validIndices[c],u=this.cohortMetadata.metadata[A][this.xAxisColumn],h=this.cohortMetadata.metadata[A][this.yAxisColumn];this.commonSettings.undefinedValues.has(h)||(this.samplesPerCategory.has(u)||this.samplesPerCategory.set(u,[]),this.samplesPerCategory.get(u).push(h))}else if("numeric"!==this.yAxisType&&"numeric"===this.xAxisType)for(var d=0;d<this.validIndices.length;++d){var f=this.validIndices[d],p=this.cohortMetadata.metadata[f][this.xAxisColumn],g=this.cohortMetadata.metadata[f][this.yAxisColumn];this.commonSettings.undefinedValues.has(p)||(this.samplesPerCategory.has(g)||this.samplesPerCategory.set(g,[]),this.samplesPerCategory.get(g).push(p))}var m=.99*this.svgWidth;if(this.maxX=this.allXvals.size,this.minX=0,"numeric"===this.xAxisType)if(null!==this.forcedMinX&&null!==this.forcedMaxX)this.minX=this.forcedMinX,this.maxX=this.forcedMaxX;else{var v=Array.from(this.allXvals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxX=v[v.length-1],this.minX=v[0]}if(this.xScale=(0,a.scaleLinear)().domain([Math.min(.1*-this.maxX,1.1*this.minX),1.1*this.maxX]).range([this.svgStartX+.01*m,this.svgStartX+.98*m]),this.maxY=this.allYvals.size,this.minY=0,"numeric"===this.yAxisType)if(null!==this.forcedMinY&&null!==this.forcedMaxY)this.minY=this.forcedMinY,this.maxY=this.forcedMaxY;else{var y=Array.from(this.allYvals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxY=y[y.length-1],this.minY=y[0]}this.yScale=(0,a.scaleLinear)().domain([Math.min(.1*-this.maxY,1.1*this.minY),1.1*this.maxY]).range([this.svgStartY+.99*this.svgHeight,this.svgStartY])}},{key:"prepareXYColourScalesStackedBarplot",value:function(){for(var e=this,t=this.stackedBarNumericColumns.length,n=void 0!==this.xAxisColumn?this.xAxisColumn:this.yAxisColumn,r=0;r<this.validIndices.length;++r){for(var o=this.validIndices[r],s=this.cohortMetadata.metadata[o],l=s[n],c=[],A=0;A<t;++A){var u=this.stackedBarNumericColumns[A],h=s[u];this.commonSettings.undefinedValues.has(h)||c.push({column:u,value:s[u]})}c.length>0&&this.stackedBarValsPerDonor.set(l,c.slice())}var d=[];this.stackedBarValsPerDonor.forEach(function(t,n,r){var o=0;t.forEach(function(e){o+=e.value}),d.push({donor:n,total:o}),e.totalsPerDonorMap.set(n,o)}),void 0!==this.xAxisColumn?d.sort(function(e,t){return t.total-e.total}):d.sort(function(e,t){return e.total-t.total});var f=d[0].donor,p=this.stackedBarValsPerDonor.get(f);p.sort(function(e,t){return t.value-e.value});var g=new Map,m=0;p.forEach(function(e){g.set(e.column,m),m+=1}),this.stackedBarValsPerDonor.forEach(function(e,t,n){e.sort(function(e,t){return g.get(t.column)-g.get(e.column)})});for(var v=[],y=this.validIndices.length,b=d.length,I=0;I<b;++I)for(var x=d[I].donor,w=0;w<y;++w){var C=this.validIndices[w];if(this.cohortMetadata.metadata[C].donor===x){v.push(C);break}}for(var E=v.length,S=0,M=0,k=0;k<E;++k){var B=v[k],D=this.cohortMetadata.metadata[B];if(void 0!==this.xAxisColumn){var P=D[this.xAxisColumn];this.allXvals.has(P)||(this.allXvals.set(P,S+.5),S++);var Q=this.totalsPerDonorMap.get(P);this.allYvals.has(Q)||(this.allYvals.set(Q,M),M++)}else{var T=D[this.yAxisColumn];this.allYvals.has(T)||(this.allYvals.set(T,M+.5),M++);var G=this.totalsPerDonorMap.get(T);this.allXvals.has(G)||(this.allXvals.set(G,S),S++)}}var R=0;this.stackedBarValsPerDonor.forEach(function(t,n,r){t.forEach(function(t){e.usedColumnsInStackedBar.has(t.column)||t.value>0&&(e.usedColumnsInStackedBar.set(t.column,R),R+=1)})}),this.colourScaleStackedBar=function(e){return(0,i.discreteColour)(this.usedColumnsInStackedBar.size)[e]};var _=.99*this.svgWidth;if(void 0!==this.xAxisColumn){this.maxX=this.allXvals.size,this.minX=0;var V=Array.from(this.allYvals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxY=V[V.length-1],this.minY=V[0],this.minY>=0&&this.maxY<=1&&(this.minY=0,this.maxY=1),this.xScale=(0,a.scaleLinear)().domain([this.minX,this.maxX]).range([this.svgStartX+.01*_,this.svgStartX+.98*_]),this.yScale=(0,a.scaleLinear)().domain([Math.min(.05*-this.maxY,1.1*this.minY),1.1*this.maxY]).range([this.svgStartY+.99*this.svgHeight,this.svgStartY])}else{this.maxY=this.allYvals.size,this.minY=0;var N=Array.from(this.allXvals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxX=N[N.length-1],this.minX=N[0],this.maxX>=0&&this.maxX<=1&&(this.minX=-0,this.maxX=1),this.xScale=(0,a.scaleLinear)().domain([Math.min(.05*-this.maxX,1.1*this.minX),1.1*this.maxX]).range([this.svgStartX+.01*_,this.svgStartX+.98*_]),this.yScale=(0,a.scaleLinear)().domain([this.minY,this.maxY]).range([this.svgStartY+.99*this.svgHeight,this.svgStartY])}}},{key:"prepareColourScale",value:function(){if(""!==this.colourColumn)if(this.colourScaleType=this.cohortMetadata.metadataDataTypes.get(this.colourColumn),"numeric"===this.colourScaleType){if(null===this.parentFlexiblePlotManager.forcedColourScale){for(var e=0,t=0;t<this.validIndices.length;++t){var n=this.validIndices[t],r=this.cohortMetadata.metadata[n][this.colourColumn];this.allColourVals.has(r)||this.commonSettings.undefinedValues.has(r)||(this.allColourVals.set(r,e),e++)}var o=Array.from(this.allColourVals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxColour=o[o.length-1],this.minColour=o[0]}else this.minColour=this.parentFlexiblePlotManager.minColourForced,this.maxColour=this.parentFlexiblePlotManager.maxColourForced;this.colourScale=(0,a.scaleLinear)().domain([this.minColour,this.maxColour]).range((0,i.discreteColourGrayRed)())}else{if(null===this.parentFlexiblePlotManager.forcedColourScale){for(var s=0,l=0;l<this.validIndices.length;++l){var c=this.validIndices[l],A=this.cohortMetadata.metadata[c][this.colourColumn];this.allColourVals.has(A)||(this.allColourVals.set(A,s),this.colourReverseMapper.set(s,A),s++)}this.maxColour=this.allColourVals.size-1}else this.allColourVals=this.parentFlexiblePlotManager.forcedAllColourVals,this.colourReverseMapper=this.parentFlexiblePlotManager.forcedColourValsReverseMapper,this.maxColour=this.parentFlexiblePlotManager.maxColourForced;this.minColour=0,this.colourScale=function(e){return(0,i.discreteColour)(this.maxColour+1)[e]}}}},{key:"prepareSymbolScale",value:function(){if(""!==this.symbolColumn)if(null===this.parentFlexiblePlotManager.forcedAllSymbolVals)for(var e=0,t=0;t<this.validIndices.length;++t){var n=this.validIndices[t],r=this.cohortMetadata.metadata[n][this.symbolColumn];this.allSymbolVals.has(r)||(this.allSymbolVals.set(r,e),this.symbolReverseMapper.set(e,r),e++)}else this.allSymbolVals=this.parentFlexiblePlotManager.forcedAllSymbolVals,this.symbolReverseMapper=this.parentFlexiblePlotManager.forcedSymbolValsReverseMapper}},{key:"prepareRadiusScale",value:function(){if(""!==this.radiusColumn)if(null===this.parentFlexiblePlotManager.forcedRadiusScale){for(var e=0,t=0;t<this.validIndices.length;++t){var n=this.validIndices[t],r=this.cohortMetadata.metadata[n][this.radiusColumn];this.allRadiusVals.has(r)||this.commonSettings.undefinedValues.has(r)||(this.allRadiusVals.set(r,e),e++)}var o=Array.from(this.allRadiusVals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxRadius=Math.max(o[o.length-1]),this.minRadius=Math.min(o[0]),this.radiusScale=(0,a.scaleLinear)().domain([this.minRadius,this.maxRadius]).range([.5,4])}else this.radiusScale=(0,a.scaleLinear)().domain([this.parentFlexiblePlotManager.minRadiusForced,this.parentFlexiblePlotManager.maxRadiusForced]).range([.5,4])}},{key:"preparePlotData",value:function(){for(var e=new Set,t=0;t<this.validIndices.length;++t){var n,r=0,o=0,a=0,s=0,l=0,c=0,A=0,h=0,d=0,f=0,p=[],g=this.validIndices[t],m=this.cohortMetadata.metadata[g],v=this.cohortMetadata.metadata[g].donor;if(n=m.index,void 0!==this.xAxisColumn)if("numeric"===this.xAxisType){if(this.commonSettings.undefinedValues.has(m[this.xAxisColumn])){this.missingDonors.add(m.index);continue}r=m[this.xAxisColumn],o=this.xScale(r)}else{var y=this.allXvals.get(m[this.xAxisColumn]);e.has(y)?(r=y+.5*Math.random()-.25,o=this.xScale(r)):(e.add(y),r=y,o=this.xScale(r))}else{if(!this.stackedBarValsPerDonor.has(v)||!this.totalsPerDonorMap.has(v)){this.missingDonors.add(m.index);continue}r=this.totalsPerDonorMap.get(v),o=this.xScale(r),p=this.stackedBarValsPerDonor.get(v).slice()}if(void 0!==this.yAxisColumn)if("numeric"===this.yAxisType){if(this.commonSettings.undefinedValues.has(m[this.yAxisColumn])){this.missingDonors.add(m.index);continue}a=m[this.yAxisColumn],s=this.yScale(a)}else{var b=this.allYvals.get(m[this.yAxisColumn]);e.has(b)?(a=b+.5*Math.random()-.25,s=this.yScale(a)):(e.add(b),a=b,s=this.yScale(a))}else{if(!this.stackedBarValsPerDonor.has(v)||!this.totalsPerDonorMap.has(v)){this.missingDonors.add(m.index);continue}a=this.totalsPerDonorMap.get(v),s=this.yScale(a),p=this.stackedBarValsPerDonor.get(v).slice()}if(""!==this.colourColumn){var I=m[this.colourColumn];if("numeric"===this.colourScaleType){if(this.commonSettings.undefinedValues.has(I)){this.missingDonors.add(m.index);continue}l=I,c=this.colourScale(l)}else l=I,c=this.colourScale(this.allColourVals.get(l))}else c=(0,i.discreteColour)(1)[0];if(""!==this.radiusColumn){var x=m[this.radiusColumn];if(this.commonSettings.undefinedValues.has(x)){this.missingDonors.add(m.index);continue}d=x,f=5*this.radiusScale(d)}else f=5*(d=1);""!==this.symbolColumn?(A=m[this.symbolColumn],h=this.allSymbolVals.get(A)):(A=0,h=0),this.plotData.push(new u.SinglePlotObject(n,r,o,a,s,l,c,A,h,d,f,p)),this.donorIndexToPlotData.set(n,this.plotData.length-1)}}},{key:"addSvgElementGroups",value:function(){(0,a.select)("#flexiblePlotMain").append("g").attr("id","flexibleStackedBars_p"+this.panelIndex),this.svgStackedBarsGroup=(0,a.select)("#flexibleStackedBars_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","subcohortShades_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","subcohortPremarkers_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","subcohortMarkers_p"+this.panelIndex),this.svgSubcohortShadeGroup=(0,a.select)("#subcohortShades_p"+this.panelIndex),this.svgSubcohortPremarkerGroup=(0,a.select)("#subcohortPremarkers_p"+this.panelIndex),this.svgSubcohortMarkerGroup=(0,a.select)("#subcohortMarkers_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","donorPremarkers_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","donorMarkers_p"+this.panelIndex),this.svgPremarkerGroup=(0,a.select)("#donorPremarkers_p"+this.panelIndex),this.svgMarkerGroup=(0,a.select)("#donorMarkers_p"+this.panelIndex),(0,a.select)("#flexiblePlotMain").append("g").attr("id","flexibleData_p"+this.panelIndex),this.svgDataGroup=(0,a.select)("#flexibleData_p"+this.panelIndex)}},{key:"addPlotSupporters",value:function(){null!==this.svgPlotSupportGroup&&e("#flexiblePlotSupportGroup_p"+this.panelIndex).remove(),this.svgPlotSupportGroup=(0,a.select)("#flexiblePlotMain").append("g").attr("id","flexiblePlotSupportGroup_p"+this.panelIndex);var t=void 0!==this.xAxisColumn&&"numeric"!==this.cohortMetadata.metadataDataTypes.get(this.xAxisColumn),n=void 0!==this.yAxisColumn&&"numeric"!==this.cohortMetadata.metadataDataTypes.get(this.yAxisColumn),r=Array.from(this.allXvals.keys()),o=Array.from(this.allYvals.keys()),i=.99*this.svgWidth,s=.99*this.svgHeight;this.svgPlotSupportGroup.append("rect").attr("x",this.svgStartX).attr("y",this.svgStartY).attr("height",s).attr("width",i).style("stroke","Black").style("fill","none").style("stroke-width",1);var l=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("xAxisLabels").generateFontCssText();t?this.bottomRow?this.svgPlotSupportGroup.append("g").attr("class","axis axis--x").call((0,a.axisBottom)(this.xScale).tickSize(4).tickValues(Array(r.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,t){return r[t]}).tickPadding(1)).attr("transform","translate(0,"+(this.svgStartY+s)+")").attr("id","flexibleXaxisLabels_p"+this.panelIndex).selectAll("text").attr("transform","rotate(90)").style("text-anchor","start").style("font",l):this.svgPlotSupportGroup.append("g").attr("class","axis axis--x").call((0,a.axisTop)(this.xScale).tickSize(4).tickValues(Array(r.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,t){return r[t]}).tickPadding(1)).attr("transform","translate(0,"+this.svgStartY+")").attr("id","flexibleXaxisLabels_p"+this.panelIndex).selectAll("text").attr("transform","rotate(90)").style("text-anchor","start").style("font",l):this.bottomRow?this.svgPlotSupportGroup.append("g").attr("class","axis axis--x").attr("id","flexibleXaxisLabels_p"+this.panelIndex).call((0,a.axisBottom)(this.xScale).ticks(5).tickSize(4).tickPadding(1)).attr("transform","translate(0,"+(this.svgStartY+s)+")").selectAll("text").attr("transform","rotate(90)").style("text-anchor","start").style("font",l):this.svgPlotSupportGroup.append("g").attr("class","axis axis--x").attr("id","flexibleXaxisLabels_p"+this.panelIndex).call((0,a.axisTop)(this.xScale).ticks(5).tickSize(4).tickPadding(1)).attr("transform","translate(0,"+this.svgStartY+")").selectAll("text").attr("transform","rotate(90)").style("text-anchor","start").style("font",l);var c=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("xAxisTitle").generateFontCssText(),A=(0,a.path)();A.moveTo(this.svgStartX,this.svgStartY+s),A.lineTo(this.svgStartX+i,this.svgStartY+s),this.svgPlotSupportGroup.append("path").attr("id","flexibleXaxisTitleHelper_p"+this.panelIndex).attr("d",A).style("display","none"),this.svgPlotSupportGroup.append("text").attr("class","markerText").style("dominant-baseline","baseline").style("alignment-baseline","baseline").attr("startOffset","50%").attr("text-anchor","middle").attr("id","flexibleXaxisTitle_p"+this.panelIndex).append("textPath").attr("xlink:href","#flexibleXaxisTitleHelper_p"+this.panelIndex).style("dominant-baseline","baseline").style("alignment-baseline","baseline").attr("startOffset","50%").attr("text-anchor","middle").style("font",c).text(this.xAxisColumn);var u=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("yAxisLabels").generateFontCssText();n?this.leftMostColumn?this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisLeft)(this.yScale).tickSize(4).tickValues(Array(o.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,t){return o[t]}).tickPadding(1)).attr("transform","translate("+this.svgStartX+",0)").selectAll("text").attr("dy",".05em").style("text-anchor","end").style("font",u):this.rightMostColumn?this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisRight)(this.yScale).tickSize(4).tickValues(Array(o.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,t){return o[t]}).tickPadding(1)).attr("transform","translate("+(this.svgStartX+i)+",0)").selectAll("text").attr("dy",".05em").style("text-anchor","end").style("font",u):this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisLeft)(this.yScale).tickSize(4).tickValues(Array(o.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,t){return o[t]}).tickPadding(1)).attr("transform","translate("+(this.svgStartX+i)+",0)").selectAll("text").attr("dy",".05em").style("text-anchor","end").style("font",u):this.leftMostColumn?this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisLeft)(this.yScale).tickSize(4).tickPadding(1)).attr("transform","translate("+this.svgStartX+",0)").selectAll("text").attr("dy",".1em").style("font",u):this.rightMostColumn?this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisRight)(this.yScale).tickSize(4).tickPadding(1)).attr("transform","translate("+(this.svgStartX+i)+",0)").selectAll("text").attr("dy",".1em").style("font",u):this.svgPlotSupportGroup.append("g").attr("class","axis axis--y").call((0,a.axisLeft)(this.yScale).tickSize(4).tickPadding(1)).attr("transform","translate("+(this.svgStartX+i)+",0)").selectAll("text").attr("dy",".1em").style("font",u);var h=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("yAxisTitle").generateFontCssText(),d=(0,a.path)();if(d.moveTo(this.svgStartX+(this.rightMostColumn?i:0),this.svgStartY),d.lineTo(this.svgStartX+(this.rightMostColumn?i:0),this.svgStartY+s),this.svgPlotSupportGroup.append("path").attr("id","flexibleYaxisTitleHelper_p"+this.panelIndex).attr("d",d).style("display","none"),this.svgPlotSupportGroup.append("text").attr("class","markerText").attr("id","flexibleYaxisTitle_p"+this.panelIndex).style("dominant-baseline","baseline").style("alignment-baseline","baseline").attr("startOffset","50%").attr("text-anchor","middle").append("textPath").attr("xlink:href","#flexibleYaxisTitleHelper_p"+this.panelIndex).style("dominant-baseline","baseline").style("alignment-baseline","baseline").attr("startOffset","50%").attr("text-anchor","middle").style("font",h).html(this.yAxisColumn),this.stackedBarplotMode)this.addStackedBars();else if(t&&n)this.addXYCategoricalGrid(r,o);else if(t)this.addVerticalBoxplots(),this.addVerticalKdes();else if(n)this.addHorizontalBoxplots(),this.addHorizontalKdes();else if(this.xAxisColumn===this.yAxisColumn){for(var f=[],p=0;p<this.validIndices.length;++p){var g=this.validIndices[p],m=this.cohortMetadata.metadata[g][this.xAxisColumn];this.commonSettings.undefinedValues.has(m)||f.push(m)}this.addSingleDiagonalBoxplot(f),this.addSingleDiagonalKde(f)}}},{key:"addVerticalBoxplots",value:function(){this.addBoxplots(this.allXvals,"x1","x2","y1","y2",!1)}},{key:"addHorizontalBoxplots",value:function(){this.addBoxplots(this.allYvals,"y2","y1","x1","x2",!0)}},{key:"addBoxplots",value:function(e,t,n,r,o,i){var a=this,s=new Map;this.samplesPerCategory.forEach(function(e,t,n){e.length>2&&s.set(t,h.quantileSeq(e,[.1,.25,.5,.75,.9]))});var l=i?-1:1,c=[],A=[];e.forEach(function(e,i,a){if(s.has(i)){var u=s.get(i),h={},d={},f={},p={},g={},m={};h[t]=e,h[n]=e+.2,h[r]=u[1],h[o]=u[3],c.push(h),d[t]=e,d[n]=e+.2*l,d[r]=u[2],d[o]=u[2],A.push(d),f[t]=e,f[n]=e,f[r]=u[3],f[o]=u[4],A.push(f),p[t]=e,p[n]=e,p[r]=u[0],p[o]=u[1],A.push(p),g[t]=e,g[n]=e+.08*l,g[r]=u[0],g[o]=u[0],A.push(g),m[t]=e,m[n]=e+.08*l,m[r]=u[4],m[o]=u[4],A.push(m)}}),this.svgPlotSupportGroup.selectAll(".quartileRects").data(c).enter().append("rect").attr("class","quartileRects").attr("x",function(e){return a.xScale(e.x1)}).attr("y",function(e){return a.yScale(e.y2)}).attr("width",function(e){return Math.abs(a.xScale(e.x2)-a.xScale(e.x1))}).attr("height",function(e){return Math.abs(a.yScale(e.y2)-a.yScale(e.y1))}).style("stroke-width",1.5).style("stroke","black").style("fill","none"),this.svgPlotSupportGroup.selectAll(".statLines").data(A).enter().append("line").attr("class","statLines").attr("x1",function(e){return a.xScale(e.x1)}).attr("x2",function(e){return a.xScale(e.x2)}).attr("y1",function(e){return a.yScale(e.y1)}).attr("y2",function(e){return a.yScale(e.y2)}).style("stroke-width",1.5).style("stroke","black")}},{key:"addSingleDiagonalBoxplot",value:function(e){var t=this;if(!(e.length<3)){var n=h.quantileSeq(e,[.1,.25,.5,.75,.9]),r=[],o=.2*(this.maxX-this.minX)/Math.sqrt(2),i=.08*(this.maxX-this.minX)/Math.sqrt(2);r.push({x1:n[1],y1:n[1],x2:n[1]+o,y2:n[1]-o}),r.push({x1:n[2],y1:n[2],x2:n[2]+o,y2:n[2]-o}),r.push({x1:n[3],y1:n[3],x2:n[3]+o,y2:n[3]-o}),r.push({x1:n[0],y1:n[0],x2:n[0]+i,y2:n[0]-i}),r.push({x1:n[4],y1:n[4],x2:n[4]+i,y2:n[4]-i}),r.push({x1:n[1],y1:n[1],x2:n[3],y2:n[3]}),r.push({x1:n[1]+o,y1:n[1]-o,x2:n[3]+o,y2:n[3]-o}),this.svgPlotSupportGroup.selectAll(".statLines").data(r).enter().append("line").attr("class","statLines").attr("x1",function(e){return t.xScale(e.x1)}).attr("x2",function(e){return t.xScale(e.x2)}).attr("y1",function(e){return t.yScale(e.y1)}).attr("y2",function(e){return t.yScale(e.y2)}).style("stroke-width",1.5).style("stroke","black")}}},{key:"addVerticalKdes",value:function(){var e=this;this.samplesPerCategory.forEach(function(t,n,o){for(var i=e.allXvals.get(n),s=(0,l.calculateKde)(t),c=r(s,3),A=c[0],u=c[1],h=c[2],d=(0,a.line)().x(function(t){return e.xScale(i-t.density)}).y(function(t){return e.yScale(t.val)}),f=(0,a.scaleLinear)().domain([0,h]).range([0,.2]),p=A.length,g=[],m=0;m<p;++m)g.push({val:A[m],density:f(u[m])});e.svgPlotSupportGroup.append("path").datum(g).attr("fill","none").style("stroke-linejoin","round").style("stroke-linecap","round").style("stroke-width",1.5).style("stroke","black").attr("d",d),e.svgPlotSupportGroup.append("line").attr("x1",e.xScale(i)).attr("x2",e.xScale(i)).attr("y1",e.yScale(e.minY)).attr("y2",e.yScale(e.maxY)).style("stroke-dasharray","5 5").style("stroke-width",1.5).style("stroke","black")})}},{key:"addHorizontalKdes",value:function(){var e=this;this.samplesPerCategory.forEach(function(t,n,o){for(var i=e.allYvals.get(n),s=(0,l.calculateKde)(t),c=r(s,3),A=c[0],u=c[1],h=c[2],d=(0,a.line)().x(function(t){return e.xScale(t.val)}).y(function(t){return e.yScale(i+t.density)}),f=(0,a.scaleLinear)().domain([0,h]).range([0,.2]),p=A.length,g=[],m=0;m<p;++m)g.push({val:A[m],density:f(u[m])});e.svgPlotSupportGroup.append("path").datum(g).attr("fill","none").style("stroke-linejoin","round").style("stroke-linecap","round").style("stroke-width",1.5).style("stroke","black").attr("d",d),e.svgPlotSupportGroup.append("line").attr("x1",e.xScale(e.minX)).attr("x2",e.xScale(e.maxX)).attr("y1",e.yScale(i)).attr("y2",e.yScale(i)).style("stroke-dasharray","5 5").style("stroke-width",1.5).style("stroke","black")})}},{key:"addStackedBars",value:function(){for(var e=this,t=this.plotData.length,n=this.yScale(0),r=this.xScale(0),o=function(t){var o=e.plotData[t],i=o.stackedBarValuesPre.length;if(void 0!==e.xAxisColumn)for(var a=e.xScale(o.xPre-.4),s=e.xScale(o.xPre+.4)-a,l=function(t){var r=e.yScale(o.stackedBarValuesPreCumulative[t]),i=n-r,l=o.stackedBarValuesPre[t].column,c=e.usedColumnsInStackedBar.has(l)?e.colourScaleStackedBar(e.usedColumnsInStackedBar.get(l)):"none";e.svgStackedBarsGroup.append("rect").attr("x",a).attr("y",r).attr("width",s).attr("height",i).style("stroke","Black").style("fill",c).style("stroke-width",.5).append("svg:title").text(function(){return e.cohortMetadata.metadata[o.donorIndex].donor+":"+l+"="+o.stackedBarValuesPre[t].value})},c=0;c<i;++c)l(c);else{var A=e.yScale(o.yPre-.4),u=e.yScale(o.yPre+.4),h=A-u,d=function(t){var n=r,i=e.xScale(o.stackedBarValuesPreCumulative[t])-r,a=o.stackedBarValuesPre[t].column,s=e.usedColumnsInStackedBar.has(a)?e.colourScaleStackedBar(e.usedColumnsInStackedBar.get(a)):"none";e.svgStackedBarsGroup.append("rect").attr("x",n).attr("y",u).attr("width",i).attr("height",h).style("stroke","Black").style("fill",s).style("stroke-width",.5).append("svg:title").text(function(){return e.cohortMetadata.metadata[o.donorIndex].donor+":"+a+"="+o.stackedBarValuesPre[t].value})};for(c=0;c<i;++c)d(c)}},i=0;i<t;++i)o(i)}},{key:"addSingleDiagonalKde",value:function(e){for(var t=this,n=(0,l.calculateKde)(e),o=r(n,3),i=o[0],s=o[1],c=o[2],A=(0,a.line)().x(function(e){return t.xScale(e.val-e.density/Math.sqrt(2))}).y(function(e){return t.yScale(e.val+e.density/Math.sqrt(2))}),u=.2*(this.maxX-this.minX)/Math.sqrt(2),h=(0,a.scaleLinear)().domain([0,c]).range([0,u]),d=i.length,f=[],p=0;p<d;++p)f.push({val:i[p],density:h(s[p])});this.svgPlotSupportGroup.append("path").datum(f).attr("fill","none").style("stroke-linejoin","round").style("stroke-linecap","round").style("stroke-width",1.5).style("stroke","black").attr("d",A),this.svgPlotSupportGroup.append("line").attr("x1",this.xScale(this.minX)).attr("x2",this.xScale(this.maxX)).attr("y1",this.yScale(this.minX)).attr("y2",this.yScale(this.maxX)).style("stroke-dasharray","5 5").style("stroke-width",1.5).style("stroke","black")}},{key:"addXYCategoricalGrid",value:function(e,t){var n=this,r=Array(e.length).fill().map(function(e,t){return t+.5}),o=new Set;r.forEach(function(e){o.add(e-.5),o.add(e+.5)});var i=Array(t.length).fill().map(function(e,t){return t+.5}),a=new Set;i.forEach(function(e){a.add(e-.5),a.add(e+.5)});var s=[];o.forEach(function(e){var n={};n.x1=e,n.x2=e,n.y1=0,n.y2=1.1*(t.length+.5),s.push(n)}),a.forEach(function(t){var n={x1:0};n.x2=1.1*(e.length+.5),n.y1=t,n.y2=t,s.push(n)}),this.svgPlotSupportGroup.selectAll(".gridLines").data(s).enter().append("line").attr("class","gridLines").attr("x1",function(e){return n.xScale(e.x1)}).attr("x2",function(e){return n.xScale(e.x2)}).attr("y1",function(e){return n.yScale(e.y1)}).attr("y2",function(e){return n.yScale(e.y2)}).style("stroke-width",.75).style("stroke","black")}},{key:"addPlotDataPoints",value:function(){var t=this;this.baseSize=Math.pow(2,parseInt(e("#flexiblePlotBaseSizeFactorController").val())-3),this.svgDataGroup.selectAll(".flexibleDataPoints").data(this.plotData).enter().append("path").attr("class","flexibleDataPoints").style("stroke",function(e){return e.colour}).style("fill",function(e){return e.colour}).attr("d",(0,a.symbol)().type(function(e){return a.symbols[e.symbol]}).size(function(e){return t.baseSize*Math.pow(e.radius,2)*d[e.symbol]})).attr("transform",function(e){return"translate("+e.x+","+e.y+")"}).append("svg:title").text(function(e){return t.cohortMetadata.prepareHoverText(e.donorIndex,t.includedHoverColumns)}),this.svgDataGroup.on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var e=(0,a.select)(a.event.target).datum();void 0!==e.donorIndex&&(t.parentFlexiblePlotManager.markDonor(e.donorIndex,!0),t.directMarkedDonors.add(e.donorIndex)),t.commonSettings.fastRelease()}})}},{key:"shadeSubcohortSilent",value:function(e,t){this.subcohortShades.has(e)&&this.subcohortShades.delete(e),this.subcohortShades.set(e,this.calculateShadingParameters(e,t))}},{key:"replot",value:function(){this.addSubcohortShades(),this.addPlotDataPoints(),this.remarkDonors()}},{key:"shadeSubcohort",value:function(e,t){this.shadeSubcohortSilent(e,t),this.replot()}},{key:"calculateShadingParameters",value:function(e,t){for(var n=[],r=0;r<this.plotData.length;++r)this.selectionManager.registeredSubcohorts.get(e).has(this.plotData[r].donorIndex)&&n.push([this.plotData[r].x,this.plotData[r].y]);return n.length>2?(0,s.default)(n,t):[]}},{key:"removeSubcohortShade",value:function(t){this.subcohortShades.delete(t),e("#flexiblePlotSubcohortMarkerHelper_"+t).remove(),e("#flexiblePlotSubcohortMarker_"+t).remove(),e("#flexiblePlotSubcohortShade_"+t).remove()}},{key:"addSubcohortShades",value:function(){var t=this;this.clearShadedSubcohorts();var n=0;this.subcohortShades.size>0&&e("#clearShadedSubcohorts").css("display","inline");var r=(0,i.discreteColour)(this.subcohortShades.size);this.subcohortShades.forEach(function(o,i,s){if(o.length>2){var l=0,c=0;t.svgSubcohortShadeGroup.append("path").attr("class","subcohortShadeElements").attr("id","flexiblePlotSubcohortShade_p"+t.panelIndex+"_"+i).style("stroke","none").style("fill",r[n]).style("opacity",.2).attr("d",function(){var e=(0,a.path)();e.moveTo(o[0][0],o[0][1]),l+=o[0][0],c+=o[0][1];for(var t=1;t<o.length;++t)e.lineTo(o[t][0],o[t][1]),l+=o[t][0],c+=o[t][1];return e.closePath(),e}).on("contextmenu",function(){a.event.preventDefault(),t.commonSettings.interactionLock||t.removeSubcohortShade(i)});var A=document.getElementById("flexiblePlotMain").getBoundingClientRect().width,u=l/o.length,h=c/o.length,d=(0,a.path)();d.moveTo(u,h),d.lineTo(A,h),d.closePath();var f=t.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("donorLabels").generateFontCssText();t.svgSubcohortPremarkerGroup.append("path").attr("id","flexiblePlotSubcohortMarkerHelper_p"+t.panelIndex+"_"+i).attr("d",d).style("display","none"),t.svgSubcohortMarkerGroup.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotSubcohortMarker_p"+t.panelIndex+"_"+i).attr("xlink:href","#flexiblePlotSubcohortMarkerHelper_p"+t.panelIndex+"_"+i).style("dominant-baseline","middle").style("alignment-baseline","middle").style("text-anchor","start").attr("startOffset","0%").style("font",f).style("fill",r[n]).html(t.selectionManager.registeredSubcohortNames.get(i)).call((0,a.drag)().on("start",function(){}).on("drag",function(){var n=a.event.x,r=a.event.y,o=(0,a.path)();o.moveTo(n,r),o.lineTo(A,r),o.closePath(),(0,a.select)("#flexiblePlotSubcohortMarkerHelper_p"+t.panelIndex+"_"+i).attr("d",o);var s=e("#flexiblePlotSubcohortMarker_p"+t.panelIndex+"_"+i);s.hide(),setTimeout(function(){s.show()},10)}).on("end",function(){})),n+=1}})}},{key:"clearShadedSubcohorts",value:function(){null!==this.svgSubcohortShadeGroup&&this.svgSubcohortShadeGroup.html(""),null!==this.svgSubcohortPremarkerGroup&&this.svgSubcohortPremarkerGroup.html(""),null!==this.svgSubcohortMarkerGroup&&this.svgSubcohortMarkerGroup.html("")}},{key:"remarkDonors",value:function(){var t=this;if(!this.commonSettings.interactionLock){this.commonSettings.fastLock();var n=[];this.markedDonors.forEach(function(e){n.push(e)}),this.clearMarkedDonors(),e("#subcohortSelectionFromFlexiblePlotDescription").empty(),n.forEach(function(e){t.markDonor(e,!1)}),this.commonSettings.fastRelease()}}},{key:"clearMarkedDonors",value:function(){this.svgPremarkerGroup.html(""),this.svgMarkerGroup.html(""),this.markedDonors.clear()}},{key:"removeDonorMark",value:function(t){e("#flexiblePlotDonorMarkerHelper_p"+this.panelIndex+"_"+t+"_dragbridge").remove(),e("#flexiblePlotDonorMarkerHelper_p"+this.panelIndex+"_"+t).remove(),e("#flexiblePlotDonorMarker_p"+this.panelIndex+"_"+t).remove(),this.markedDonors.delete(t),0===this.markedDonors.size&&(e("#clearMarkedDonorsFromFlexiblePlot").css("display","none"),e("#subcohortSelectionFromFlexiblePlotGroup").css("display","none"),e("#flexibleSubcohortSelectionName").css("display","none"))}},{key:"markDonor",value:function(t,n){var r=this;if(this.missingDonors.has(t))return!1;var o=e("#flexiblePlotDonorMarker_p"+this.panelIndex+"_"+t);if(o.length)return!n||(o.remove(),this.removeDonorMark(t),!1);var i=this.plotData[this.donorIndexToPlotData.get(t)];e("#clearMarkedDonorsFromFlexiblePlot").css("display","inline"),e("#subcohortSelectionFromFlexiblePlotGroup").css("display","inline"),e("#flexibleSubcohortSelectionName").css("display","inline"),this.markedDonors.add(t);var s=document.getElementById("flexiblePlotMain").getBoundingClientRect().width,l=i.x,c=i.y,A=l+Math.sqrt(.5*this.baseSize*i.radius),u=(0,a.path)();u.moveTo(A,c),u.lineTo(s,c);var h=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("donorLabels").generateFontCssText();return this.svgPremarkerGroup.append("path").attr("id","flexiblePlotDonorMarkerHelper_p"+this.panelIndex+"_"+t).attr("d",u).style("display","none"),this.svgMarkerGroup.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotDonorMarker_p"+this.panelIndex+"_"+t).attr("xlink:href","#flexiblePlotDonorMarkerHelper_p"+this.panelIndex+"_"+t).style("dominant-baseline","middle").style("alignment-baseline","middle").style("text-anchor","start").attr("startOffset","0%").style("font",h).html(this.cohortMetadata.prepareLabelText(t,this.includedLabelColumns)).on("contextmenu",function(){a.event.preventDefault(),r.commonSettings.interactionLock||r.removeDonorMark(t)}).call((0,a.drag)().on("start",function(){e("#flexiblePlotDonorMarkerHelper_p"+r.panelIndex+"_"+t+"_dragbridge").remove()}).on("drag",function(){var n=a.event.y,o=a.event.x+Math.sqrt(.5*r.baseSize*i.radius),l=(0,a.path)();l.moveTo(o,n),l.lineTo(s,n),l.closePath(),(0,a.select)("#flexiblePlotDonorMarkerHelper_p"+r.panelIndex+"_"+t).attr("d",l);var c=e("#flexiblePlotDonorMarker_p"+r.panelIndex+"_"+t);c.hide(),setTimeout(function(){c.show()},10)}).on("end",function(){var e=i.x,n=i.y,o=e+Math.sqrt(.5*r.baseSize*i.radius),s=a.event.x,l=a.event.y,c=s+Math.sqrt(.5*r.baseSize*i.radius);l>n?l-=Math.sqrt(.5*i.radius):l<n&&(l+=2*Math.sqrt(.5*i.radius));var A=(0,a.path)();A.moveTo(o,n),A.lineTo(c,l),A.closePath(),r.svgPremarkerGroup.append("path").attr("id","flexiblePlotDonorMarkerHelper_p"+r.panelIndex+"_"+t+"_dragbridge").attr("d",A).style("stroke","Black").style("display","inline")})),!0}},{key:"getNamePrefix",value:function(e){var t=this.xAxisColumn.replace(/ dim1$/,"").replace(/ dim2$/,"");return t===this.yAxisColumn.replace(/ dim1$/,"").replace(/ dim2$/,"")?t+"_"+e:"x:"+this.xAxisColumn+"_y:"+this.yAxisColumn+"_"+e}},{key:"runKmeans",value:function(t,n){for(var r=this,o=parseInt(e("#kmeansK").slider().val()),i=e("#FlexibleClusteringDistanceSelector").val(),a=[],s=[],l=0;l<this.plotData.length;++l)a.push([this.plotData[l].xPre,this.plotData[l].yPre]),s.push(this.plotData[l].donorIndex);f.clusterize(a,{k:o,distance:function(e,t){return c.DistanceMeasures[i](e,t)}},function(e,i){if(e)console.error(e);else{for(var a=[],l=0;l<o;++l){a.push([]);for(var c=0;c<i[l].clusterInd.length;++c)a[l].push(s[i[l].clusterInd[c]])}r.cohortMetadata.createMultipleGroups(a,r.missingDonors,n,t,r.panelIndex)}})}},{key:"runKmedoids",value:function(t,n,r){for(var o=parseInt(e("#kmedoidsK").slider().val()),i=A.Clusterer.getInstance(this.plotData,o,function(e,t){return c.DistanceMeasures[r]([e.xPre,e.yPre],[t.xPre,t.yPre])}).getClusteredData(),a=[],s=0;s<o;++s){a.push([]);for(var l=0;l<i[s].length;++l)a[s].push(i[s][l].donorIndex)}this.cohortMetadata.createMultipleGroups(a,this.missingDonors,n,t,this.panelIndex)}},{key:"runDBSCAN",value:function(t,n,r){for(var o=+e("#epsMinDBSCAN").slider().val(),i=+e("#epsMaxDBSCAN").slider().val(),a=parseInt(e("#mPtsMinDBSCAN").slider().val()),s=parseInt(e("#mPtsMaxDBSCAN").slider().val()),l=p().epsMin(o).epsMax(i).mPtsMin(a).mPtsMax(s).distanceFn(function(e,t){return c.DistanceMeasures[r]([e.xPre,e.yPre],[t.xPre,t.yPre])}).cluster(this.plotData),A=[],u=0;u<l.length;++u){A.push([]);for(var h=0;h<l[u].length;++h)A[u].push(this.plotData[l[u][h].index].donorIndex)}this.cohortMetadata.createMultipleGroups(A,this.missingDonors,n,t,this.panelIndex)}},{key:"runOPTICS",value:function(t,n){for(var r=parseInt(e("#mPtsMinOPTICS").slider().val()),o=+e("#neighbourhoodRadiusOPTICS").slider().val(),i=new g.OPTICS,a=[],s=[],l=0;l<this.plotData.length;++l)a.push([this.plotData[l].xPre,this.plotData[l].yPre]),s.push(this.plotData[l].donorIndex);for(var c=i.run(a,o,r),A=[],u=0;u<c.length;++u){A.push([]);for(var h=0;h<c[u].length;++h)A[u].push(s[c[u][h]])}this.cohortMetadata.createMultipleGroups(A,this.missingDonors,n,t,this.panelIndex)}},{key:"getHeaderChunksForTextExport",value:function(){var e=["Donor",this.xAxisColumn,this.yAxisColumn];return""!==this.colourColumn&&e.push(this.colourColumn),""!==this.symbolColumn&&e.push(this.symbolColumn),""!==this.radiusColumn&&e.push(this.radiusColumn),e}},{key:"provideRowsForTextExport",value:function(e){var t=[];if(e){for(var n=0;n<this.cohortMetadata.metadata.length;++n)if(!this.missingDonors.has(n)){var r=[];r.push(this.cohortMetadata.metadata[n].donor),r.push(this.panelIndex),r.push(this.xAxisColumn),r.push(this.cohortMetadata.metadata[n][this.xAxisColumn]),r.push(this.yAxisColumn),r.push(this.cohortMetadata.metadata[n][this.yAxisColumn]),r.push(this.colourColumn),""!==this.colourColumn?r.push(this.cohortMetadata.metadata[n][this.colourColumn]):r.push("NA"),r.push(this.symbolColumn),""!==this.symbolColumn?r.push(this.cohortMetadata.metadata[n][this.symbolColumn]):r.push("NA"),r.push(this.radiusColumn),""!==this.radiusColumn?r.push(this.cohortMetadata.metadata[n][this.radiusColumn]):r.push("NA"),t.push(r)}}else for(var o=0;o<this.cohortMetadata.metadata.length;++o)if(!this.missingDonors.has(o)){var i=[];i.push(this.cohortMetadata.metadata[o].donor),i.push(this.cohortMetadata.metadata[o][this.xAxisColumn]),i.push(this.cohortMetadata.metadata[o][this.yAxisColumn]),""!==this.colourColumn&&i.push(this.cohortMetadata.metadata[o][this.colourColumn]),""!==this.symbolColumn&&i.push(this.cohortMetadata.metadata[o][this.symbolColumn]),""!==this.radiusColumn&&i.push(this.cohortMetadata.metadata[o][this.radiusColumn]),t.push(i)}return t}},{key:"getTitleChunks",value:function(){var e=[this.cohortMetadata.cohortName];return this.stackedBarplotMode?void 0!==this.xAxisColumn?(e.push("x_"+this.xAxisColumn.replace(/ /g,"_")),e.push("y_stackedBar")):(e.push("x_stackedBar"),e.push("y_"+this.yAxisColumn.replace(/ /g,"_"))):(e.push("x_"+this.xAxisColumn.replace(/ /g,"_")),e.push("y_"+this.yAxisColumn.replace(/ /g,"_"))),""!==this.colourColumn&&e.push("colour_"+this.colourColumn.replace(/ /g,"_")),""!==this.symbolColumn&&e.push("symbol_"+this.symbolColumn.replace(/ /g,"_")),""!==this.radiusColumn&&e.push("radius_"+this.radiusColumn.replace(/ /g,"_")),e}}]),t}()}).call(this,n(0))},function(e,t){},function(e,t,n){var r;!function(o,i){var a,s=(0,eval)("this"),l=256,c=6,A="random",u=i.pow(l,c),h=i.pow(2,52),d=2*h,f=l-1;function p(e,t,n){var r=[],p=m(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(o)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(l):(e=new Uint8Array(l),(s.crypto||s.msCrypto).getRandomValues(e)),v(e)}catch(e){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,v(o)]}}():e,3),r),y=new function(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);o<l;)a[o]=o++;for(o=0;o<l;o++)a[o]=a[i=f&i+e[o%n]+(t=a[o])],a[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,a=r.S;e--;)t=a[o=f&o+1],n=n*l+a[f&(a[o]=a[i=f&i+t])+(a[i]=t)];return r.i=o,r.j=i,n})(l)}(r),b=function(){for(var e=y.g(c),t=u,n=0;e<h;)e=(e+n)*l,t*=l,n=y.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,m(v(y.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&g(r,y),e.state=function(){return g(y,{})}),n?(i[A]=e,t):e})(b,p,"global"in t?t.global:this==i,t.state)}function g(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function m(e,t){for(var n,r=e+"",o=0;o<r.length;)t[f&o]=f&(n^=19*t[f&o])+r.charCodeAt(o++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(i["seed"+A]=p,m(i.random(),o),"object"==typeof e&&e.exports){e.exports=p;try{a=n(231)}catch(e){}}else void 0===(r=function(){return p}.call(t,n,t,e))||(e.exports=r)}([],Math)},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.tychei=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],l=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,l=Math.max(l,t.length)),o=0,i=-32;i<l;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=s[127&i]^=r+a)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=a,e.X=s,e.i=o}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor4096=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorshift7=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new function(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorwow=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new function(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&("object"==typeof r&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor128=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){(function(e){var r;!function(e,o,i){function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new function(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,r&&("object"==typeof r&&a(r,n),o.state=function(){return a(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(19)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.alea=s}(0,"object"==typeof e&&e,n(9))}).call(this,n(22)(e))},function(e,t,n){var r=n(238),o=n(237),i=n(236),a=n(235),s=n(234),l=n(233),c=n(232);c.alea=r,c.xor128=o,c.xorwow=i,c.xorshift7=a,c.xor4096=s,c.tychei=l,e.exports=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var a=n(31),s=n(18).create();s.import(n(37)),s.import(n(36)),t.SpectralEmbedding_precomputed=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.n_components=t,this.gamma=n,this.random_state=r,this.n_neighbors=o}return o(e,[{key:"fit_precomputed",value:function(t){this.embedding_=e.spectral_embedding(t,this.n_components,this.random_state)}},{key:"fit_transform_precomputed",value:function(e){return this.fit_precomputed(e),this.embedding_}}],[{key:"spectral_embedding",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:None,!(arguments.length>3&&void 0!==arguments[3])||arguments[3]),i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];i&&(n+=1);var l=e.csgraph_laplacian_dense(t,o,!0),c=r(l,2),A=c[0],u=c[1];if(o)for(var h=A.length,d=0;d<h;++d)A[d][d]=1;var f=new a.Matrix(A),p=new a.EigenvalueDecomposition(f).eigenvectorMatrix,g=s.transpose(p).slice(0,n);if(e._deterministic_vector_sign_flip(g),o)for(var m=g.length,v=g[0].length,y=0;y<m;++y)for(var b=0;b<v;++b)g[y][b]/=u[b];return i?s.transpose(g.slice(1,n)):s.transpose(g.slice(0,n))}},{key:"csgraph_laplacian_dense",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=1;arguments.length>3&&void 0!==arguments[3]&&arguments[3]||(i=0);var a=e._laplacian_dense(t,n,i),s=r(a,2),l=s[0],c=s[1];return o?[l,c]:l}},{key:"_laplacian_dense",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=t.slice(),i=o.length,a=o[0].length,s=0;s<i;++s)o[s][s]=0;var l=null,c=null;if(0===r){c=a,l=new Array(a).fill(0);for(var A=0;A<i;++A)for(var u=0;u<a;++u)l[u]+=o[A][u]}else if(1===r){c=i,l=new Array(i).fill(0);for(var h=0;h<i;++h)for(var d=0;d<a;++d)l[h]+=o[h][d]}if(n){for(var f=[],p=0;p<c;++p){var g=0===l[p];f.push(1-g),g&&(l[p]=Math.sqrt(l[p]))}for(var m=o.length,v=o[0].length,y=0;y<m;++y)for(var b=0;b<v;++b)o[y][b]/=-l[y]*l[b];e._setdiag_dense(o,f)}else{for(var I=o.length,x=o[0].length,w=0;w<I;++w)for(var C=0;C<x;++C)o[w][C]*=-1;e._setdiag_dense(o,l)}return[o,l]}},{key:"_deterministic_vector_sign_flip",value:function(e){for(var t=e[0].length,n=0;n<e.length;++n)if(Math.max.apply(Math,i(e[n]))<0)for(var r=0;r<t;++r)e[n][r]*=-1}},{key:"_setdiag_dense",value:function(e,t){for(var n=e.length,r=0;r<n;++r)e[r][r]=t[r]}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.spectral_layout=function(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"euclidean",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=A(t),h=r(l,2),d=h[0],f=h[1];if(d>1)return u(e,t,d,f,n,o,i,a);for(var p=new c.Matrix(t.toDense()),g=t.sumOverAxis0(),m=c.Matrix.eye(t.dim0),v=c.Matrix.eye(t.dim0),y=0;y<t.dim0;++y)g[y]=1/Math.sqrt(g[y]),v.set(y,y,g[y]);for(var b=c.Matrix.sub(m,v.mmul(p).mmul(v)),I=new c.EigenvalueDecomposition(b),x=I.realEigenvalues,w=I.imaginaryEigenvalues,C=[],E=0;E<x.length;++E){var S=Math.sqrt(Math.pow(x[E],2)+Math.pow(w[E],2));C.push({mag:S,ind:E})}C.sort(function(e,t){return e.mag<t.mag?-1:1});for(var M=I.eigenvectorMatrix,k=[],B=0;B<n+1;++B)k.push(M.columnView(C[B].ind).to1DArray());return s.transpose(k)},t.connected_components=A,t.multi_component_layout=u,t.component_layout=h,t._connected_components_directed=d,t._connected_components_undirected=f;var o=n(34),i=n(91),a=n(240),s=n(18).create();s.import(n(37)),s.import(n(36));var l=-9999,c=n(31);function A(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"weak",r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=new i.CsrSparseMatrix;o.addCooData(e),"weak"===n&&(t=!1);var a=new Array(o.dim0).fill(l),s=0;if(t)s=d(o.indices,o.indptr,a);else{var c=e.transpose().toCsr();s=f(o.indices,o.indptr,c.indices,c.indptr,a)}return r?[s,a]:s}function u(e,t,n,r,i,a,l,A){for(var u=[],d=0;d<t.dim0;++d){u.push([]);for(var f=0;f<i;++f)u[d].push(0)}var p=null;if(n>2*i)p=h(e,n,r,i,l,A);else{for(var g=Math.ceil(n/2),m=i,v=g,y=[],b=0;b<v;++b){y.push([]);for(var I=0;I<m;++I)y[b].push(0)}for(var x=0;x<v;++x)y[x][x]=1;var w=m,C=2*v;p=[];for(var E=0;E<C;++E){p.push([]);for(var S=0;S<w;++S)p[E].push(0)}for(var M=0;M<v;++M)for(var k=0;k<w;++k){var B=y[M][k];p[M][k]=B,p[M+v][k]=-B}p=p.slice(0,n)}for(var D=function(e){for(var n=[],a=0,h=new Map,d=0;d<r.length;++d)r[d]===e&&(n.push(d),h.set(d,a),a+=1);var f=t.filterByRowCol(n,h),g=(0,o.pairwise_distancesXY)([p[e]],p,l,A),m=Number.MAX_VALUE,v=g.length,y=1;if(Array.isArray(g[0])){y=g[0].length;for(var b=0;b<v;++b)for(var I=0;I<y;++I){var x=g[b][I];x>0&&x<m&&(m=x)}}else for(var w=0;w<v;++w){var C=g[w];C>0&&C<m&&(m=C)}if(m/=2,f.dim0<2*i){for(var E=0;E<r.length;++E)if(r[E]===e){u[E]=[];for(var S=0;S<i;++S)u[E].push(Math.random()*m*2-m+p[e][S])}return"continue"}for(var M=f.sumOverAxis0(),k=c.Matrix.eye(f.dim0),B=c.Matrix.eye(f.dim0),D=0;D<f.dim0;++D)M[D]=1/Math.sqrt(M[D]),B.set(D,D,M[D]);for(var P=new c.Matrix(f.toDense()),Q=c.Matrix.sub(k,B.mmul(P).mmul(B)),T=new c.EigenvalueDecomposition(Q),G=T.realEigenvalues,R=T.imaginaryEigenvalues,_=[],V=0;V<G.length;++V){var N=Math.sqrt(Math.pow(G[V],2)+Math.pow(R[V],2));_.push({mag:N,ind:V})}_.sort(function(e,t){return e.mag<t.mag?-1:1});for(var F=s.transpose(T.eigenvectorMatrix.to2DArray()),O=[],L=Number.MIN_VALUE,j=1;j<i+1;++j){var z=F[_[j].ind];O.push(z.slice()),z.forEach(function(e){var t=Math.abs(e);t>L&&(L=t)})}for(var H=m/L,U=0;U<O.length;++U)for(var Y=e%2==0||U%2==0?1:-1,X=0;X<O[0].length;++X)O[U][X]*=H*Y;O=s.transpose(O);for(var q=0;q<r.length;++q)if(r[q]===e)for(var K=0;K<i;++K)u[q][K]=O[h.get(q)][K]+p[e][K]},P=0;P<n;++P)D(P);return u}function h(e,t,n,r,i,s){for(var l=e[0].length,c=[],A=0;A<t;++A){c.push([]);for(var u=0;u<l;++u)c[A].push(0);for(var h=[],d=0;d<t;++d)n[d]===A&&h.push(d);for(var f=h.length,p=0;p<f;++p)for(var g=0;g<l;++g)c[A][g]+=e[h[p]][g]/f}for(var m=(0,o.pairwise_distances)(c,i,s),v=m.length,y=m[0].length,b=[],I=0;I<v;++I){b.push([]);for(var x=0;x<y;++x)b[I].push(Math.exp(-Math.pow(m[I][x],2)))}for(var w=new a.SpectralEmbedding_precomputed(r).fit_transform_precomputed(b),C=w.length,E=w[0].length,S=Number.MIN_VALUE,M=0;M<C;++M)for(var k=0;k<E;++k){var B=w[M][k];B>S&&(S=B)}for(var D=0;D<C;++D)for(var P=0;P<E;++P)w[D][P]/=S;return w}function d(e,t,n){for(var r=n.length,o=0,i=0,a=0,s=0,l=0,c=0,A=-2,u=new Array(r).fill(-1),h=new Array(r).fill(-1),d=new Array(r).fill(-1),f=new Array(n.length).fill(-1),p=0,g=r-1,m=0,v=0;v<r;++v){if(-1===f[v])for(m=v,h[v]=-2,d[v]=-2;-2!==m;)if(-1===f[v=m]){f[v]=p,p+=1;for(var y=t[v];y<t[v+1];++y)-1===f[o=e[y]]&&(-1!==h[o]&&(l=h[o],-2!==(c=d[o])&&(h[c]=l),-2!==l&&(d[l]=c)),h[o]=m,d[o]=-2,d[m]=o,m=o)}else{(m=h[v])>=0&&(d[m]=-2),h[v]=-1,d[v]=-1,s=1,i=f[v];for(var b=t[v];b<t[v+1];++b)(a=f[e[b]])<i&&(i=a,s=0);if(f[v]=i,s)for(p-=1;-2!==A&&f[v]<=f[A];)A=u[o=A],u[o]=-1,n[o]=g,p-=1;else u[v]=A,A=v}n[v]=r-1-n[v]}return r-1-g}function f(e,t,n,r,o){for(var i=o.length,a=0,s=-2,l=0;l<i;++l)o[l]=-1;for(var c=0;c<i;++c)if(-1===o[c]){for(s=c,o[c]=-2;-2!==s;){s=o[c=s],o[c]=a;for(var A=t[c];A<t[c+1];++A){var u=e[A];-1===o[u]&&(o[u]=s,s=u)}for(var h=r[c];h<r[c+1];++h){var d=n[h];-1===o[d]&&(o[d]=s,s=d)}}a+=1}return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CooSparseMatrix=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(91);t.CooSparseMatrix=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[],this.row=[],this.col=[],this.dim0=0,this.dim1=0,this.has_canonical_format=!1}return r(e,[{key:"addIdentityData",value:function(e){this.dim0=e,this.dim1=e;for(var t=0;t<e;++t)this.data.push(1),this.row.push(t),this.col.push(t);this.has_canonical_format=!0}},{key:"addMainDiagonalData",value:function(e){var t=e.length;this.dim0=t,this.dim1=t;for(var n=0;n<t;++n)this.data.push(1),this.row.push(e[n]),this.col.push(e[n]);this.has_canonical_format=!0}},{key:"sortCooRowOnly",value:function(e){if(null===e){e=[];for(var t=this.data.length,n=0;n<t;++n)e.push({row:this.row[n],col:this.col[n],data:this.data[n]})}e.sort(function(e,t){return e.row<t.row?-1:e.row>t.row?1:-1}),this.data=[],this.row=[],this.col=[];for(var r=e.length,o=0;o<r;++o){var i=e[o];this.data.push(i.data),this.row.push(i.row),this.col.push(i.col)}}},{key:"sortCoo",value:function(e){if(null===e){e=[];for(var t=this.data.length,n=0;n<t;++n)e.push({row:this.row[n],col:this.col[n],data:this.data[n]})}e.sort(function(e,t){return e.row<t.row?-1:e.row>t.row?1:e.col<t.col?-1:e.col>t.col?1:-1}),this.data=[],this.row=[],this.col=[];for(var r=e.length,o=0;o<r;++o){var i=e[o];this.data.push(i.data),this.row.push(i.row),this.col.push(i.col)}}},{key:"addDenseData",value:function(e){for(var t=e.length,n=e[0].length,r=0;r<t;++r)for(var o=0;o<n;++o){var i=e[r][o];0!==i&&(this.data.push(i),this.row.push(r),this.col.push(o))}this.dim0=t,this.dim1=n,this.has_canonical_format=!0}},{key:"addCooData",value:function(e,t,n,r,o){this.data=e.slice(),this.row=t.slice(),this.col=n.slice(),this.dim0=r,this.dim1=o}},{key:"addCooMatrix",value:function(e){this.data=e.data.slice(),this.row=e.row.slice(),this.col=e.col.slice(),this.dim0=e.dim0,this.dim1=e.dim1}},{key:"sum_duplicates",value:function(){if(!this.has_canonical_format){for(var e=new Array(this.dim0*this.dim1).fill(0),t=[],n=[],r=this.data.length,o=0;o<r;++o){var i=this.data[o];if(0!==i){var a=this.row[o],s=this.col[o];e[a*this.dim1+s]+=i,t.push(a),n.push(s)}}for(var l=t.length,c=[],A=0;A<l;++A){var u=t[A],h=n[A],d=u*this.dim1+h,f=e[d];0!==f&&void 0!==f&&(e[d]=void 0,c.push({data:f,row:u,col:h}))}this.sortCoo(c),this.has_canonical_format=!0}}},{key:"mult_duplicates",value:function(){if(!this.has_canonical_format){for(var e=new Array(this.dim0*this.dim1).fill(1),t=new Array(this.dim0*this.dim1).fill(0),n=[],r=[],o=this.data.length,i=0;i<o;++i){var a=this.data[i];if(0!==a){var s=this.row[i],l=this.col[i],c=s*this.dim1+l;e[c]*=a,t[c]+=1,n.push(s),r.push(l)}}for(var A=[],u=n.length,h=0;h<u;++h){var d=n[h],f=r[h],p=d*this.dim1+f;if(t[p]>1){var g=e[p];0!==g&&void 0!==g&&(e[p]=void 0,A.push({data:g,row:d,col:f}))}}this.sortCoo(A),this.has_canonical_format=!0}}},{key:"eliminate_zeros",value:function(){for(var e=this.data.length,t=[],n=[],r=[],o=0;o<e;++o)0!==this.data[o]&&(t.push(this.data[o]),n.push(this.row[o]),r.push(this.col[o]));this.data.length=0,this.row.length=0,this.col.length=0,this.data=t,this.row=n,this.col=r}},{key:"transpose",value:function(){var t=new e;return t.addCooData(this.data,this.col,this.row,this.dim1,this.dim0),t}},{key:"add",value:function(t){var n=this.data.concat(t.data),r=this.row.concat(t.row),o=this.col.concat(t.col),i=new e;return i.addCooData(n,r,o,this.dim0,this.dim1),i.sum_duplicates(),i}},{key:"multiplyByScalar",value:function(t){for(var n=this.data.slice(),r=this.row.slice(),o=this.col.slice(),i=new e,a=this.data.length,s=0;s<a;++s)n[s]*=t;return i.addCooData(n,r,o,this.dim0,this.dim1),i}},{key:"multiplyElementwise",value:function(t){var n=this.data.concat(t.data),r=this.row.concat(t.row),o=this.col.concat(t.col),i=new e;return i.addCooData(n,r,o,this.dim0,this.dim1),i.mult_duplicates(),i}},{key:"sumOverAxis0",value:function(){for(var e=new Array(this.dim1).fill(0),t=this.data.length,n=0;n<t;++n){var r=this.data[n];e[this.col[n]]+=r}return e}},{key:"toDense",value:function(){for(var e=[],t=0;t<this.dim0;++t){e.push([]);for(var n=0;n<this.dim1;++n)e[t].push(0)}for(var r=this.data.length,o=0;o<r;++o)e[this.row[o]][this.col[o]]=this.data[o];return e}},{key:"toCsr",value:function(){var e=new o.CsrSparseMatrix;return e.addCooData(this),e}},{key:"filterByRowCol",value:function(t,n){for(var r=new Set(t),o=this.data.length,i=[],a=[],s=[],l=Math.min(this.dim0,r.size),c=Math.min(this.dim1,r.size),A=0;A<o;++A){var u=this.row[A],h=this.col[A];r.has(u)&&r.has(h)&&(i.push(this.data[A]),a.push(n.get(u)),s.push(n.get(h)))}var d=new e;return d.addCooData(i,a,s,l,c),d}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlatTree=function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hyperplanes=t,this.offsets=n,this.children=r,this.indices=o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RandomProjectionTreeNode=function e(t,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indices=t,this.is_leaf=n,this.hyperplane=r,this.offset=o,this.left_child=i,this.right_child=a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};t.make_forest=function(e,t,n,r){for(var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=[],a=Math.max(10,t),l=0;l<n;++l)i.push(s(u(e,r,a,o),a));return i},t.flatten_tree=s,t.recursive_flatten=l,t.num_nodes=c,t.num_leaves=A,t.make_tree=u,t.make_angular_tree=h,t.make_euclidean_tree=d,t.euclidean_random_projection_split=f,t.angular_random_projection_split=p,t.rptree_leaf_array=function(e){var t=[],n=e.length;if(!(n>0))return[-1];for(var r=0;r<n;++r)t.push(e[r].indices);return t};var o=n(244),i=n(34),a=n(243);function s(e,t){for(var n=c(e),r=A(e),o=[],i=[],s=[],u=e.hyperplane.length,h=0;h<n;++h){i.push(0),o.push([]),s.push([-1,-1]);for(var d=0;d<u;++d)o[h].push(0)}for(var f=[],p=0;p<r;++p){f.push([]);for(var g=0;g<t;++g)f[p].push(-1)}return l(e,o,i,s,f,0,0),new a.FlatTree(o,i,s,f)}function l(e,t,n,o,i,a,s){if(e.is_leaf){o[a][0]=-s;for(var c=0;c<e.indices.length;++c)i[s][c]=e.indices[c];return[a,s+=1]}t[a]=e.hyperplane,n[a]=e.offset,o[a][0]=a+1;var A=a,u=l(e.left_child,t,n,o,i,a+1,s),h=r(u,2);a=h[0],s=h[1],o[A][1]=a+1;var d=l(e.right_child,t,n,o,i,a+1,s),f=r(d,2);return[a=f[0],s=f[1]]}function c(e){return e.is_leaf?1:1+c(e.left_child)+c(e.right_child)}function A(e){return e.is_leaf?1:A(e.left_child)+A(e.right_child)}function u(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.length,i=[],a=0;a<o;++a)i.push(a);return r?h(e,i,t,n):d(e,i,t,n)}function h(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,a=null;if(t.length>i){var s=p(e,t,n),l=r(s,4),c=l[0],A=l[1],u=l[2],d=l[3],f=h(e,c,n,i),g=h(e,A,n,i);a=new o.RandomProjectionTreeNode(null,!1,u,d,f,g)}else a=new o.RandomProjectionTreeNode(t,!0,null,null,null,null);return a}function d(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,a=null;if(t.length>i){var s=f(e,t,n),l=r(s,4),c=l[0],A=l[1],u=l[2],h=l[3],p=d(e,c,n,i),g=d(e,A,n,i);a=new o.RandomProjectionTreeNode(null,!1,u,h,p,g)}else a=new o.RandomProjectionTreeNode(t,!0,null,null,null,null);return a}function f(e,t,n){var r=e[0].length,o=t.length,a=Math.abs((0,i.tau_rand_int)(n)%o),s=Math.abs((0,i.tau_rand_int)(n)%o);s+=a===s,s=Math.abs(s%o);for(var l=t[a],c=t[s],A=0,u=[],h=0;h<r;++h){var d=e[l][h]-e[c][h];u.push(d),A-=d*(e[l][h]+e[c][h])/2}for(var f=[],p=0;p<o;++p){for(var g=A,m=0;m<r;++m)g+=u[m]*e[t[p]][m];if(Math.abs(g)<1e-8){var v=Math.abs((0,i.tau_rand_int)(n)%2);f.push(v)}else g>0?f.push(0):f.push(1)}for(var y=[],b=[],I=0;I<o;++I)0===f[I]?y.push(t[I]):b.push(t[I]);return[y,b,u,A]}function p(e,t,n){var r=e[0].length,o=t.length,a=Math.abs((0,i.tau_rand_int)(n)%o),s=Math.abs((0,i.tau_rand_int)(n)%o);s+=a===s,s=Math.abs(s%o);var l=t[a],c=t[s],A=(0,i.l2Norm)(e[l]),u=(0,i.l2Norm)(e[c]);Math.abs(A)<1e-8&&(A=1),Math.abs(u)<1e-8&&(u=1);for(var h=[],d=0;d<r;++d)h.push(e[l][d]/A-e[c][d]/u);var f=(0,i.l2Norm)(h);Math.abs(f)<1e-8&&(f=1);for(var p=0;p<r;++p)h[p]=h[p]/f;for(var g=[],m=0;m<o;++m){for(var v=0,y=0;y<r;++y)v+=h[y]*e[t[m]][y];if(Math.abs(v)<1e-8){var b=Math.abs((0,i.tau_rand_int)(n)%2);g.push(b)}else v>0?g.push(0):g.push(1)}for(var I=[],x=[],w=0;w<o;++w)0===g[w]?I.push(t[w]):x.push(t[w]);return[I,x,h,null]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.make_nn_descent=function(e,t){return function(n,i,a){for(var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001,A=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7],h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,d=n.length,f=(0,r.make_heap)(d,i),p=0;p<d;++p)for(var g=(0,r.rejection_sample)(i,d,a),m=0;m<g.length;++m){var v=e.apply(void 0,[n[p],n[g[m]]].concat(o(t)));(0,r.heap_push)(f,p,v,g[m],1),(0,r.heap_push)(f,g[m],v,p,1)}if(u)for(var y=h.length,b=h[0].length,I=0;I<y;++I)for(var x=0;x<b&&!(h[I][x]<0);++x)for(var w=x+1;w<b&&!(h[I][w]<0);++w){var C=e.apply(void 0,[h[I][x],h[I][w]].concat(o(t)));(0,r.heap_push)(f,h[I][x],C,h[I][w],1),(0,r.heap_push)(f,h[I][w],C,h[I][x],1)}for(var E=n.length,S=0;S<l;++S){for(var M=(0,r.build_candidates)(f,d,i,s,a),k=0,B=0;B<d;++B)for(var D=0;D<s;++D){var P=M[0][B][D];if(!(P<0||(0,r.tau_rand)(a)<A))for(var Q=0;Q<s;++Q){var T=M[0][B][Q];if(!(T<0||!M[2][B][D]&&M[2][B][Q])){var G=e.apply(void 0,[n[P],n[T]].concat(o(t)));k+=(0,r.heap_push)(f,P,G,T,1),k+=(0,r.heap_push)(f,T,G,P,1)}}}if(k<=c*i*E)break}return(0,r.deheap_sort)(f)}};var r=n(34);function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}},function(e,t,n){"use strict";var r=n(31);function o(e,t,n){var r=0;const o=n(t);for(var i=0;i<e.x.length;i++)r+=Math.abs(e.y[i]-o(e.x[i]));return r}function i(e,t,n,o,i){var a=r.Matrix.eye(t.length).mul(n*o*o),s=e.x.length,l=new Array(s);const c=i(t);for(var A=0;A<s;A++)l[A]=c(e.x[A]);var u=function(e,t,n,o,i){const a=n.length,s=e.x.length;for(var l=new Array(a),c=0;c<a;c++){l[c]=new Array(s);var A=n.concat();A[c]+=o;for(var u=i(A),h=0;h<s;h++)l[c][h]=t[h]-u(e.x[h])}return new r.Matrix(l)}(e,l,t,o,i),h=function(e,t){const n=e.x.length;for(var o=new Array(n),i=0;i<n;i++)o[i]=e.y[i]-t[i];return new r.Matrix([o])}(e,l).transposeView(),d=r.inverse(a.add(u.mmul(u.transposeView())));return(t=(t=new r.Matrix([t])).sub(d.mmul(u).mmul(h).mul(o).transposeView())).to1DArray()}e.exports=function(e,t,n={}){let{maxIterations:r=100,gradientDifference:a=.1,damping:s=0,errorTolerance:l=.01,initialValues:c}=n;if(s<=0)throw new Error("The damping option must be a positive number");if(!e.x||!e.y)throw new Error("The data parameter must have x and y elements");if(!Array.isArray(e.x)||e.x.length<2||!Array.isArray(e.y)||e.y.length<2)throw new Error("The data parameter elements must be an array with more than 2 points");if(e.x.length!==e.y.length)throw new Error("The data parameter elements must have the same size");var A=c||new Array(t.length).fill(1);if(!Array.isArray(A))throw new Error("initialValues must be an array");for(var u=o(e,A,t),h=u<=l,d=0;d<r&&!h;d++)h=(u=o(e,A=i(e,A,s,a,t),t))<=l;return{parameterValues:A,parameterError:u,iterations:d}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UMAP=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(e){return e&&e.__esModule?e:{default:e}}(n(247)),a=n(246),s=n(245),l=n(242),c=n(34),A=n(241),u=n(38);function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var d=n(239);t.UMAP=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"euclidean",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"spectral",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.1,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,A=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:5,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:null,g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:null,m=arguments.length>15&&void 0!==arguments[15]?arguments[15]:null,v=arguments.length>16&&void 0!==arguments[16]&&arguments[16];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.n_neighbors=t,this.distanceFunction=u.DistanceMeasures[r],this.metric_kwds=m,this.n_epochs=o,this.init=a,this.n_components=n,this.repulsion_strength=h,this.learning_rate=i,this.spread=l,this.min_dist=s,this.set_op_mix_ratio=c,this.local_connectivity=A,this.negative_sample_rate=d,this.random_state=g,this.angular_rp_forest=v,this.a=null,this.b=null,this._a=f,this._b=p,this._raw_data=null}return o(e,[{key:"fit",value:function(t){if(this._raw_data=t,null===this._a||null===this._b){var n=e.find_ab_params(this.spread,this.min_dist),o=r(n,2);this._a=o[0],this._b=o[1]}else this._a=this.a,this._b=this.b;null!==this.metric_kwds?this._metric_kwds=this.metric_kwds:this._metric_kwds=[],this._initial_alpha=this.learning_rate;var i=t.length;if(t.length<=this.n_neighbors){if(1===i){for(var a=[],s=0;s<this.n_components;++s)a.push(0);return void(this.embedding_=a)}this._n_neighbors=i-1}else this._n_neighbors=this.n_neighbors;var l=e.check_random_state(this.random_state);if(i<4096){var A=(0,c.pairwise_distances)(t,this.distanceFunction,this._metric_kwds);this.graph_=e.fuzzy_simplicial_set(A,this._n_neighbors,l,"precomputed",this._metric_kwds,null,null,this.angular_rp_forest,this.set_op_mix_ratio,this.local_connectivity),this.embedding_=e.simplicial_set_embedding(this._raw_data,this.graph_,this.n_components,this._initial_alpha,this._a,this._b,this.repulsion_strength,this.negative_sample_rate,null!==this.n_epochs?this.n_epochs:0,this.init,l,this.distanceFunction,this._metric_kwds);for(var u=this.embedding_.length,d=this.embedding_[0].length,f=[],p=0;p<d;++p){f.push([]);for(var g=0;g<u;++g)f[p].push(this.embedding_[g][p]);f[p]=(Math.max.apply(Math,h(f[p]))+Math.min.apply(Math,h(f[p])))/2}for(var m=0;m<u;++m)for(var v=0;v<d;++v)this.embedding_[m][v]-=f[v]}else console.log("sparse UMAP not implemented")}},{key:"fit_transform",value:function(e){return this.fit(e),this.embedding_}}],[{key:"find_ab_params",value:function(e,t){for(var n={x:(0,c.linspace)(0,3*e,300),y:[]},o=0;o<n.x.length;++o)n.x[o]<t?n.y.push(1):n.y.push(Math.exp(-(n.x[o]-t)/e));var a=(0,i.default)(n,function(e){var t=r(e,2),n=t[0],o=t[1];return function(e){return 1/(1+n*Math.pow(e,2*o))}},{damping:1.5,initialValues:[1,1],gradientDifference:.1,maxIterations:100,errorTolerance:.01}).parameterValues;return[a[0],a[1]]}},{key:"check_random_state",value:function(e){return null===e?d():d(e)}},{key:"nearest_neighbors",value:function(e,t,n,o,i,l){if("precomputed"===n){for(var c=e.length,A=Math.min(t,c),u=[],h=0;h<c;++h){u.push([]);for(var d=[],f=0;f<c;++f)d.push({val:e[h][f],index:f});d.sort(function(e,t){return e.val<t.val?-1:e.val>t.val?1:0});for(var p=0;p<A;++p)u[h].push(d[p].index)}for(var g=[],m=0;m<c;++m){g.push([]);for(var v=0;v<A;++v)g[m].push(e[m][u[m][v]])}return[u,g,[]]}for(var y=n,b=[],I=0;I<3;++I)b.push(l.int32());var x=(0,a.make_nn_descent)(y,o),w=e.length,C=5+Math.round(Math.pow(w,.5)/20),E=Math.max(5,Math.round(Math.log2(w))),S=(0,s.make_forest)(e,t,C,b,i),M=x(e,t,b,60,E,.001,.5,!0,(0,s.rptree_leaf_array)(S)),k=r(M,2);return[k[0],k[1],S]}},{key:"smooth_knn_dist",value:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=Math.log2(t)*o,a=e.length,s=e[0].length,l=new Array(a).fill(0),c=new Array(a).fill(0),A=0,u=0;u<a;++u)for(var d=0;d<s;++d)A+=e[u][d];for(var f=.001*A/(a*s),p=Math.floor(r),g=r-p,m=0;m<a;++m){var v=0,y=Number.MAX_VALUE,b=1,I=e[m].filter(function(e){return e>0});I.length>=r?p>0?(l[m]=I[p-1],g>1e-5&&(l[m]+=g*(I[p]-I[p-1]))):l[m]=g*I[0]:I.length>0&&(l[m]=Math.max.apply(Math,h(I)));for(var x=0;x<n;++x){for(var w=0,C=1;C<s;++C){var E=e[m][C]-l[m];w+=E>0?Math.exp(-E/b):1}if(Math.abs(w-i)<1e-5)break;w>i?b=(v+(y=b))/2:(v=b,y===Number.MAX_VALUE?b*=2:b=(v+y)/2)}if(c[m]=b,l[m]>0){var S=I.reduce(function(e,t){return e+t})/s*.001;c[m]<S&&(c[m]=S)}else c[m]<f&&(c[m]=f)}return[c,l]}},{key:"compute_membership_strengths",value:function(e,t,n,r){for(var o=e.length,i=e[0].length,a=new Array(o*i).fill(0),s=new Array(o*i).fill(0),l=new Array(o*i).fill(0),c=0,A=0;A<o;++A)for(var u=0;u<i;++u)if(-1!==e[A][u]){var h=A*i+u;c=e[A][u]===A?0:t[A][u]-r[A]<=0?1:Math.exp(-(t[A][u]-r[A])/n[A]),a[h]=A,s[h]=e[A][u],l[h]=c}return[a,s,l,o,o]}},{key:"randomEmbedding",value:function(e,t,n){for(var r=[],o=0;o<e;++o){r.push([]);for(var i=0;i<t;++i)r[o].push(20*Math.random()-10)}return r}},{key:"fuzzy_simplicial_set",value:function(t,n,o,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,A=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,d=s,f=c;if(null===d||null===f){var p=e.nearest_neighbors(t,n,i,a,A,o),g=r(p,3);d=g[0],f=g[1],g[2]}var m=e.smooth_knn_dist(f,n,64,h),v=r(m,2),y=v[0],b=v[1],I=e.compute_membership_strengths(d,f,y,b),x=r(I,5),w=x[0],C=x[1],E=x[2],S=x[3],M=x[4],k=new l.CooSparseMatrix;k.addCooData(E,w,C,S,M),k.eliminate_zeros(),k.sum_duplicates();var B=k.transpose(),D=k.multiplyElementwise(B);return(k=D.data.length>0?0===u?D:1===u?(k=k.add(B)).add(D.multiplyByScalar(-1)):(k=(k=(k=k.add(B)).add(D.multiplyByScalar(-1))).multiplyByScalar(u)).add(D.multiplyByScalar(1-u)):(k=k.add(B)).multiplyByScalar(u)).eliminate_zeros(),k.sum_duplicates(),k.eliminate_zeros(),k}},{key:"simplicial_set_embedding",value:function(t,n,r,o,i,a,s,u,d,f,p,g,m){var v=n.dim0,y=n.dim1;d<=0&&(d=v<=1e4?500:200);var b=new l.CooSparseMatrix;b.addCooMatrix(n),b.sum_duplicates(),b.eliminate_zeros();for(var I=b.data.length,x=Math.max.apply(Math,h(b.data))/d,w=0;w<I;++w)b.data[w]<x&&(b.data[w]=0);b.eliminate_zeros();var C=[];if("string"==typeof f&&"random"===f)C=e.randomEmbedding(n.dim0,r,p);else if("string"==typeof f&&"spectral"===f)try{for(var E=(0,A.spectral_layout)(t,b,r,p,g,m),S=Number.MIN_VALUE,M=E.length,k=E[0].length,B=0;B<M;++B)for(var D=0;D<k;++D){var P=E[B][D];P>S&&(S=P)}for(var Q=10/S,T=0;T<b.dim0;++T){C.push([]);for(var G=0;G<r;++G)C[T].push(E[T][G]*Q+(0,c.generateGaussian)(0,1e-4))}}catch(t){console.error(t),C=e.randomEmbedding(n.dim0,r,p)}else console.log("initialization with pre-defined initialization data is not implemented");for(var R=e.make_epochs_per_sample(b.data,d),_=b.row,V=b.col,N=[],F=0;F<3;++F)N.push(p.int32());return e.optimize_layout(C,C,_,V,d,y,R,i,a,N,s,o,u)}},{key:"make_epochs_per_sample",value:function(e,t){for(var n=new Array(e.length).fill(-1),r=n.length,o=[],i=Number.MIN_VALUE,a=0;a<r;++a){var s=e[a];s>i&&(i=s),o.push(t*s)}for(var l=0;l<r;++l){o[l]/=i;var c=o[l];c>0&&(n[l]=t/c)}return n}},{key:"optimize_layout",value:function(e,t,n,r,o,i,a,s,l,A){var u=arguments.length>10&&void 0!==arguments[10]?arguments[10]:1,h=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:5,f=e[0].length,p=e.length===t.length,g=[];a.forEach(function(e){g.push(e/d)});for(var m=h,v=g.slice(),y=a.slice(),b=a.length,I=0;I<o;++I){for(var x=0;x<b;++x)if(y[x]<=I){var w=n[x],C=r[x],E=e[w],S=t[C],M=(0,c.rdist)(E,S),k=0;M>0&&(k=-2*s*l*Math.pow(M,l-1),k/=s*Math.pow(M,l)+1);for(var B=0;B<f;++B){var D=(0,c.clip)(k*(E[B]-S[B]),4)*m;E[B]+=D,p&&(S[B]-=D)}y[x]+=a[x];for(var P=Math.floor((I-v[x])/g[x]),Q=0;Q<P;++Q){var T=((0,c.tau_rand_int)(A)%i+i)%i;T<0&&(T+=t.length);var G=t[T],R=(0,c.rdist)(E,G),_=0;if(R>0)_=2*u*l,_/=(.001+R)*(s*Math.pow(R,l)+1);else if(w===T)continue;for(var V=0;V<f;++V){var N=4;_>0&&(N=(0,c.clip)(_*(E[V]-G[V]),4)),E[V]+=N*m}}v[x]+=P*g[x]}m=h*(1-I/o)}return e}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.FlexiblePlotManagerNew=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),i=n(8),a=n(13),s=n(248),l=n(230);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var A=[Math.PI,20/9,1,2,10*Math.tan(Math.PI/10)/(3-Math.pow(Math.tan(Math.PI/10),2)),3*Math.sqrt(3)/4,9*(1+1/Math.sqrt(3))*(1/Math.pow(2*Math.sqrt(3)+1,2))],u=n(18).create();u.import(n(37)),u.import(n(36)),u.import(n(35));var h=n(143),d=n(142);t.FlexiblePlotManagerNew=function(){function t(n,r,i,a,s,l){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=n,this.references=r,this.cohortMetadata=i,this.selectionManager=a,this.fontManager=s,this.textExportManager=l,this.markedDonors=new Set,this.rectStart={},this.rectEnd={},this.columnIds=new Map,this.reverseColumnIds=new Map,this.relativeSignatureColumnIds=new Set,this.absoluteSignatureColumnIds=new Set,this.svg=null,this.gridGuides=null,this.minRadiusForced=null,this.maxRadiusForced=null,this.minColourForced=null,this.maxColourForced=null,this.usedDataPointsForClustering=[],this.usedDataPointsForClusteringDescriptions=[],this.subplotInfo=new Map,this.forcedSymbolValsReverseMapper=new Map,this.forcedColourValsReverseMapper=new Map,this.subcohortSelectorFlexiblePlotGridDefaultHandle=e("#subcohortSelectorFlexiblePlotGridDefault"),this.flexibleSubcohortSelectorHandle=e("#flexibleSubcohortSelector"),this.flexibleSubcohortSelectorManifoldHandle=e("#flexibleSubcohortSelectorManifold"),this.xAxisSelectorHandle=e("#flexibleXaxisSelector"),this.xAxisSelectorGroupHandle=e("#flexibleXaxisSelectorGroup"),this.yAxisSelectorHandle=e("#flexibleYaxisSelector"),this.yAxisSelectorGroupHandle=e("#flexibleYaxisSelectorGroup"),this.colourSelectorHandle=e("#flexibleColourSelector"),this.symbolSelectorHandle=e("#flexibleSymbolSelector"),this.radiusSelectorHandle=e("#flexibleRadiusSelector"),this.colourSelectorGridCommonHandle=e("#flexibleColourSelectorGridCommon"),this.symbolSelectorGridCommonHandle=e("#flexibleSymbolSelectorGridCommon"),this.radiusSelectorGridCommonHandle=e("#flexibleRadiusSelectorGridCommon"),this.gridStartXSelectorHandle=e("#flexibleGridStartXSelector"),this.gridEndXSelectorHandle=e("#flexibleGridEndXSelector"),this.gridStartYSelectorHandle=e("#flexibleGridStartYSelector"),this.gridEndYSelectorHandle=e("#flexibleGridEndYSelector"),this.gridStartXManifoldSelectorHandle=e("#flexibleGridStartXManifoldSelector"),this.gridEndXManifoldSelectorHandle=e("#flexibleGridEndXManifoldSelector"),this.gridStartYManifoldSelectorHandle=e("#flexibleGridStartYManifoldSelector"),this.gridEndYManifoldSelectorHandle=e("#flexibleGridEndYManifoldSelector"),this.flexibleHoverDescriptionColumnsCollapseHandle=e("#flexibleHoverDescriptionColumnsCollapse"),this.flexibleLabelDescriptionColumnsCollapseHandle=e("#flexibleLabelDescriptionColumnsCollapse"),this.flexibleNumericColumnsForCustomManifoldCollapseHandle=e("#flexibleNumericColumnsForCustomManifoldCollapse"),this.flexibleNumericColumnsForBarplotsCollapseHandle=e("#flexibleNumericColumnsForBarplotsCollapse"),this.flexibleNumericColumnsForBarplotsGroupHandle=e("#flexibleNumericColumnsForBarplotsGroup"),this.flexibleNumericColumnsForCustomManifoldGroupHandle=e("#flexibleNumericColumnsForCustomManifoldGroup"),this.flexibleHoverDescriptionColumnsCollapseHandle.empty(),this.flexibleLabelDescriptionColumnsCollapseHandle.empty(),this.flexibleNumericColumnsForBarplotsCollapseHandle.empty(),this.flexibleNumericColumnsForCustomManifoldCollapseHandle.empty(),this.flexibleDonorMarkerSelectorHandle=e("#flexibleDonorMarkerSelector"),this.flexibleSubcohortMarkerSelector=e("#flexibleSubcohortMarkerSelector"),this.flexiblePlotClusteringTargetPanelSelectorHandle=e("#flexiblePlotClusteringTargetPanelSelector"),this.flexiblePlotGridSelectionHelperRectHandle=e("#flexiblePlotGridSelectionHelperRect"),this.barplotAxisLabelHandle=e("#BarplotAxisLabel"),this.includeInBarplotHandles=new Map,this.includeInCustomManifoldHandles=new Map,this.customManifoldMode=!1,this.submitFlexiblePlotAnalysisHandle=e("#submitFlexiblePlotAnalysis"),this.xAxisSelectorGroupHandle.css("display","inline"),this.yAxisSelectorGroupHandle.css("display","inline"),this.flexibleNumericColumnsForBarplotsGroupHandle.css("display","none"),this.flexibleNumericColumnsForCustomManifoldGroupHandle.css("display","none"),this.multiplotMode=!1,this.gridCellsX=0,this.gridCellsY=0,this.nextAvailableGridX=0,this.nextAvailableGridY=0,this.defaultSubcohort=0,this.svgCellWidth=0,this.svgCellHeight=0,this.gridCellXstartPositions=[],this.gridCellXendPositions=[],this.gridCellYstartPositions=[],this.gridCellYendPositions=[],this.gridAvailable=!1,this.forcedColourScale=null,this.forcedAllColourVals=new Map,this.forcedAllSymbolVals=new Map,this.forcedAllRadiusVals=new Map,this.forcedRadiusScale=null,this.forcedColourColumnPre=-1,this.forcedColourColumn=null,this.forcedSymbolColumnPre=-1,this.forcedSymbolColumn=null,this.forcedRadiusColumnPre=-1,this.forcedRadiusColumn=null,this.maxSubplotInfo=0,this.maxYDepth=-1,this.firstVisit=!1,e("#flexiblePlotAddNewestMetadataColumn").off("click").on("click",function(){c.addNewestMetadataColumn()});var A=["flexiblePlotControls","svgDownloader"];e("#flexiblePlotsContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,o.switchElements)(A,[])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,o.switchElements)(A,[])}).off("shown.bs.tab").on("shown.bs.tab",function(){c.firstVisit||(c.prepareGrid(),c.firstVisit=!0),e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,o.switchElements)([],A),c.gridAvailable||e("#flexiblePlotPostGridControls").css("display","none"),e("#selectorControlsCollapse").collapse("hide"),e("#subcohortSelectionFromFlexiblePlotDescription").empty(),e("#PCACollapse").collapse("hide"),e("#tSNECollapse").collapse("hide"),e("#UMAPCollapse").collapse("hide"),e("#flexiblePlotClusteringCollapse").collapse("hide"),e("#OPTICSCollapse").collapse("hide"),e("#DBSCANCollapse").collapse("hide"),e("#KmeansCollapse").collapse("hide"),e("#KmedoidsCollapse").collapse("hide"),c.flexibleNumericColumnsForBarplotsCollapseHandle.collapse("hide"),c.fontManager.setAvailableFontSettings("flexiblePlot"),c.textExportManager.setAvailableExportSettings("flexiblePlot"),c.commonSettings.releaseLock()}),this.initialized=!1,this.subplotModules=new Map}return r(t,[{key:"resetGridSelectors",value:function(){this.gridStartXSelectorHandle.empty().append('<option value="-1">Select Starting X Cell on Grid</option>'),this.gridStartXManifoldSelectorHandle.empty().append('<option value="-1">Select Starting X Cell on Grid</option>'),this.gridEndXSelectorHandle.empty().append('<option value="-1">Select Last X Cell on Grid</option>'),this.gridEndXManifoldSelectorHandle.empty().append('<option value="-1">Select Last X Cell on Grid</option>'),this.gridStartYSelectorHandle.empty().append('<option value="-1">Select Starting Y Cell on Grid</option>'),this.gridStartYManifoldSelectorHandle.empty().append('<option value="-1">Select Starting Y Cell on Grid</option>'),this.gridEndYSelectorHandle.empty().append('<option value="-1">Select Last Y Cell on Grid</option>'),this.gridEndYManifoldSelectorHandle.empty().append('<option value="-1">Select Last Y Cell on Grid</option>'),this.flexiblePlotClusteringTargetPanelSelectorHandle.empty().append('<option value="-1">Select Subplot to do Clustering</option>'),e("#flexiblePlotClusteringControls").css("display","none"),e("#flexiblePlotManifoldProgressBar").css("width","0%"),e("#flexiblePlotManifoldProgressBarGroup").css("display","none")}},{key:"initialize",value:function(){this.initialized=!0,e("#flexiblePlotsContentMain").empty(),e("#flexiblePlotPostGridControls").css("display","none"),this.subcohortSelectorFlexiblePlotGridDefaultHandle.val("0"),this.flexibleSubcohortSelectorHandle.val("0"),this.colourSelectorGridCommonHandle.empty().append('<option value="-1">Optional: Select Common Colour Variable for the Grid (&le;21 diff. values for categorical columns)</option>'),this.symbolSelectorGridCommonHandle.empty().append('<option value="-1">Optional: Select Common Symbol Variable for the Grid (&le;7 diff. values only for categorical columns)</option>'),this.radiusSelectorGridCommonHandle.empty().append('<option value="-1">Optional: Select Common Marker Radius Variable for the Grid (Only for numerical columns)</option>'),this.xAxisSelectorHandle.empty().append('<option value="-1">Select x-Axis Variable (mandatory if not PCA/tSNE/UMAP)</option>'),this.yAxisSelectorHandle.empty().append('<option value="-1">Select y-Axis Variable (mandatory if not PCA/tSNE/UMAP)</option>'),this.colourSelectorHandle.empty().append('<option value="-1">Select Colour Variable (&le;21 diff. values for categorical columns)</option>'),this.symbolSelectorHandle.empty().append('<option value="-1">Select Symbol Variable (&le;7 diff. values only for categorical columns)</option>'),this.radiusSelectorHandle.empty().append('<option value="-1">Select Marker Radius Variable (Only for numerical columns)</option>'),this.flexibleDonorMarkerSelectorHandle.empty().append('<option value="-1">Select Donor</option>'),this.flexibleSubcohortMarkerSelector.empty().append('<option value="-1">Select Subcohort</option>');for(var t=this.cohortMetadata.metadata.length,n=0;n<t;++n)this.flexibleDonorMarkerSelectorHandle.append("<option value="+this.cohortMetadata.metadata[n].index+">"+this.cohortMetadata.metadata[n].donor+"</option>");this.enableGridControls(),this.enableClusteringControls(),this.commonSettings.releaseLock()}},{key:"addNewestMetadataColumn",value:function(){if(this.initialized){var e=this.cohortMetadata.maxIndex-1,t=this.cohortMetadata.possibleMetadataColumnsReverse.get(e);this.addNewMetadataColumn(t,e)}}},{key:"addNewMetadataColumn",value:function(t,n){var r=this;if("index"!==t)if(this.columnIds.set(n,t),this.reverseColumnIds.set(t,n),"donor"!==t&&(this.flexibleHoverDescriptionColumnsCollapseHandle.append('\n                <label class="custom-control custom-checkbox active" id="includeInHover_'+n+'_group">\n                    <input id="includeInHover_'+n+'" type="checkbox" class="custom-control-input">\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+t+"</span>\n                </label>"),this.flexibleLabelDescriptionColumnsCollapseHandle.append('\n                <label class="custom-control custom-checkbox active" id="includeInLabel_'+n+'_group">\n                    <input id="includeInLabel_'+n+'" type="checkbox" class="custom-control-input">\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+t+"</span>\n                </label>"),e("#includeInHover_"+n).off("change").on("change",function(){r.refreshHoverColumns(),setTimeout(function(){r.replotSubplots()},0)}),e("#includeInLabel_"+n).off("change").on("change",function(){r.refreshLabelColumns(),setTimeout(function(){r.remarkDonors()},0)})),this.xAxisSelectorHandle.append("<option value="+n+">"+t+"</option>"),this.yAxisSelectorHandle.append("<option value="+n+">"+t+"</option>"),"numeric"===this.cohortMetadata.metadataDataTypes.get(t)){this.colourSelectorGridCommonHandle.append("<option value="+n+">"+t+"</option>"),this.radiusSelectorGridCommonHandle.append("<option value="+n+">"+t+"</option>"),this.colourSelectorHandle.append("<option value="+n+">"+t+"</option>"),this.radiusSelectorHandle.append("<option value="+n+">"+t+"</option>"),"COSMIC sig 1"===t?(this.flexibleNumericColumnsForBarplotsCollapseHandle.append('\n                    <label class="custom-control custom-checkbox active" id="includeInBarplot_RelativeSignatures_group">\n                        <input id="includeInBarplot_RelativeSignatures" type="checkbox" class="custom-control-input">\n                        <span class="custom-control-indicator"></span>\n                        <span class="custom-control-description">Relative Mutational Signature Contributions</span>\n                    </label>'),this.flexibleNumericColumnsForCustomManifoldCollapseHandle.append('\n                    <label class="custom-control custom-checkbox active" id="includeInCustomManifold_RelativeSignatures_group">\n                        <input id="includeInCustomManifold_RelativeSignatures" type="checkbox" class="custom-control-input">\n                        <span class="custom-control-indicator"></span>\n                        <span class="custom-control-description">Relative Mutational Signature Contributions</span>\n                    </label>')):"COSMIC sig 1 Muts"===t&&(this.flexibleNumericColumnsForBarplotsCollapseHandle.append('\n                    <label class="custom-control custom-checkbox active" id="includeInBarplot_AbsoluteSignatures_group">\n                        <input id="includeInBarplot_AbsoluteSignatures" type="checkbox" class="custom-control-input">\n                        <span class="custom-control-indicator"></span>\n                        <span class="custom-control-description">Absolute Mutational Signature Contributions</span>\n                    </label>'),this.flexibleNumericColumnsForCustomManifoldCollapseHandle.append('\n                    <label class="custom-control custom-checkbox active" id="includeInCustomManifold_AbsoluteSignatures_group">\n                        <input id="includeInCustomManifold_AbsoluteSignatures" type="checkbox" class="custom-control-input">\n                        <span class="custom-control-indicator"></span>\n                        <span class="custom-control-description">Absolute Mutational Signature Contributions</span>\n                    </label>')),t.startsWith("COSMIC sig ")&&(t.endsWith(" Muts")?this.absoluteSignatureColumnIds.add(n):this.relativeSignatureColumnIds.add(n)),this.flexibleNumericColumnsForBarplotsCollapseHandle.append('\n                <label class="custom-control custom-checkbox active" id="includeInBarplot_'+n+'_group">\n                    <input id="includeInBarplot_'+n+'" type="checkbox" class="custom-control-input">\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+t+"</span>\n                </label>"),this.flexibleNumericColumnsForCustomManifoldCollapseHandle.append('\n                <label class="custom-control custom-checkbox active" id="includeInCustomManifold_'+n+'_group">\n                    <input id="includeInCustomManifold_'+n+'" type="checkbox" class="custom-control-input">\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+t+"</span>\n                </label>");var o=e("#includeInBarplot_"+n);o.off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){r.checkSelectionValidity(!1,!0)?r.submitFlexiblePlotAnalysisHandle.css("display","inline"):r.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.includeInBarplotHandles.set(t,o),this.includeInCustomManifoldHandles.set(t,e("#includeInCustomManifold_"+n))}else this.cohortMetadata.metadataDataPossibleValues.get(t).size<22&&(this.colourSelectorGridCommonHandle.append("<option value="+n+">"+t+"</option>"),this.colourSelectorHandle.append("<option value="+n+">"+t+"</option>")),this.cohortMetadata.metadataDataPossibleValues.get(t).size<8&&(this.symbolSelectorGridCommonHandle.append("<option value="+n+">"+t+"</option>"),this.symbolSelectorHandle.append("<option value="+n+">"+t+"</option>"))}},{key:"resetCustomManifoldCheckboxes",value:function(){this.flexibleNumericColumnsForCustomManifoldGroupHandle.css("display","none"),this.flexibleNumericColumnsForCustomManifoldCollapseHandle.collapse("hide"),this.includeInCustomManifoldHandles.forEach(function(e,t,n){e.prop("checked",!1).parent().removeClass("active")}),e("#includeInCustomManifold_AbsoluteSignatures").prop("checked",!1).parent().removeClass("active"),e("#includeInCustomManifold_RelativeSignatures").prop("checked",!1).parent().removeClass("active"),this.customManifoldMode=!1}},{key:"checkCustomManifoldValidity",value:function(){var e=0;return this.includeInCustomManifoldHandles.forEach(function(t,n,r){t.is(":checked")&&(e+=1)}),e>2}},{key:"removeMetadataColumn",value:function(t){var n=this,r=this.reverseColumnIds.get(t);this.reverseColumnIds.delete(t),this.columnIds.delete(r),e("#includeInHover_"+r+"_group").remove(),e("#includeInLabel_"+r+"_group").remove(),["flexibleXaxisSelector","flexibleYaxisSelector","flexibleColourSelector","flexibleSymbolSelector","flexibleRadiusSelector","flexibleColourSelectorGridCommon","flexibleSymbolSelectorGridCommon","flexibleRadiusSelectorGridCommon"].forEach(function(t){e("#"+t+" option[value='"+r+"']").remove()});var o=new Set;this.subplotModules.forEach(function(e,n,r){e.cleanupMetadataColumn(t)&&o.add(n)}),o.forEach(function(e){n.subplotModules.delete(e),n.subplotInfo.delete(e)})}},{key:"enableGridControls",value:function(){for(var t=this,n=["numGridCellsXController","numGridCellsYController"],r=["Horizontal Cells","Vertical Cells"],i=0;i<n.length;++i)(0,o.generalizedSliderEvents)(""+n[i],function(e){return e},r[i]+":",function(e){});this.cohortMetadata.possibleMetadataColumnsReverse.forEach(function(e,n,r){t.addNewMetadataColumn(e,n)}),e("#gridCreationSubmit").off("click").on("click",function(){t.prepareGrid()})}},{key:"determineForcedColourScale",value:function(){if(null!==this.forcedAllColourVals?this.forcedAllColourVals.clear():this.forcedAllColourVals=new Map,this.forcedColourValsReverseMapper.clear(),this.forcedColourScale=null,this.forcedColourColumn=null,this.maxColourForced=Number.MIN_VALUE,this.minColourForced=Number.MAX_VALUE,-1!==this.forcedColourColumnPre){this.forcedColourColumn=this.cohortMetadata.possibleMetadataColumnsReverse.get(this.forcedColourColumnPre),this.forcedColourScaleType=this.cohortMetadata.metadataDataTypes.get(this.forcedColourColumn),this.forcedAllColourVals=new Map;for(var t=0,n=this.cohortMetadata.metadata.length,r=0;r<n;++r){var a=this.cohortMetadata.metadata[r][this.forcedColourColumn];this.forcedAllColourVals.has(a)||("numeric"===this.forcedColourScaleType?this.commonSettings.undefinedValues.has(a)||(this.forcedAllColourVals.set(a,t),t++):(this.forcedAllColourVals.set(a,t),this.forcedColourValsReverseMapper.set(t,a),t++))}if("numeric"===this.forcedColourScaleType){var s=Array.from(this.forcedAllColourVals.keys()).sort(function(e,t){return e<t?-1:e>t?1:-1});this.maxColourForced=s[s.length-1],this.minColourForced=s[0],this.forcedColourScale=(0,i.scaleLinear)().domain([this.minColourForced,this.maxColourForced]).range((0,o.discreteColourGrayRed)())}else this.minColourForced=0,this.maxColourForced=this.forcedAllColourVals.size-1,this.forcedColourScale=function(e){return(0,o.discreteColour)(this.maxColourForced+1)[e]};this.multiplotMode&&(e("#flexiblePlotIndepentColourCheck").css("display","inline"),e("#independentColour").removeClass("checked").prop("checked",!1),e("#flexibleColourSelectorGroup").css("display","none"),this.colourSelectorHandle.val(this.forcedColourColumnPre))}else this.forcedColourScale=null,this.forcedAllColourVals=null,e("#flexiblePlotIndepentColourCheck").css("display","none"),e("#independentColour").removeClass("checked").prop("checked",!1),e("#flexibleColourSelectorGroup").css("display","inline"),this.colourSelectorHandle.val(-1)}},{key:"determineForcedSymbolScale",value:function(){if(this.forcedAllSymbolVals=null,this.forcedSymbolValsReverseMapper.clear(),this.forcedSymbolColumn=null,-1!==this.forcedSymbolColumnPre){this.forcedSymbolColumn=this.cohortMetadata.possibleMetadataColumnsReverse.get(this.forcedSymbolColumnPre),this.forcedAllSymbolVals=new Map;for(var t=0,n=this.cohortMetadata.metadata.length,r=0;r<n;++r){var o=this.cohortMetadata.metadata[r][this.forcedSymbolColumn];this.forcedAllSymbolVals.has(o)||(this.forcedAllSymbolVals.set(o,t),this.forcedSymbolValsReverseMapper.set(t,o),t++)}this.multiplotMode&&(e("#flexiblePlotIndepentSymbolCheck").css("display","inline"),e("#independentSymbol").removeClass("checked").prop("checked",!1),e("#flexibleSymbolSelectorGroup").css("display","none"),this.symbolSelectorHandle.val(this.forcedSymbolColumnPre))}else this.forcedAllSymbolVals=null,e("#flexiblePlotIndepentSymbolCheck").css("display","none"),e("#independentSymbol").removeClass("checked").prop("checked",!1),e("#flexibleSymbolSelectorGroup").css("display","inline"),this.symbolSelectorHandle.val(-1)}},{key:"determineForcedRadiusScale",value:function(){if(this.forcedRadiusScale=null,this.forcedRadiusColumn=null,this.maxRadiusForced=Number.MIN_VALUE,this.minRadiusForced=Number.MAX_VALUE,-1!==this.forcedRadiusColumnPre){this.forcedRadiusColumn=this.cohortMetadata.possibleMetadataColumnsReverse.get(this.forcedRadiusColumnPre);var t=0;this.forcedAllRadiusVals=new Map;for(var n=this.cohortMetadata.metadata.length,r=0;r<n;++r){var o=this.cohortMetadata.metadata[r][this.forcedRadiusColumn];this.forcedAllRadiusVals.has(o)||this.commonSettings.undefinedValues.has(o)||(this.forcedAllRadiusVals.set(o,t),o<this.minRadiusForced&&(this.minRadiusForced=o),o>this.maxRadiusForced&&(this.maxRadiusForced=o),t++)}this.forcedRadiusScale=(0,i.scaleLinear)().domain([this.minRadiusForced,this.maxRadiusForced]).range([.5,4]),this.multiplotMode&&(e("#flexiblePlotIndepentRadiusCheck").css("display","inline"),e("#independentRadius").removeClass("checked").prop("checked",!1),e("#flexibleRadiusSelectorGroup").css("display","none"),this.radiusSelectorHandle.val(this.forcedRadiusColumnPre))}else this.forcedRadiusScale=null,e("#flexiblePlotIndepentRadiusCheck").css("display","none"),e("#independentRadius").removeClass("checked").prop("checked",!1),e("#flexibleRadiusSelectorGroup").css("display","inline"),this.radiusSelectorHandle.val(-1)}},{key:"prepareGrid",value:function(){this.maxYDepth=-1,this.cleanupAllSubplots(),e("#flexiblePlotsContentMain").empty(),this.defaultSubcohort=parseInt(e("#subcohortSelectorFlexiblePlotGridDefault").val()),this.gridCellsX=parseInt(e("#numGridCellsXController").val()),this.gridCellsY=parseInt(e("#numGridCellsYController").val()),this.multiplotMode=this.gridCellsX>1||this.gridCellsY>1,this.forcedColourColumnPre=parseInt(this.colourSelectorGridCommonHandle.val()),this.determineForcedColourScale(),this.forcedSymbolColumnPre=parseInt(this.symbolSelectorGridCommonHandle.val()),this.determineForcedSymbolScale(),this.forcedRadiusColumnPre=parseInt(this.radiusSelectorGridCommonHandle.val()),this.determineForcedRadiusScale();var t=this;this.currentWidth=e("#mainSide").width();var n=.1*-this.currentWidth+" "+5e-5*-this.currentWidth+" "+1.2*this.currentWidth+" "+1.2*this.currentWidth;this.svg=(0,i.select)("#flexiblePlotsContentMain").classed("svg-container",!0).append("svg").classed("container-fluid",!0).classed("wrap",!0).classed("svg-content-responsive",!0).attr("viewBox",n).attr("id","flexiblePlotMain").attr("preserveAspectRatio","xMinYMin meet").attr("width","100%").attr("height","100%"),this.svg.on("mousedown",function(){t.rectStart=(0,i.mouse)(this),t.rectStart.x>t.svgWidth||t.rectStart.y>t.targetHeight?t.resetSelectionRect():t.rectStart.x<0||t.rectStart.y<0?t.resetSelectionRect():t.svg.append("rect").attr("id","flexibleDonorSelectBox").attr("x",t.rectStart[0]).attr("y",t.rectStart[1]).attr("width",0).attr("height",0).style("fill","none").style("stroke","Black").style("stroke-width",.6)}).on("mousemove",function(){var e=t.svg.select("#flexibleDonorSelectBox");if(!e.empty()){var n=(0,i.mouse)(this),r={x:+e.attr("x"),y:+e.attr("y"),width:+e.attr("width"),height:+e.attr("height")},o={x:n[0]-r.x,y:n[1]-r.y};o.x<1||2*o.x<r.width?(r.x=n[0],r.width-=o.x):r.width=o.x,o.y<1||2*o.y<r.height?(r.y=n[1],r.height-=o.y):r.height=o.y,e.attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height)}}).on("mouseup",function(){if(t.svg.select("#flexibleDonorSelectBox").remove(),!t.commonSettings.interactionLock)if(t.commonSettings.lock(),t.rectEnd=(0,i.mouse)(this),t.rectEnd.x>t.svgWidth||t.rectEnd.y>t.targetHeight)t.resetSelectionRect();else if(t.rectEnd.x<0||t.rectEnd.y<0)t.resetSelectionRect();else{var e=[t.rectStart[0],t.rectEnd[0]].sort(function(e,t){return e<t?-1:e>t?1:-1}),n=[t.rectStart[1],t.rectEnd[1]].sort(function(e,t){return e<t?-1:e>t?1:-1}),r=new Set;t.subplotModules.forEach(function(t,o,i){t.svgStartX<=e[0]&&e[0]<=t.svgEndX&&t.svgStartY<=n[0]&&n[0]<=t.svgEndY&&t.svgStartX<=e[1]&&e[1]<=t.svgEndX&&t.svgStartY<=n[1]&&n[1]<=t.svgEndY&&r.add(o)}),1===r.size&&t.subplotModules.get([].concat(c(r))[0]).emitSelectedDonorsFromSvgCoordinates(e[0],e[1],n[0],n[1]).forEach(function(e){t.markDonor(e,!1)}),t.commonSettings.releaseLock()}}),(0,i.select)("#flexiblePlotMain").append("g").attr("id","gridGuides"),this.gridGuides=(0,i.select)("#gridGuides");var r=e("#flexiblePlotMain"),o=.99*this.currentWidth;this.svgCellWidth=o/this.gridCellsX;var a=Math.max(this.svgCellWidth*this.gridCellsY,o);r.height(1.1*a),this.svgCellHeight=this.svgCellWidth,e("#flexiblePlotManifoldControls").css("display","inline"),this.gridCellXstartPositions.length=0,this.gridCellXendPositions.length=0;for(var s=0;s<this.gridCellsX;++s)this.gridCellXstartPositions.push(this.svgCellWidth*s),this.gridCellXendPositions.push(this.svgCellWidth*(s+1));this.gridCellYstartPositions.length=0,this.gridCellYendPositions.length=0;for(var l=0;l<this.gridCellsY;++l)this.gridCellYstartPositions.push(this.svgCellHeight*l),this.gridCellYendPositions.push(this.svgCellHeight*(l+1));this.gridAvailable=!0,this.addControlElements(),e("#gridCreatorCollapse").collapse("hide")}},{key:"findNextAvailableGridCell",value:function(){var e=this.nextAvailableGridX,t=this.nextAvailableGridY;e===this.gridCellsX&&t===this.gridCellsY&&(e=0,t=0);for(var n=!0,r=this.nextAvailableGridX;r<this.gridCellsX;++r){n=!0;for(var o=r===this.nextAvailableGridX?this.nextAvailableGridY:0;o<this.gridCellsY;++o){n=!1;var i=!0,a=!1,s=void 0;try{for(var l,c=this.subplotInfo.values()[Symbol.iterator]();!(i=(l=c.next()).done);i=!0){var A=l.value;if(r<=A.flexibleGridEndX&&A.flexibleGridStartX<=r&&o<=A.flexibleGridEndY&&A.flexibleGridStartY<=o){n=!0;break}}}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}if(!n)break}if(!n)break}if(n){for(var u=0;u<=this.nextAvailableGridX;++u){n=!0;for(var h=u===this.nextAvailableGridX?this.nextAvailableGridY:this.gridCellsY,d=0;d<h;++d){n=!1;var f=!0,p=!1,g=void 0;try{for(var m,v=this.subplotInfo.values()[Symbol.iterator]();!(f=(m=v.next()).done);f=!0){var y=m.value;if(u<=y.flexibleGridEndX&&y.flexibleGridStartX<=u&&d<=y.flexibleGridEndY&&y.flexibleGridStartY<=d){n=!0;break}}}catch(e){p=!0,g=e}finally{try{!f&&v.return&&v.return()}finally{if(p)throw g}}if(!n)break}if(!n)break}n&&(e=0,t=0)}this.nextAvailableGridX=e,this.nextAvailableGridY=t,this.gridStartXSelectorHandle.val(this.nextAvailableGridX),this.gridEndXSelectorHandle.val(this.nextAvailableGridX),this.gridStartYSelectorHandle.val(this.nextAvailableGridY),this.gridEndYSelectorHandle.val(this.nextAvailableGridY),this.gridStartXManifoldSelectorHandle.val(this.nextAvailableGridX),this.gridEndXManifoldSelectorHandle.val(this.nextAvailableGridX),this.gridStartYManifoldSelectorHandle.val(this.nextAvailableGridY),this.gridEndYManifoldSelectorHandle.val(this.nextAvailableGridY)}},{key:"goToNextCell",value:function(){var e=parseInt(this.gridEndXSelectorHandle.val()),t=parseInt(this.gridEndYSelectorHandle.val());e===this.gridCellsX-1?(e=0,(t+=1)===this.gridCellsY&&(t=0)):e+=1,-1===t&&(t=0),this.gridStartXSelectorHandle.val(e),this.gridEndXSelectorHandle.val(e),this.gridStartYSelectorHandle.val(t),this.gridEndYSelectorHandle.val(t),this.gridStartXManifoldSelectorHandle.val(e),this.gridEndXManifoldSelectorHandle.val(e),this.gridStartYManifoldSelectorHandle.val(t),this.gridEndYManifoldSelectorHandle.val(t)}},{key:"addControlElements",value:function(){var t=this;e("#independentSubcohort").removeClass("checked").prop("checked",!1),e("#flexiblePlotIndepentSubcohortCheck").css("display",this.multiplotMode?"inline":"none"),e("#flexibleSubcohortSelectorGroup").css("display",this.multiplotMode?"none":"inline"),this.flexibleSubcohortSelectorHandle.val(this.defaultSubcohort),e("#independentSubcohortManifold").removeClass("checked").prop("checked",!1),e("#flexiblePlotIndepentSubcohortManifoldCheck").css("display",this.multiplotMode?"inline":"none"),e("#flexibleSubcohortSelectorManifoldGroup").css("display",this.multiplotMode?"none":"inline"),this.flexibleSubcohortSelectorManifoldHandle.val(this.defaultSubcohort),e("#flexiblePlotManifoldProgressBar").css("width","0%"),e("#flexiblePlotManifoldProgressBarGroup").css("display","none"),this.resetGridSelectors();for(var n=0;n<this.gridCellsX;++n)this.gridStartXSelectorHandle.append("<option value="+n+">X-Start Cell: "+n+"</option>"),this.gridStartXManifoldSelectorHandle.append("<option value="+n+">X-Start Cell: "+n+"</option>"),this.gridEndXSelectorHandle.append("<option value="+n+">X-End Cell: "+n+"</option>"),this.gridEndXManifoldSelectorHandle.append("<option value="+n+">X-End Cell: "+n+"</option>");for(var r=0;r<this.gridCellsY;++r)this.gridStartYSelectorHandle.append("<option value="+r+">Y-Start Cell: "+r+"</option>"),this.gridStartYManifoldSelectorHandle.append("<option value="+r+">Y-Start Cell: "+r+"</option>"),this.gridEndYSelectorHandle.append("<option value="+r+">Y-End Cell: "+r+"</option>"),this.gridEndYManifoldSelectorHandle.append("<option value="+r+">Y-End Cell: "+r+"</option>");this.findNextAvailableGridCell(),this.drawGridSelectionHelperRect();var o=e("#flexibleSubcohortMarkerSelector");this.selectionManager.registeredSubcohortNames.forEach(function(e,n,r){o.append("<option value="+n+">"+t.selectionManager.cohortName+"_"+e+"</option>")}),e("#flexiblePlotPostGridControls").css("display","inline"),this.xAxisSelectorHandle.val(-1),this.yAxisSelectorHandle.val(-1),this.colourSelectorHandle.val(this.forcedColourColumnPre),this.radiusSelectorHandle.val(this.forcedRadiusColumnPre),this.symbolSelectorHandle.val(this.forcedSymbolColumnPre),this.enablePlotControls()}},{key:"enableMultiplotSpecificControls",value:function(){var t=this,n=this;e("#flexibleGridGoToNextAvailable").off("click").on("click",function(){t.findNextAvailableGridCell(),t.drawGridSelectionHelperRect()}),e("#flexibleGridGoToNextAvailableManifold").off("click").on("click",function(){t.findNextAvailableGridCell(),t.drawGridSelectionHelperRect()}),e("#flexibleGridGoToNext").off("click").on("click",function(){t.goToNextCell(),t.drawGridSelectionHelperRect()}),e("#flexibleGridGoToNextManifold").off("click").on("click",function(){t.goToNextCell(),t.drawGridSelectionHelperRect()}),this.gridStartXSelectorHandle.off("change").on("change",function(){n.gridStartXManifoldSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridEndXSelectorHandle.val())<e&&(n.gridEndXSelectorHandle.val(this.value),n.gridEndXManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridStartXManifoldSelectorHandle.off("change").on("change",function(){n.gridStartXSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridEndXSelectorHandle.val())<e&&(n.gridEndXSelectorHandle.val(this.value),n.gridEndXManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridEndXSelectorHandle.off("change").on("change",function(){n.gridEndXManifoldSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridStartXSelectorHandle.val())>e&&(n.gridStartXSelectorHandle.val(this.value),n.gridStartXManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridEndXManifoldSelectorHandle.off("change").on("change",function(){n.gridEndXSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridStartXSelectorHandle.val())>e&&(n.gridStartXSelectorHandle.val(this.value),n.gridStartXManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridStartYSelectorHandle.off("change").on("change",function(){n.gridStartYManifoldSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridEndYSelectorHandle.val())<e&&(n.gridEndYSelectorHandle.val(this.value),n.gridEndYManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridStartYManifoldSelectorHandle.off("change").on("change",function(){n.gridStartYSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridEndYSelectorHandle.val())<e&&(n.gridEndYSelectorHandle.val(this.value),n.gridEndYManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridEndYSelectorHandle.off("change").on("change",function(){n.gridEndYManifoldSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridStartYSelectorHandle.val())>e&&(n.gridStartYSelectorHandle.val(this.value),n.gridStartYManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")}),this.gridEndYManifoldSelectorHandle.off("change").on("change",function(){n.gridEndYSelectorHandle.val(this.value);var e=parseInt(this.value);parseInt(n.gridStartYSelectorHandle.val())>e&&(n.gridStartYSelectorHandle.val(this.value),n.gridStartYManifoldSelectorHandle.val(this.value)),n.drawGridSelectionHelperRect(),n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none")})}},{key:"enablePlotControls",value:function(){var t=this;this.multiplotMode?(e("#flexibleGridSettingsGroup").css("display","inline"),e("#flexibleGridSettingsManifoldGroup").css("display","inline"),this.enableMultiplotSpecificControls()):(e("#flexibleGridSettingsGroup").css("display","none"),e("#flexibleGridSettingsManifoldGroup").css("display","none"),this.colourSelectorHandle.off("change").on("change",function(){n.forcedColourColumnPre=parseInt(this.value)}),this.symbolSelectorHandle.off("change").on("change",function(){n.forcedSymbolColumnPre=parseInt(this.value)}),this.radiusSelectorHandle.off("change").on("change",function(){n.forcedRadiusColumnPre=parseInt(this.value)}));var n=this;this.flexibleSubcohortSelectorManifoldHandle.off("change").on("change",function(){n.flexibleSubcohortSelectorHandle.val(this.value)}),this.flexibleSubcohortSelectorHandle.off("change").on("change",function(){n.flexibleSubcohortSelectorManifoldHandle.val(this.value)}),e("#includeInBarplot_RelativeSignatures").off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?(n.relativeSignatureColumnIds.forEach(function(t){e("#includeInBarplot_"+t).prop("checked",!0).parent().addClass("active")}),n.submitFlexiblePlotAnalysisHandle.css("display","inline")):(n.relativeSignatureColumnIds.forEach(function(t){e("#includeInBarplot_"+t).prop("checked",!1).parent().removeClass("active")}),n.submitFlexiblePlotAnalysisHandle.css("display","none"))}),e("#includeInBarplot_AbsoluteSignatures").off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?(n.absoluteSignatureColumnIds.forEach(function(t){e("#includeInBarplot_"+t).prop("checked",!0).parent().addClass("active")}),n.submitFlexiblePlotAnalysisHandle.css("display","inline")):(n.absoluteSignatureColumnIds.forEach(function(t){e("#includeInBarplot_"+t).prop("checked",!1).parent().removeClass("active")}),n.submitFlexiblePlotAnalysisHandle.css("display","none"))}),e("#includeInCustomManifold_RelativeSignatures").off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?(n.relativeSignatureColumnIds.forEach(function(t){e("#includeInCustomManifold_"+t).prop("checked",!0).parent().addClass("active")}),n.checkSelectionValidity(!0,!1)&&e("#manifoldMainControls").css("display","inline")):(n.relativeSignatureColumnIds.forEach(function(t){e("#includeInCustomManifold_"+t).prop("checked",!0).parent().addClass("active")}),n.checkSelectionValidity(!0,!1)&&n.checkCustomManifoldValidity()||e("#manifoldMainControls").css("display","none"))}),e("#includeInCustomManifold_AbsoluteSignatures").off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?(n.absoluteSignatureColumnIds.forEach(function(t){e("#includeInCustomManifold_"+t).prop("checked",!0).parent().addClass("active")}),n.checkSelectionValidity(!0,!1)&&e("#manifoldMainControls").css("display","inline")):(n.absoluteSignatureColumnIds.forEach(function(t){e("#includeInCustomManifold_"+t).prop("checked",!0).parent().addClass("active")}),n.checkSelectionValidity(!0,!1)&&n.checkCustomManifoldValidity()||e("#manifoldMainControls").css("display","none"))}),e("#flexibleDonorMarkerSelector").off("change").on("change",function(){-1===parseInt(this.value)?e("#submitDonorForMarking").css("display","none"):e("#submitDonorForMarking").css("display","inline")}),e("#submitDonorForMarking").off("click").on("click",function(){var n=parseInt(e("#flexibleDonorMarkerSelector").val());t.markDonor(n,!1)}),e("#flexibleSubcohortMarkerSelector").off("change").on("change",function(){-1===parseInt(this.value)?(e("#submitSubcohortForMarking").css("display","none"),e("#submitSubcohortForShading").css("display","none"),e("#subcohortShadingConcavityGroup").css("display","none")):(e("#submitSubcohortForMarking").css("display","inline"),e("#submitSubcohortForShading").css("display","inline"),e("#subcohortShadingConcavityGroup").css("display","inline"))}),e("#submitSubcohortForMarking").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=parseInt(e("#flexibleSubcohortMarkerSelector").val());t.markSubcohort(n),t.commonSettings.fastRelease()}}),e("#submitSubcohortForShading").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=parseInt(e("#flexibleSubcohortMarkerSelector").val()),r=parseInt(e("#subcohortShadingConcavityController").val());r>20&&(r=20*Math.pow(2,r-20)),t.shadeSubcohort(n,r),t.commonSettings.fastRelease()}}),this.xAxisSelectorHandle.off("change").on("change",function(){"-1"===this.value?n.submitFlexiblePlotAnalysisHandle.css("display","none"):n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none"),"donor"===e("#flexibleXaxisSelector :selected").text()?(n.yAxisSelectorGroupHandle.css("display","none"),n.resetStackedBarplotCheckboxes(),n.submitFlexiblePlotAnalysisHandle.css("display","none"),n.flexibleNumericColumnsForBarplotsGroupHandle.css("display","inline"),n.yAxisSelectorHandle.val(-1),n.barplotAxisLabelHandle.html("<b>Y</b>")):(n.yAxisSelectorGroupHandle.css("display","inline"),n.flexibleNumericColumnsForBarplotsGroupHandle.css("display","none"))}),this.yAxisSelectorHandle.off("change").on("change",function(){"-1"===this.value?n.submitFlexiblePlotAnalysisHandle.css("display","none"):n.checkSelectionValidity(!1,!1)?n.submitFlexiblePlotAnalysisHandle.css("display","inline"):n.submitFlexiblePlotAnalysisHandle.css("display","none"),"donor"===e("#flexibleYaxisSelector :selected").text()?(n.xAxisSelectorGroupHandle.css("display","none"),n.resetStackedBarplotCheckboxes(),n.submitFlexiblePlotAnalysisHandle.css("display","none"),n.flexibleNumericColumnsForBarplotsGroupHandle.css("display","inline"),n.xAxisSelectorHandle.val(-1),n.barplotAxisLabelHandle.html("<b>X</b>")):(n.xAxisSelectorGroupHandle.css("display","inline"),n.flexibleNumericColumnsForBarplotsGroupHandle.css("display","none"))}),(0,o.generalizedSliderEvents)("flexiblePlotBaseSizeFactorController",function(e){return Math.pow(2,parseInt(e)-3)},"DefaultSize x",function(e){t.adjustDefaultSymbolSize(Math.pow(2,parseInt(e)-3)),t.addLegend()}),(0,o.generalizedSliderEvents)("subcohortShadingConcavityController",function(e){return e>20?20*Math.pow(2,e-20):e},"Concavity =",function(e){}),this.submitFlexiblePlotAnalysisHandle.off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),t.multiplotMode||(t.determineForcedColourScale(),t.determineForcedSymbolScale(),t.determineForcedRadiusScale()),t.submitFlexiblePlotAnalysisHandle.css("display","none"),e("#flexiblePlotTypeToExpect").html(""),t.usedDataPointsForClustering.length=0,t.usedDataPointsForClusteringDescriptions.length=0,e("#flexiblePlotManifoldChoicesCollapseControl").css("display","none"),e("#flexiblePlotManifoldChoices").empty(),e("#flexiblePlotGridSelectionHelperRect").remove(),t.submitFlexiblePlotAnalysis(),t.commonSettings.releaseLock())}),e("#clearMarkedDonorsFromFlexiblePlot").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),t.clearMarkedDonors(),e("#subcohortSelectionFromFlexiblePlotDescription").empty(),t.commonSettings.fastRelease())}),e("#clearShadedSubcohorts").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),t.clearShadedSubcohorts(),t.commonSettings.fastRelease())}),e("#flexibleSubcohortSelectionName").off("change").on("change",function(){n.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#createSubcohortFromMarkedDonors").css("display","none"):e("#createSubcohortFromMarkedDonors").css("display","inline")}),e("#independentSubcohort").off("change").on("change",function(){e("#flexibleSubcohortSelector").val(n.defaultSubcohort),e("#flexibleSubcohortSelectorManifold").val(n.defaultSubcohort),e(this).is(":checked")?e("#flexibleSubcohortSelectorGroup").css("display","inline"):e("#flexibleSubcohortSelectorGroup").css("display","none")}),e("#independentSubcohortManifold").off("change").on("change",function(){e("#flexibleSubcohortSelector").val(n.defaultSubcohort),e("#flexibleSubcohortSelectorManifold").val(n.defaultSubcohort),e(this).is(":checked")?e("#flexibleSubcohortSelectorManifoldGroup").css("display","inline"):e("#flexibleSubcohortSelectorManifoldGroup").css("display","none")}),e("#independentColour").off("change").on("change",function(){e("#flexibleColourSelector").val(n.forcedColourColumnPre),e(this).is(":checked")?e("#flexibleColourSelectorGroup").css("display","inline"):e("#flexibleColourSelectorGroup").css("display","none")}),e("#independentSymbol").off("change").on("change",function(){e("#flexibleSymbolSelector").val(n.forcedSymbolColumnPre),e(this).is(":checked")?e("#flexibleSymbolSelectorGroup").css("display","inline"):e("#flexibleSymbolSelectorGroup").css("display","none")}),e("#independentRadius").off("change").on("change",function(){e("#flexibleRadiusSelector").val(n.forcedRadiusColumnPre),e(this).is(":checked")?e("#flexibleRadiusSelectorGroup").css("display","inline"):e("#flexibleRadiusSelectorGroup").css("display","none")}),e("#createSubcohortFromMarkedDonors").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=[];t.subplotModules.forEach(function(e,t,r){e.directMarkedDonors.size>0&&n.push(t)});var r=e("#flexibleSubcohortSelectionName");if(n.length>1){var o=new Set,i=new Set;t.cohortMetadata.donors.forEach(function(e){i.add(e)}),t.subplotModules.forEach(function(e,t,n){i=new Set([].concat(c(i)).filter(function(t){return e.missingDonors.has(t)})),o=new Set([].concat(c(o),c(e.markedDonors)))});var a=r.val();t.cohortMetadata.finalizeSelection(o,i,a,"subcohortSelectionFromFlexiblePlotDescription")}else if(1===n.length){var s=t.subplotModules.get(n[0]),l=e("#flexibleSubcohortSelectionName").val();t.cohortMetadata.finalizeSelection(s.markedDonors,s.missingDonors,l,"subcohortSelectionFromFlexiblePlotDescription")}t.submitFlexiblePlotAnalysisHandle.css("display","inline"),r.val("").css("display","none"),t.commonSettings.fastRelease()}})}},{key:"submitFlexiblePlotAnalysis",value:function(){this.addSubplot.apply(this,c(this.readSubplotChoices())),e("#flexiblePlotTypeToExpect").html(""),this.xAxisSelectorHandle.val(-1),this.yAxisSelectorHandle.val(-1),this.xAxisSelectorGroupHandle.css("display","inline"),this.yAxisSelectorGroupHandle.css("display","inline"),this.colourSelectorHandle.val(this.forcedColourColumnPre),this.radiusSelectorHandle.val(this.forcedRadiusColumnPre),this.symbolSelectorHandle.val(this.forcedSymbolColumnPre),this.flexibleSubcohortSelectorManifoldHandle.val(this.defaultSubcohort),this.flexibleSubcohortSelectorHandle.val(this.defaultSubcohort),this.xAxisSelectorHandle.css("display","inline"),this.yAxisSelectorHandle.css("display","inline"),this.resetStackedBarplotCheckboxes(),this.resetCustomManifoldCheckboxes()}},{key:"drawGridSelectionHelperRect",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=null,r=null,o=null,i=null;if(null===t){if(-1===(n=parseInt(this.gridStartXSelectorHandle.val())))return this.flexiblePlotGridSelectionHelperRectHandle.remove(),void this.submitFlexiblePlotAnalysisHandle.css("display","none");if(-1===(r=parseInt(this.gridEndXSelectorHandle.val())))return this.flexiblePlotGridSelectionHelperRectHandle.remove(),void this.submitFlexiblePlotAnalysisHandle.css("display","none");if(n>r)return;if(-1===(o=parseInt(this.gridStartYSelectorHandle.val())))return this.flexiblePlotGridSelectionHelperRectHandle.remove(),void this.submitFlexiblePlotAnalysisHandle.css("display","none");if(-1===(i=parseInt(this.gridEndYSelectorHandle.val())))return this.flexiblePlotGridSelectionHelperRectHandle.remove(),void this.submitFlexiblePlotAnalysisHandle.css("display","none");if(o>i)return}else{var a=this.subplotInfo.get(t);n=a.flexibleGridStartX,r=a.flexibleGridEndX,o=a.flexibleGridStartY,i=a.flexibleGridEndY}var s=this.svgCellWidth*(r-n+1),l=this.svgCellHeight*(i-o+1);this.flexiblePlotGridSelectionHelperRectHandle.remove(),this.gridGuides.append("rect").attr("id","flexiblePlotGridSelectionHelperRect").attr("x",this.gridCellXstartPositions[n]).attr("y",this.gridCellYstartPositions[o]).attr("width",s).attr("height",l).style("fill","none").style("stroke","Red").style("stroke-width",2),this.flexiblePlotGridSelectionHelperRectHandle=e("#flexiblePlotGridSelectionHelperRect")}},{key:"resetSelectionRect",value:function(){this.rectStart={},this.rectEnd={},e("#flexibleDonorSelectBox").remove()}},{key:"checkSelectionValidity",value:function(e,t){var n=[];this.multiplotMode&&(n.push("gridStartXSelectorHandle"),n.push("gridEndXSelectorHandle"),n.push("gridStartYSelectorHandle"),n.push("gridEndYSelectorHandle")),e||t||(n.push("xAxisSelectorHandle"),n.push("yAxisSelectorHandle"));for(var r=n.length,o=0;o<r;++o)if("-1"===this[n[o]].val())return!1;if(t){var i=this.includeInBarplotHandles.keys(),a=!0,s=!1,l=void 0;try{for(var c,A=i[Symbol.iterator]();!(a=(c=A.next()).done);a=!0){var u=c.value;if(this.includeInBarplotHandles.get(u).is(":checked"))return this.annotateExpectedPlotType(!0),!0}}catch(e){s=!0,l=e}finally{try{!a&&A.return&&A.return()}finally{if(s)throw l}}return!1}return this.annotateExpectedPlotType(!1),!0}},{key:"annotateExpectedPlotType",value:function(t){if(t)"-1"===this.xAxisSelectorHandle.val()?e("#flexiblePlotTypeToExpect").html("Generated Plot -> Horizontal (Stacked) Bar Plot"):e("#flexiblePlotTypeToExpect").html("Generated Plot -> Vertical (Stacked) Bar Plot");else{var n=parseInt(this.xAxisSelectorHandle.val()),r=parseInt(this.yAxisSelectorHandle.val()),o="numeric"===this.cohortMetadata.metadataDataTypes.get(this.columnIds.get(n)),i="numeric"===this.cohortMetadata.metadataDataTypes.get(this.columnIds.get(r));o&&i?n===r?e("#flexiblePlotTypeToExpect").html("-> Self-Scatter Plot With KDE & Boxplot"):e("#flexiblePlotTypeToExpect").html("-> Scatter Plot"):o&&!i?e("#flexiblePlotTypeToExpect").html("-> Horizontal KDE & Boxplots with Jitters"):!o&&i?e("#flexiblePlotTypeToExpect").html("-> Vertical KDE & Boxplots with Jitters"):e("#flexiblePlotTypeToExpect").html("-> Multi-Categorical Plot")}}},{key:"resetStackedBarplotCheckboxes",value:function(){this.flexibleNumericColumnsForBarplotsGroupHandle.css("display","none"),this.flexibleNumericColumnsForBarplotsCollapseHandle.collapse("hide"),this.includeInBarplotHandles.forEach(function(e,t,n){e.prop("checked",!1).parent().removeClass("active")}),e("#includeInBarplot_AbsoluteSignatures").prop("checked",!1).parent().removeClass("active"),e("#includeInBarplot_RelativeSignatures").prop("checked",!1).parent().removeClass("active")}},{key:"readSubplotChoices",value:function(){var t=parseInt(this.gridStartXSelectorHandle.val()),n=parseInt(this.gridEndXSelectorHandle.val()),r=parseInt(this.gridStartYSelectorHandle.val()),o=parseInt(this.gridEndYSelectorHandle.val());this.multiplotMode?(this.gridStartXSelectorHandle.val("-1"),this.gridEndXSelectorHandle.val("-1"),this.gridEndYSelectorHandle.val("-1"),this.gridStartYSelectorHandle.val("-1"),this.gridStartXManifoldSelectorHandle.val("-1"),this.gridStartYManifoldSelectorHandle.val("-1"),this.gridEndXManifoldSelectorHandle.val("-1"),this.gridEndYManifoldSelectorHandle.val("-1")):(this.gridStartXSelectorHandle.val("0"),this.gridEndXSelectorHandle.val("0"),this.gridEndYSelectorHandle.val("0"),this.gridStartYSelectorHandle.val("0"),this.gridEndYSelectorHandle.val("0"),this.gridStartXManifoldSelectorHandle.val("0"),this.gridStartYManifoldSelectorHandle.val("0"),this.gridEndXManifoldSelectorHandle.val("0"),this.gridEndYManifoldSelectorHandle.val("0"));var i=parseInt(this.flexibleSubcohortSelectorHandle.val()),a=parseInt(this.xAxisSelectorHandle.val()),s=parseInt(this.yAxisSelectorHandle.val()),l=parseInt(this.colourSelectorHandle.val()),c=parseInt(this.radiusSelectorHandle.val()),A=parseInt(this.symbolSelectorHandle.val()),u="";-1!==l&&(u=this.cohortMetadata.possibleMetadataColumnsReverse.get(l));var h="";-1!==A&&(h=this.cohortMetadata.possibleMetadataColumnsReverse.get(A));var d="";-1!==c&&(d=this.cohortMetadata.possibleMetadataColumnsReverse.get(c));var f=this.cohortMetadata.possibleMetadataColumnsReverse.get(a),p=this.cohortMetadata.possibleMetadataColumnsReverse.get(s),g=this.cohortMetadata.metadataDataTypes.get(f),m=this.cohortMetadata.metadataDataTypes.get(p);"numeric"===g&&"numeric"===m&&(this.flexiblePlotClusteringTargetPanelSelectorHandle.append('<option value="'+this.maxSubplotInfo+'">Subplot '+this.maxSubplotInfo+"</option>"),e("#flexiblePlotClusteringControls").css("display","inline")),e("#flexiblePlotBaseSizeFactorControllerGroup").css("display","inline"),e("#flexibleDonorMarkerGroup").css("display","inline"),e("#flexibleSubcohortMarkerGroup").css("display","inline");var v=[];return-1!==a&&-1!==s||this.includeInBarplotHandles.forEach(function(e,t,n){e.is(":checked")&&v.push(t)}),[t,r,n,o,i,f,p,u,h,d,v]}},{key:"cleanupAllSubplots",value:function(){var e=this,t=new Set;this.subplotInfo.forEach(function(e,n,r){t.add(n)}),t.forEach(function(t){e.subplotInfo.delete(t),e.subplotModules.get(t).cleanup(),e.subplotModules.delete(t),e.flexiblePlotClusteringTargetPanelSelectorHandle.find('[value="'+t+'"]').remove()})}},{key:"addSubplot",value:function(e,t,n,r,o,i,a,s,c,A,u){var h=this,d=new Set;this.subplotInfo.forEach(function(o,i,a){e<=o.flexibleGridEndX&&o.flexibleGridStartX<=n&&t<=o.flexibleGridEndY&&o.flexibleGridStartY<=r&&d.add(i)}),d.forEach(function(e){h.subplotInfo.delete(e),h.subplotModules.get(e).cleanup(),h.subplotModules.delete(e),h.flexiblePlotClusteringTargetPanelSelectorHandle.find('[value="'+e+'"]').remove()});var f=t===this.gridCellYstartPositions.length-1;this.subplotInfo.set(this.maxSubplotInfo,{panelIndex:this.maxSubplotInfo,flexibleGridStartX:e,flexibleGridStartY:t,flexibleGridEndX:n,flexibleGridEndY:r,svgStartX:this.gridCellXstartPositions[e],svgStartY:this.gridCellYstartPositions[t],svgWidth:this.svgCellWidth*(n-e+1),svgHeight:this.svgCellHeight*(r-t+1),subcohortIndex:o,xAxisColumn:i,yAxisColumn:a,colourColumn:s,symbolColumn:c,radiusColumn:A,stackedBarNumericColumns:u,leftMostColumn:0===e,rightMostColumn:e===this.gridCellXstartPositions.length-1,bottomRow:f,topRow:0===t,forcedIndependence:s!==this.forcedColourColumn||c!==this.forcedSymbolColumn||A!==this.forcedRadiusColumn}),this.subplotModules.set(this.maxSubplotInfo,new l.FlexiblePlotModule(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this,o,this.subplotInfo.get(this.maxSubplotInfo),null,null,null,null)),r>this.maxYDepth&&(this.maxYDepth=r),this.addLegend(),this.maxSubplotInfo+=1}},{key:"markSubcohort",value:function(e){var t=this;this.selectionManager.registeredSubcohorts.get(e).forEach(function(e){t.markDonor(e,!1)})}},{key:"shadeSubcohort",value:function(e,t){this.subplotModules.forEach(function(n,r,o){n.shadeSubcohort(e,t)})}},{key:"removeSubcohortShade",value:function(t){var n=new Set;this.subplotModules.forEach(function(e,r,o){e.removeSubcohortShade(t),e.subcohortShades.keys().forEach(function(e){n.add(e)})}),0===n.size&&e("#clearShadedSubcohorts").css("display","none")}},{key:"clearShadedSubcohorts",value:function(){this.subplotModules.forEach(function(e,t,n){e.clearShadedSubcohorts()}),e("#clearShadedSubcohorts").css("display","none")}},{key:"replotSubplots",value:function(){this.subplotModules.forEach(function(e,t,n){e.replot()})}},{key:"refreshHoverColumns",value:function(){this.subplotModules.forEach(function(e,t,n){e.refreshHoverColumns()})}},{key:"refreshLabelColumns",value:function(){this.subplotModules.forEach(function(e,t,n){e.refreshLabelColumns()})}},{key:"remarkDonors",value:function(){this.subplotModules.forEach(function(e,t,n){e.remarkDonors()})}},{key:"clearMarkedDonors",value:function(){this.subplotModules.forEach(function(e,t,n){e.clearMarkedDonors()}),e("#clearMarkedDonorsFromFlexiblePlot").css("display","none")}},{key:"removeDonorMark",value:function(t){var n=new Set;this.subplotModules.forEach(function(e,r,o){e.removeDonorMark(t),n=new Set([].concat(c(n),c(e.markedDonors)))}),0===n.size&&(e("#clearMarkedDonorsFromFlexiblePlot").css("display","none"),e("#subcohortSelectionFromFlexiblePlotGroup").css("display","none"),e("#flexibleSubcohortSelectionName").css("display","none"))}},{key:"markDonor",value:function(e,t){t&&this.markedDonors.has(e)?this.markedDonors.delete(e):this.markedDonors.add(e),this.subplotModules.forEach(function(n,r,o){n.markDonor(e,t)})}},{key:"adjustDefaultSymbolSize",value:function(e){this.subplotModules.forEach(function(t,n,r){t.adjustDefaultSymbolSize(e)})}},{key:"enablePCAControls",value:function(){var t=this;e("#PCASubmit").off("click").on("click",function(){e("#PCASubmit").css("display","none"),t.runPCA()})}},{key:"enableUMAPControls",value:function(){var n=this,r=this;e("#nDimPCAPreUmap").slider("setAttribute","max",this.cohortMetadata.donors.size).slider("setValue",Math.min(50,this.cohortMetadata.donors.size)).slider("refresh"),e("#nDimPCAPreUmapLabel").html("Dimensions: "+Math.min(50,this.cohortMetadata.donors.size));var i=e("#UMAPDistanceSelector");i.off("change").on("change",function(){"-1"!==this.value&&t.checkMinDistSpreadValidity()&&r.checkSelectionValidity(!0,!1)?e("#UMAPSubmit").css("display","inline"):e("#UMAPSubmit").css("display","none")});for(var a=["UMAP_minDist","UMAP_spread","UMAP_n_neighbors","UMAP_n_epochs","UMAP_learningRate","UMAP_set_op_mix_ratio","UMAP_local_connectivity","UMAP_repulsion_strength","UMAP_negative_sample_rate","nDimPCAPreUmap"],s=["minDist (must be <= spread)","spread (must be >= minDist)","n_neighbors","n_epochs","learningRate","set_op_mix_ratio","local_connectivity","repulsion_strength","negative_sample_rate","Dimensions"],l=function(r){(0,o.generalizedSliderEvents)(""+a[r],function(e){return e},s[r]+":",function(o){0!==r&&1!==r||(t.checkMinDistSpreadValidity()&&"-1"!==i.val()&&n.checkSelectionValidity(!0,!1)?e("#UMAPSubmit").css("display","inline"):e("#UMAPSubmit").css("display","none"))})},c=0;c<a.length;++c)l(c);e("#UMAPSubmit").off("click").on("click",function(){e("#UMAPSubmit").css("display","none"),n.runUMAP()}),e("#nDimPCAPreUmapGroup").css("display","none"),e("#pcaPreUmap").removeClass("checked").prop("checked",!1).off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?e("#nDimPCAPreUmapGroup").css("display","inline"):e("#nDimPCAPreUmapGroup").css("display","none")})}},{key:"enableTSNEControls",value:function(){for(var t=this,n=["tSNEPerplexity","tSNELearningRate","tSNEIterations","nDimPCAPreTsne","tSNEEarlyExaggeration","tSNEIterationsEarlyExaggeration","tSNELateExaggeration","tSNEIterationsLateExaggeration","tSNEAlpha"],r=["Perplexity","Learning Rate","Iterations","Dimensions","EarlyExaggeration","IterationsEarlyExaggeration","LateExaggeration","IterationsLateExaggeration","Alpha"],i=0;i<n.length;++i)(0,o.generalizedSliderEvents)(""+n[i],function(e){return e},r[i]+":",function(e){});e("#tSNEPerplexity").slider("setAttribute","max",this.cohortMetadata.donors.size-1).slider("refresh"),e("#nDimPCAPreTsne").slider("setAttribute","max",this.cohortMetadata.donors.size).slider("setValue",Math.min(50,this.cohortMetadata.donors.size)).slider("refresh"),e("#nDimPCAPreTsneLabel").html("Dimensions: "+Math.min(50,this.cohortMetadata.donors.size)),e("#tSNESubmit").off("click").on("click",function(){e("#tSNESubmit").css("display","none"),t.runTSNE()}),e("#nDimPCAPreTsneGroup").css("display","none"),e("#pcaPreTsne").removeClass("checked").prop("checked",!1).off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){e(this).is(":checked")?e("#nDimPCAPreTsneGroup").css("display","inline"):e("#nDimPCAPreTsneGroup").css("display","none")})}},{key:"enableClusteringControls",value:function(){var t=this,n=this;this.flexiblePlotClusteringTargetPanelSelectorHandle.off("change").on("change",function(){n.drawGridSelectionHelperRect(n.subplotInfo.get(parseInt(this.value)).panelIndex)});var r=function(n){t.commonSettings.fastLock();var r="p_"+n+"_"+e("#flexibleClusteringPrefixName").val();t.selectionManager.clusteringPrefixToSubcohortIndices.has(r)&&(t.selectionManager.cleanupSubcohortCluster(r,t.cohortMetadata).forEach(function(e){t.removeSubcohortShade(e)}),t.cohortMetadata.setupComplexSelectionQueryBuilder(),t.cohortMetadata.refreshMetadata(),t.cohortMetadata.updateSelectionToCategoricalControls(),t.submitFlexiblePlotAnalysisHandle.css("display","inline")),t.commonSettings.fastRelease()},i=e("#flexibleClusteringPrefixName"),a=e("#FlexibleClusteringDistanceSelector"),s=["#KmeansSubmit","#KmedoidsSubmit","#DBSCANSubmit","#OPTICSSubmit"];i.off("change").on("change",function(){if(""===this.value||"-1"===a.val())for(var t=0;t<s.length;++t)e(s[t]).css("display","none");else for(var n=0;n<s.length;++n)e(s[n]).css("display","inline")}),a.off("change").on("change",function(){var t=i.val();if("-1"===this.value||""===t)for(var n=0;n<s.length;++n)e(s[n]).css("display","none");else for(var r=0;r<s.length;++r)e(s[r]).css("display","inline")}),e("#KmeansSubmit").off("click").on("click",function(){t.commonSettings.lock(),t.flexiblePlotGridSelectionHelperRectHandle.remove();var n=parseInt(t.flexiblePlotClusteringTargetPanelSelectorHandle.val());r(n),t.subplotModules.get(n).runKmeans(e("#flexibleClusteringPrefixName").val(),e("#shadeClusters").is(":checked"),e("#FlexibleClusteringDistanceSelector").val()),t.commonSettings.releaseLock()}),e("#KmedoidsSubmit").off("click").on("click",function(){t.commonSettings.lock(),t.flexiblePlotGridSelectionHelperRectHandle.remove();var n=parseInt(t.flexiblePlotClusteringTargetPanelSelectorHandle.val());r(n),t.subplotModules.get(n).runKmedoids(e("#flexibleClusteringPrefixName").val(),e("#shadeClusters").is(":checked"),e("#FlexibleClusteringDistanceSelector").val()),t.commonSettings.releaseLock()}),e("#DBSCANSubmit").off("click").on("click",function(){t.commonSettings.lock(),t.flexiblePlotGridSelectionHelperRectHandle.remove();var n=parseInt(t.flexiblePlotClusteringTargetPanelSelectorHandle.val());r(n),t.subplotModules.get(n).runDBSCAN(e("#flexibleClusteringPrefixName").val(),e("#shadeClusters").is(":checked"),e("#FlexibleClusteringDistanceSelector").val()),t.commonSettings.releaseLock()}),e("#OPTICSSubmit").off("click").on("click",function(){t.commonSettings.lock(),t.flexiblePlotGridSelectionHelperRectHandle.remove();var n=parseInt(t.flexiblePlotClusteringTargetPanelSelectorHandle.val());r(n),t.subplotModules.get(n).runOPTICS(e("#flexibleClusteringPrefixName").val(),e("#shadeClusters").is(":checked")),t.commonSettings.releaseLock()});for(var l=["mPtsMinOPTICS","neighbourhoodRadiusOPTICS","mPtsMaxDBSCAN","mPtsMinDBSCAN","epsMaxDBSCAN","epsMinDBSCAN","kmedoidsK","kmeansK"],c=["mPtsMin","neighbourhoodRadius","mPtsMax","mPtsMin","epsMax","epsMin","K","K"],A=0;A<l.length;++A)(0,o.generalizedSliderEvents)(""+l[A],function(e){return e},c[A]+":",function(e){})}},{key:"runPCA",value:function(){var t=this;if(this.commonSettings.lock(),this.customManifoldMode)setTimeout(function(){t.runManifoldAnalysisCustomMetadata(t.getMetadataColumnsForCustomManifoldAnalysis(),"PCA")},0);else{var n=e("#ManifoldPhenotypeSelector").val();"cnStatus"===n||"svStatus"===n?setTimeout(function(){t.runManifoldAnalysisNoDb(n,"PCA")},0):setTimeout(function(){t.runManifoldAnalysis(n,"PCA")},0)}}},{key:"runTSNE",value:function(){var t=this;if(this.commonSettings.lock(),this.customManifoldMode)setTimeout(function(){t.runManifoldAnalysisCustomMetadata(t.getMetadataColumnsForCustomManifoldAnalysis(),"tSNE")},0);else{var n=e("#ManifoldPhenotypeSelector").val();"cnStatus"===n||"svStatus"===n?setTimeout(function(){t.runManifoldAnalysisNoDb(n,"tSNE")},0):setTimeout(function(){t.runManifoldAnalysis(n,"tSNE")},0)}}},{key:"runUMAP",value:function(){var t=this;if(this.commonSettings.lock(),this.customManifoldMode)setTimeout(function(){t.runManifoldAnalysisCustomMetadata(t.getMetadataColumnsForCustomManifoldAnalysis(),"UMAP")},0);else{var n=e("#ManifoldPhenotypeSelector").val();"cnStatus"===n||"svStatus"===n?setTimeout(function(){t.runManifoldAnalysisNoDb(n,"UMAP")},0):setTimeout(function(){t.runManifoldAnalysis(n,"UMAP")},0)}}},{key:"getMetadataColumnsForCustomManifoldAnalysis",value:function(){var e=[];return this.includeInCustomManifoldHandles.forEach(function(t,n,r){t.is(":checked")&&e.push(n)}),e}},{key:"enableManifoldControls",value:function(){var t=this;(0,o.generalizedSliderEvents)("ManifoldTopN",function(e){return 50*e},"Top N:",function(e){}),e("#manifoldMainControls").css("display","none");var n=e("#ManifoldPhenotypeSelector");n.empty(),n.append('<option value="-1">Select Phenotype</option>'),this.cohortMetadata.geneExpressionAvailable>2&&n.append('<option value="geneExpressions">Gene Expression</option>'),this.cohortMetadata.methylomeArrayAvailable>2&&n.append('<option value="methylomeBetas">Methylome Betas</option>'),this.cohortMetadata.cnvAvailable>2&&n.append('<option value="cnStatus">Copy Number Status</option>'),this.cohortMetadata.svAvailable>2&&n.append('<option value="svStatus">SV Status</option>'),n.append('<option value="custom">Custom Numeric Metadata Columns (at least 3)</option>'),n.off("change").on("change",function(){"custom"===this.value?(e("#ManifoldTopNGroup").css("display","none"),t.resetCustomManifoldCheckboxes(),t.customManifoldMode=!0,t.flexibleNumericColumnsForCustomManifoldGroupHandle.css("display","inline"),t.includeInCustomManifoldHandles.forEach(function(n,r,o){n.off("change.bootstrapSwitch").on("change.bootstrapSwitch",function(){t.checkSelectionValidity(!0,!1)&&t.checkCustomManifoldValidity()?e("#manifoldMainControls").css("display","inline"):e("#manifoldMainControls").css("display","none")})})):(t.resetCustomManifoldCheckboxes(),e("#ManifoldTopNGroup").css("display","inline"),-1!==parseInt(this.value)&&t.checkSelectionValidity(!0,!1)?e("#manifoldMainControls").css("display","inline"):e("#manifoldMainControls").css("display","none"))})}},{key:"runManifoldAnalysisCustomMetadata",value:function(t,n){for(var r=[],o=t.length,i=this.cohortMetadata.metadata.length,a=this.selectionManager.registeredSubcohorts.get(parseInt(e("#flexibleSubcohortSelectorManifold").val())),s=0;s<i;++s)if(a.has(this.cohortMetadata.metadata[s].index)){for(var l=!0,c=0;c<o;++c)if(this.commonSettings.undefinedValues.has(this.cohortMetadata.metadata[s][t[c]])){l=!1;break}l&&r.push(this.cohortMetadata.metadata[s].index)}for(var A=[],u=0;u<r.length;++u){var h=r[u];A.push([]);for(var d=0;d<o;++d){var f=this.cohortMetadata.metadata[h][t[d]];A[u].push(f)}}var p=e("#flexibleCustomManifoldName").val();""===p&&(p=t.join(",")),this.continueWithManifoldData(n,p,-1,A,r)}},{key:"runManifoldAnalysisNoDb",value:function(t,n){this.usedDataPointsForClustering.length=0,this.usedDataPointsForClusteringDescriptions.length=0;var r=50*+e("#ManifoldTopN").slider().val(),o=this.cohortMetadata.metadata.length,i=this.selectionManager.registeredSubcohorts.get(parseInt(e("#flexibleSubcohortSelectorManifold").val())),a=[],s=[];if("cnStatus"===t){r*=2;for(var l=0;l<o;++l){var c=this.cohortMetadata.metadata[l].index;i.has(c)&&"+"===this.cohortMetadata.metadata[l].CNV&&a.push(c)}for(var A=1;A<this.references.tads.length&&this.references.tads[A].chromosomeIndex<23;++A){for(var h=this.references.tads[A].cnvLossDonorContributorIndices,d=this.references.tads[A].cnvGainDonorContributorIndices,f=this.references.tads[A].lohDonorContributorIndices,p=[],g=[],m=!1,v=!1,y=0;y<a.length;++y)h.has(a[y])||f.has(a[y])?(p[y]=.05*Math.random()+.95,m=!0):p[y]=.05*Math.random(),d.has(a[y])?(g[y]=.05*Math.random()+.95,v=!0):g[y]=.05*Math.random();if(m){var b={data:p,variance:u.var(p),tadIndex:A,direction:-1};s.push(b)}if(v){var I={data:g,variance:u.var(g),tadIndex:A,direction:1};s.push(I)}}}else if("svStatus"===t){for(var x=0;x<o;++x){var w=this.cohortMetadata.metadata[x].index;i.has(w)&&"+"===this.cohortMetadata.metadata[x].SV&&a.push(w)}for(var C=1;C<this.references.tads.length&&this.references.tads[C].chromosomeIndex<23;++C){for(var E=this.references.tads[C].svDonorContributorIndicesOffset0,S=[],M=!1,k=0;k<a.length;++k)E.has(a[k])?(M=!0,S[k]=.1*Math.random()+.95):S[k]=.1*Math.random();if(M){var B={data:S,variance:u.var(S),tadIndex:C,direction:1};s.push(B)}}}s=s.sort(function(e,t){return e.variance>t.variance?-1:1});for(var D=[],P=new Set([]),Q=new Set([]),T=0;T<s.length&&T<=r;++T){var G=s[T].tadIndex;if(-1===s[T].direction){if(this.references.tads[G-1].chromosomeIndex===this.references.tads[G].chromosomeIndex&&Q.has(this.references.tads[G-1]))continue;if(this.references.tads[G+1].chromosomeIndex===this.references.tads[G].chromosomeIndex&&Q.has(this.references.tads[G+1]))continue;Q.add(G)}else{if(this.references.tads[G-1].chromosomeIndex===this.references.tads[G].chromosomeIndex&&P.has(this.references.tads[G-1]))continue;if(this.references.tads[G+1].chromosomeIndex===this.references.tads[G].chromosomeIndex&&P.has(this.references.tads[G+1]))continue;P.add(G)}D.push(s[T].data),this.usedDataPointsForClustering.push([s[T].tadIndex,s[T].direction])}if("cnStatus"===t)for(var R=0;R<this.usedDataPointsForClustering.length;++R)this.usedDataPointsForClusteringDescriptions.push([this.references.tads[this.usedDataPointsForClustering[R][0]].printTadRange(this.references),-1===this.usedDataPointsForClustering[R][1]?"loss":"gain"].join("\t"));else{this.usedDataPointsForClusteringDescriptions.push(["TADs sorted by genomic location","TADs sorted by top Variance"].join("\t"));for(var _=0;_<this.usedDataPointsForClustering.length;++_)this.usedDataPointsForClusteringDescriptions.push(this.references.tads[this.usedDataPointsForClustering[_][0]].printTadRange(this.references))}var V=u.transpose(D);this.continueWithManifoldData(n,t,r,V,a)}},{key:"runManifoldAnalysis",value:function(t,n){this.usedDataPointsForClustering.length=0,this.usedDataPointsForClusteringDescriptions.length=0;var r=50*parseInt(e("#ManifoldTopN").slider().val()),o=this;e.ajax({url:o.commonSettings.baseUrl+"/php/getTopNDataFromPhenotypeDb.php",type:"GET",dataType:"json",data:{cohort:o.cohortMetadata.cohortName,suffix:t,topN:r},error:function(e){console.error(e),o.commonSettings.releaseLock()},success:function(i){for(var a=o.cohortMetadata.metadata.length,s=o.selectionManager.registeredSubcohorts.get(parseInt(e("#flexibleSubcohortSelectorManifold").val())),l=[],c=[],A="geneExpressions"===t?"RNA":"MethylationArray",u="geneExpressions"===t?"gene":"probe",h=0;h<a;++h){var d=o.cohortMetadata.metadata[h].index;s.has(d)&&"+"===o.cohortMetadata.metadata[h][A]&&(l.push(d),c.push(d.toString()))}for(var f=[],p=i.length,g=[],m=[],v=0;v<l.length;++v)i[0].hasOwnProperty(c[v])&&(g.push(l[v]),m.push(c[v]));for(var y=g.length,b=new Array(y).fill([]),I=0;I<y;++I){b[I]=new Array(p).fill(0);for(var x=m[I],w=0;w<p;++w)b[I][w]=+i[w][x]}for(var C=0;C<p;++C){var E=i[C][u];isNaN(E)?o.usedDataPointsForClustering[C]=E:o.usedDataPointsForClustering[C]=+E,f.push(C)}if("gene"===u)for(var S=0;S<o.usedDataPointsForClustering.length;++S)o.usedDataPointsForClusteringDescriptions.push(o.references.genes.get(o.usedDataPointsForClustering[S]).geneName);else if("probe"===u)for(var M=0;M<o.usedDataPointsForClustering.length;++M)o.usedDataPointsForClusteringDescriptions.push(o.usedDataPointsForClustering[M]);o.continueWithManifoldData(n,t,r,b,g)}})}},{key:"umapCalculation",value:function(t,n,r,o,i,a,l,c,A,u,h,d,f,p,g,m,v){var y=new s.UMAP(n,r,o,i,a,l,c,A,u,h,d,f).fit_transform(t);this.processManifoldresults(p,g,m,v,y,[],n),e("#flexiblePlotManifoldProgressBarGroup").css("display","none"),e("#flexiblePlotManifoldProgressBar").css("width","0%"),e("#UMAPCollapse").collapse("hide")}},{key:"tsneCalculation",value:function(t,n,r,o,i,s,l,c,A,u,f,p,g){var m=this,v=(0,a.queue)(1),y=new h.tSNE({epsilon:r,perplexity:n,alpha:A,dim:2,earlyExaggeration:i,iterationsEarlyExaggeration:s,lateExaggeration:l,iterationsLateExaggeration:c,maxIter:o});if(e("#pcaPreTsne").is(":checked")){var b=new d(t),I=Math.min(parseInt(e("#nDimPCAPreTsne").val()),t.length);y.initDataRaw(b.predict(t,{nComponents:I}))}else y.initDataRaw(t);var x=e("#flexiblePlotManifoldProgressBar");e("#flexiblePlotManifoldProgressBarGroup").css("display","inline");var w=!0;v.defer(function(e){for(var t=function(e){if(!w)return"break";if(y.step()===Number.MAX_VALUE){var t=o-c;y.iter=t;for(var n=t;n<o;++n)y.step();w=!1}setTimeout(function(){x.css("width",100*e/o+"%")},1)},n=0;n<o&&"break"!==t(n);++n);e()}),v.awaitAll(function(){m.processManifoldresults(u,f,p,g,y.getSolution(),[],n),e("#flexiblePlotManifoldProgressBarGroup").css("display","none"),e("#flexiblePlotManifoldProgressBar").css("width","0%"),e("#tSNECollapse").collapse("hide"),e("#tSNESubmit").css("display","inline")})}},{key:"continueWithManifoldData",value:function(t,n,r,o,i){var a=this;if("tSNE"===t){var s=parseInt(e("#tSNEPerplexity").slider().val()),l=+e("#tSNELearningRate").slider().val(),c=parseInt(e("#tSNEIterations").slider().val()),A=parseInt(e("#tSNEEarlyExaggeration").slider().val()),u=parseInt(e("#tSNEIterationsEarlyExaggeration").slider().val()),h=+e("#tSNELateExaggeration").slider().val(),f=parseInt(e("#tSNEIterationsLateExaggeration").slider().val()),p=+e("#tSNEAlpha").slider().val();setTimeout(function(){a.tsneCalculation(o,s,l,c,A,u,h,f,p,t,n,r,i)},0)}else if("PCA"===t){for(var g=new d(o),m=g.getExplainedVariance(),v=[],y=0;y<10;++y)v.push((100*m[y]).toFixed(2));this.processManifoldresults(t,n,r,i,g.predict(o,{nComponents:10}),v,0),e("#PCACollapse").collapse("hide"),e("#PCASubmit").css("display","inline")}else if("UMAP"===t){var b=parseInt(e("#UMAP_n_neighbors").slider().val()),I=parseInt(e("#UMAP_n_epochs").slider().val()),x=+e("#UMAP_learningRate").slider().val(),w=+e("#UMAP_minDist").slider().val(),C=+e("#UMAP_spread").slider().val(),E=+e("#UMAP_set_op_mix_ratio").slider().val(),S=+e("#UMAP_local_connectivity").slider().val(),M=+e("#UMAP_repulsion_strength").slider().val(),k=+e("#UMAP_negative_sample_rate").slider().val(),B=e("#UMAPInitSelector").val(),D=e("#UMAPDistanceSelector").val();e("#UMAPDistanceSelector").val(-1);var P=o;if(e("#pcaPreUmap").is(":checked")){var Q=new d(o),T=Math.min(parseInt(e("#nDimPCAPreUmap").val()),o.length);P=Q.predict(o,{nComponents:T})}setTimeout(function(){a.umapCalculation(P,b,2,D,I,x,B,w,C,E,S,M,k,t,n,r,i)},0)}}},{key:"processManifoldresults",value:function(t,n,r,o,i,a,s){var l="",c="",A=r>0?" top"+r+" ":" ",u=this.selectionManager.registeredSubcohortNames.get(parseInt(e("#flexibleSubcohortSelectorManifold").val()));if("PCA"===t){l=n+" "+t+A+u+" ("+a[0]+"% variance) dim1",c=n+" "+t+A+u+" ("+a[1]+"% variance) dim2";for(var h=3;h<11;++h){var d=n+" "+t+A+u+" ("+a[h-1]+"% variance) dim"+h;this.cohortMetadata.metadataDataPossibleValues.set(d,new Set),this.cohortMetadata.metadataDataTypes.set(d,"numeric");for(var f=0;f<this.cohortMetadata.metadata.length;++f)this.cohortMetadata.metadata[f][d]="";for(var p=0;p<o.length;++p)this.cohortMetadata.metadata[o[p]][d]=i[p][h],this.cohortMetadata.metadataDataPossibleValues.get(d).add(i[p][h]);this.cohortMetadata.addPossibleMetadataColumn(d)}}else if("tSNE"===t){l=n+" "+t+A+u+" perplexity "+s+" dim1",c=n+" "+t+A+u+" perplexity "+s+" dim2";for(var g=2;this.cohortMetadata.possibleMetadataColumns.has(l);)l=n+" "+t+A+u+" perplexity "+s+" run"+g+" dim1",c=n+" "+t+A+u+" perplexity "+s+" run"+g+" dim2",g+=1}else if("UMAP"===t){l=n+" "+t+A+u+" n_neighbors "+s+" dim1",c=n+" "+t+A+u+" n_neighbors "+s+" dim2";for(var m=2;this.cohortMetadata.possibleMetadataColumns.has(l);)l=n+" "+t+A+u+" n_neighbors "+s+" run"+m+" dim1",c=n+" "+t+A+u+" n_neighbors "+s+" run"+m+" dim2",m+=1}this.cohortMetadata.metadataDataPossibleValues.set(l,new Set),this.cohortMetadata.metadataDataPossibleValues.set(c,new Set),this.cohortMetadata.metadataDataTypes.set(l,"numeric"),this.cohortMetadata.metadataDataTypes.set(c,"numeric");for(var v=0;v<this.cohortMetadata.metadata.length;++v)this.cohortMetadata.metadata[v][l]="",this.cohortMetadata.metadata[v][c]="";for(var y=0;y<o.length;++y)this.cohortMetadata.metadata[o[y]][l]=i[y][0],this.cohortMetadata.metadataDataPossibleValues.get(l).add(i[y][0]),this.cohortMetadata.metadata[o[y]][c]=i[y][1],this.cohortMetadata.metadataDataPossibleValues.get(c).add(i[y][1]);this.cohortMetadata.addPossibleMetadataColumn(l),this.cohortMetadata.addPossibleMetadataColumn(c),this.commonSettings.lock(),this.xAxisSelectorHandle.val(this.cohortMetadata.possibleMetadataColumns.get(l)),this.yAxisSelectorHandle.val(this.cohortMetadata.possibleMetadataColumns.get(c)),e("#flexiblePlotGridSelectionHelperRect").remove(),this.submitFlexiblePlotAnalysis(),e("#flexiblePlotManifoldChoicesCollapseControl").css("display","inline"),e("#flexiblePlotManifoldChoices").html(this.usedDataPointsForClusteringDescriptions.join("<br>")),this.commonSettings.releaseLock()}},{key:"getTitleChunks",value:function(){return 1===this.subplotModules.size?this.subplotModules.values().next().value.getTitleChunks():[this.cohortMetadata.cohortName,"MultiPlot"]}},{key:"saveFlexibleSvg",value:function(){var e=this.getTitleChunks();e.push("svg");var t=e.join(".");(0,o.saveSvg)("flexiblePlotMain",t)}},{key:"textExport",value:function(){if(this.subplotModules.size>1){var e=[["Donor","panel","x","xVal","y","yVal","colour","colourVal","symbol","symbolVal","radius","radiusVal"]];return this.subplotModules.forEach(function(t,n,r){t.provideRowsForTextExport(!0).forEach(function(t){e.push(t)})}),e}var t=this.subplotModules.values().next().value,n=[t.getHeaderChunksForTextExport()];return t.provideRowsForTextExport(!1).forEach(function(e){n.push(e)}),n}},{key:"checkLegendValidity",value:function(){return this.subplotInfo.forEach(function(e,t,n){if(e.forcedIndependence)return!1}),!0}},{key:"addLegend",value:function(){var t=this;if(null!==this.svgLegendGroup&&(e("#flexiblePlotLegendGroup").remove(),this.svgLegendGroup=null),this.checkLegendValidity()){var n=null!==this.forcedColourColumn,r=null!==this.forcedSymbolColumn,a=null!==this.forcedRadiusColumn;if(0!==n+r+a){this.svgLegendGroup=(0,i.select)("#flexiblePlotMain").append("g").attr("id","flexiblePlotLegendGroup");var s=e("#flexiblePlotMain"),l=.99*s.width(),c=this.fontManager.fontTree.get("flexiblePlotFontTargetSelector").get("legendLabels").generateFontCssText(),u=0;this.subplotInfo.forEach(function(e,n,r){if(e.flexibleGridEndY===t.maxYDepth){var o=document.getElementById("flexibleXaxisLabels_p"+n).getBBox().height;o>u&&(u=o)}});var h=this.gridCellYendPositions[this.maxYDepth],d=.05*this.currentWidth,f=h+1.2*u,p=0;n&&("numeric"!==this.forcedColourScaleType?p+=Math.ceil(this.forcedColourValsReverseMapper.size/2):p+=1),r&&(p+=Math.ceil(this.forcedSymbolValsReverseMapper.size/2)),a&&(p+=1),s.height(Math.max(l,1.2*h+d*p));var g=.5*Math.pow(d/2,2);if(n){var m="numeric"!==this.forcedColourScaleType?Math.ceil(this.forcedColourValsReverseMapper.size/2)*d:d;if(this.svgLegendGroup.append("rect").attr("x",0).attr("y",f).attr("width",l).attr("height",m).style("fill","none").style("stroke","black"),"numeric"===this.forcedColourScaleType){this.forcedColourValsReverseMapper.clear();for(var v=(0,o.linspace)(this.minColourForced,this.maxColourForced,5),y=0;y<v.length;++y){var b=v[y];this.forcedColourValsReverseMapper.set(b,b)}var I=f+.165*d,x=I+.25*d,w=I+.5*d,C=0;this.forcedColourValsReverseMapper.forEach(function(e,n,r){var o=.2*C+.1,a=o*l,s=(o-.1)*l,A=(o+.1)*l,u=(0,i.path)();u.moveTo(s,w),u.lineTo(A,w),t.svgLegendGroup.append("path").style("stroke",t.forcedColourScale(n)).style("fill",t.forcedColourScale(n)).attr("d",(0,i.symbol)().type(i.symbols[0]).size(g)).attr("transform",function(e){return"translate("+a+","+x+")"}),t.svgLegendGroup.append("path").attr("id","flexiblePlotColourLegendHelper_"+C).attr("d",u).style("display","none"),t.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotColourLegend_"+C).attr("xlink:href","#flexiblePlotColourLegendHelper_"+C).style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").attr("startOffset","50%").style("font",c).html(e),C+=1})}else{var E=0;this.forcedColourValsReverseMapper.forEach(function(e,n,r){var o=E%2==0?.25:.75,a=Math.floor(E/2),s=o*l,A=(o-.25)*l,u=(o+.25)*l,h=f+(a+.165)*d,p=h+.25*d,m=h+.5*d,v=(0,i.path)();v.moveTo(A,m),v.lineTo(u,m),t.svgLegendGroup.append("path").style("stroke",t.forcedColourScale(n)).style("fill",t.forcedColourScale(n)).attr("d",(0,i.symbol)().type(i.symbols[0]).size(g)).attr("transform",function(e){return"translate("+s+","+p+")"}),t.svgLegendGroup.append("path").attr("id","flexiblePlotColourLegendHelper_"+E).attr("d",v).style("display","none"),t.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotColourLegend_"+E).attr("xlink:href","#flexiblePlotColourLegendHelper_"+E).style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").attr("startOffset","50%").style("font",c).html(e),E+=1})}var S=(0,i.path)();S.moveTo(0,f),S.lineTo(l,f),this.svgLegendGroup.append("path").attr("id","flexiblePlotColourLegendTitleHelper").attr("d",S).style("display","none"),this.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").append("textPath").attr("class","markerText").attr("id","flexiblePlotColourLegendTitle").attr("xlink:href","#flexiblePlotColourLegendTitleHelper").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("font",c).html(this.forcedColourColumn),f+=m}if(r){var M=Math.ceil(this.forcedSymbolValsReverseMapper.size/2)*d;this.svgLegendGroup.append("rect").attr("x",0).attr("y",f).attr("width",l).attr("height",M).style("fill","none").style("stroke","black");var k=0;this.forcedSymbolValsReverseMapper.forEach(function(e,n,r){var o=k%2==0?.25:.75,a=Math.floor(k/2),s=o*l,A=(o-.25)*l,u=(o+.25)*l,h=f+(a+.165)*d,p=h+.25*d,m=h+.5*d,v=(0,i.path)();v.moveTo(A,m),v.lineTo(u,m),t.svgLegendGroup.append("path").style("stroke","slategray").style("fill","slategray").attr("d",(0,i.symbol)().type(i.symbols[n]).size(g)).attr("transform",function(e){return"translate("+s+","+p+")"}),t.svgLegendGroup.append("path").attr("id","flexiblePlotSymbolLegendHelper_"+k).attr("d",v).style("display","none"),t.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotSymbolLegend_"+k).attr("xlink:href","#flexiblePlotSymbolLegendHelper_"+k).style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").attr("startOffset","50%").style("font",c).html(e),k+=1});var B=(0,i.path)();B.moveTo(0,f),B.lineTo(l,f),this.svgLegendGroup.append("path").attr("id","flexiblePlotSymbolLegendTitleHelper").attr("d",B).style("display","none"),this.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").append("textPath").attr("class","markerText").attr("id","flexiblePlotSymbolLegendTitle").attr("xlink:href","#flexiblePlotSymbolLegendTitleHelper").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("font",c).html(this.forcedSymbolColumn),f+=M}if(a){var D=Math.pow(2,parseInt(e("#flexiblePlotBaseSizeFactorController").val())-3);this.svgLegendGroup.append("rect").attr("x",0).attr("y",f).attr("width",l).attr("height",d).style("fill","none").style("stroke","black");for(var P=new Map,Q=(0,o.linspace)(this.minRadiusForced,this.maxRadiusForced,5),T=0;T<Q.length;++T){var G=Q[T];P.set(G,G)}var R=f+.165*d,_=R+.25*d,V=R+.5*d,N=0;P.forEach(function(e,n,r){var o=.2*N+.1,a=o*l,s=(o-.1)*l,u=(o+.1)*l,h=(0,i.path)();h.moveTo(s,V),h.lineTo(u,V),t.svgLegendGroup.append("path").style("stroke","slategray").style("fill","slategray").attr("d",(0,i.symbol)().type(i.symbols[0]).size(D*Math.pow(5*t.forcedRadiusScale(n),2)*A[0])).attr("transform",function(e){return"translate("+a+","+_+")"}),t.svgLegendGroup.append("path").attr("id","flexiblePlotRadiusLegendHelper_"+N).attr("d",h).style("display","none"),t.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").append("textPath").attr("class","markerText").attr("id","flexiblePlotRadiusLegend_"+N).attr("xlink:href","#flexiblePlotRadiusLegendHelper_"+N).style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","middle").attr("startOffset","50%").style("font",c).html(e),N+=1});var F=(0,i.path)();F.moveTo(0,f),F.lineTo(l,f),this.svgLegendGroup.append("path").attr("id","flexiblePlotRadiusLegendTitleHelper").attr("d",F).style("display","none"),this.svgLegendGroup.append("text").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").append("textPath").attr("class","markerText").attr("id","flexiblePlotRadiusLegendTitle").attr("xlink:href","#flexiblePlotRadiusLegendTitleHelper").style("dominant-baseline","hanging").style("alignment-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("font",c).html(this.forcedRadiusColumn)}}}}},{key:"adjustPlotSupporters",value:function(){this.subplotModules.forEach(function(e,t,n){e.addPlotSupporters()})}}],[{key:"checkMinDistSpreadValidity",value:function(){return+e("#UMAP_minDist").val()<=+e("#UMAP_spread").val()}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";t.factory=function(e,t,r,o){var i=r(n(54)),a=o("divide",{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Fraction | BigNumber":function(e,t){var n=e.clone();return n.value=a(null===n.value?n._normalize(1):n.value,t),n},"number | Fraction | BigNumber, Unit":function(e,t){var n=t.pow(-1);return n.value=i(null===n.value?n._normalize(1):n.value,e),n},"Unit, Unit":function(e,t){return e.divide(t)}});return a}},function(e,t,n){"use strict";var r=n(58);t.name="unaryMinus",t.factory=function(e,t,o,i){var a=n(17),s=i("unaryMinus",{number:function(e){return-e},Complex:function(e){return e.neg()},BigNumber:function(e){return e.neg()},Fraction:function(e){return e.neg()},Unit:function(e){var t=e.clone();return t.value=s(e.value),t},"Array | Matrix":function(e){return r(e,s,!0)}});return s.toTex={1:a.operators.unaryMinus+"\\left(${args[0]}\\right)"},s}},function(e,t,n){"use strict";var r=n(11);t.name="subtract",t.factory=function(e,t,o,i){var a=n(17),s=o(n(15)),l=o(n(41)),c=o(n(251)),A=o(n(109)),u=o(n(39)),h=o(n(106)),d=o(n(108)),f=o(n(30)),p=o(n(24)),g=i("subtract",{"number, number":function(e,t){return e-t},"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":function(e,t){if(null==e.value)throw new Error("Parameter x contains a unit with undefined value");if(null==t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=g(n.value,t.value),n.fixPrefix=!1,n},"Matrix, Matrix":function(e,t){var n,o=e.size(),i=t.size();if(o.length!==i.length)throw new r(o.length,i.length);switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=h(e,t,g);break;default:n=u(t,e,g,!0)}break;default:switch(t.storage()){case"sparse":n=A(e,t,g,!1);break;default:n=f(e,t,g)}}return n},"Array, Array":function(e,t){return g(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return g(s(e),t)},"Matrix, Array":function(e,t){return g(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=d(e,c(t),l);break;default:n=p(e,t,g)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=d(t,e,g,!0);break;default:n=p(t,e,g,!0)}return n},"Array, any":function(e,t){return p(s(e),t,g,!1).valueOf()},"any, Array":function(e,t){return p(s(t),e,g,!0).valueOf()}});return g.toTex={2:"\\left(${args[0]}"+a.operators.subtract+"${args[1]}\\right)"},g}},function(e,t,n){"use strict";var r=n(60);e.exports=function e(t,n){r(t)&&(t=t.valueOf());for(var o=0,i=t.length;o<i;o++){var a=t[o];Array.isArray(a)?e(a,n):n(a)}}},function(e,t,n){"use strict";t.name="sparse",t.factory=function(e,t,n,r){var o=e.SparseMatrix,i=r("sparse",{"":function(){return new o([])},string:function(e){return new o([],e)},"Array | Matrix":function(e){return new o(e)},"Array | Matrix, string":function(e,t){return new o(e,t)}});return i.toTex={0:"\\begin{bsparse}\\end{bsparse}",1:"\\left(${args[0]}\\right)"},i}},function(e,t,n){"use strict";t.name="index",t.factory=function(e,t,n,r){return r("index",{"...number | string | BigNumber | Range | Array | Matrix":function(t){var n=t.map(function(t){return e.isBigNumber(t)?t.toNumber():Array.isArray(t)||e.isMatrix(t)?t.map(function(t){return e.isBigNumber(t)?t.toNumber():t}):t}),r=new e.Index;return e.Index.apply(r,n),r}})}},function(e,t,n){"use strict";var r=n(6);t.name="Range",t.path="type",t.factory=function(e,t,n,o){function i(t,n,r){if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if(null!=t)if(e.isBigNumber(t))t=t.toNumber();else if("number"!=typeof t)throw new TypeError("Parameter start must be a number");if(null!=n)if(e.isBigNumber(n))n=n.toNumber();else if("number"!=typeof n)throw new TypeError("Parameter end must be a number");if(null!=r)if(e.isBigNumber(r))r=r.toNumber();else if("number"!=typeof r)throw new TypeError("Parameter step must be a number");this.start=null!=t?parseFloat(t):0,this.end=null!=n?parseFloat(n):0,this.step=null!=r?parseFloat(r):1}return i.prototype.type="Range",i.prototype.isRange=!0,i.parse=function(e){if("string"!=typeof e)return null;var t=e.split(":").map(function(e){return parseFloat(e)});if(t.some(function(e){return isNaN(e)}))return null;switch(t.length){case 2:return new i(t[0],t[1]);case 3:return new i(t[0],t[2],t[1]);default:return null}},i.prototype.clone=function(){return new i(this.start,this.end,this.step)},i.prototype.size=function(){var e=0,t=this.start,n=this.step,o=this.end-t;return r.sign(n)==r.sign(o)?e=Math.ceil(o/n):0==o&&(e=0),isNaN(e)&&(e=0),[e]},i.prototype.min=function(){var e=this.size()[0];return e>0?this.step>0?this.start:this.start+(e-1)*this.step:void 0},i.prototype.max=function(){var e=this.size()[0];return e>0?this.step>0?this.start+(e-1)*this.step:this.start:void 0},i.prototype.forEach=function(e){var t=this.start,n=this.step,r=this.end,o=0;if(n>0)for(;t<r;)e(t,[o],this),t+=n,o++;else if(n<0)for(;t>r;)e(t,[o],this),t+=n,o++},i.prototype.map=function(e){var t=[];return this.forEach(function(n,r,o){t[r[0]]=e(n,r,o)}),t},i.prototype.toArray=function(){var e=[];return this.forEach(function(t,n){e[n[0]]=t}),e},i.prototype.valueOf=function(){return this.toArray()},i.prototype.format=function(e){var t=r.format(this.start,e);return 1!=this.step&&(t+=":"+r.format(this.step,e)),t+":"+r.format(this.end,e)},i.prototype.toString=function(){return this.format()},i.prototype.toJSON=function(){return{mathjs:"Range",start:this.start,end:this.end,step:this.step}},i.fromJSON=function(e){return new i(e.start,e.end,e.step)},i}},function(e,t,n){"use strict";var r=n(7).clone,o=n(6).isInteger;t.name="Index",t.path="type",t.factory=function(e){function t(r){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._dimensions=[],this._isScalar=!0;for(var o=0,i=arguments.length;o<i;o++){var a=arguments[o];if(e.isRange(a))this._dimensions.push(a),this._isScalar=!1;else if(Array.isArray(a)||e.isMatrix(a)){var s=n(a.valueOf());this._dimensions.push(s);var l=s.size();1===l.length&&1===l[0]||(this._isScalar=!1)}else if("number"==typeof a)this._dimensions.push(n([a]));else{if("string"!=typeof a)throw new TypeError("Dimension must be an Array, Matrix, number, string, or Range");this._dimensions.push(a)}}}function n(t){for(var n=0,r=t.length;n<r;n++)if("number"!=typeof t[n]||!o(t[n]))throw new TypeError("Index parameters must be positive integer numbers");return new e.ImmutableDenseMatrix(t)}return t.prototype.type="Index",t.prototype.isIndex=!0,t.prototype.clone=function(){var e=new t;return e._dimensions=r(this._dimensions),e._isScalar=this._isScalar,e},t.create=function(e){var n=new t;return t.apply(n,e),n},t.prototype.size=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?1:r.size()[0]}return e},t.prototype.max=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?r:r.max()}return e},t.prototype.min=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e[t]="string"==typeof r?r:r.min()}return e},t.prototype.forEach=function(e){for(var t=0,n=this._dimensions.length;t<n;t++)e(this._dimensions[t],t,this)},t.prototype.dimension=function(e){return this._dimensions[e]||null},t.prototype.isObjectProperty=function(){return 1===this._dimensions.length&&"string"==typeof this._dimensions[0]},t.prototype.getObjectProperty=function(){return this.isObjectProperty()?this._dimensions[0]:null},t.prototype.isScalar=function(){return this._isScalar},t.prototype.toArray=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];e.push("string"==typeof r?r:r.toArray())}return e},t.prototype.valueOf=t.prototype.toArray,t.prototype.toString=function(){for(var e=[],t=0,n=this._dimensions.length;t<n;t++){var r=this._dimensions[t];"string"==typeof r?e.push(JSON.stringify(r)):e.push(r.toString())}return"["+e.join(", ")+"]"},t.prototype.toJSON=function(){return{mathjs:"Index",dimensions:this._dimensions}},t.fromJSON=function(e){return t.create(e.dimensions)},t}},function(e,t,n){"use strict";var r=n(29),o=r.string,i=r.object,a=Array.isArray,s=o.isString;t.name="ImmutableDenseMatrix",t.path="type",t.factory=function(e,t,o){var l=o(n(95)),c=o(n(93));function A(t,n){if(!(this instanceof A))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!s(n))throw new Error("Invalid datatype: "+n);if(e.isMatrix(t)||a(t)){var o=new l(t,n);this._data=o._data,this._size=o._size,this._datatype=o._datatype,this._min=null,this._max=null}else if(t&&a(t.data)&&a(t.size))this._data=t.data,this._size=t.size,this._datatype=t.datatype,this._min=void 0!==t.min?t.min:null,this._max=void 0!==t.max?t.max:null;else{if(t)throw new TypeError("Unsupported type of data ("+r.types.type(t)+")");this._data=[],this._size=[0],this._datatype=n,this._min=null,this._max=null}}return A.prototype=new l,A.prototype.type="ImmutableDenseMatrix",A.prototype.isImmutableDenseMatrix=!0,A.prototype.subset=function(t){switch(arguments.length){case 1:var n=l.prototype.subset.call(this,t);return e.isMatrix(n)?new A({data:n._data,size:n._size,datatype:n._datatype}):n;case 2:case 3:throw new Error("Cannot invoke set subset on an Immutable Matrix instance");default:throw new SyntaxError("Wrong number of arguments")}},A.prototype.set=function(){throw new Error("Cannot invoke set on an Immutable Matrix instance")},A.prototype.resize=function(){throw new Error("Cannot invoke resize on an Immutable Matrix instance")},A.prototype.reshape=function(){throw new Error("Cannot invoke reshape on an Immutable Matrix instance")},A.prototype.clone=function(){return new A({data:i.clone(this._data),size:i.clone(this._size),datatype:this._datatype})},A.prototype.toJSON=function(){return{mathjs:"ImmutableDenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},A.fromJSON=function(e){return new A(e)},A.prototype.swapRows=function(){throw new Error("Cannot invoke swapRows on an Immutable Matrix instance")},A.prototype.min=function(){if(null===this._min){var e=null;this.forEach(function(t){(null===e||c(t,e))&&(e=t)}),this._min=null!==e?e:void 0}return this._min},A.prototype.max=function(){if(null===this._max){var e=null;this.forEach(function(t){(null===e||c(e,t))&&(e=t)}),this._max=null!==e?e:void 0}return this._max},A}},function(e,t,n){"use strict";var r=n(6).nearlyEqual,o=n(40);t.name="larger",t.factory=function(e,t,i,a){var s=i(n(15)),l=i(n(39)),c=i(n(92)),A=i(n(53)),u=i(n(30)),h=i(n(24)),d=n(17),f=a("larger",{"boolean, boolean":function(e,t){return e>t},"number, number":function(e,n){return e>n&&!r(e,n,t.epsilon)},"BigNumber, BigNumber":function(e,n){return e.gt(n)&&!o(e,n,t.epsilon)},"Fraction, Fraction":function(e,t){return 1===e.compare(t)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return f(e.value,t.value)},"string, string":function(e,t){return e>t},"Matrix, Matrix":function(e,t){var n;switch(e.storage()){case"sparse":switch(t.storage()){case"sparse":n=c(e,t,f);break;default:n=l(t,e,f,!0)}break;default:switch(t.storage()){case"sparse":n=l(e,t,f,!1);break;default:n=u(e,t,f)}}return n},"Array, Array":function(e,t){return f(s(e),s(t)).valueOf()},"Array, Matrix":function(e,t){return f(s(e),t)},"Matrix, Array":function(e,t){return f(e,s(t))},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=A(e,t,f,!1);break;default:n=h(e,t,f,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=A(t,e,f,!0);break;default:n=h(t,e,f,!0)}return n},"Array, any":function(e,t){return h(s(e),t,f,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,f,!0).valueOf()}});return f.toTex={2:"\\left(${args[0]}"+d.operators.larger+"${args[1]}\\right)"},f}},function(e,t,n){"use strict";t.name="FibonacciHeap",t.path="type",t.factory=function(e,t,r,o){var i=r(n(93)),a=r(n(259)),s=1/Math.log((1+Math.sqrt(5))/2);function l(){if(!(this instanceof l))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}l.prototype.type="FibonacciHeap",l.prototype.isFibonacciHeap=!0,l.prototype.insert=function(e,t){var n={key:e,value:t,degree:0};if(this._minimum){var r=this._minimum;n.left=r,n.right=r.right,r.right=n,n.right.left=n,i(e,r.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},l.prototype.size=function(){return this._size},l.prototype.clear=function(){this._minimum=null,this._size=0},l.prototype.isEmpty=function(){return 0===this._size},l.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var t=this._minimum,n=e.degree,r=e.child;n>0;){var o=r.right;r.left.right=r.right,r.right.left=r.left,r.left=t,r.right=t.right,t.right=r,r.right.left=r,r.parent=null,r=o,n--}return e.left.right=e.right,e.right.left=e.left,e==e.right?t=null:(t=e.right,t=d(t,this._size)),this._size--,this._minimum=t,e},l.prototype.remove=function(e){this._minimum=c(this._minimum,e,-1),this.extractMinimum()};var c=function(e,t,n){t.key=n;var r=t.parent;return r&&i(t.key,r.key)&&(A(e,t,r),u(e,r)),i(t.key,e.key)&&(e=t),e},A=function(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child==t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1},u=function(e,t){var n=t.parent;n&&(t.mark?(A(e,t,n),u(n)):t.mark=!0)},h=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1},d=function(e,t){var n,r=Math.floor(Math.log(t)*s)+1,o=new Array(r),l=0,c=e;if(c)for(l++,c=c.right;c!==e;)l++,c=c.right;for(;l>0;){for(var A=c.degree,u=c.right;n=o[A];){if(a(c.key,n.key)){var d=n;n=c,c=d}h(n,c),o[A]=null,A++}o[A]=c,c=u,l--}e=null;for(var f=0;f<r;f++)(n=o[f])&&(e?(n.left.right=n.right,n.right.left=n.left,n.left=e,n.right=e.right,e.right=n,n.right.left=n,i(n.key,e.key)&&(e=n)):e=n);return e};return l}},function(e,t,n){"use strict";t.name="Spa",t.path="type",t.factory=function(e,t,r){var o=r(n(110)),i=r(n(25));function a(){if(!(this instanceof a))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new e.FibonacciHeap}return a.prototype.type="Spa",a.prototype.isSpa=!0,a.prototype.set=function(e,t){if(this._values[e])this._values[e].value=t;else{var n=this._heap.insert(e,t);this._values[e]=n}},a.prototype.get=function(e){var t=this._values[e];return t?t.value:0},a.prototype.accumulate=function(e,t){var n=this._values[e];n?n.value=o(n.value,t):(n=this._heap.insert(e,t),this._values[e]=n)},a.prototype.forEach=function(e,t,n){var r=this._heap,o=this._values,a=[],s=r.extractMinimum();for(s&&a.push(s);s&&s.key<=t;)s.key>=e&&(i(s.value,0)||n(s.key,s.value,this)),(s=r.extractMinimum())&&a.push(s);for(var l=0;l<a.length;l++){var c=a[l];o[(s=r.insert(c.key,c.value)).key]=s}},a.prototype.swap=function(e,t){var n=this._values[e],r=this._values[t];if(!n&&r)n=this._heap.insert(e,r.value),this._heap.remove(r),this._values[e]=n,this._values[t]=void 0;else if(n&&!r)r=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=r,this._values[e]=void 0;else if(n&&r){var o=n.value;n.value=r.value,r.value=o}},a}},function(e,t,n){"use strict";var r=n(29),o=n(11),i=r.array,a=r.object,s=r.string,l=r.number,c=Array.isArray,A=l.isNumber,u=l.isInteger,h=s.isString,d=i.validateIndex;t.name="SparseMatrix",t.path="type",t.factory=function(e,t,f,p){var g=f(n(47)),m=f(n(25));function v(t,n){if(!(this instanceof v))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!h(n))throw new Error("Invalid datatype: "+n);if(e.isMatrix(t))y(this,t,n);else if(t&&c(t.index)&&c(t.ptr)&&c(t.size))this._values=t.values,this._index=t.index,this._ptr=t.ptr,this._size=t.size,this._datatype=n||t.datatype;else if(c(t))b(this,t,n);else{if(t)throw new TypeError("Unsupported type of data ("+r.types.type(t)+")");this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=n}}var y=function(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?a.clone(t._values):void 0,e._index=a.clone(t._index),e._ptr=a.clone(t._ptr),e._size=a.clone(t._size),e._datatype=n||t._datatype):b(e,t.valueOf(),n||t._datatype)},b=function(e,t,n){e._values=[],e._index=[],e._ptr=[],e._datatype=n;var r=t.length,o=0,i=m,a=0;if(h(n)&&(i=p.find(m,[n,n])||m,a=p.convert(0,n)),r>0){var s=0;do{e._ptr.push(e._index.length);for(var l=0;l<r;l++){var A=t[l];if(c(A)){if(0===s&&o<A.length&&(o=A.length),s<A.length){var u=A[s];i(u,a)||(e._values.push(u),e._index.push(l))}}else 0===s&&o<1&&(o=1),i(A,a)||(e._values.push(A),e._index.push(l))}s++}while(s<o)}e._ptr.push(e._index.length),e._size=[r,o]};v.prototype=new g,v.prototype.type="SparseMatrix",v.prototype.isSparseMatrix=!0,v.prototype.storage=function(){return"sparse"},v.prototype.datatype=function(){return this._datatype},v.prototype.create=function(e,t){return new v(e,t)},v.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},v.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return I(this,e);case 2:case 3:return x(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments")}};var I=function(t,n){if(!e.isIndex(n))throw new TypeError("Invalid index");if(n.isScalar())return t.get(n.min());var r,i,a,s,l=n.size();if(l.length!=t._size.length)throw new o(l.length,t._size.length);var c=n.min(),A=n.max();for(r=0,i=t._size.length;r<i;r++)d(c[r],t._size[r]),d(A[r],t._size[r]);var u=t._values,h=t._index,f=t._ptr,p=n.dimension(0),g=n.dimension(1),m=[],y=[];p.forEach(function(e,t){y[e]=t[0],m[e]=!0});var b=u?[]:void 0,I=[],x=[];return g.forEach(function(e){for(x.push(I.length),a=f[e],s=f[e+1];a<s;a++)r=h[a],!0===m[r]&&(I.push(y[r]),b&&b.push(u[a]))}),x.push(I.length),new v({values:b,index:I,ptr:x,size:l,datatype:t._datatype})},x=function(t,n,r,s){if(!n||!0!==n.isIndex)throw new TypeError("Invalid index");var l,c=n.size(),A=n.isScalar();if(e.isMatrix(r)?(l=r.size(),r=r.toArray()):l=i.size(r),A){if(0!==l.length)throw new TypeError("Scalar expected");t.set(n.min(),r,s)}else{if(1!==c.length&&2!==c.length)throw new o(c.length,t._size.length,"<");if(l.length<c.length){for(var u=0,h=0;1===c[u]&&1===l[u];)u++;for(;1===c[u];)h++,u++;r=i.unsqueeze(r,c.length,h,l)}if(!a.deepEqual(c,l))throw new o(c,l,">");for(var d=n.min()[0],f=n.min()[1],p=l[0],g=l[1],m=0;m<p;m++)for(var v=0;v<g;v++){var y=r[m][v];t.set([m+d,v+f],y,s)}}return t};v.prototype.get=function(e){if(!c(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];d(t,this._size[0]),d(n,this._size[1]);var r=w(t,this._ptr[n],this._ptr[n+1],this._index);return r<this._ptr[n+1]&&this._index[r]===t?this._values[r]:0},v.prototype.set=function(e,t,n){if(!c(e))throw new TypeError("Array expected");if(e.length!=this._size.length)throw new o(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var r=e[0],i=e[1],a=this._size[0],s=this._size[1],l=m,A=0;h(this._datatype)&&(l=p.find(m,[this._datatype,this._datatype])||m,A=p.convert(0,this._datatype)),(r>a-1||i>s-1)&&(S(this,Math.max(r+1,a),Math.max(i+1,s),n),a=this._size[0],s=this._size[1]),d(r,a),d(i,s);var u=w(r,this._ptr[i],this._ptr[i+1],this._index);return u<this._ptr[i+1]&&this._index[u]===r?l(t,A)?C(u,i,this._values,this._index,this._ptr):this._values[u]=t:E(u,r,i,t,this._values,this._index,this._ptr),this};var w=function(e,t,n,r){if(n-t==0)return n;for(var o=t;o<n;o++)if(r[o]===e)return o;return t},C=function(e,t,n,r,o){n.splice(e,1),r.splice(e,1);for(var i=t+1;i<o.length;i++)o[i]--},E=function(e,t,n,r,o,i,a){o.splice(e,0,r),i.splice(e,0,t);for(var s=n+1;s<a.length;s++)a[s]++};v.prototype.resize=function(e,t,n){if(!c(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");e.forEach(function(t){if(!l.isNumber(t)||!l.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+s.format(e)+")")});var r=n?this.clone():this;return S(r,e[0],e[1],t)};var S=function(e,t,n,r){var o=r||0,i=m,a=0;h(e._datatype)&&(i=p.find(m,[e._datatype,e._datatype])||m,a=p.convert(0,e._datatype),o=p.convert(o,e._datatype));var s,l,c,A=!i(o,a),u=e._size[0],d=e._size[1];if(n>d){for(l=d;l<n;l++)if(e._ptr[l]=e._values.length,A)for(s=0;s<u;s++)e._values.push(o),e._index.push(s);e._ptr[n]=e._values.length}else n<d&&(e._ptr.splice(n+1,d-n),e._values.splice(e._ptr[n],e._values.length),e._index.splice(e._ptr[n],e._index.length));if(d=n,t>u){if(A){var f=0;for(l=0;l<d;l++){e._ptr[l]=e._ptr[l]+f,c=e._ptr[l+1]+f;var g=0;for(s=u;s<t;s++,g++)e._values.splice(c+g,0,o),e._index.splice(c+g,0,s),f++}e._ptr[d]=e._values.length}}else if(t<u){var v=0;for(l=0;l<d;l++){e._ptr[l]=e._ptr[l]-v;var y=e._ptr[l],b=e._ptr[l+1]-v;for(c=y;c<b;c++)(s=e._index[c])>t-1&&(e._values.splice(c,1),e._index.splice(c,1),v++)}e._ptr[l]=e._values.length}return e._size[0]=t,e._size[1]=n,e};v.prototype.reshape=function(e,t){if(!c(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(e.forEach(function(t){if(!l.isNumber(t)||!l.isInteger(t)||t<0)throw new TypeError("Invalid size, must contain positive integers (size: "+s.format(e)+")")}),this._size[0]*this._size[1]!=e[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var r=[],o=0;o<n._ptr.length;o++)for(var i=0;i<n._ptr[o+1]-n._ptr[o];i++)r.push(o);var a=n._values.slice(),A=n._index.slice();for(o=0;o<n._index.length;o++){var u=A[o],h=r[o],d=u*n._size[1]+h;r[o]=d%e[1],A[o]=Math.floor(d/e[1])}for(n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice(),o=0;o<n._ptr.length;o++)n._ptr[o]=0;for(var f=0;f<a.length;f++){o=A[f],i=r[f];var p=a[f],g=w(o,n._ptr[i],n._ptr[i+1],n._index);E(g,o,i,p,n._values,n._index,n._ptr)}return n},v.prototype.clone=function(){return new v({values:this._values?a.clone(this._values):void 0,index:a.clone(this._index),ptr:a.clone(this._ptr),size:a.clone(this._size),datatype:this._datatype})},v.prototype.size=function(){return this._size.slice(0)},v.prototype.map=function(e,t){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this,r=this._size[0],o=this._size[1];return M(this,0,r-1,0,o-1,function(t,r,o){return e(t,[r,o],n)},t)};var M=function(e,t,n,r,o,i,a){var s=[],l=[],c=[],A=m,u=0;h(e._datatype)&&(A=p.find(m,[e._datatype,e._datatype])||m,u=p.convert(0,e._datatype));for(var d=function(e,t,n){e=i(e,t,n),A(e,u)||(s.push(e),l.push(t))},f=r;f<=o;f++){c.push(s.length);for(var g=e._ptr[f],y=e._ptr[f+1],b=t,I=g;I<y;I++){var x=e._index[I];if(x>=t&&x<=n){if(!a)for(var w=b;w<x;w++)d(0,w-t,f-r);d(e._values[I],x-t,f-r)}b=x+1}if(!a)for(var C=b;C<=n;C++)d(0,C-t,f-r)}return c.push(s.length),new v({values:s,index:l,ptr:c,size:[n-t+1,o-r+1]})};v.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this._size[0],r=this._size[1],o=0;o<r;o++){for(var i=this._ptr[o],a=this._ptr[o+1],s=0,l=i;l<a;l++){var c=this._index[l];if(!t)for(var A=s;A<c;A++)e(0,[A,o],this);e(this._values[l],[c,o],this),s=c+1}if(!t)for(var u=s;u<n;u++)e(0,[u,o],this)}},v.prototype.toArray=function(){return k(this._values,this._index,this._ptr,this._size,!0)},v.prototype.valueOf=function(){return k(this._values,this._index,this._ptr,this._size,!1)};var k=function(e,t,n,r,o){var i,s,l=r[0],c=r[1],A=[];for(i=0;i<l;i++)for(A[i]=[],s=0;s<c;s++)A[i][s]=0;for(s=0;s<c;s++)for(var u=n[s],h=n[s+1],d=u;d<h;d++)A[i=t[d]][s]=e?o?a.clone(e[d]):e[d]:1;return A};return v.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],r=this.density(),o="Sparse Matrix ["+s.format(t,e)+" x "+s.format(n,e)+"] density: "+s.format(r,e)+"\n",i=0;i<n;i++)for(var a=this._ptr[i],l=this._ptr[i+1],c=a;c<l;c++){var A=this._index[c];o+="\n    ("+s.format(A,e)+", "+s.format(i,e)+") ==> "+(this._values?s.format(this._values[c],e):"X")}return o},v.prototype.toString=function(){return s.format(this.toArray())},v.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},v.prototype.diagonal=function(t){if(t){if(e.isBigNumber(t)&&(t=t.toNumber()),!A(t)||!u(t))throw new TypeError("The parameter k must be an integer number")}else t=0;var n=t>0?t:0,r=t<0?-t:0,o=this._size[0],i=this._size[1],a=Math.min(o-r,i-n),s=[],l=[],c=[];c[0]=0;for(var h=n;h<i&&s.length<a;h++)for(var d=this._ptr[h],f=this._ptr[h+1],p=d;p<f;p++){var g=this._index[p];if(g===h-n+r){s.push(this._values[p]),l[s.length-1]=g-r;break}}return c.push(s.length),new v({values:s,index:l,ptr:c,size:[a,1]})},v.fromJSON=function(e){return new v(e)},v.diagonal=function(t,n,r,o,i){if(!c(t))throw new TypeError("Array expected, size parameter");if(2!==t.length)throw new Error("Only two dimensions matrix are supported");if(t=t.map(function(t){if(e.isBigNumber(t)&&(t=t.toNumber()),!A(t)||!u(t)||t<1)throw new Error("Size values must be positive integers");return t}),r){if(e.isBigNumber(r)&&(r=r.toNumber()),!A(r)||!u(r))throw new TypeError("The parameter k must be an integer number")}else r=0;var a=m,s=0;h(i)&&(a=p.find(m,[i,i])||m,s=p.convert(0,i));var l,d=r>0?r:0,f=r<0?-r:0,g=t[0],y=t[1],b=Math.min(g-f,y-d);if(c(n)){if(n.length!==b)throw new Error("Invalid value array length");l=function(e){return n[e]}}else if(e.isMatrix(n)){var I=n.size();if(1!==I.length||I[0]!==b)throw new Error("Invalid matrix length");l=function(e){return n.get([e])}}else l=function(){return n};for(var x=[],w=[],C=[],E=0;E<y;E++){C.push(x.length);var S=E-d;if(S>=0&&S<b){var M=l(S);a(M,s)||(w.push(S+f),x.push(M))}}return C.push(x.length),new v({values:x,index:w,ptr:C,size:[g,y]})},v.prototype.swapRows=function(e,t){if(!(A(e)&&u(e)&&A(t)&&u(t)))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return d(e,this._size[0]),d(t,this._size[0]),v._swapRows(e,t,this._size[1],this._values,this._index,this._ptr),this},v._forEachRow=function(e,t,n,r,o){for(var i=r[e],a=r[e+1],s=i;s<a;s++)o(n[s],t[s])},v._swapRows=function(e,t,n,r,o,i){for(var a=0;a<n;a++){var s=i[a],l=i[a+1],c=w(e,s,l,o),A=w(t,s,l,o);if(c<l&&A<l&&o[c]===e&&o[A]===t){if(r){var u=r[c];r[c]=r[A],r[A]=u}}else if(c<l&&o[c]===e&&(A>=l||o[A]!==t)){var h=r?r[c]:void 0;o.splice(A,0,t),r&&r.splice(A,0,h),o.splice(A<=c?c+1:c,1),r&&r.splice(A<=c?c+1:c,1)}else if(A<l&&o[A]===t&&(c>=l||o[c]!==e)){var d=r?r[A]:void 0;o.splice(c,0,e),r&&r.splice(c,0,d),o.splice(c<=A?A+1:A,1),r&&r.splice(c<=A?A+1:A,1)}}},e.Matrix._storage.sparse=v,v},t.lazy=!1},function(e,t,n){var r=n(97),o=function(e,t,n){this.distance=e,this.linkage=t,this.threshold=void 0==n?1/0:n};o.prototype={tree:function(e,t,n){this.tree=[],this.dists=[],this.mins=[],this.index=[];for(var r=0;r<e.length;r++){var o={value:e[r],key:r,index:r,size:1};this.tree[r]=o,this.index[r]=o,this.dists[r]=[],this.mins[r]=0}for(r=0;r<this.tree.length;r++)for(var i=0;i<=r;i++){var a=r==i?1/0:this.distance(this.tree[r].value,this.tree[i].value);this.dists[r][i]=a,this.dists[i][r]=a,a<this.dists[r][this.mins[r]]&&(this.mins[r]=i)}var s=this.mergeClosest();for(r=0;s;)n&&r++%t==0&&n(this.tree),s=this.mergeClosest();return this.tree.forEach(function(e){delete e.key,delete e.index}),this.tree},mergeClosest:function(){for(var e=0,t=1/0,n=0;n<this.tree.length;n++){var r=this.tree[n].key;(s=this.dists[r][this.mins[r]])<t&&(e=r,t=s)}if(t>=this.threshold)return!1;var o=this.index[e],i=this.index[this.mins[e]],a={dist:t,left:o,right:i,key:o.key,size:o.size+i.size};for(this.tree[o.index]=a,this.tree.splice(i.index,1),this.index[o.key]=a,n=0;n<this.tree.length;n++){var s,l=this.tree[n];o.key==l.key?s=1/0:"single"==this.linkage?(s=this.dists[o.key][l.key],this.dists[o.key][l.key]>this.dists[i.key][l.key]&&(s=this.dists[i.key][l.key])):"complete"==this.linkage?(s=this.dists[o.key][l.key],this.dists[o.key][l.key]<this.dists[i.key][l.key]&&(s=this.dists[i.key][l.key])):s="average"==this.linkage?(this.dists[o.key][l.key]*o.size+this.dists[i.key][l.key]*i.size)/(o.size+i.size):this.distance(l.value,o.value),this.dists[o.key][l.key]=this.dists[l.key][o.key]=s}for(n=0;n<this.tree.length;n++){var c=this.tree[n].key;if(this.mins[c]==o.key||this.mins[c]==i.key){t=c;for(var A=0;A<this.tree.length;A++){var u=this.tree[A].key;this.dists[c][u]<this.dists[c][t]&&(t=u)}this.mins[c]=t}this.tree[n].index=n}return delete o.key,delete i.key,delete o.index,delete i.index,!0},clusters:function(e){(e>this.tree.size||e<1)&&(e=this.tree.size);for(var t=[],n=[this.tree];e>1;){var r=o(n);n.splice(n.indexOf(r),1),n.push(r.left,r.right),e--}function o(e){var t,n=-1;return e.forEach(function(e){e.dist>n&&(n=e.dist,t=e)}),t}return n.forEach(function(e){t.push(function e(t){return 1===t.size?[t.value]:e(t.left).concat(e(t.right))}(e))}),t}},e.exports=function(e,t,n,i,a,s){t=t||"euclidean",n=n||"average","string"==typeof t&&(t=r[t]);var l=new o(t,n,i),c=l.tree(e,a,s);return{tree:void 0===i?c[0]:c,clusters:l.clusters}}},function(e,t,n){e.exports={hcluster:n(263),Kmeans:n(96),kmeans:n(96).kmeans}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.HeatmapPlotter=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(264),i=n(1),a=n(8),s=n(38),l=n(18).create();l.import(n(37)),l.import(n(36)),l.import(n(35)),t.HeatmapPlotter=function(){function t(n,r,o,i,a,l,c,A,u,h,d,f){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=n,this.references=r,this.cohortMetadata=o,this.selectionManager=i,this.fontManager=a,this.textExportManager=l,this.selectedSubcohort=c,this.phenotype=A,this.topN=u,"cnStatus"===this.phenotype&&(this.topN*=2),this.heightCoefficient=h,this.hclustDistance=d,this.hclustLinkage=f,this.usedDataPointsForClustering=[],this.usedDataPointsForClusteringDescriptions=[],this.cellSizeX=0,this.cellSizeY=0,this.svgWidth=0,this.svgHeight=0,this.targetWidth=0,this.targetHeight=0,this.maxPhenotypeValue=0,this.selectedDonors=[],this.missingDonors=new Set,this.selectedDonorsStr=[],this.donorIndexToColumnIndex=new Map;var p="",g=!1;"geneExpressions"===this.phenotype?(p="RNA",g=!1):"methylomeBetas"===this.phenotype?(p="MethylationArray",g=!1):"cnStatus"===this.phenotype?(p="CNV",g=!0):"svStatus"===this.phenotype&&(p="SV",g=!0),this.currentSubcohortIndex=parseInt(e("#subcohortSelector").val()),this.validIndicesSet=this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex),this.validIndices=[];for(var m=0;m<this.cohortMetadata.metadata.length;++m)this.validIndicesSet.has(m)?this.validIndices.push(m):this.missingDonors.add(this.cohortMetadata.metadata[m].index);for(var v=0;v<this.validIndices.length;++v){var y=this.validIndices[v];"+"===this.cohortMetadata.metadata[y][p]?(this.selectedDonors.push(this.cohortMetadata.metadata[y].index),this.selectedDonorsStr.push(this.cohortMetadata.metadata[y].index.toString())):this.missingDonors.add(this.cohortMetadata.metadata[y].index)}e("#heatmapContent").empty(),this.orderedPhenotypeIdentifiers=[],this.orderedDonorIndices=[],this.distanceFunc=function(e,t){var n=e.slice(0,e.length-1),r=t.slice(0,t.length-1);return s.DistanceMeasures[d](n,r)},this.data=[],this.markedPhenotypeIndices=new Set,this.heatmapEntryGroup=null,this.heatmapSupportGroup=null,this.heatmapPhenotypeLabelsGroup=null,this.rectStart={},this.rectEnd={},this.manuallySelectedDonors=new Set,g?this.runClusteringAnalysisNoDb():this.runClusteringAnalysis()}return r(t,[{key:"runClusteringAnalysis",value:function(){var t=this;e.ajax({url:t.commonSettings.baseUrl+"/php/getTopNDataFromPhenotypeDb.php",type:"GET",dataType:"json",data:{cohort:this.cohortMetadata.cohortName,suffix:this.phenotype,topN:this.topN},error:function(e){console.error(e),t.commonSettings.releaseLock()},success:function(e){for(var n="geneExpressions"===t.phenotype?"gene":"probe",r=[],o=[],i=0;i<e.length;++i){for(var a=[],s=!0,c=0;c<t.selectedDonorsStr.length;++c){if(!e[i].hasOwnProperty(t.selectedDonorsStr[c])){s=!1;break}var A=+e[i][t.selectedDonorsStr[c]];a.push(A);var u=+t.selectedDonorsStr[c];t.donorIndexToColumnIndex.has(u)||t.donorIndexToColumnIndex.set(u,a.length-1)}if(s){r.push(a);var h=e[i][n];isNaN(h)?t.usedDataPointsForClustering[i]=h:t.usedDataPointsForClustering[i]=+h,o.push(i)}}if("gene"===n)for(var d=0;d<t.usedDataPointsForClustering.length;++d)t.usedDataPointsForClusteringDescriptions.push(t.references.genes.get(t.usedDataPointsForClustering[d]).geneName);else if("probe"===n)for(var f=0;f<t.usedDataPointsForClustering.length;++f)t.usedDataPointsForClusteringDescriptions.push(t.usedDataPointsForClustering[f]);var p=l.transpose(r);t.heatmapDataPrep(r,p,o)}})}},{key:"runClusteringAnalysisNoDb",value:function(){var e=[],t=[];if("cnStatus"===this.phenotype)for(var n=1;n<this.references.tads.length&&this.references.tads[n].chromosomeIndex<23;++n){for(var r=this.references.tads[n].cnvLossDonorContributorIndices,o=this.references.tads[n].cnvGainDonorContributorIndices,i=this.references.tads[n].lohDonorContributorIndices,a=[],s=[],c=!1,A=!1,u=0;u<this.selectedDonors.length;++u)r.has(this.selectedDonors[u])||i.has(this.selectedDonors[u])?(a[u]=1,c=!0):a[u]=0,o.has(this.selectedDonors[u])?(s[u]=1,A=!0):s[u]=0,this.donorIndexToColumnIndex.has(this.selectedDonors[u])||this.donorIndexToColumnIndex.set(this.selectedDonors[u],u);if(c){var h={data:a,variance:l.var(a),tadIndex:n,direction:-1};e.push(h)}if(A){var d={data:s,variance:l.var(s),tadIndex:n,direction:1};e.push(d)}}else if("svStatus"===this.phenotype)for(var f=1;f<this.references.tads.length&&this.references.tads[f].chromosomeIndex<24;++f){for(var p=this.references.tads[f].svDonorContributorIndicesOffset0,g=[],m=!1,v=0;v<this.selectedDonors.length;++v)this.donorIndexToColumnIndex.has(this.selectedDonors[v])||this.donorIndexToColumnIndex.set(this.selectedDonors[v],v),p.has(this.selectedDonors[v])?(m=!0,g[v]=.05*Math.random()+.95):g[v]=.05*Math.random();if(m){var y={data:g,variance:l.var(g),tadIndex:f,direction:1};e.push(y)}}e=e.sort(function(e,t){return e.variance>t.variance?-1:1});for(var b=[],I=new Set([]),x=new Set([]),w=0;w<e.length&&w<this.topN;++w){var C=e[w].tadIndex;if(-1===e[w].direction){if(this.references.tads[C-1].chromosomeIndex===this.references.tads[C].chromosomeIndex&&x.has(this.references.tads[C-1]))continue;if(this.references.tads[C+1].chromosomeIndex===this.references.tads[C].chromosomeIndex&&x.has(this.references.tads[C+1]))continue;x.add(C)}else{if(this.references.tads[C-1].chromosomeIndex===this.references.tads[C].chromosomeIndex&&I.has(this.references.tads[C-1]))continue;if(this.references.tads[C+1].chromosomeIndex===this.references.tads[C].chromosomeIndex&&I.has(this.references.tads[C+1]))continue;I.add(C)}b.push(e[w].data),this.usedDataPointsForClustering.push([e[w].tadIndex,e[w].direction]),t.push(w)}if("cnStatus"===this.phenotype)for(var E=0;E<this.usedDataPointsForClustering.length;++E)this.usedDataPointsForClusteringDescriptions.push([this.references.tads[this.usedDataPointsForClustering[E][0]].printTadRange(this.references),-1===this.usedDataPointsForClustering[E][1]?"loss":"gain"].join("\t"));else for(var S=0;S<this.usedDataPointsForClustering.length;++S)this.usedDataPointsForClusteringDescriptions.push([this.references.tads[this.usedDataPointsForClustering[S][0]].printTadRange(this.references)].join("\t"));var M=l.transpose(b);this.heatmapDataPrep(b,M,t)}},{key:"heatmapDataPrep",value:function(e,t,n){for(var r=[],s=0;s<e.length;++s)r.push(e[s]),r[s].push(n[s]);for(var c=[],A=0;A<t.length;++A)c.push(t[A]),c[A].push(this.selectedDonors[A]);var u=(0,o.hcluster)(r,this.distanceFunc,this.hclustLinkage).tree,h=(0,o.hcluster)(c,this.distanceFunc,this.hclustLinkage).tree;r.length=0,c.length=0,(0,i.depadTree)(u),(0,i.depadTree)(h);for(var d=(0,i.getTreeLeaves)(u),f=[],p=[],g=0;g<d.length;++g)f.push(e[d[g]]),p.push(this.usedDataPointsForClusteringDescriptions[d[g]]);this.usedDataPointsForClusteringDescriptions=p;for(var m=(0,i.getTreeLeaves)(h),v=l.transpose(f),y=[],b=0;b<m.length;++b){var I=this.donorIndexToColumnIndex.get(m[b]);y.push(v[I])}this.data=l.transpose(y),this.maxPhenotypeValue=0;for(var x=0;x<this.data.length;++x)for(var w=0;w<this.data[x].length;++w){var C=this.data[x][w];C>this.maxPhenotypeValue&&(this.maxPhenotypeValue=C)}for(var E=0;E<d.length;++E)this.orderedPhenotypeIdentifiers.push(this.usedDataPointsForClustering[d[E]]);for(var S=0;S<m.length;++S)this.orderedDonorIndices.push(m[S]);this.colourScaleHeatmap=(0,a.scaleLinear)().domain([0,this.maxPhenotypeValue]).range((0,i.discreteColour)(2)),this.plotHeatmapSupporters(),this.plotHeatmap()}},{key:"resetSelectionRect",value:function(){this.rectStart={},this.rectEnd={},e("#heatmapSelectBox").remove()}},{key:"plotHeatmapSupporters",value:function(){var t=this,n=this;e("#heatmapContent").empty(),this.svgHeatmap=(0,a.select)("#heatmapContent").classed("svg-container",!0).append("svg").classed("container-fluid",!0).classed("wrap",!0).classed("svg-content-responsive",!0).attr("id","heatmap").attr("shape-rendering","crispEdges").attr("preserveAspectRatio","none").attr("width","100%");var r=e("#heatmap");this.generateScalesXY(),r.height(this.svgHeight),this.heatmapSupportGroup=this.svgHeatmap.append("g"),this.svgHeatmap.on("mousedown",function(){n.rectStart=(0,a.mouse)(this),n.rectStart.x>n.svgWidth||n.rectStart.y>n.targetHeight?n.resetSelectionRect():n.rectStart.x<0||n.rectStart.y<0?n.resetSelectionRect():n.svgHeatmap.append("rect").attr("id","heatmapSelectBox").attr("x",n.rectStart[0]).attr("y",n.rectStart[1]).attr("width",0).attr("height",0).style("fill","none").style("stroke","Black").style("stroke-width",.6)}).on("mousemove",function(){var e=n.svgHeatmap.select("#heatmapSelectBox");if(!e.empty()){var t=(0,a.mouse)(this),r={x:+e.attr("x"),y:+e.attr("y"),width:+e.attr("width"),height:+e.attr("height")},o={x:t[0]-r.x,y:t[1]-r.y};o.x<1||2*o.x<r.width?(r.x=t[0],r.width-=o.x):r.width=o.x,o.y<1||2*o.y<r.height?(r.y=t[1],r.height-=o.y):r.height=o.y,e.attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height)}}).on("mouseup",function(){if(n.svgHeatmap.select("#heatmapSelectBox").remove(),!n.commonSettings.interactionLock)if(n.commonSettings.fastLock(),n.rectEnd=(0,a.mouse)(this),n.rectEnd.x>n.svgWidth||n.rectEnd.y>n.targetHeight)n.resetSelectionRect();else if(n.rectEnd.x<0||n.rectEnd.y<0)n.resetSelectionRect();else{n.generateScalesXY();for(var t=[n.xScaleHeatmap.invert(n.rectStart[0]),n.xScaleHeatmap.invert(n.rectEnd[0])].sort(function(e,t){return e<t?-1:e>t?1:-1}),r=Math.floor(t[0]),o=Math.floor(t[1]),i=!1,s=r;s<=o;++s)s>0&&s<n.orderedDonorIndices.length&&(n.manuallySelectedDonors.has(n.orderedDonorIndices[s])?(n.manuallySelectedDonors.delete(n.orderedDonorIndices[s]),i=!0):(n.manuallySelectedDonors.add(n.orderedDonorIndices[s]),i=!0));for(var l=[n.yScaleHeatmap.invert(n.rectStart[1]),n.yScaleHeatmap.invert(n.rectEnd[1])].sort(function(e,t){return e<t?-1:e>t?1:-1}),c=Math.ceil(l[0]),A=Math.floor(l[1]),u=[],h=[],d=c;d<=A;++d)d>=0&&d<n.orderedPhenotypeIdentifiers.length&&(n.markedPhenotypeIndices.has(d)?h.push(d):u.push(d));u.length>0&&n.markSelectedPhenotypes(u);for(var f=0;f<h.length;++f)n.removeMarkedPhenotypeItem(h[f]),n.markedPhenotypeIndices.delete(h[f]);n.manuallySelectedDonors.size>0?e("#subcohortSelectionFromHeatmapGroup").css("display","inline"):(e("#subcohortSelectionFromHeatmapGroup").css("display","none"),e("#heatmapSubcohortSelectionName").empty(),e("#heatmapSubcohortSelectionDescription").empty()),i&&n.remarkDonors(),n.rectStart={},n.rectEnd={},n.commonSettings.fastRelease()}}),this.heatmapPhenotypeLabelsGroup=this.heatmapSupportGroup.append("g"),this.remarkDonors(),this.heatmapPhenotypeLabelsGroup.on("contextmenu",function(){if(a.event.preventDefault(),!t.commonSettings.interactionLock){t.commonSettings.fastLock();try{var e=parseInt((0,a.select)(a.event.target).attr("phenotypeItemIndex"));t.removeMarkedPhenotypeItem(e)}catch(e){return console.error(e),void t.commonSettings.fastRelease()}t.commonSettings.fastRelease()}}),this.markedPhenotypeIndices.size>0&&this.markSelectedPhenotypes(this.markedPhenotypeIndices),e("#heatmapClusteringChoicesCollapseControl").css("display","inline"),e("#heatmapClusteringChoices").html(this.usedDataPointsForClusteringDescriptions.join("<br>"))}},{key:"plotHeatmap",value:function(){if(this.generateScalesXY(),this.heatmapEntryGroup=this.svgHeatmap.append("g"),this.data.length*this.data[0].length<1e6){var n=null;"geneExpressions"===this.phenotype?n=t.getHoverLabelGene:"methylomeBetas"===this.phenotype?n=t.getHoverLabelMeth:"cnStatus"===this.phenotype?n=t.getHoverLabelTad:"svStatus"===this.phenotype&&(n=t.getHoverLabelTad);for(var r=0;r<this.data.length;++r)for(var o=0;o<this.data[r].length;++o)this.heatmapEntryGroup.append("rect").attr("width",this.cellSizeX).attr("height",this.cellSizeY).attr("x",this.xScaleHeatmap(o)).attr("y",this.yScaleHeatmap(r)).attr("fill",this.colourScaleHeatmap(this.data[r][o])).append("svg:title").text(n(r,o,this))}else for(var i=0;i<this.data.length;++i)for(var a=0;a<this.data[i].length;++a)this.heatmapEntryGroup.append("rect").attr("width",this.cellSizeX).attr("height",this.cellSizeY).attr("x",this.xScaleHeatmap(a)).attr("y",this.yScaleHeatmap(i)).attr("fill",this.colourScaleHeatmap(this.data[i][a]));e("#heatmapSubmit").css("display","inline"),this.commonSettings.releaseLock()}},{key:"clearMarkedDonors",value:function(){this.manuallySelectedDonors.clear(),this.remarkDonors(),e("#subcohortSelectionFromHeatmapGroup").css("display","none"),e("#heatmapSubcohortSelectionDescription").empty(),e("#heatmapSubcohortSelectionName").empty(),e("#createSubcohortFromMarkedDonorsHeatmap").css("display","none")}},{key:"remarkDonors",value:function(){var t=this;e("#heatmapXaxis").remove(),this.generateScalesXY();var n=this.fontManager.fontTree.get("heatmapFontTargetSelector").get("donorLabels").generateFontCssText();this.heatmapSupportGroup.append("g").attr("class","axis axis--x").attr("id","heatmapXaxis").call((0,a.axisBottom)(this.xScaleHeatmap).tickValues(Array(this.orderedDonorIndices.length).fill().map(function(e,t){return t+.5})).tickFormat(function(e,n){return t.cohortMetadata.metadata[t.orderedDonorIndices[n]].donor})).attr("transform","translate(0,"+(this.targetHeight+this.cellSizeY)+")").selectAll("text").attr("y",0).attr("x",15).attr("dy",".05em").attr("transform","rotate(90)").style("text-anchor","start").style("font",n).style("color",function(e,n){return t.manuallySelectedDonors.has(t.orderedDonorIndices[n])?"red":"black"})}},{key:"generateScalesXY",value:function(){var t=e("#heatmap");this.svgWidth=t.width(),this.targetWidth=Math.round(.92*this.svgWidth),this.targetHeight=Math.round(this.targetWidth*this.heightCoefficient),this.xScaleHeatmap=(0,a.scaleLinear)().domain([0,this.selectedDonors.length]).range([0,this.targetWidth]),this.yScaleHeatmap=(0,a.scaleLinear)().domain([0,this.orderedPhenotypeIdentifiers.length]).range([0,this.targetHeight]),this.cellSizeX=this.xScaleHeatmap(1),this.cellSizeY=this.targetWidth*this.heightCoefficient/this.orderedPhenotypeIdentifiers.length,this.svgHeight=1.1*this.targetHeight,this.svgHeight<this.svgWidth&&(this.svgHeight=this.svgWidth,this.targetWidth=this.svgWidth)}},{key:"markSelectedPhenotypes",value:function(e){var t=this;e.forEach(function(e){t.markPhenotypeItem(e),t.markedPhenotypeIndices.add(e)})}},{key:"markPhenotypeItem",value:function(t){var n=this.orderedPhenotypeIdentifiers[t],r=this;this.generateScalesXY();var o=this.fontManager.fontTree.get("heatmapFontTargetSelector").get("markedElementLabels").generateFontCssText(),i="";"geneExpressions"===this.phenotype?i=this.references.genes.get(n).getGeneCardsLinkPlain():"methylomeBetas"===this.phenotype?i=n:"cnStatus"===this.phenotype?i=[this.references.cytobands[this.references.tads[n[0]].cytobandIndices[0]].cytobandName,-1===n[1]?"loss":"gain"].join("\t"):"svStatus"===this.phenotype&&(i=this.references.cytobands[this.references.tads[n[0]].cytobandIndices[0]].cytobandName),i='<a id="heatmapPhenotypeLabelPadSpace">&ensp;</a>'+i;var s=this.yScaleHeatmap(t+.5),l=(0,a.path)();l.moveTo(this.targetWidth+this.cellSizeY,s),l.lineTo(this.svgWidth,s),l.closePath(),this.heatmapPhenotypeLabelsGroup.append("path").attr("id","heatmapHelperPath_"+t).attr("d",l).style("display","none"),this.heatmapPhenotypeLabelsGroup.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("class","markerText").attr("phenotypeItemIndex",t).attr("id","heatmapPhenotypeMarker_"+t).append("textPath").attr("xlink:href","#heatmapHelperPath_"+t).attr("phenotypeItemIndex",t).style("dominant-baseline","middle").style("alignment-baseline","middle").style("font",o).html(i).call((0,a.drag)().on("start",function(){e("#heatmapPhenotypeMarker_"+t+"_dragbridge").remove(),e("#heatmapPhenotypeMarkerPad_"+t+"_dragbridge").remove()}).on("drag",function(){var n=Math.max(a.event.x,r.xScaleHeatmap(r.selectedDonors.length)),o=a.event.y,i=(0,a.path)();i.moveTo(n,o),i.lineTo(r.svgWidth,o),i.closePath(),(0,a.select)("#heatmapHelperPath_"+t).attr("d",i);var s=e("#heatmapPhenotypeMarker_"+t);s.hide(),setTimeout(function(){s.show()},10)}).on("end",function(){var e=r.yScaleHeatmap(t+.5),n=Math.max(a.event.x,r.xScaleHeatmap(r.selectedDonors.length)),o=a.event.y,i=(0,a.path)();i.moveTo(r.xScaleHeatmap(r.selectedDonors.length),e),i.lineTo(n,o),i.closePath(),r.heatmapSupportGroup.append("path").attr("id","heatmapPhenotypeMarker_"+t+"_dragbridge").attr("d",i).style("stroke","Black").style("display","inline")}))}},{key:"removeMarkedPhenotypeItem",value:function(t){e("#heatmapPhenotypeMarker_"+t+"_dragbridge").remove(),e("#heatmapPhenotypeMarker_"+t).remove(),e("#heatmapHelperPath_"+t).remove()}},{key:"markSubcohort",value:function(t){var n=this;this.selectionManager.registeredSubcohorts.get(t).forEach(function(e){n.manuallySelectedDonors.add(e)}),this.manuallySelectedDonors.size>0?(e("#subcohortSelectionFromHeatmapGroup").css("display","inline"),this.remarkDonors()):(e("#subcohortSelectionFromHeatmapGroup").css("display","none"),e("#heatmapSubcohortSelectionName").empty(),e("#heatmapSubcohortSelectionDescription").empty()),e("#submitSubcohortForMarkingHeatmap").css("display","none")}}],[{key:"getHoverLabelGene",value:function(e,t,n){return n.cohortMetadata.metadata[n.orderedDonorIndices[t]].donor+","+n.references.genes.get(n.orderedPhenotypeIdentifiers[e]).geneName+","+n.data[e][t]}},{key:"getHoverLabelMeth",value:function(e,t,n){return n.cohortMetadata.metadata[n.orderedDonorIndices[t]].donor+","+n.orderedPhenotypeIdentifiers[e]+","+n.data[e][t]}},{key:"getHoverLabelTad",value:function(e,t,n){return n.cohortMetadata.metadata[n.orderedDonorIndices[t]].donor+","+n.usedDataPointsForClusteringDescriptions[e]+","+n.data[e][t]}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.HeatmapManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(265),i=n(1);n(121),t.HeatmapManager=function(){function t(e,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.selectionManager=o,this.fontManager=i,this.textExportManager=a,this.heatmapPlotter=null,this.newAnalysisRequired=!0}return r(t,[{key:"enableControls",value:function(){var t=this,n=this,r=e("#heatmapPhenotypeSelector");r.empty(),r.append('<option value="-1">Select Phenotype</option>'),this.cohortMetadata.geneExpressionAvailable>2&&r.append('<option value="geneExpressions">Gene Expression</option>'),this.cohortMetadata.methylomeArrayAvailable>2&&r.append('<option value="methylomeBetas">Methylome Betas</option>'),this.cohortMetadata.cnvAvailable>2&&r.append('<option value="cnStatus">Copy Number Status</option>'),this.cohortMetadata.svAvailable>2&&r.append('<option value="svStatus">SV Status</option>');var o=e("#heatmapSubmit");(0,i.generalizedSliderEvents)("heatmapTopN",function(e){return 100*e},"Top N:",function(e){t.newAnalysisRequired=!0,t.heatmapPlotter&&(t.heatmapPlotter.heightCoefficient=Math.pow(2,e-3))}),(0,i.generalizedSliderEvents)("heatmapHeightCoeff",function(e){return Math.pow(2,e-3).toFixed(2)},"Height = Width *",function(e){t.heatmapPlotter&&(t.heatmapPlotter.heightCoefficient=Math.pow(2,e-3))}),e("#heatmapDistanceSelector").off("change").on("change",function(){"-1"!==this.value?(n.newAnalysisRequired=!0,"-1"!==e("#heatmapLinkageSelector").val()&&"-1"!==r.val()&&o.css("display","inline")):o.css("display","none")}),e("#heatmapLinkageSelector").off("change").on("change",function(){"-1"!==this.value?(n.newAnalysisRequired=!0,"-1"!==e("#heatmapDistanceSelector").val()&&"-1"!==r.val()&&o.css("display","inline")):o.css("display","none")}),r.off("change").on("change",function(){"-1"!==this.value?(n.newAnalysisRequired=!0,"-1"!==e("#heatmapDistanceSelector").val()&&"-1"!==e("#heatmapLinkageSelector").val()&&o.css("display","inline")):o.css("display","none")}),o.off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),o.css("display","none"),t.newAnalysisRequired?(t.launchHeatmapAnalysis(),t.newAnalysisRequired=!1):(t.heatmapPlotter.plotHeatmapSupporters(),t.heatmapPlotter.plotHeatmap()))});var a=["heatmapControls","subcohortSelectorGroup","svgDownloader"];e("#heatmapContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,i.switchElements)(a,[])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,i.switchElements)(a,[])}).off("shown.bs.tab").on("shown.bs.tab",function(){e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,i.switchElements)([],a),e("#selectorControlsCollapse").collapse("hide"),e("#subcohortSelectionFromFlexiblePlotDescription").empty(),t.fontManager.setAvailableFontSettings("heatmap"),t.textExportManager.setAvailableExportSettings("heatmap"),t.commonSettings.releaseLock()}),e("#heatmapLaunchConsensusPathDb").off("click").on("click",function(){t.commonSettings.interactionLock||((0,i.selectTextFromDivAndCopy)("heatmapMarkedEntriesList"),window.open("http://cpdb.molgen.mpg.de/CPDB/fct_annot","_blank"))}),e("#heatmapLaunchGsea").off("click").on("click",function(){t.commonSettings.interactionLock||((0,i.selectTextFromDivAndCopy)("heatmapMarkedEntriesList"),window.open("http://software.broadinstitute.org/gsea/msigdb/annotate.jsp","_blank"))}),e("#heatmapLaunchReactome").off("click").on("click",function(){t.commonSettings.interactionLock||((0,i.selectTextFromDivAndCopy)("heatmapMarkedEntriesList"),window.open("https://reactome.org/PathwayBrowser/#TOOL=AT","_blank"))}),e("#heatmapLaunchDavid").off("click").on("click",function(){t.commonSettings.interactionLock||((0,i.selectTextFromDivAndCopy)("heatmapMarkedEntriesList"),window.open("https://david.ncifcrf.gov/gene2gene.jsp","_blank"))}),e("#heatmapSubcohortSelectionName").off("change").on("change",function(){n.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#createSubcohortFromMarkedDonorsHeatmap").css("display","none"):e("#createSubcohortFromMarkedDonorsHeatmap").css("display","inline")}),e("#createSubcohortFromMarkedDonorsHeatmap").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=e("#heatmapSubcohortSelectionName").val();console.log(t.heatmapPlotter.manuallySelectedDonors),t.cohortMetadata.finalizeSelection(t.heatmapPlotter.manuallySelectedDonors,t.heatmapPlotter.missingDonors,n,"heatmapSubcohortSelectionDescription"),t.commonSettings.fastRelease()}}),e("#heatmapSubcohortMarkerSelector").off("change").on("change",function(){-1===parseInt(this.value)?e("#submitSubcohortForMarkingHeatmap").css("display","none"):e("#submitSubcohortForMarkingHeatmap").css("display","inline")}),e("#submitSubcohortForMarkingHeatmap").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=parseInt(e("#heatmapSubcohortMarkerSelector").val());t.heatmapPlotter.markSubcohort(n),t.commonSettings.fastRelease()}}),e("#clearMarkedDonorsFromHeatmap").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),t.heatmapPlotter.clearMarkedDonors(),e("#subcohortSelectionFromFlexiblePlotDescription").empty(),t.commonSettings.fastRelease())})}},{key:"remarkDonors",value:function(){this.heatmapPlotter.remarkDonors(),e("#heatmapSubcohortSelectionDescription").empty()}},{key:"remarkPhenotypes",value:function(){this.heatmapPlotter.heatmapPhenotypeLabelsGroup.selectAll("*").remove(),this.heatmapPlotter.markSelectedPhenotypes(this.heatmapPlotter.markedPhenotypeIndices)}},{key:"textExport",value:function(){}},{key:"getTitleChunks",value:function(){}},{key:"launchHeatmapAnalysis",value:function(){e("#heatmapSubcohortSelectionDescription").empty(),e("#heatmapSubcohortSelectionName").empty(),e("#createSubcohortFromMarkedDonorsHeatmap").css("display","none");var t=100*+e("#heatmapTopN").slider().val(),n=e("#heatmapPhenotypeSelector").val(),r=parseInt(e("#subcohortSelector").val()),i=Math.pow(2,+e("#heatmapHeightCoeff").val()-3),a=e("#heatmapDistanceSelector").val(),s=e("#heatmapLinkageSelector").val();delete this.heatmapPlotter,this.heatmapPlotter=new o.HeatmapPlotter(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.textExportManager,r,n,t,i,a,s)}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.TsvExportManager=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentCohort=null,this.currentTargetName="-1"}return n(t,[{key:"registerCohort",value:function(e){this.currentCohort=e}},{key:"resetCohortContributions",value:function(){this.currentCohort=null}},{key:"triggerTextExport",value:function(){"variantView"===this.currentScreenName?this.variantViewTextExport():"singlePhenotypeExpression"===this.currentScreenName?this.singlePhenotypeExpressionTextExport():"survival"===this.currentScreenName?this.survivalTextExport():"metadata"===this.currentScreenName?this.metadataTextExport():"flexiblePlot"===this.currentScreenName?this.flexiblePlotTextExport():"heatmap"===this.currentScreenName?this.heatmapTextExport():"volcano"===this.currentScreenName&&this.volcanoTextExport()}},{key:"setAvailableExportSettings",value:function(t){var n=this,r=this;this.currentScreenName=t,e("#variantViewTsvExportControls").css("display","none"),e("#singlePhenotypeExpressionTsvExportControls").css("display","none"),e("#survivalTsvExportControls").css("display","none"),e("#metadataTsvExportControls").css("display","none"),e("#flexiblePlotTsvExportControls").css("display","none"),e("#volcanoTsvExportControls").css("display","none"),e("#commonTsvExportControls").css("display","none"),e("#"+this.currentScreenName+"TsvExportControls").css("display","inline"),e("#"+this.currentScreenName+"TsvExportTargetSelector").off("change").val("-1").on("change",function(){r.currentTargetName=this.value,"-1"!==this.value?e("#commonTsvExportControls").css("display","inline"):e("#commonTsvExportControls").css("display","none")}),e("#tsvExportSubmit").off("click").on("click",function(){n.triggerTextExport()})}},{key:"variantViewTextExport",value:function(){null!==this.currentCohort&&("wheel1Recurrence"===this.currentTargetName?this.finalExport(this.currentCohort.wheelManager.textExport(0),this.currentCohort.cohortName+"_wheel1.tsv"):"wheel2Recurrence"===this.currentTargetName?this.finalExport(this.currentCohort.wheelManager.textExport(1),this.currentCohort.cohortName+"_wheel2.tsv"):"wheel3Recurrence"===this.currentTargetName?this.finalExport(this.currentCohort.wheelManager.textExport(2),this.currentCohort.cohortName+"_wheel3.tsv"):"wheel4Recurrence"===this.currentTargetName?this.finalExport(this.currentCohort.wheelManager.textExport(3),this.currentCohort.cohortName+"_wheel4.tsv"):"visibleSv"===this.currentTargetName?this.finalExport(this.currentCohort.vizManager.textExport("sv"),this.currentCohort.cohortName+"_svs.tsv"):"visibleSmallVar"===this.currentTargetName&&this.finalExport(this.currentCohort.vizManager.textExport("smallVar"),this.currentCohort.cohortName+"_smallVars.tsv"))}},{key:"metadataTextExport",value:function(){null!==this.currentCohort&&this.finalExport(this.currentCohort.cohortMetadata.textExport(),this.currentCohort.cohortName+"_cohortMetadata.tsv")}},{key:"flexiblePlotTextExport",value:function(){null!==this.currentCohort&&this.finalExport(this.currentCohort.flexiblePlotManager.textExport(),this.currentCohort.flexiblePlotManager.getTitleChunks().join(".")+".tsv")}},{key:"heatmapTextExport",value:function(){}},{key:"volcanoTextExport",value:function(){if(null!==this.currentCohort){var e=this.currentCohort.determineCurrentVolcano();null!==e&&this.finalExport(e.textExport(),e.volcanoTitle+".tsv")}}},{key:"singlePhenotypeExpressionTextExport",value:function(){}},{key:"survivalTextExport",value:function(){}},{key:"finalExport",value:function(t,n){t[0][0]="data:text/csv;charset=utf-8,"+t[0][0];var r=t.map(function(e){return e.join("\t")}).join("\n"),o=encodeURI(r),i=document.createElement("a");i.setAttribute("href",o),i.setAttribute("download",n),document.body.appendChild(i),setTimeout(function(){e("#"+i.id)},12e4),i.click()}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.FontSettings=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.font=t,this.fontSize=n,this.isItalic=r,this.isBold=o}return r(e,[{key:"generateFontCssText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return(this.isItalic?"italic":"normal")+" "+(this.isBold?"bold":"normal")+" "+Math.round(this.fontSize*e)+'px "'+this.font+'", sans'}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.FontManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(268);t.FontManager=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentCohort=null,this.currentScreenName="",this.currentTargetName="",this.fontTree=new Map([]),this.addNewFont("variantViewFontTargetSelector","title","Noto Sans",24,!1,!0),this.addNewFont("variantViewFontTargetSelector","chromosomeLabels","Noto Sans",14,!1,!0),this.addNewFont("variantViewFontTargetSelector","verticalAxisLabels","Noto Sans",8,!1,!1),this.addNewFont("variantViewFontTargetSelector","horizontalAxisLabels","Noto Sans",10,!1,!1),this.addNewFont("variantViewFontTargetSelector","cytobandAndGeneLabels","Noto Sans",12,!1,!1),this.addNewFont("singlePhenotypeExpressionFontTargetSelector","title","Noto Sans",20,!1,!0),this.addNewFont("singlePhenotypeExpressionFontTargetSelector","expressionQuantityLabels","Noto Sans",12,!1,!1),this.addNewFont("singlePhenotypeExpressionFontTargetSelector","expressionQuantityTitle","Noto Sans",14,!1,!1),this.addNewFont("singlePhenotypeExpressionFontTargetSelector","donorLabels","Noto Sans",10,!1,!1),this.addNewFont("survivalFontTargetSelector","title","Noto Sans",16,!1,!0),this.addNewFont("survivalFontTargetSelector","xAxisLabels","Noto Sans",12,!1,!1),this.addNewFont("survivalFontTargetSelector","xAxisTitle","Noto Sans",14,!1,!1),this.addNewFont("survivalFontTargetSelector","yAxisLabels","Noto Sans",12,!1,!1),this.addNewFont("flexiblePlotFontTargetSelector","donorLabels","Noto Sans",14,!1,!0),this.addNewFont("flexiblePlotFontTargetSelector","xAxisLabels","Noto Sans",12,!1,!1),this.addNewFont("flexiblePlotFontTargetSelector","xAxisTitle","Noto Sans",14,!1,!1),this.addNewFont("flexiblePlotFontTargetSelector","yAxisLabels","Noto Sans",12,!1,!1),this.addNewFont("flexiblePlotFontTargetSelector","yAxisTitle","Noto Sans",14,!1,!1),this.addNewFont("flexiblePlotFontTargetSelector","legendLabels","Noto Sans",12,!1,!1),this.addNewFont("heatmapFontTargetSelector","donorLabels","Noto Sans",14,!1,!0),this.addNewFont("heatmapFontTargetSelector","markedElementLabels","Noto Sans",10,!1,!0),this.addNewFont("volcanoFontTargetSelector","title","Noto Sans",16,!1,!0),this.addNewFont("volcanoFontTargetSelector","markedElementLabels","Noto Sans",10,!1,!1),this.addNewFont("volcanoFontTargetSelector","xAxisLabels","Noto Sans",10,!1,!1),this.addNewFont("volcanoFontTargetSelector","xAxisTitle","Noto Sans",14,!1,!1),this.addNewFont("volcanoFontTargetSelector","yAxisLabels","Noto Sans",10,!1,!1),this.addNewFont("volcanoFontTargetSelector","yAxisTitle","Noto Sans",14,!1,!1),this.enableControls()}return r(t,[{key:"registerCohort",value:function(e){this.currentCohort=e}},{key:"resetCohortContributions",value:function(){this.currentCohort=null}},{key:"addNewFont",value:function(e,t,n,r,i,a){this.fontTree.has(e)||this.fontTree.set(e,new Map([])),this.fontTree.get(e).set(t,new o.FontSettings(n,r,i,a))}},{key:"enableControls",value:function(){var t=this;e("#fontSelector").off("change").on("change",function(){t.fontTree.get(t.currentScreenName+"FontTargetSelector").get(t.currentTargetName).font=this.value,t.triggerFontAdjustment()}),e("#fontSizeSelector").off("change").on("change",function(){t.fontTree.get(t.currentScreenName+"FontTargetSelector").get(t.currentTargetName).fontSize=this.value,t.triggerFontAdjustment()}),e("#boldFontSettingButton").off("click").on("click",function(){var n=t.fontTree.get(t.currentScreenName+"FontTargetSelector").get(t.currentTargetName);n.isBold?(e(this).removeClass("active"),n.isBold=!1):(e(this).addClass("active"),n.isBold=!0),t.triggerFontAdjustment()}),e("#italicFontSettingButton").off("click").on("click",function(){var n=t.fontTree.get(t.currentScreenName+"FontTargetSelector").get(t.currentTargetName);n.isItalic?(e(this).removeClass("active"),n.isItalic=!1):(e(this).addClass("active"),n.isItalic=!0),t.triggerFontAdjustment()})}},{key:"triggerFontAdjustment",value:function(){"variantView"===this.currentScreenName?this.variantViewFontAdjustment(this.currentTargetName):"singlePhenotypeExpression"===this.currentScreenName?this.singlePhenotypeExpressionFontAdjustment():"survival"===this.currentScreenName?this.survivalFontAdjustment():"flexiblePlot"===this.currentScreenName?this.flexiblePlotFontAdjustment(this.currentTargetName):"heatmap"===this.currentScreenName?this.heatmapFontAdjustment(this.currentTargetName):"volcano"===this.currentScreenName&&this.volcanoPlotFontAdjustment(this.currentTargetName)}},{key:"setAvailableFontSettings",value:function(t){var n=this;this.currentScreenName=t,e("#variantViewFontTargetSelector").css("display","none"),e("#singlePhenotypeExpressionFontTargetSelector").css("display","none"),e("#survivalFontTargetSelector").css("display","none"),e("#flexiblePlotFontTargetSelector").css("display","none"),e("#heatmapFontTargetSelector").css("display","none"),e("#volcanoFontTargetSelector").css("display","none"),e("#commonFontControls").css("display","none"),e("#"+this.currentScreenName+"FontTargetSelector").css("display","inline").off("change").val("-1").on("change",function(){if("-1"!==this.value){n.currentTargetName=this.value;var t=n.fontTree.get(n.currentScreenName+"FontTargetSelector").get(n.currentTargetName);e("#fontSelector").val(t.font),e("#fontSizeSelector").val(t.fontSize),t.isBold?e("#boldFontSettingButton").addClass("active"):e("#boldFontSettingButton").removeClass("active"),t.isItalic?e("#italicFontSettingButton").addClass("active"):e("#italicFontSettingButton").removeClass("active"),e("#commonFontControls").css("display","inline")}})}},{key:"variantViewFontAdjustment",value:function(e){null!==this.currentCohort&&("title"===e?this.currentCohort.plotTitle(this.currentCohort.currentSubcohortIndex,this.currentCohort.selectedDiffSubcohortIndex):"chromosomeLabels"===e?this.currentCohort.wheelManager.horizontalAxisGenerator.generate():"verticalAxisLabels"===e?this.currentCohort.wheelManager.replotVerticalAxis():"horizontalAxisLabels"===e?this.currentCohort.wheelManager.horizontalAxisGenerator.generate():"cytobandAndGeneLabels"===e&&(this.currentCohort.wheelManager.replotGeneLabels(),this.currentCohort.vizManager.adjustVdjMarkerFont()))}},{key:"singlePhenotypeExpressionFontAdjustment",value:function(){null!==this.currentCohort&&this.currentCohort.singlePhenotypePlotManager.resetPlots()}},{key:"survivalFontAdjustment",value:function(){null!==this.currentCohort&&(this.currentCohort.survivalPlotManager.resetKaplanMeier(),this.currentCohort.survivalPlotManager.plotKaplanMeier())}},{key:"flexiblePlotFontAdjustment",value:function(e){null!==this.currentCohort&&("donorLabels"===e?this.currentCohort.flexiblePlotManager.remarkDonors():"legendLabels"===e?this.currentCohort.flexiblePlotManager.addLegend():this.currentCohort.flexiblePlotManager.adjustPlotSupporters())}},{key:"heatmapFontAdjustment",value:function(e){null!==this.currentCohort&&("donorLabels"===e?this.currentCohort.heatmapManager.remarkDonors():this.currentCohort.heatmapManager.remarkPhenotypes())}},{key:"volcanoPlotFontAdjustment",value:function(e){if(null!==this.currentCohort){var t="";if("title"===e)t="plotTitle";else if("markedElementLabels"===e)t="replotAllMarked";else if("xAxisLabels"===e)t="plotAxis";else if("xAxisTitle"===e)t="plotAxis";else if("yAxisLabels"===e)t="plotAxis";else{if("yAxisTitle"!==e)return;t="plotAxis"}null!==this.currentCohort.variantGeneExpressionVolcano&&null!==this.currentCohort.variantGeneExpressionVolcano.volcanoSVG&&this.currentCohort.variantGeneExpressionVolcano[t](),null!==this.currentCohort.subcohortGeneExpressionVolcano&&null!==this.currentCohort.subcohortGeneExpressionVolcano.volcanoSVG&&this.currentCohort.subcohortGeneExpressionVolcano[t](),null!==this.currentCohort.correlationGeneExpressionVolcano&&null!==this.currentCohort.correlationGeneExpressionVolcano.volcanoSVG&&this.currentCohort.correlationGeneExpressionVolcano[t](),null!==this.currentCohort.subcohortMutexVolcano&&null!==this.currentCohort.subcohortMutexVolcano.volcanoSVG&&this.currentCohort.subcohortMutexVolcano[t](),null!==this.currentCohort.variantRppaExpressionVolcano&&null!==this.currentCohort.variantRppaExpressionVolcano.volcanoSVG&&this.currentCohort.variantRppaExpressionVolcano[t](),null!==this.currentCohort.subcohortRppaExpressionVolcano&&null!==this.currentCohort.subcohortRppaExpressionVolcano.volcanoSVG&&this.currentCohort.subcohortRppaExpressionVolcano[t]()}}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SinglePhenotypeExpressionManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),i=n(115);t.SinglePhenotypeExpressionManager=function(){function t(e,n,r,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.selectionManager=o,this.fontManager=i,this.textExportManager=a,this.singleGeneExpression=null,this.singleRppaExpression=null,this.svMaxTadOffset=1,this.offIndelMaxTadOffset=-1,this.geneId=null,this.gene2Id=null,this.rppaId=null,this.rppa2Id=null,this.group1=0,this.group2=0,this.customMagFactor=1,this.singleDonorVariantContributions=null,this.enableControls()}return r(t,[{key:"reset",value:function(){e("#singleGeneExpressionSelection").empty().append('<option value"-1">Select Gene</option>'),e("#geneExpressionContent").empty(),e("#singleRppaExpressionSelector").empty().append('<option value"-1">Select RPPA Antibody</option>'),e("#rppaExpressionContent").empty(),e("#singleGeneExpressionSelectorGroup").css("display","none"),e("#singleRppaExpressionSelectorGroup").css("display","none"),this.geneId=null,this.gene2Id=null,this.rppaId=null,this.rppa2Id=null,this.singleGeneExpression=null,this.singleRppaExpression=null,this.singleDonorVariantContributions=null,this.singleDonorVariantContributions2=null,this.setGroup1(0),this.setGroup2(0)}},{key:"setGroup1",value:function(t){this.group1=t,e("#groupSelectorSinglePhenotypeSelector1").val(t)}},{key:"setGroup2",value:function(t){this.group2=t,e("#groupSelectorSinglePhenotypeSelector2").val(t)}},{key:"setSvMaxTadOffset",value:function(t){this.svMaxTadOffset=t,e("#svTadOffsetSelectorSinglePhenotypeSelector").val(t)}},{key:"setOffIndelMaxTadOffset",value:function(t){this.offIndelMaxTadOffset=t,e("#offIndelTadOffsetSelectorSinglePhenotypeSelector").val(t)}},{key:"setSingleDonorVariantContributions",value:function(e){this.singleDonorVariantContributions=e}},{key:"setSingleDonorVariantContributions2",value:function(e){this.singleDonorVariantContributions2=e}},{key:"enableControls",value:function(){var t=this,n=["svgDownloader","svDescriptionPaneControl","midSizedSvDescriptionPaneControl","vdjSvDescriptionPaneControl","smallVariantDescriptionPaneControl","selectorControlsCollapseControl","singlePhenotypeExpressionControls","groupSelectorSinglePhenotypeGroup","singlePhenotypeViewSpecificCytobandSelectorControls","singlePhenotypeViewSpecificGeneSelectorControls","singlePhenotypeViewSpecificAntibodySelectorControls"];e("#phenotypeExpressionContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,o.switchElements)(n,["tsvExportPanel"])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,o.switchElements)(n,["tsvExportPanel"])}).off("shown.bs.tab").on("shown.bs.tab",function(){e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,o.switchElements)(["tsvExportPanel"],n),t.fontManager.setAvailableFontSettings("singlePhenotypeExpression"),t.textExportManager.setAvailableExportSettings("singlePhenotypeExpression")}),e("#plotSingleGeneAsSinglePhenotype").off("click").on("click",function(){if(t.reset(),t.geneId=t.references.geneInputAwesompleteCurrentGene,e("#geneSelector").val("FETCHING"),t.cohortMetadata.rppaExpressionAvailable>0){var n=t.references.genes.get(t.geneId).rppaIds;t.addCorrespondingAntibodies(n)}t.plotSingleGeneExpression()}),e("#addSecondGeneAsSinglePhenotype").off("click").on("click",function(){null!==t.geneId&&(t.gene2Id=t.references.geneInputAwesompleteCurrentGene,e("#geneSelector").val("FETCHING"),t.plotSingleGeneExpression())}),e("#plotSingleAntibodyAsSinglePhenotype").off("click").on("click",function(){t.reset(),t.rppaId=t.references.rppaInputAwesompleteCurrentRppa,e("#antibodySelector").val("FETCHING"),t.plotSingleRppaExpression();var n=t.references.rppaAntibodies[t.rppaId].geneIds;if(t.cohortMetadata.rppaExpressionAvailable>0){var r=new Set([t.rppaId]);n.forEach(function(e){t.references.genes.get(e).rppaIds.forEach(function(e){r.add(e)})}),r=Array.from(r)}}),e("#addSecondAntibodyAsSinglePhenotype").off("click").on("click",function(){t.rppa2Id=t.references.rppaInputAwesompleteCurrentRppa,e("#antibodySelector").val("FETCHING"),t.plotSingleRppaExpression();var n=t.references.rppaAntibodies[t.rppa2Id].geneIds;if(t.cohortMetadata.rppaExpressionAvailable>0){var r=new Set([t.rppa2Id]);n.forEach(function(e){t.references.genes.get(e).rppaIds.forEach(function(e){r.add(e)})}),r=Array.from(r)}});var r=this;e("#svTadOffsetSelectorSinglePhenotypeSelector").off("change").on("change",function(){r.svMaxTadOffset=parseInt(this.value),r.resetPlots()}),e("#offIndelTadOffsetSelectorSinglePhenotypeSelector").off("change").on("change",function(){r.offIndelMaxTadOffset=parseInt(this.value),r.resetPlots()}),e("#addGenesOnCytobandCarryingGenesToList").off("click").on("click",function(){t.reset();var e=t.references.geneInputAwesompleteCurrentGene;t.references.currentCohort.resetGeneSelector();var n=t.references.genes.get(e).cytobandIndices,r=new Set([e]);n.forEach(function(e){t.references.cytobands[e].getGeneIndices().forEach(function(e){r.add(e)})}),r=Array.from(r)}),e("#addGenesOnCytobandToList").off("click").on("click",function(){e("#singleGeneExpressionSelection").empty(),e("#singleRppaExpressionSelector").empty();var n=t.references.cytobandInputAwesompleteCurrentCytoband;t.references.currentCohort.resetCytobandSelector();var r=new Set([]);t.references.cytobands[n].getGeneIndices().forEach(function(e){r.add(e)})}),e("#singleGeneExpressionSelector").off("change").on("change",function(){if("-1"!==this.value&&(r.geneId=parseInt(this.value),r.plotSingleGeneExpression(),this.cohortMetadata.rppaExpressionAvailable>0)){var e=r.references.genes.get(r.geneId).rppaIds;r.addCorrespondingAntibodies(e)}}),e("#singleRppaExpressionSelector").off("change").on("change",function(){"-1"!==this.value&&(r.rppaId=parseInt(this.value),r.plotSingleRppaExpression())}),e("#groupSelectorSinglePhenotypeSelector1").off("change").on("change",function(){"-1"!==this.value&&(r.group1=parseInt(this.value),r.resetPlots())}),e("#groupSelectorSinglePhenotypeSelector2").off("change").on("change",function(){"-1"!==this.value&&(r.group2=parseInt(this.value),r.resetPlots())}),(0,o.generalizedSliderEvents)("singlePhenotypePlotBaseSizeFactorController",function(e){return parseInt(e)/100},"DefaultSize x",function(e){t.customMagFactor=parseInt(e)/100,t.resetPlots()})}},{key:"redrawPlotSupporters",value:function(){this.singleGeneExpression&&this.singleGeneExpression.drawPlotSupporters(),this.singleRppaExpression&&this.singleRppaExpression.drawPlotSupporters()}},{key:"resetPlots",value:function(){this.singleGeneExpression&&this.plotSingleGeneExpression(),this.singleRppaExpression&&this.plotSingleRppaExpression()}},{key:"addGenesToCandidateList",value:function(t){var n=this;t.length>0&&e("#singleGeneExpressionSelectorGroup").css("display","inline"),t.forEach(function(t){e("#singleGeneExpressionSelector").append("<option value="+t+">"+n.references.genes.get(t).geneName+"</option>")})}},{key:"addCorrespondingAntibodies",value:function(t){var n=this;t.length>0&&e("#singleRppaExpressionSelectorGroup").css("display","inline"),t.forEach(function(t){e("#singleRppaExpressionSelector").append("<option value="+t+">"+n.references.rppaAntibodies[t].antibodyName+"</option>")})}},{key:"plotSingleGeneExpression",value:function(){this.singleGeneExpression=null,e("#geneExpressionContent").empty(),this.singleGeneExpression=new i.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!1,"gene",this.geneId,this.gene2Id,this.svMaxTadOffset,this.offIndelMaxTadOffset,this.group1,this.group2,this.fontManager,this.singleDonorVariantContributions,this.singleDonorVariantContributions2,this.customMagFactor),e("#geneSelector").val(""),this.references.currentCohort.resetGeneSelector()}},{key:"plotSingleRppaExpression",value:function(){this.singleRppaExpression=null,e("#rppaExpressionContent").empty(),this.singleRppaExpression=new i.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!1,"rppa",this.rppaId,this.rppa2Id,this.svMaxTadOffset,this.offIndelMaxTadOffset,this.group1,this.group2,this.fontManager,this.singleDonorVariantContributions,this.singleDonorVariantContributions2,this.customMagFactor),e("#antibodySelectorSelector").val(""),this.references.currentCohort.resetRppaSelector()}},{key:"savePhenotypeSvg",value:function(){this.singleGeneExpression&&this.singleGeneExpression.savePhenotypeSvg(),this.singleRppaExpression&&this.singleRppaExpression.savePhenotypeSvg()}},{key:"textExport",value:function(){}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.SurvivalPlotManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),i=n(8);t.SurvivalPlotManager=function(){function t(n,r,i,a,s){var l=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=n,this.references=r,this.cohortMetadata=i,this.selectionManager=a,this.fontManager=s,this.survivalSVG=null,this.targetWidth=0,this.xScale=null,this.yScale=null,e("#survivalContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,o.switchElements)(["survivalControls","svgDownloader"],["tsvExportPanel"])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,o.switchElements)(["survivalControls","svgDownloader"],["tsvExportPanel"])}).off("shown.bs.tab").on("shown.bs.tab",function(){e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,o.switchElements)(["tsvExportPanel"],["survivalControls","svgDownloader"]),l.addSelections(),l.fontManager.setAvailableFontSettings("survival")}),this.cohortSurvivalMax=1825,this.undefinedValues=new Set([void 0,NaN,"NA","N.A","N.A.",""]);for(var c=0;c<this.cohortMetadata.metadata.length;++c){var A=this.cohortMetadata.metadata[c].OS,u=this.cohortMetadata.metadata[c].censoredOS;this.undefinedValues.has(A)||A>this.cohortSurvivalMax&&(this.cohortSurvivalMax=A),this.undefinedValues.has(u)||u>this.cohortSurvivalMax&&(this.cohortSurvivalMax=u)}this.includedSelections=[],this.selectionSurvivals=[],this.selectionCensoredSurvivals=[],this.discreteColours=[]}return r(t,[{key:"addSelections",value:function(){var t=this,n=e("#survivalSelectionCheckboxes");n.empty(),this.selectionManager.registeredSubcohortNames.forEach(function(e,t,r){n.append('\n                <label class="custom-control custom-checkbox">\n                    <input id="includeSelectionInSurvival'+t+'" type="checkbox" class="custom-control-input">\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+e+"</span>\n                </label><br>\n            ")}),e("#survivalSelectionsSubmit").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),t.includedSelections.length=0,t.selectionManager.registeredSubcohorts.forEach(function(n,r,o){e("#includeSelectionInSurvival"+r).is(":checked")&&t.includedSelections.push(r)}),t.resetKaplanMeier(),0!==t.includedSelections.length&&t.plotKaplanMeier(),t.commonSettings.releaseLock())})}},{key:"addTitle",value:function(){for(var e=[this.cohortMetadata.cohortName+":"],t=0;t<this.includedSelections.length;++t)e.push('<a fill="'+this.discreteColours[t]+'" style="text-decoration:none">\n                    '+this.selectionManager.registeredSubcohortNames.get(this.includedSelections[t])+"\n                    ("+this.selectionSurvivals[t].length+"/"+this.selectionManager.registeredSubcohorts.get(this.includedSelections[t]).size+")\n                </a>");var n=e.join(" "),r=(0,i.path)();r.moveTo(0,-5),r.lineTo(this.targetWidth,-5),this.survivalSVG.append("path").attr("id","survivalTitleFrame").attr("d",r);var o=this.fontManager.fontTree.get("survivalFontTargetSelector").get("title").generateFontCssText();this.survivalSVG.append("text").append("textPath").attr("class","markerTextCohort").attr("xlink:href","#survivalTitleFrame").attr("id","volcanoTitle").style("text-anchor","start").attr("startOffset","0%").style("display","inline").style("font",o).html(n)}},{key:"addHelpers",value:function(){this.survivalSVG.append("line").style("stroke","black").style("stroke-dasharray","3, 3").attr("x1",this.xScale(1825)).attr("y1",this.yScale(0)).attr("x2",this.xScale(1825)).attr("y2",this.yScale(1)),this.survivalSVG.append("line").style("stroke","black").style("stroke-dasharray","3, 3").attr("x1",this.xScale(0)).attr("y1",this.yScale(.5)).attr("x2",this.xScale(this.cohortSurvivalMax)).attr("y2",this.yScale(.5))}},{key:"addAxis",value:function(e){var t=this.fontManager.fontTree.get("survivalFontTargetSelector").get("xAxisLabels").generateFontCssText(),n=this.fontManager.fontTree.get("survivalFontTargetSelector").get("yAxisLabels").generateFontCssText(),r=this.fontManager.fontTree.get("survivalFontTargetSelector").get("xAxisTitle").generateFontCssText();this.survivalSVG.append("text").attr("class","axis").attr("transform","translate("+this.targetWidth/2+","+1.05*this.targetWidth+")").style("text-anchor","middle").style("font",r).text("Overall Survival (Days)"),this.survivalSVG.datum(e).append("g").attr("class","axis axis--x").attr("transform","translate(0,"+this.targetWidth+")").call((0,i.axisBottom)(this.xScale)).style("font",t),this.survivalSVG.datum(e).append("g").attr("class","axis axis--y").call((0,i.axisLeft)(this.yScale)).style("font",n)}},{key:"resetKaplanMeier",value:function(){null!==this.survivalSVG&&(this.survivalSVG.remove(),this.survivalSVG=null),this.selectionSurvivals.length=0,this.selectionCensoredSurvivals.length=0,e("#survivalContent").empty()}},{key:"plotKaplanMeier",value:function(){for(var t=0;t<this.includedSelections.length;++t)this.selectionSurvivals.push([]),this.selectionCensoredSurvivals.push([]);for(var n=0;n<this.cohortMetadata.metadata.length;++n){var r=this.cohortMetadata.metadata[n].OS,a=this.cohortMetadata.metadata[n].censoredOS;if(this.undefinedValues.has(r)||isNaN(r)){if(!this.undefinedValues.has(a)&&!isNaN(a))for(var s=this.cohortMetadata.metadata[n].index,l=0;l<this.includedSelections.length;++l)this.selectionManager.registeredSubcohorts.get(this.includedSelections[l]).has(s)&&this.selectionCensoredSurvivals[l].push(a)}else for(var c=this.cohortMetadata.metadata[n].index,A=0;A<this.includedSelections.length;++A)this.selectionManager.registeredSubcohorts.get(this.includedSelections[A]).has(c)&&this.selectionSurvivals[A].push(r)}for(var u=0;u<this.selectionSurvivals.length;++u)this.selectionSurvivals[u].sort(function(e,t){return e-t});for(var h=0;h<this.selectionCensoredSurvivals.length;++h)this.selectionCensoredSurvivals[h].sort(function(e,t){return e-t});var d=e("#mainSide").width(),f=.15*-d+" "+.15*-d+" "+1.2*d+" "+1.2*d;this.survivalSVG=(0,i.select)("#survivalContent").classed("svg-container",!0).append("svg").classed("svg-content-responsive",!0).attr("viewBox",f).attr("id","survivalSVG").attr("preserveAspectRatio","xMinYMin slice").attr("width","95%").attr("height","95%"),this.targetWidth=.99*e("#survivalSVG").width(),this.xScale=(0,i.scaleLinear)().domain([0,this.cohortSurvivalMax]).range([0,this.targetWidth]),this.yScale=(0,i.scaleLinear)().domain([0,1]).range([this.targetWidth,0]);var p=[];this.discreteColours.length=0,this.discreteColours=(0,o.discreteColour)(this.includedSelections.length),this.addTitle();for(var g=0;g<this.includedSelections.length;++g)p=p.concat(this.addGroup(g));this.addHelpers(),this.addAxis(p)}},{key:"addGroup",value:function(e){for(var t=this,n=this.includedSelections[e],r=this.selectionSurvivals[e],a=this.selectionCensoredSurvivals[e].slice(),s=this.discreteColours[e],l=this.selectionManager.registeredSubcohorts.get(n).size,c=1/l,A=(0,o.range)(1-r.length/l,1.00001,c).reverse(),u=[[0,1]],h=[],d=0,f=a[d];f<r[0]&&d!==a.length;)h.push([[f,A[0]-.005],[f,A[0]+.005]]),f=a[d+=1];for(var p=0;p<r.length;++p)if(u.push([r[p],A[p]]),u.push([r[p],A[p+1]]),a.length>0)if(p!==r.length-1)for(;d!==a.length&&f<r[p+1];)h.push([[f,A[p+1]-.005],[f,A[p+1]+.005]]),f=a[d+=1];else for(;d!==a.length;)h.push([[f,A[p+1]-.005],[f,A[p+1]+.005]]),f=a[d+=1];u.push([this.cohortSurvivalMax,A[r.length]]);var g=(0,i.line)().x(function(e){return t.xScale(e[0])}).y(function(e){return t.yScale(e[1])});return this.survivalSVG.datum(u).append("path").attr("class","selectedLine").style("fill","none").style("stroke",s).style("stroke-width","2").attr("d",g),h.forEach(function(e){t.survivalSVG.datum(e).append("path").attr("class","selectedLine").style("fill","none").style("stroke","Black").style("stroke-width","2").attr("d",g)}),u}},{key:"getTitleChunks",value:function(){var e=[""+this.cohortMetadata.cohortName];e.push("Survival");for(var t=0;t<this.includedSelections.length;++t)e.push(this.selectionManager.registeredSubcohortNames.get(this.includedSelections[t])+"("+this.selectionSurvivals[t].length+"of"+this.selectionManager.registeredSubcohorts.get(this.includedSelections[t]).size+")");return e}},{key:"saveSurvivalSvg",value:function(){var e=this.getTitleChunks().join("_")+".svg";(0,o.saveSvg)("survivalSVG",e)}},{key:"textExport",value:function(){}}]),t}()}).call(this,n(0))},function(e,t,n){!function(e,t,n){"use strict";var r=1e-10;function o(e,t){var n,o=function(e){for(var t=[],n=0;n<e.length;++n)for(var r=n+1;r<e.length;++r)for(var o=l(e[n],e[r]),i=0;i<o.length;++i){var a=o[i];a.parentIndex=[n,r],t.push(a)}return t}(e),s=o.filter(function(t){return function(e,t){for(var n=0;n<t.length;++n)if(a(e,t[n])>t[n].radius+r)return!1;return!0}(t,e)}),A=0,u=0,h=[];if(s.length>1){var d=c(s);for(n=0;n<s.length;++n){var f=s[n];f.angle=Math.atan2(f.x-d.x,f.y-d.y)}s.sort(function(e,t){return t.angle-e.angle});var p=s[s.length-1];for(n=0;n<s.length;++n){var g=s[n];u+=(p.x+g.x)*(g.y-p.y);for(var m={x:(g.x+p.x)/2,y:(g.y+p.y)/2},v=null,y=0;y<g.parentIndex.length;++y)if(p.parentIndex.indexOf(g.parentIndex[y])>-1){var b=e[g.parentIndex[y]],I=Math.atan2(g.x-b.x,g.y-b.y),x=Math.atan2(p.x-b.x,p.y-b.y),w=x-I;w<0&&(w+=2*Math.PI);var C=x-w/2,E=a(m,{x:b.x+b.radius*Math.sin(C),y:b.y+b.radius*Math.cos(C)});E>2*b.radius&&(E=2*b.radius),(null===v||v.width>E)&&(v={circle:b,width:E,p1:g,p2:p})}null!==v&&(h.push(v),A+=i(v.circle.radius,v.width),p=g)}}else{var S=e[0];for(n=1;n<e.length;++n)e[n].radius<S.radius&&(S=e[n]);var M=!1;for(n=0;n<e.length;++n)if(a(e[n],S)>Math.abs(S.radius-e[n].radius)){M=!0;break}M?A=u=0:(A=S.radius*S.radius*Math.PI,h.push({circle:S,p1:{x:S.x,y:S.y+S.radius},p2:{x:S.x-r,y:S.y+S.radius},width:2*S.radius}))}return u/=2,t&&(t.area=A+u,t.arcArea=A,t.polygonArea=u,t.arcs=h,t.innerPoints=s,t.intersectionPoints=o),A+u}function i(e,t){return e*e*Math.acos(1-t/e)-(e-t)*Math.sqrt(t*(2*e-t))}function a(e,t){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}function s(e,t,n){if(n>=e+t)return 0;if(n<=Math.abs(e-t))return Math.PI*Math.min(e,t)*Math.min(e,t);var r=t-(n*n-e*e+t*t)/(2*n);return i(e,e-(n*n-t*t+e*e)/(2*n))+i(t,r)}function l(e,t){var n=a(e,t),r=e.radius,o=t.radius;if(n>=r+o||n<=Math.abs(r-o))return[];var i=(r*r-o*o+n*n)/(2*n),s=Math.sqrt(r*r-i*i),l=e.x+i*(t.x-e.x)/n,c=e.y+i*(t.y-e.y)/n,A=-(t.y-e.y)*(s/n),u=-(t.x-e.x)*(s/n);return[{x:l+A,y:c-u},{x:l-A,y:c+u}]}function c(e){for(var t={x:0,y:0},n=0;n<e.length;++n)t.x+=e[n].x,t.y+=e[n].y;return t.x/=e.length,t.y/=e.length,t}function A(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function u(e,t){return A(e).map(function(){return A(t)})}function h(e,t){for(var n=0,r=0;r<e.length;++r)n+=e[r]*t[r];return n}function d(e){return Math.sqrt(h(e,e))}function f(e,t,n){for(var r=0;r<t.length;++r)e[r]=t[r]*n}function p(e,t,n,r,o){for(var i=0;i<e.length;++i)e[i]=t*n[i]+r*o[i]}function g(e,t,n){var r,o=(n=n||{}).maxIterations||200*t.length,i=n.nonZeroDelta||1.05,a=n.zeroDelta||.001,s=n.minErrorDelta||1e-6,l=n.minErrorDelta||1e-5,c=void 0!==n.rho?n.rho:1,A=void 0!==n.chi?n.chi:2,u=void 0!==n.psi?n.psi:-.5,h=void 0!==n.sigma?n.sigma:.5,d=t.length,f=new Array(d+1);f[0]=t,f[0].fx=e(t),f[0].id=0;for(var g=0;g<d;++g){var m=t.slice();m[g]=m[g]?m[g]*i:a,f[g+1]=m,f[g+1].fx=e(m),f[g+1].id=g+1}function v(e){for(var t=0;t<e.length;t++)f[d][t]=e[t];f[d].fx=e.fx}for(var y=function(e,t){return e.fx-t.fx},b=t.slice(),I=t.slice(),x=t.slice(),w=t.slice(),C=0;C<o;++C){if(f.sort(y),n.history){var E=f.map(function(e){var t=e.slice();return t.fx=e.fx,t.id=e.id,t});E.sort(function(e,t){return e.id-t.id}),n.history.push({x:f[0].slice(),fx:f[0].fx,simplex:E})}for(r=0,g=0;g<d;++g)r=Math.max(r,Math.abs(f[0][g]-f[1][g]));if(Math.abs(f[0].fx-f[d].fx)<s&&r<l)break;for(g=0;g<d;++g){b[g]=0;for(var S=0;S<d;++S)b[g]+=f[S][g];b[g]/=d}var M=f[d];if(p(I,1+c,b,-c,M),I.fx=e(I),I.fx<f[0].fx)p(w,1+A,b,-A,M),w.fx=e(w),w.fx<I.fx?v(w):v(I);else if(I.fx>=f[d-1].fx){var k=!1;if(I.fx>M.fx?(p(x,1+u,b,-u,M),x.fx=e(x),x.fx<M.fx?v(x):k=!0):(p(x,1-u*c,b,u*c,M),x.fx=e(x),x.fx<I.fx?v(x):k=!0),k){if(h>=1)break;for(g=1;g<f.length;++g)p(f[g],1-h,f[0],h,f[g]),f[g].fx=e(f[g])}}else v(I)}return f.sort(y),{fx:f[0].fx,x:f[0]}}function m(e,t,n,r,o,i,a){var s=n.fx,l=h(n.fxprime,t),c=s,A=s,u=l,d=0;function f(A,d,f){for(var g=0;g<16;++g)if(o=(A+d)/2,p(r.x,1,n.x,o,t),c=r.fx=e(r.x,r.fxprime),u=h(r.fxprime,t),c>s+i*o*l||c>=f)d=o;else{if(Math.abs(u)<=-a*l)return o;u*(d-A)>=0&&(d=A),A=o,f=c}return 0}o=o||1,i=i||1e-6,a=a||.1;for(var g=0;g<10;++g){if(p(r.x,1,n.x,o,t),c=r.fx=e(r.x,r.fxprime),u=h(r.fxprime,t),c>s+i*o*l||g&&c>=A)return f(d,o,A);if(Math.abs(u)<=-a*l)return o;if(u>=0)return f(o,d,c);A=c,d=o,o*=2}return o}function v(e,t,n){var r,o,i,a={x:t.slice(),fx:0,fxprime:t.slice()},s={x:t.slice(),fx:0,fxprime:t.slice()},l=t.slice(),c=1;i=(n=n||{}).maxIterations||20*t.length,a.fx=e(a.x,a.fxprime),f(r=a.fxprime.slice(),a.fxprime,-1);for(var A=0;A<i;++A){if(c=m(e,r,a,s,c),n.history&&n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice(),alpha:c}),c){p(l,1,s.fxprime,-1,a.fxprime);var u=h(a.fxprime,a.fxprime);p(r,Math.max(0,h(l,s.fxprime)/u),r,-1,s.fxprime),o=a,a=s,s=o}else f(r,a.fxprime,-1);if(d(a.fxprime)<=1e-5)break}return n.history&&n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice(),alpha:c}),a}function y(e,t){(t=t||{}).maxIterations=t.maxIterations||500;var n=t.initialLayout||x,r=t.lossFunction||C;e=function(e){e=e.slice();var t,n,r,o,i=[],a={};for(t=0;t<e.length;++t){var s=e[t];1==s.sets.length?i.push(s.sets[0]):2==s.sets.length&&(a[[r=s.sets[0],o=s.sets[1]]]=!0,a[[o,r]]=!0)}for(i.sort(function(e,t){return e>t}),t=0;t<i.length;++t)for(r=i[t],n=t+1;n<i.length;++n)[r,o=i[n]]in a||e.push({sets:[r,o],size:0});return e}(e);var o,i=n(e,t),a=[],s=[];for(o in i)i.hasOwnProperty(o)&&(a.push(i[o].x),a.push(i[o].y),s.push(o));for(var l=g(function(t){for(var n={},o=0;o<s.length;++o){var a=s[o];n[a]={x:t[2*o],y:t[2*o+1],radius:i[a].radius}}return r(n,e)},a,t).x,c=0;c<s.length;++c)o=s[c],i[o].x=l[2*c],i[o].y=l[2*c+1];return i}var b=1e-10;function I(e,t,n){return Math.min(e,t)*Math.min(e,t)*Math.PI<=n+b?Math.abs(e-t):function(e,t,n,r){var o=(r=r||{}).maxIterations||100,i=r.tolerance||1e-10,a=e(t),s=e(n),l=n-t;if(a*s>0)throw"Initial bisect points must have opposite signs";if(0===a)return t;if(0===s)return n;for(var c=0;c<o;++c){var A=t+(l/=2),u=e(A);if(u*a>=0&&(t=A),Math.abs(l)<i||0===u)return A}return t+l}(function(r){return s(e,t,r)-n},0,e+t)}function x(e,t){var n=w(e,t),r=t.lossFunction||C;if(e.length>=8){var o=function(e,t){var n,r=(t=t||{}).restarts||10,o=[],i={};for(n=0;n<e.length;++n){var a=e[n];1==a.sets.length&&(i[a.sets[0]]=o.length,o.push(a))}var s=function(e,t,n){var r=u(t.length,t.length),o=u(t.length,t.length);return e.filter(function(e){return 2==e.sets.length}).map(function(e){var i=n[e.sets[0]],a=n[e.sets[1]],s=I(Math.sqrt(t[i].size/Math.PI),Math.sqrt(t[a].size/Math.PI),e.size);r[i][a]=r[a][i]=s;var l=0;e.size+1e-10>=Math.min(t[i].size,t[a].size)?l=1:e.size<=1e-10&&(l=-1),o[i][a]=o[a][i]=l}),{distances:r,constraints:o}}(e,o,i),l=s.distances,c=s.constraints,h=d(l.map(d))/l.length;l=l.map(function(e){return e.map(function(e){return e/h})});var p,g,m=function(e,t){return function(e,t,n,r){var o,i=0;for(o=0;o<t.length;++o)t[o]=0;for(o=0;o<n.length;++o)for(var a=e[2*o],s=e[2*o+1],l=o+1;l<n.length;++l){var c=e[2*l],A=e[2*l+1],u=n[o][l],h=r[o][l],d=(c-a)*(c-a)+(A-s)*(A-s),f=Math.sqrt(d),p=d-u*u;h>0&&f<=u||h<0&&f>=u||(i+=2*p*p,t[2*o]+=4*p*(a-c),t[2*o+1]+=4*p*(s-A),t[2*l]+=4*p*(c-a),t[2*l+1]+=4*p*(A-s))}return i}(e,t,l,c)};for(n=0;n<r;++n){g=v(m,A(2*l.length).map(Math.random),t),(!p||g.fx<p.fx)&&(p=g)}var y=p.x,b={};for(n=0;n<o.length;++n){var x=o[n];b[x.sets[0]]={x:y[2*n]*h,y:y[2*n+1]*h,radius:Math.sqrt(x.size/Math.PI)}}if(t.history)for(n=0;n<t.history.length;++n)f(t.history[n].x,h);return b}(e,t);r(o,e)+1e-8<r(n,e)&&(n=o)}return n}function w(e,t){for(var n,r=t&&t.lossFunction?t.lossFunction:C,o={},i={},a=0;a<e.length;++a){var s=e[a];1==s.sets.length&&(n=s.sets[0],o[n]={x:1e10,y:1e10,rowid:o.length,size:s.size,radius:Math.sqrt(s.size/Math.PI)},i[n]=[])}for(e=e.filter(function(e){return 2==e.sets.length}),a=0;a<e.length;++a){var c=e[a],A=c.hasOwnProperty("weight")?c.weight:1,u=c.sets[0],h=c.sets[1];c.size+b>=Math.min(o[u].size,o[h].size)&&(A=0),i[u].push({set:h,size:c.size,weight:A}),i[h].push({set:u,size:c.size,weight:A})}var d=[];for(n in i)if(i.hasOwnProperty(n)){var f=0;for(a=0;a<i[n].length;++a)f+=i[n][a].size*i[n][a].weight;d.push({set:n,size:f})}function p(e,t){return t.size-e.size}d.sort(p);var g={};function m(e){return e.set in g}function v(e,t){o[t].x=e.x,o[t].y=e.y,g[t]=!0}for(v({x:0,y:0},d[0].set),a=1;a<d.length;++a){var y=d[a].set,x=i[y].filter(m);if(n=o[y],x.sort(p),0===x.length)throw"ERROR: missing pairwise overlap information";for(var w=[],E=0;E<x.length;++E){var S=o[x[E].set],M=I(n.radius,S.radius,x[E].size);w.push({x:S.x+M,y:S.y}),w.push({x:S.x-M,y:S.y}),w.push({y:S.y+M,x:S.x}),w.push({y:S.y-M,x:S.x});for(var k=E+1;k<x.length;++k)for(var B=o[x[k].set],D=I(n.radius,B.radius,x[k].size),P=l({x:S.x,y:S.y,radius:M},{x:B.x,y:B.y,radius:D}),Q=0;Q<P.length;++Q)w.push(P[Q])}var T=1e50,G=w[0];for(E=0;E<w.length;++E){o[y].x=w[E].x,o[y].y=w[E].y;var R=r(o,e);R<T&&(T=R,G=w[E])}v(G,y)}return o}function C(e,t){var n=0;function r(t){return t.map(function(t){return e[t]})}for(var i=0;i<t.length;++i){var l,c=t[i];if(1!=c.sets.length){if(2==c.sets.length){var A=e[c.sets[0]],u=e[c.sets[1]];l=s(A.radius,u.radius,a(A,u))}else l=o(r(c.sets));n+=(c.hasOwnProperty("weight")?c.weight:1)*(l-c.size)*(l-c.size)}}return n}function E(e,t,n){var r;if(null===n?e.sort(function(e,t){return t.radius-e.radius}):e.sort(n),e.length>0){var o=e[0].x,i=e[0].y;for(r=0;r<e.length;++r)e[r].x-=o,e[r].y-=i}2==e.length&&(a(e[0],e[1])<Math.abs(e[1].radius-e[0].radius)&&(e[1].x=e[0].x+e[0].radius-e[1].radius-1e-10,e[1].y=e[0].y));if(e.length>1){var s,l,c=Math.atan2(e[1].x,e[1].y)-t,A=Math.cos(c),u=Math.sin(c);for(r=0;r<e.length;++r)s=e[r].x,l=e[r].y,e[r].x=A*s-u*l,e[r].y=u*s+A*l}if(e.length>2){for(var h=Math.atan2(e[2].x,e[2].y)-t;h<0;)h+=2*Math.PI;for(;h>2*Math.PI;)h-=2*Math.PI;if(h>Math.PI){var d=e[1].y/(1e-10+e[1].x);for(r=0;r<e.length;++r){var f=(e[r].x+d*e[r].y)/(1+d*d);e[r].x=2*f-e[r].x,e[r].y=2*f*d-e[r].y}}}}function S(e){function t(e){return e.parent!==e&&(e.parent=t(e.parent)),e.parent}function n(e,n){var r=t(e),o=t(n);r.parent=o}e.map(function(e){e.parent=e});for(var r=0;r<e.length;++r)for(var o=r+1;o<e.length;++o){var i=e[r].radius+e[o].radius;a(e[r],e[o])+1e-10<i&&n(e[o],e[r])}var s,l={};for(r=0;r<e.length;++r)(s=t(e[r]).parent.setid)in l||(l[s]=[]),l[s].push(e[r]);e.map(function(e){delete e.parent});var c=[];for(s in l)l.hasOwnProperty(s)&&c.push(l[s]);return c}function M(e){var t=function(t){return{max:Math.max.apply(null,e.map(function(e){return e[t]+e.radius})),min:Math.min.apply(null,e.map(function(e){return e[t]-e.radius}))}};return{xRange:t("x"),yRange:t("y")}}function k(e,t,n){null===t&&(t=Math.PI/2);var r,o,i=[];for(o in e)if(e.hasOwnProperty(o)){var a=e[o];i.push({x:a.x,y:a.y,radius:a.radius,setid:o})}var s=S(i);for(r=0;r<s.length;++r){E(s[r],t,n);var l=M(s[r]);s[r].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),s[r].bounds=l}s.sort(function(e,t){return t.size-e.size});var c=(i=s[0]).bounds,A=(c.xRange.max-c.xRange.min)/50;function u(e,t,n){if(e){var r,o,a,s=e.bounds;t?r=c.xRange.max-s.xRange.min+A:(r=c.xRange.max-s.xRange.max,(a=(s.xRange.max-s.xRange.min)/2-(c.xRange.max-c.xRange.min)/2)<0&&(r+=a)),n?o=c.yRange.max-s.yRange.min+A:(o=c.yRange.max-s.yRange.max,(a=(s.yRange.max-s.yRange.min)/2-(c.yRange.max-c.yRange.min)/2)<0&&(o+=a));for(var l=0;l<e.length;++l)e[l].x+=r,e[l].y+=o,i.push(e[l])}}for(var h=1;h<s.length;)u(s[h],!0,!1),u(s[h+1],!1,!0),u(s[h+2],!0,!0),h+=3,c=M(i);var d={};for(r=0;r<i.length;++r)d[i[r].setid]=i[r];return d}function B(e,t,n,r){var o=[],i=[];for(var a in e)e.hasOwnProperty(a)&&(i.push(a),o.push(e[a]));t-=2*r,n-=2*r;var s=M(o),l=s.xRange,c=s.yRange;if(l.max==l.min||c.max==c.min)return console.log("not scaling solution: zero size detected"),e;for(var A=t/(l.max-l.min),u=n/(c.max-c.min),h=Math.min(u,A),d=(t-(l.max-l.min)*h)/2,f=(n-(c.max-c.min)*h)/2,p={},g=0;g<o.length;++g){var m=o[g];p[i[g]]={radius:h*m.radius,x:r+d+(m.x-l.min)*h,y:r+f+(m.y-c.min)*h}}return p}function D(e,n){return function(){for(var r,o=t.select(this),i=o.datum(),a=e[i.sets[0]].radius||50,s=n(i)||"",l=s.split(/\s+/).reverse(),c=(s.length+l.length)/3,A=l.pop(),u=[A],h=0,d=o.text(null).append("tspan").text(A);A=l.pop();)u.push(A),r=u.join(" "),d.text(r),r.length>c&&d.node().getComputedTextLength()>a&&(u.pop(),d.text(u.join(" ")),u=[A],d=o.append("tspan").text(A),h++);var f=.35-1.1*h/2,p=o.attr("x"),g=o.attr("y");o.selectAll("tspan").attr("x",p).attr("y",g).attr("dy",function(e,t){return f+1.1*t+"em"})}}function P(e,t,n){var r,o,i=t[0].radius-a(t[0],e);for(r=1;r<t.length;++r)(o=t[r].radius-a(t[r],e))<=i&&(i=o);for(r=0;r<n.length;++r)(o=a(n[r],e)-n[r].radius)<=i&&(i=o);return i}function Q(e,t){var n,r=[];for(n=0;n<e.length;++n){var i=e[n];r.push({x:i.x,y:i.y}),r.push({x:i.x+i.radius/2,y:i.y}),r.push({x:i.x-i.radius/2,y:i.y}),r.push({x:i.x,y:i.y+i.radius/2}),r.push({x:i.x,y:i.y-i.radius/2})}var s=r[0],l=P(r[0],e,t);for(n=1;n<r.length;++n){var A=P(r[n],e,t);A>=l&&(s=r[n],l=A)}var u=g(function(n){return-1*P({x:n[0],y:n[1]},e,t)},[s.x,s.y],{maxIterations:500,minErrorDelta:1e-10}).x,h={x:u[0],y:u[1]},d=!0;for(n=0;n<e.length;++n)if(a(h,e[n])>e[n].radius){d=!1;break}for(n=0;n<t.length;++n)if(a(h,t[n])<t[n].radius){d=!1;break}if(!d)if(1==e.length)h={x:e[0].x,y:e[0].y};else{var f={};o(e,f),h=0===f.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==f.arcs.length?{x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:t.length?Q(e,[]):c(f.arcs.map(function(e){return e.p1}))}return h}function T(e){var t={},n=[];for(var r in e)n.push(r),t[r]=[];for(var o=0;o<n.length;o++)for(var i=e[n[o]],s=o+1;s<n.length;++s){var l=e[n[s]],c=a(i,l);c+l.radius<=i.radius+1e-10?t[n[s]].push(n[o]):c+i.radius<=l.radius+1e-10&&t[n[o]].push(n[s])}return t}function G(e,t){for(var n={},r=T(e),o=0;o<t.length;++o){for(var i=t[o].sets,a={},s={},l=0;l<i.length;++l){a[i[l]]=!0;for(var c=r[i[l]],A=0;A<c.length;++A)s[c[A]]=!0}var u=[],h=[];for(var d in e)d in a?u.push(e[d]):d in s||h.push(e[d]);var f=Q(u,h);n[i]=f,f.disjoint&&t[o].size>0&&console.log("WARNING: area "+i+" not represented on screen")}return n}function R(e,t,n){var r=[];return r.push("\nM",e,t),r.push("\nm",-n,0),r.push("\na",n,n,0,1,0,2*n,0),r.push("\na",n,n,0,1,0,2*-n,0),r.join(" ")}function _(e){var t=e.split(" ");return{x:parseFloat(t[1]),y:parseFloat(t[2]),radius:-parseFloat(t[4])}}function V(e){var t={};o(e,t);var n=t.arcs;if(0===n.length)return"M 0 0";if(1==n.length){var r=n[0].circle;return R(r.x,r.y,r.radius)}for(var i=["\nM",n[0].p2.x,n[0].p2.y],a=0;a<n.length;++a){var s=n[a],l=s.circle.radius,c=s.width>l;i.push("\nA",l,l,0,c?1:0,1,s.p1.x,s.p1.y)}return i.join(" ")}e.intersectionArea=o,e.circleCircleIntersection=l,e.circleOverlap=s,e.circleArea=i,e.distance=a,e.venn=y,e.greedyLayout=w,e.scaleSolution=B,e.normalizeSolution=k,e.bestInitialLayout=x,e.lossFunction=C,e.disjointCluster=S,e.distanceFromIntersectArea=I,e.VennDiagram=function(){var e=600,n=350,r=15,o=1e3,i=Math.PI/2,a=!0,s=!0,l=!0,c=null,A=null,u={},h=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],d=0,f=function(e){if(e in u)return u[e];var t=u[e]=h[d];return(d+=1)>=h.length&&(d=0),t},p=y,g=C;function m(u){var h=u.datum(),d={};h.forEach(function(e){0==e.size&&1==e.sets.length&&(d[e.sets[0]]=1)});var m={},v={};if((h=h.filter(function(e){return!e.sets.some(function(e){return e in d})})).length>0){var y=p(h,{lossFunction:g});a&&(y=k(y,i,A)),m=B(y,e,n,r),v=G(m,h)}var b={};function I(e){return e.sets in b?b[e.sets]:1==e.sets.length?""+e.sets[0]:void 0}h.forEach(function(e){e.label&&(b[e.sets]=e.label)}),u.selectAll("svg").data([m]).enter().append("svg");var x=u.select("svg").attr("width",e).attr("height",n),w={},C=!1;x.selectAll(".venn-area path").each(function(e){var n=t.select(this).attr("d");1==e.sets.length&&n&&(C=!0,w[e.sets[0]]=_(n))});var E=function(t){return function(r){return V(t.sets.map(function(t){var o=w[t],i=m[t];return o||(o={x:e/2,y:n/2,radius:1}),i||(i={x:e/2,y:n/2,radius:1}),{x:o.x*(1-r)+i.x*r,y:o.y*(1-r)+i.y*r,radius:o.radius*(1-r)+i.radius*r}}))}},S=x.selectAll(".venn-area").data(h,function(e){return e.sets}),M=S.enter().append("g").attr("class",function(e){return"venn-area venn-"+(1==e.sets.length?"circle":"intersection")}).attr("data-venn-sets",function(e){return e.sets.join("_")}),P=M.append("path"),Q=M.append("text").attr("class","label").text(function(e){return I(e)}).attr("text-anchor","middle").attr("dy",".35em").attr("x",e/2).attr("y",n/2);l&&(P.style("fill-opacity","0").filter(function(e){return 1==e.sets.length}).style("fill",function(e){return f(e.sets)}).style("fill-opacity",".25"),Q.style("fill",function(e){return 1==e.sets.length?f(e.sets):"#444"}));var T=u;C?(T=u.transition("venn").duration(o)).selectAll("path").attrTween("d",E):T.selectAll("path").attr("d",function(e){return V(e.sets.map(function(e){return m[e]}))});var R=T.selectAll("text").filter(function(e){return e.sets in v}).text(function(e){return I(e)}).attr("x",function(e){return Math.floor(v[e.sets].x)}).attr("y",function(e){return Math.floor(v[e.sets].y)});s&&(C?"on"in R?R.on("end",D(m,I)):R.each("end",D(m,I)):R.each(D(m,I)));var N=S.exit().transition("venn").duration(o).remove();N.selectAll("path").attrTween("d",E);var F=N.selectAll("text").attr("x",e/2).attr("y",n/2);return null!==c&&(Q.style("font-size","0px"),R.style("font-size",c),F.style("font-size","0px")),{circles:m,textCentres:v,nodes:S,enter:M,update:T,exit:N}}return m.wrap=function(e){return arguments.length?(s=e,m):s},m.width=function(t){return arguments.length?(e=t,m):e},m.height=function(e){return arguments.length?(n=e,m):n},m.padding=function(e){return arguments.length?(r=e,m):r},m.colours=function(e){return arguments.length?(f=e,m):f},m.fontSize=function(e){return arguments.length?(c=e,m):c},m.duration=function(e){return arguments.length?(o=e,m):o},m.layoutFunction=function(e){return arguments.length?(p=e,m):p},m.normalize=function(e){return arguments.length?(a=e,m):a},m.styled=function(e){return arguments.length?(l=e,m):l},m.orientation=function(e){return arguments.length?(i=e,m):i},m.orientationOrder=function(e){return arguments.length?(A=e,m):A},m.lossFunction=function(e){return arguments.length?(g=e,m):g},m},e.wrapText=D,e.computeTextCentres=G,e.computeTextCentre=Q,e.sortAreas=function(e,t){for(var n=T(e.selectAll("svg").datum()),r={},o=0;o<t.sets.length;++o){var i=t.sets[o];for(var a in n)for(var s=n[a],l=0;l<s.length;++l)if(s[l]==i){r[a]=!0;break}}function c(e){for(var t=0;t<e.length;++t)if(!(e[t]in r))return!1;return!0}e.selectAll("g").sort(function(e,n){return e.sets.length!=n.sets.length?e.sets.length-n.sets.length:e==t?c(n.sets)?-1:1:n==t?c(e.sets)?1:-1:n.size-e.size})},e.circlePath=R,e.circleFromPath=_,e.intersectionAreaPath=V,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(2),n(123))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VolcanoMutexEntry=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(105);t.VolcanoMutexEntry=function(){function e(t,n,o,a,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.volcanoItemIndex=0,this.identifier=t,this.mutexEntryType=l,this.mutexEntrySecondaryType=c,this.x=0,this.y=0;var A=e.generateContingencyTable(o,a,s),u=r(A,4),h=u[0],d=u[1],f=u[2],p=u[3];if(f){if(this.quant=1/d,this.subcohort1MutRatio=h[0][0]/d,this.subcohort1WtRatio=h[1][0]/d,this.subcohort2MutRatio=h[1][0]/d,this.subcohort2WtRatio=h[1][1]/d,this.subcohort1Mut=h[0][0],this.subcohort1Wt=h[0][1],this.subcohort2Mut=h[1][0],this.subcohort2Wt=h[1][1],this.totalMut=o.size,p){var g=[h[1],h[0]];h[0]=g[0],h[1]=g[1]}this.pValLog10=-Math.log10(i.StatsTests.fisherExactNonCentered(h,1))}else this.pValLog10=-1}return o(e,[{key:"generateVennSets",value:function(e,t,n,r){var o=this.getName(e);return[{sets:[t],size:this.subcohort1Mut+this.subcohort1Wt,label:t+"\n("+this.subcohort1Wt+")"},{sets:[n],size:this.subcohort2Mut+this.subcohort2Wt,label:n+"\n("+this.subcohort2Wt+")"},{sets:[t,n],size:r.size,label:""+r.size},{sets:[o],size:this.totalMut},{sets:[o,t],size:this.subcohort1Mut,label:""+this.subcohort1Mut},{sets:[o,n],size:this.subcohort2Mut,label:""+this.subcohort2Mut}]}},{key:"addNoise",value:function(){return Math.random()*this.quant*.8-.4*this.quant}},{key:"setX",value:function(){this.subcohort1MutRatio>=this.subcohort2MutRatio?this.x=this.subcohort1MutRatio+this.addNoise():this.x=-(this.subcohort2MutRatio+this.addNoise())}},{key:"setY",value:function(e){this.y=this.pValLog10}},{key:"getGeneIndices",value:function(e){return 3===this.mutexEntryType?[this.identifier]:[]}},{key:"getName",value:function(t){switch(this.mutexEntryType){case 3:return t.genes.get(this.identifier).geneName;case 2:return t.tads[this.identifier].printTadRange(t)+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 1:return t.cytobands[this.identifier].cytobandName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 0:return t.chromosomeArms[this.identifier].chromosomeArmName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);default:return""}}},{key:"getHoverLabel",value:function(t){switch(this.mutexEntryType){case 3:var n=[];return t.genes.get(this.identifier).cytobandIndices.forEach(function(e){n.push(t.cytobands[e].cytobandName)}),t.genes.get(this.identifier).geneName+"\n("+n.join(",")+")";case 2:return t.tads[this.identifier].printTadRange(t)+" ("+t.tads[this.identifier].printCytobandHits(t)+") "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 1:return t.cytobands[this.identifier].cytobandName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 0:return t.chromosomeArms[this.identifier].chromosomeArmName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);default:return""}}},{key:"getLabel",value:function(t){switch(this.mutexEntryType){case 3:var n=[];return t.genes.get(this.identifier).cytobandIndices.forEach(function(e){n.push(t.cytobands[e].cytobandName)}),t.genes.get(this.identifier).getGeneCardsLinkPlain()+" ("+n.join(",")+")";case 2:return t.tads[this.identifier].printTadRange(t)+" ("+t.tads[this.identifier].printCytobandHits(t)+") "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 1:return t.cytobands[this.identifier].cytobandName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);case 0:return t.chromosomeArms[this.identifier].chromosomeArmName+" "+e.getSecondaryDescription(this.mutexEntrySecondaryType);default:return""}}},{key:"textExport",value:function(e){var t=[];return t.push(this.getName(e)),t.push(this.pValLog10),t.push(this.subcohort1MutRatio),t.push(this.subcohort1WtRatio),t.push(this.subcohort2MutRatio),t.push(this.subcohort2WtRatio),t.push(this.subcohort1Mut),t.push(this.subcohort1Wt),t.push(this.subcohort2Mut),t.push(this.subcohort2Wt),t}}],[{key:"getSecondaryDescription",value:function(e){return["","Gain","Loss","LOH","cnLOH","LossOrLOH","SV"][e]}},{key:"generateContingencyTable",value:function(e,t,n){var r=[[0,0],[0,0]],o=0;t.forEach(function(t){e.has(t)?r[0][0]+=1:r[0][1]+=1,o+=1}),n.forEach(function(t){e.has(t)?r[1][0]+=1:r[1][1]+=1,o+=1});var i=r[0][0]+r[0][1]>0&&r[1][0]+r[1][1]>0&&r[0][1]+r[1][1]>0&&r[0][0]+r[1][0]>0,a=r[0][0]<r[1][0];return[r,o,i,a]}},{key:"generalHeaderExport",value:function(){return["Item","pValLog10","subcohort1MutRatio","subcohort1WtRatio","subcohort2MutRatio","subcohort2WtRatio","subcohort1Mut","subcohort1Wt","subcohort2Mut","subcohort2Wt"]}},{key:"createVolcanoMutexEntryChromosomeArm",value:function(t,n,r,o,i,a){return new e(t,n,r,o,i,0,a)}},{key:"createVolcanoMutexEntryCytoband",value:function(t,n,r,o,i,a){return new e(t,n,r,o,i,1,a)}},{key:"createVolcanoMutexEntryTad",value:function(t,n,r,o,i,a){return new e(t,n,r,o,i,2,a)}},{key:"createVolcanoMutexEntryGene",value:function(t,n,r,o,i){return new e(t,n,r,o,i,3,-1)}}]),e}()},function(e,t){var n=[.254829592,-.284496736,1.421413741,-1.453152027,1.061405429];t.erf=function(e){var t=1;e<0&&(t=-1);var r=1/(1+.3275911*(e=Math.abs(e)));return t*(1-((((n[4]*r+n[3])*r+n[2])*r+n[1])*r+n[0])*r*Math.exp(-e*e))};var r=1.1283791670955126,o=[-2.8e-17,1.21e-16,-9.4e-17,-1.523e-15,7.106e-15,3.81e-16,-1.12708e-13,3.13092e-13,8.94487e-13,-6.886027e-12,2.394038e-12,9.6467911e-11,-2.27365122e-10,-9.91364156e-10,5.059343495e-9,6.529054439e-9,-8.5238095915e-8,1.5626441722e-8,130365583558e-17,-1624290004647e-18,-20278578112534e-18,42523324806907e-18,.000366839497852761,-.000946595344482036,-.00956151478680863,.019476473204185836,.6419697923564902,-1.3026537197817094],i=o[o.length-1];function a(e){function t(e){for(var t=0,n=0,r=0,a=2/(2+e),s=4*a-2,l=0,c=o.length-1;l<c;l++)r=t,t=s*t-n+o[l],n=r;return a*Math.exp(-e*e+.5*(i+s*t)-n)}return e>=0?t(e):2-t(-e)}function s(e){if(e<0||e>2)throw RangeError("Argument must be betweeen 0 and 2");if(0===e)return 1/0;if(2===e)return-1/0;var t=e<1?e:2-e,n=Math.sqrt(-2*Math.log(t/2)),o=-.70711*((2.30753+.27061*n)/(1+n*(.99229+.04481*n))-n),i=a(o)-t,s=a(o+=i/(r*Math.exp(-o*o)-o*i))-t;return o+=s/(r*Math.exp(-o*o)-o*s),e<1?o:-o}t.erfc=a,t.invErfc=s,t.invErf=function(e){if(e<-1||e>1)throw RangeError("Argument must be betweeen -1 and 1");return-s(e+1)}},function(e,t,n){var r=n(99),o=n(98).log1p;function i(e,t){if(e<0||t<0)throw RangeError("Arguments must be positive.");return 0===e&&0===t?NaN:0===e||0===t?1/0:e+t>170?Math.exp(r.betaln(e,t)):r.gamma(e)*r.gamma(t)/r.gamma(e+t)}function a(e,t,n){var r,o,i,a,s,l,c,A,u,h=1;for(A=t-1,i=1,a=1-(c=t+n)*e/(u=t+1),Math.abs(a)<1e-30&&(a=1e-30),l=a=1/a;h<=100&&(a=1+(o=h*(n-h)*e/((A+(r=2*h))*(t+r)))*a,Math.abs(a)<1e-30&&(a=1e-30),i=1+o/i,Math.abs(i)<1e-30&&(i=1e-30),l*=(a=1/a)*i,a=1+(o=-(t+h)*(c+h)*e/((t+r)*(u+r)))*a,Math.abs(a)<1e-30&&(a=1e-30),i=1+o/i,Math.abs(i)<1e-30&&(i=1e-30),l*=s=(a=1/a)*i,!(Math.abs(s-1)<3e-7));h++);return l}function s(e,t,n){if(e<0||e>1)throw new RangeError("First argument must be between 0 and 1.");if(1===t&&1===n)return e;if(0===e)return 0;if(1===e)return 1;if(0===t)return 1;if(0===n)return 0;var i=Math.exp(r.logGamma(t+n)-r.logGamma(t)-r.logGamma(n)+t*Math.log(e)+n*o(-e));return e<(t+1)/(t+n+2)?i*a(e,t,n)/t:1-i*a(1-e,n,t)/n}t.beta=i,t.logBeta=function(e,t){if(e<0||t<0)throw RangeError("Arguments must be positive.");return 0===e&&0===t?NaN:0===e||0===t?1/0:r.logGamma(e)+r.logGamma(t)-r.logGamma(e+t)},t.incBeta=function(e,t,n){return s(e,t,n)*i(t,n)},t.invIncBeta=function(e,t,n){if(u<0||u>1)throw new RangeError("First argument must be between 0 and 1.");if(1===t&&1===n)return e;if(1===e)return 1;if(0===e)return 0;if(0===t)return 0;if(0===n)return 1;var i,a,l,c,A,u,h,d,f,p,g=t-1,m=n-1,v=0;for(t>=1&&n>=1?(l=e<.5?e:1-e,u=(2.30753+.27061*(c=Math.sqrt(-2*Math.log(l))))/(1+c*(.99229+.04481*c))-c,e<.5&&(u=-u),h=(u*u-3)/6,d=2/(1/(2*t-1)+1/(2*n-1)),f=u*Math.sqrt(h+d)/d-(1/(2*n-1)-1/(2*t-1))*(h+5/6-2/(3*d)),u=t/(t+n*Math.exp(2*f))):(i=Math.log(t/(t+n)),a=Math.log(n/(t+n)),u=e<(c=Math.exp(t*i)/t)/(f=c+(A=Math.exp(n*a)/n))?Math.pow(t*f*e,1/t):1-Math.pow(n*f*(1-e),1/n)),p=-r.logGamma(t)-r.logGamma(n)+r.logGamma(t+n);v<10;v++){if(0===u||1===u)return u;if((u-=c=(A=(s(u,t,n)-e)/(c=Math.exp(g*Math.log(u)+m*o(-u)+p)))/(1-.5*Math.min(1,A*(g/u-m/(1-u)))))<=0&&(u=.5*(u+c)),u>=1&&(u=.5*(u+c+1)),Math.abs(c)<1e-8*u&&v>0)break}return u}},function(e,t,n){function r(e){for(var n=Object.keys(e),r=0,o=n.length;r<o;r++)t[n[r]]=e[n[r]]}r(n(275)),r(n(274)),r(n(99)),r(n(98))},function(e,t){var n=[Array,Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];function r(e,t){if(!(this instanceof r))return new r(e,t);if(-1===n.indexOf(e.constructor))throw TypeError("data must be an array");this._data=e,this._sorted=!!t,this._length=e.length,this._cache_sum=null,this._cache_mode=null,this._cache_mean=null,this._cache_quartiles={},this._cache_variance=null,this._cache_sd=null,this._cache_max=null,this._cache_min=null}e.exports=r,r.prototype.sort=function(){return!1===this._sorted&&(this._sorted=!0,this._data=this._data.sort(function(e,t){return e-t})),this._data},r.prototype.size=function(){return this._length},r.prototype.sum=function(){if(null===this._cache_sum){for(var e=0,t=0;t<this._length;t++)e+=this._data[t];this._cache_sum=e}return this._cache_sum},r.prototype.mode=function(){if(null===this._cache_mode){for(var e=this.sort(),t=NaN,n=0,r=e[0],o=1,i=1;i<this._length;i++)e[i]===r?o+=1:(o>=n&&(n=o,t=r),r=e[i],o=1);o>=n&&(n=o,t=r),this._cache_mode=t}return this._cache_mode},r.prototype.mean=function(){return null===this._cache_mean&&(this._cache_mean=this.sum()/this._length),this._cache_mean},r.prototype.quartile=function(e){if(!this._cache_quartiles.hasOwnProperty(e)){var t=this.sort(),n=e*this.size(),r=Math.ceil(n);r===n?0===r?this._cache_quartiles[e]=t[0]:r===t.length?this._cache_quartiles[e]=t[t.length-1]:this._cache_quartiles[e]=(t[r-1]+t[r])/2:this._cache_quartiles[e]=t[r-1]}return this._cache_quartiles[e]},r.prototype.median=function(){return this.quartile(.5)},r.prototype.variance=function(){if(null===this._cache_variance){for(var e=this.mean(),t=0,n=0;n<this._length;n++)t+=(this._data[n]-e)*(this._data[n]-e);this._cache_variance=t/(this._length-1)}return this._cache_variance},r.prototype.sd=function(){return null===this._cache_sd&&(this._cache_sd=Math.sqrt(this.variance())),this._cache_sd},r.prototype.max=function(){return null===this._cache_max&&(this._cache_max=this.sort()[this._length-1]),this._cache_max},r.prototype.min=function(){return null===this._cache_min&&(this._cache_min=this.sort()[0]),this._cache_min}},function(e,t,n){"use strict";const r=n(51).Studentt,o=n(49),i=n(48);function a(e,t,n){i.call(this,n);const o=e.variance/e.size,a=t.variance/t.size,s=o+a;this._df=Math.pow(s,2)/(Math.pow(o,2)/(e.size-1)+Math.pow(a,2)/(t.size-1)),this._dist=new r(this._df),this._se=Math.sqrt(s),this._mean=e.mean-t.mean}o.inherits(a,i),e.exports=a},function(e,t,n){"use strict";const r=n(51).Studentt,o=n(49),i=n(48);function a(e,t,n){i.call(this,n),this._df=e.size+t.size-2,this._dist=new r(this._df);const o=((e.size-1)*e.variance+(t.size-1)*t.variance)/this._df;this._se=Math.sqrt(o*(1/e.size+1/t.size)),this._mean=e.mean-t.mean}o.inherits(a,i),e.exports=a},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t,n){var r=n(50);function o(e,t){if(!(this instanceof o))return new o(e,t);if("number"!=typeof e)throw TypeError("properbility must be a number");if("number"!=typeof t)throw TypeError("size must be a number");if(t<=0)throw TypeError("size must be positive");if(e<0||e>1)throw TypeError("properbility must be between 0 and 1");this._properbility=e,this._size=t}e.exports=o,o.prototype.pdf=function(e){var t=this._size,n=this._properbility;return r.gamma(t+1)/(r.gamma(e+1)*r.gamma(t-e+1))*Math.pow(n,e)*Math.pow(1-n,t-e)},o.prototype.cdf=function(e){return r.bdtr(e,this._size,this._properbility)},o.prototype.inv=function(e){throw new Error("Inverse CDF of binomial distribution is not implemented")},o.prototype.median=function(){return Math.round(this._properbility*this._size)},o.prototype.mean=function(){return this._properbility*this._size},o.prototype.variance=function(){return this._properbility*this._size*(1-this._properbility)}},function(e,t){function n(e,t){if(!(this instanceof n))return new n(e,t);if("number"!=typeof e&&void 0!==e)throw TypeError("mean must be a number");if("number"!=typeof t&&void 0!==t)throw TypeError("sd must be a number");if(this._a="number"==typeof e?e:0,this._b="number"==typeof t?t:1,this._b<=this._a)throw new RangeError("a must be greater than b");this._k=1/(this._b-this._a),this._mean=(this._a+this._b)/2,this._var=(this._a-this._b)*(this._a-this._b)/12}e.exports=n,n.prototype.pdf=function(e){return e<this._a||e>this._b?0:this._k},n.prototype.cdf=function(e){return e<this._a?0:e>this._b?1:(e-this._a)*this._k},n.prototype.inv=function(e){return e<0||e>1?NaN:e*(this._b-this._a)+this._a},n.prototype.median=function(){return this._mean},n.prototype.mean=function(){return this._mean},n.prototype.variance=function(){return this._var}},function(e,t,n){var r=n(50);function o(e){if(!(this instanceof o))return new o(e);if("number"!=typeof e)throw TypeError("mean must be a number");if(e<=0)throw RangeError("df must be a positive number");this._df=e,this._pdf_const=r.gamma((e+1)/2)/(Math.sqrt(e*Math.PI)*r.gamma(e/2)),this._pdf_exp=-(e+1)/2,this._df_half=e/2}e.exports=o,o.prototype.pdf=function(e){return this._pdf_const*Math.pow(1+e*e/this._df,this._pdf_exp)},o.prototype.cdf=function(e){return r.stdtr(this._df,e)},o.prototype.inv=function(e){return e<=0?-1/0:e>=1?1/0:r.stdtri(this._df,e)},o.prototype.median=function(){return 0},o.prototype.mean=function(){return this._df>1?0:void 0},o.prototype.variance=function(){return this._df>2?this._df/(this._df-2):this._df>1?1/0:void 0}},function(e){e.exports="AGFzbQEAAAABkwEWYAJ/fwF/YAF/AX9gAAF/YAF/AGACf38AYAF8AXxgBXx/f39/AX9gAnx8AXxgA39/fAF8YAN8fHwBfGADfH9/AXxgBnx8f39/fwF/YAJ/fAF8YAJ8fwF8YAF/AXxgA3x/fwF/YAR8fHx8AXxgBXx8fHx/AXxgBXx8fH9/AXxgAXwBf2AEf3x/fwF8YAR8f39/AX8CHgIDZW52B19tdGhlcnIAAANlbnYGbWVtb3J5AgEgIAONAYsBAQIDBAUGBQUFBQcFCAgIBwcJBQoHBwcFBQUHBwULBQUFBQwNDggICA0NDwUFCQkQEQkSBQUFBQcHBwkJCRMTEwcFBQUFDAcHBxQFBQUFDAwFDAUFBQUICAgFBQUFDAwMBwcHBQoKDAcNBQUFDw8FBQkVBQUFBQwMEREHBwUNBQUNBQUFBQUMBwUBAwYQAn8BQeCAAQt/AUHggMEACweMEIQBDF9jZXBoZXNfYWNvcwAIDV9jZXBoZXNfYWNvc2gABQxfY2VwaGVzX2FpcnkABgxfY2VwaGVzX2FzaW4ABw1fY2VwaGVzX2FzaW5oAAkMX2NlcGhlc19hdGFuAAoNX2NlcGhlc19hdGFuMgALDV9jZXBoZXNfYXRhbmgADAxfY2VwaGVzX2JkdHIADg1fY2VwaGVzX2JkdHJjAA0NX2NlcGhlc19iZHRyaQAPDF9jZXBoZXNfYmV0YQAQDV9jZXBoZXNfYnRkdHIAEgxfY2VwaGVzX2NicnQAEw5fY2VwaGVzX2NoYmV2bAAUDV9jZXBoZXNfY2hkdHIAFg5fY2VwaGVzX2NoZHRyYwAVDl9jZXBoZXNfY2hkdHJpABcLX2NlcGhlc19jb3MAcA1fY2VwaGVzX2Nvc2RnAHQMX2NlcGhlc19jb3NoABgNX2NlcGhlc19jb3NtMQCGAQtfY2VwaGVzX2NvdAB/DV9jZXBoZXNfY290ZGcAggENX2NlcGhlc19kYXdzbgAZCl9jZXBoZXNfZWkAGg1fY2VwaGVzX2VsbGllABsNX2NlcGhlc19lbGxpawAcDV9jZXBoZXNfZWxscGUAHQ1fY2VwaGVzX2VsbHBqAB4NX2NlcGhlc19lbGxwawAfC19jZXBoZXNfZXJmAFwMX2NlcGhlc19lcmZjAFsLX2NlcGhlc19leHAAIA1fY2VwaGVzX2V4cDEwACEMX2NlcGhlc19leHAyACINX2NlcGhlc19leHBtMQCFAQxfY2VwaGVzX2V4cG4AIw1fY2VwaGVzX2V4cHgyACQLX2NlcGhlc19mYWMAJQxfY2VwaGVzX2ZkdHIAJw1fY2VwaGVzX2ZkdHJjACYNX2NlcGhlc19mZHRyaQAoDl9jZXBoZXNfZnJlc25sACsNX2NlcGhlc19mcmV4cAApDV9jZXBoZXNfZ2FtbWEALAxfY2VwaGVzX2dkdHIALg1fY2VwaGVzX2dkdHJjAC8OX2NlcGhlc19oeXAyZjAAMw5fY2VwaGVzX2h5cDJmMQAwDl9jZXBoZXNfaHlwZXJnADIKX2NlcGhlc19pMAA0C19jZXBoZXNfaTBlADUKX2NlcGhlc19pMQA2C19jZXBoZXNfaTFlADcMX2NlcGhlc19pZ2FtADkNX2NlcGhlc19pZ2FtYwA4DV9jZXBoZXNfaWdhbWkAOg5fY2VwaGVzX2luY2JldAA7DV9jZXBoZXNfaW5jYmkAPRBfY2VwaGVzX2lzZmluaXRlAEANX2NlcGhlc19pc25hbgA/Cl9jZXBoZXNfaXYAQQpfY2VwaGVzX2owAEIKX2NlcGhlc19qMQBECl9jZXBoZXNfam4ARgpfY2VwaGVzX2p2AEcKX2NlcGhlc19rMABLC19jZXBoZXNfazBlAEwKX2NlcGhlc19rMQBNC19jZXBoZXNfazFlAE4KX2NlcGhlc19rbgBPD19jZXBoZXNfa29sbW9naQBTEl9jZXBoZXNfa29sbW9nb3JvdgBRDV9jZXBoZXNfbGJldGEAEQ1fY2VwaGVzX2xkZXhwACoMX2NlcGhlc19sZ2FtAC0LX2NlcGhlc19sb2cAVA1fY2VwaGVzX2xvZzEwAFUNX2NlcGhlc19sb2cxcACEAQxfY2VwaGVzX2xvZzIAVg1fY2VwaGVzX25iZHRyAFgOX2NlcGhlc19uYmR0cmMAVw5fY2VwaGVzX25iZHRyaQBZDF9jZXBoZXNfbmR0cgBaDV9jZXBoZXNfbmR0cmkAXQ1fY2VwaGVzX29uZWYyAHkNX2NlcGhlc19wMWV2bABmDF9jZXBoZXNfcGR0cgBfDV9jZXBoZXNfcGR0cmMAXg1fY2VwaGVzX3BkdHJpAGAPX2NlcGhlc19wbGFuY2tjAGIPX2NlcGhlc19wbGFuY2tkAGMPX2NlcGhlc19wbGFuY2tpAGEPX2NlcGhlc19wbGFuY2t3AGQOX2NlcGhlc19wb2xldmwAZQ9fY2VwaGVzX3BvbHlsb2cAZwtfY2VwaGVzX3BvdwBoDF9jZXBoZXNfcG93aQBpC19jZXBoZXNfcHNpAGoOX2NlcGhlc19yYWRpYW4AcQ5fY2VwaGVzX3JnYW1tYQBrDV9jZXBoZXNfcm91bmQAbA5fY2VwaGVzX3NoaWNoaQBtDF9jZXBoZXNfc2ljaQBuD19jZXBoZXNfc2lnbmJpdAA+C19jZXBoZXNfc2luAG8OX2NlcGhlc19zaW5jb3MAcg1fY2VwaGVzX3NpbmRnAHMMX2NlcGhlc19zaW5oAHUPX2NlcGhlc19zbWlybm92AFAQX2NlcGhlc19zbWlybm92aQBSDl9jZXBoZXNfc3BlbmNlAHYNX2NlcGhlc19zdGR0cgB3Dl9jZXBoZXNfc3RkdHJpAHgOX2NlcGhlc19zdHJ1dmUAewtfY2VwaGVzX3RhbgB9DV9jZXBoZXNfdGFuZGcAgAEMX2NlcGhlc190YW5oAIMBD19jZXBoZXNfdGhyZWVmMAB6Cl9jZXBoZXNfeTAAQwpfY2VwaGVzX3kxAEUKX2NlcGhlc195bgCHAQpfY2VwaGVzX3l2AHwMX2NlcGhlc196ZXRhAIgBDV9jZXBoZXNfemV0YWMAiQEFX2ZyZWUAiwEHX21hbGxvYwCKARNlc3RhYmxpc2hTdGFja1NwYWNlAAQKc3RhY2tBbGxvYwABDHN0YWNrUmVzdG9yZQADCXN0YWNrU2F2ZQACCo39AosBGwEBfyMAIQEgACMAaiQAIwBBD2pBcHEkACABCwQAIwALBgAgACQACwoAIAAkACABJAELmgEBAXwgAEQAAAAAAADwP2MEQEGA8wBBARAAGkHw8gArAwAPCyAARAAAAACE15dBZARAQejyACsDACIBIABhBEAgAQ8LIAAQVEHQ8gArAwCgDwsgAEQAAAAAAADwv6AiAUQAAAAAAADgP2MEfCABnyABQYAIQQQQZSABQbAIQQUQZqOiBSABIABEAAAAAAAA8D+gop8gAKAQVAsLigkCAX8IfCAARAwCK4cW+VlAZARAIAFEAAAAAAAAAAA5AwAgAkQAAAAAAAAAADkDACADQZjyACsDADkDACAEQZjyACsDADkD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aGR0cgBjaGR0cmkAY29zaABlaQBlbGxpawBlbGxwZQBlbGxwagBlbGxwawBleHBuAGZhYwBmZHRyYwBmZHRyAGZkdHJpAGdhbW1hAGxnYW0AZ2R0cgBnZHRyYwBoeXAyZjEAaHlwZXJnAGlnYW1jAGlnYW0AaWdhbWkAaW5jYmV0AGluY2JpAGl2AHkwAHkxAEp2AGp2AGswAGswZQBrMQBrMWUAa24Ac21pcm5vdmkAa29sbW9naQBsb2cAbG9nMTAAbG9nMgBuYmR0cgBuYmR0cmkAZXJmYwBuZHRyaQBwZHRyYwBwZHRyAHBkdHJpAHBvbHlsb2cAcG93AHBvdwBwb3dpAHBzaQByZ2FtbWEAc2luAGNvcwBzaW5kZwBjb3NkZwBzaW5oAHNwZW5jZQBzdGR0cgBzdGR0cmkAdGFuAGNvdAB0YW5kZwBjb3RkZwB5bgB6ZXRhAHpldGFjANoPBG5hbWUB0g+MAQAHX210aGVycgEKc3RhY2tBbGxvYwIJc3RhY2tTYXZlAwxzdGFja1Jlc3RvcmUEE2VzdGFibGlzaFN0YWNrU3BhY2UFDV9jZXBoZXNfYWNvc2gGDF9jZXBoZXNfYWlyeQcMX2NlcGhlc19hc2luCAxfY2VwaGVzX2Fjb3MJDV9jZXBoZXNfYXNpbmgKDF9jZXBoZXNfYXRhbgsNX2NlcGhlc19hdGFuMgwNX2NlcGhlc19hdGFuaA0NX2NlcGhlc19iZHRyYw4MX2NlcGhlc19iZHRyDw1fY2VwaGVzX2JkdHJpEAxfY2VwaGVzX2JldGERDV9jZXBoZXNfbGJldGESDV9jZXBoZXNfYnRkdHITDF9jZXBoZXNfY2JydBQOX2NlcGhlc19jaGJldmwVDl9jZXBoZXNfY2hkdHJjFg1fY2VwaGVzX2NoZHRyFw5fY2VwaGVzX2NoZHRyaRgMX2NlcGhlc19jb3NoGQ1fY2VwaGVzX2Rhd3NuGgpfY2VwaGVzX2VpGw1fY2VwaGVzX2VsbGllHA1fY2VwaGVzX2VsbGlrHQ1fY2VwaGVzX2VsbHBlHg1fY2VwaGVzX2VsbHBqHw1fY2VwaGVzX2VsbHBrIAtfY2VwaGVzX2V4cCENX2NlcGhlc19leHAxMCIMX2NlcGhlc19leHAyIwxfY2VwaGVzX2V4cG4kDV9jZXBoZXNfZXhweDIlC19jZXBoZXNfZmFjJg1fY2VwaGVzX2ZkdHJjJwxfY2VwaGVzX2ZkdHIoDV9jZXBoZXNfZmR0cmkpDV9jZXBoZXNfZnJleHAqDV9jZXBoZXNfbGRleHArDl9jZXBoZXNfZnJlc25sLA1fY2VwaGVzX2dhbW1hLQxfY2VwaGVzX2xnYW0uDF9jZXBoZXNfZ2R0ci8NX2NlcGhlc19nZHRyYzAOX2NlcGhlc19oeXAyZjExB19oeXQyZjEyDl9jZXBoZXNfaHlwZXJnMw5fY2VwaGVzX2h5cDJmMDQKX2NlcGhlc19pMDULX2NlcGhlc19pMGU2Cl9jZXBoZXNfaTE3C19jZXBoZXNfaTFlOA1fY2VwaGVzX2lnYW1jOQxfY2VwaGVzX2lnYW06DV9jZXBoZXNfaWdhbWk7Dl9jZXBoZXNfaW5jYmV0PAhfcHNlcmllcz0NX2NlcGhlc19pbmNiaT4PX2NlcGhlc19zaWduYml0Pw1fY2VwaGVzX2lzbmFuQBBfY2VwaGVzX2lzZmluaXRlQQpfY2VwaGVzX2l2QgpfY2VwaGVzX2owQwpfY2VwaGVzX3kwRApfY2VwaGVzX2oxRQpfY2VwaGVzX3kxRgpfY2VwaGVzX2puRwpfY2VwaGVzX2p2SARfanZzSQdfaGFua2VsSgZfcmVjdXJLCl9jZXBoZXNfazBMC19jZXBoZXNfazBlTQpfY2VwaGVzX2sxTgtfY2VwaGVzX2sxZU8KX2NlcGhlc19rblAPX2NlcGhlc19zbWlybm92URJfY2VwaGVzX2tvbG1vZ29yb3ZSEF9jZXBoZXNfc21pcm5vdmlTD19jZXBoZXNfa29sbW9naVQLX2NlcGhlc19sb2dVDV9jZXBoZXNfbG9nMTBWDF9jZXBoZXNfbG9nMlcOX2NlcGhlc19uYmR0cmNYDV9jZXBoZXNfbmJkdHJZDl9jZXBoZXNfbmJkdHJpWgxfY2VwaGVzX25kdHJbDF9jZXBoZXNfZXJmY1wLX2NlcGhlc19lcmZdDV9jZXBoZXNfbmR0cmleDV9jZXBoZXNfcGR0cmNfDF9jZXBoZXNfcGR0cmANX2NlcGhlc19wZHRyaWEPX2NlcGhlc19wbGFuY2tpYg9fY2VwaGVzX3BsYW5ja2NjD19jZXBoZXNfcGxhbmNrZGQPX2NlcGhlc19wbGFuY2t3ZQ5fY2VwaGVzX3BvbGV2bGYNX2NlcGhlc19wMWV2bGcPX2NlcGhlc19wb2x5bG9naAtfY2VwaGVzX3Bvd2kMX2NlcGhlc19wb3dpagtfY2VwaGVzX3BzaWsOX2NlcGhlc19yZ2FtbWFsDV9jZXBoZXNfcm91bmRtDl9jZXBoZXNfc2hpY2hpbgxfY2VwaGVzX3NpY2lvC19jZXBoZXNfc2lucAtfY2VwaGVzX2Nvc3EOX2NlcGhlc19yYWRpYW5yDl9jZXBoZXNfc2luY29zcw1fY2VwaGVzX3NpbmRndA1fY2VwaGVzX2Nvc2RndQxfY2VwaGVzX3Npbmh2Dl9jZXBoZXNfc3BlbmNldw1fY2VwaGVzX3N0ZHRyeA5fY2VwaGVzX3N0ZHRyaXkNX2NlcGhlc19vbmVmMnoPX2NlcGhlc190aHJlZWYwew5fY2VwaGVzX3N0cnV2ZXwKX2NlcGhlc195dn0LX2NlcGhlc190YW5+B190YW5jb3R/C19jZXBoZXNfY290gAENX2NlcGhlc190YW5kZ4EBC190YW5jb3RfMjI0ggENX2NlcGhlc19jb3RkZ4MBDF9jZXBoZXNfdGFuaIQBDV9jZXBoZXNfbG9nMXCFAQ1fY2VwaGVzX2V4cG0xhgENX2NlcGhlc19jb3NtMYcBCl9jZXBoZXNfeW6IAQxfY2VwaGVzX3pldGGJAQ1fY2VwaGVzX3pldGFjigEHX21hbGxvY4sBBV9mcmVl"},function(e,t){},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){t.read=function(e,t,n,r,o){var i,a,s=8*o-r-1,l=(1<<s)-1,c=l>>1,A=-7,u=n?o-1:0,h=n?-1:1,d=e[t+u];for(u+=h,i=d&(1<<-A)-1,d>>=-A,A+=s;A>0;i=256*i+e[t+u],u+=h,A-=8);for(a=i&(1<<-A)-1,i>>=-A,A+=r;A>0;a=256*a+e[t+u],u+=h,A-=8);if(0===i)i=1-c;else{if(i===l)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),i-=c}return(d?-1:1)*a*Math.pow(2,i-r)},t.write=function(e,t,n,r,o,i){var a,s,l,c=8*i-o-1,A=(1<<c)-1,u=A>>1,h=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,f=r?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=A):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),(t+=a+u>=1?h/l:h*Math.pow(2,1-u))*l>=2&&(a++,l/=2),a+u>=A?(s=0,a=A):a+u>=1?(s=(t*l-1)*Math.pow(2,o),a+=u):(s=t*Math.pow(2,u-1)*Math.pow(2,o),a=0));o>=8;e[n+d]=255&s,d+=f,s/=256,o-=8);for(a=a<<o|s,c+=o;c>0;e[n+d]=255&a,d+=f,a/=256,c-=8);e[n+d-f]|=128*p}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],a=n[1],s=new i(3*(r+a)/4-a),l=0,A=a>0?r-4:r,u=0;u<A;u+=4)t=o[e.charCodeAt(u)]<<18|o[e.charCodeAt(u+1)]<<12|o[e.charCodeAt(u+2)]<<6|o[e.charCodeAt(u+3)],s[l++]=t>>16&255,s[l++]=t>>8&255,s[l++]=255&t;return 2===a&&(t=o[e.charCodeAt(u)]<<2|o[e.charCodeAt(u+1)]>>4,s[l++]=255&t),1===a&&(t=o[e.charCodeAt(u)]<<10|o[e.charCodeAt(u+1)]<<4|o[e.charCodeAt(u+2)]>>2,s[l++]=t>>8&255,s[l++]=255&t),s},t.fromByteArray=function(e){for(var t,n=e.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(u(e,a,a+16383>s?s:a+16383));return 1===o?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===o&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,l=a.length;s<l;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function A(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function u(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(A(r));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},function(e,t,n){(function(t){n(286);const r=t.from(n(285),"base64");e.exports=class{constructor(e){if(this._wasmMemory=new WebAssembly.Memory({initial:32,maximum:32}),this._HEAP8=new Int8Array(this._wasmMemory.buffer),this._HEAP16=new Int16Array(this._wasmMemory.buffer),this._HEAP32=new Int32Array(this._wasmMemory.buffer),this._HEAPF32=new Float32Array(this._wasmMemory.buffer),this._HEAPF64=new Float64Array(this._wasmMemory.buffer),e){const e=this._compileSync();this._exportProgram(e),this.compiled=Promise.resolve()}else this.compiled=this._compileAsync().then(e=>this._exportProgram(e))}_AsciiToString(e){let t="";for(;;){const n=this._HEAP8[e++>>0];if(0===n)return t;t+=String.fromCharCode(n)}}_mtherr(e,t){let n="";switch(t){case 1:n="argument domain error";break;case 2:n="function singularity";break;case 3:n="overflow range error";break;case 4:n="underflow range error";break;case 5:n="total loss of precision";break;case 6:n="partial loss of precision";break;case 33:n="Unix domain error code";break;case 34:n="Unix range error code";break;default:n="unknown error"}const r='cephes reports "'+n+'" in '+this._AsciiToString(e);throw this.stackRestore(0),1==t?new RangeError(r):new Error(r)}_wasmImports(){return{env:{_mtherr:this._mtherr.bind(this),memory:this._wasmMemory,STACKTOP:0,STACK_MAX:1048576}}}_compileSync(){return new WebAssembly.Instance(new WebAssembly.Module(r),this._wasmImports())}_compileAsync(){return WebAssembly.instantiate(r,this._wasmImports()).then(e=>e.instance)}_exportProgram(e){for(const t of Object.keys(e.exports))t.startsWith("_cephes_")&&(this[t]=e.exports[t]);this.stackAlloc=e.exports.stackAlloc,this.stackRestore=e.exports.stackRestore,this.stackSave=e.exports.stackSave}getValue(e,t){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return this._HEAP8[e>>0];case"i16":return this._HEAP16[e>>1];case"i32":case"i64":return this._HEAP32[e>>2];case"float":return this._HEAPF32[e>>2];case"double":return this._HEAPF64[e>>3];default:throw new Error("invalid type for getValue: "+t)}return null}writeArrayToMemory(e,t){this._HEAP8.set(e,t)}}}).call(this,n(102).Buffer)},function(e,t,n){const r=n(290);e.exports=new r(!1)},function(e,t,n){var r=n(50);function o(e,t){if(!(this instanceof o))return new o(e,t);if("number"!=typeof e&&void 0!==e)throw TypeError("mean must be a number");if("number"!=typeof t&&void 0!==t)throw TypeError("sd must be a number");if(void 0!==t&&t<=0)throw TypeError("sd must be positive");this._mean=e||0,this._sd=t||1,this._var=this._sd*this._sd}e.exports=o,o.prototype.pdf=function(e){return Math.exp(-.9189385332046728-Math.log(this._sd)-Math.pow(e-this._mean,2)/(2*this._var))},o.prototype.cdf=function(e){return r.ndtr((e-this._mean)/this._sd)},o.prototype.inv=function(e){return e<=0?-1/0:e>=1?1/0:this._sd*r.ndtri(e)+this._mean},o.prototype.median=function(){return this._mean},o.prototype.mean=function(){return this._mean},o.prototype.variance=function(){return this._var}},function(e,t,n){"use strict";const r=n(51).Studentt,o=n(49),i=n(48);function a(e,t){i.call(this,t),this._df=e.size-1,this._dist=new r(this._df),this._se=Math.sqrt(e.variance/e.size),this._mean=e.mean}o.inherits(a,i),e.exports=a},function(e,t,n){"use strict";const r=n(293),o=n(279),i=n(278),a=n(277),s=Object.assign(Object.create(null),{"not equal":0,less:-1,greater:1});function l(e){return e&&"function"==typeof e.mean&&"function"==typeof e.variance&&"function"==typeof e.size}function c(e){return Array.isArray(e)||l(e)||function(e){return e&&"number"==typeof e.mean&&"number"==typeof e.variance&&"number"==typeof e.size}(e)}function A(e){if(Array.isArray(e)||l(e)){const t=l(e)?e:new a(e);return{mean:t.mean(),variance:t.variance(),size:t.size()}}return e}e.exports=function(e,t,n){if(!c(e))throw new TypeError("left value in hypothesis test must be an array or data summary");if(c(t)||(n=t,t=void 0),(n=Object.assign({mu:0,varEqual:!1,alpha:.05,alternative:"not equal"},n)).alternative=s[n.alternative],"number"!=typeof n.mu)throw new TypeError("alpha option must be a number");if("boolean"!=typeof n.varEqual)throw new TypeError("varEqual option must be a boolean");if("number"!=typeof n.alpha)throw new TypeError("alpha option must be a number");if(n.alpha>=1)throw new RangeError("alpha must be bellow 1.0");if(void 0===typeof n.alternative)throw new Error("alternative must be either not equal, less or greater");return c(t)?n.varEqual?new o(A(e),A(t),n):new i(A(e),A(t),n):new r(A(e),n)}},function(e,t,n){var r=n(23),o=n(14);Nonparametric=function(){},Nonparametric.kolmogorovSmirnov=function(e,t){var n=new r.Vector(e.elements.concat(t.elements)).sort(),i=e.ecdf(n),a=t.ecdf(n).subtract(i).abs().max(),s=e.length()*t.length()/(e.length()+t.length()),l=Math.sqrt(s)*a;return{d:a,ks:l,p:1-(new o.Kolmogorov).distr(l)}},e.exports.Nonparametric=Nonparametric},function(e,t,n){var r=n(14);Power=function(){},Power.sampleSize=function(e,t,n,o){var i=new r.Normal(0,1);return 2*Math.pow(i.inverse(1-e/2)+i.inverse(t),2)*Math.pow(n,2)/Math.pow(o,2)},e.exports.Power=Power},function(e,t,n){var r=n(14);Confidence=function(){},Confidence.normal=function(e,t){var n=1-t,o=new r.T(e.length()-1);return[e.mean()-o.inverse(1-n/2)*e.sem(),e.mean()+o.inverse(1-n/2)*e.sem()]},Confidence.normalUpper=function(e,t){var n=1-t,o=new r.T(e.length()-1);return e.mean()+o.inverse(1-n)*e.sem()},Confidence.normalLower=function(e,t){var n=1-t,o=new r.T(e.length()-1);return e.mean()-o.inverse(1-n)*e.sem()},e.exports.Confidence=Confidence},function(e,t,n){n(104);var r=n(23),o=n(14);Normality=function(){},Normality.shapiroWilk=function(e){result={};for(var t=e.sort(),n=(e.mean(),e.length()),i=1/Math.sqrt(n),a=new o.StandardNormal,s=new r.Vector([]),l=1;l<=n;l++)s.push(a.inverse((l-3/8)/(n+.25)));var c,A=s.dot(s),u=s.multiply(1/Math.sqrt(A)),h=-2.706056*Math.pow(i,5)+4.434685*Math.pow(i,4)-2.07119*Math.pow(i,3)-.147981*Math.pow(i,2)+.221157*i+u.elements[n-1],d=-3.582633*Math.pow(i,5)+5.682633*Math.pow(i,4)-1.752461*Math.pow(i,3)-.293762*Math.pow(i,2)+.042981*i+u.elements[n-2];c=n>5?(A-2*Math.pow(s.elements[n-1],2)-2*Math.pow(s.elements[n-2],2))/(1-2*Math.pow(h,2)-2*Math.pow(d,2)):(A-2*Math.pow(s.elements[n-1],2))/(1-2*Math.pow(h,2));var f,p,g,m=new r.Vector([]);if(n>5){for(m.push(-h),m.push(-d),l=2;l<n-2;l++)m.push(s.elements[l]*Math.pow(c,-.5));m.push(d),m.push(h)}else{for(m.push(-h),l=1;l<n-1;l++)m.push(s.elements[l]*Math.pow(c,-.5));m.push(h)}if(result.w=Math.pow(m.multiply(t).sum(),2)/t.ss(),n<12){var v=.459*n-2.273;f=-Math.log(v-Math.log(1-result.w)),p=-6714e-7*Math.pow(n,3)+.025054*Math.pow(n,2)-.39978*n+.544,g=Math.exp(-.0020322*Math.pow(n,3)+.062767*Math.pow(n,2)-.77857*n+1.3822)}else i=Math.log(n),f=Math.log(1-result.w),p=.0038915*Math.pow(i,3)-.083751*Math.pow(i,2)-.31082*i-1.5851,g=Math.exp(.0030302*Math.pow(i,2)-.082676*i-.4803);var y=(f-p)/g,b=new o.StandardNormal;return result.p=1-b.distr(y),result},e.exports.Normality=Normality},function(e,t,n){var r=n(23),o=n(14);Anova=function(){},Anova.oneway=function(e,t){for(var n={},i=[],a=0;a<e.groups();a++){for(var s=new r.Vector([]),l=e.group(a),c=0;c<l.length;c++)s.push(t.elements[l[c]]);i.push(s)}var A=new r.Vector([]),u=new r.Vector([]);for(s=new r.Vector([]),a=0;a<i.length;a++)A.push(i[a].mean()),u.push(i[a].length()),s.push(i[a].variance());n.tdf=e.groups()-1,n.tss=A.add(-t.mean()).pow(2).multiply(u).sum(),n.tms=n.tss/n.tdf,n.edf=e.length()-e.groups(),n.ess=s.multiply(u.add(-1)).sum(),n.ems=n.ess/n.edf,n.f=n.tms/n.ems;var h=new o.F(n.tdf,n.edf);return n.p=1-h.distr(Math.abs(n.f)),n},e.exports.Anova=Anova},function(e,t,n){var r=n(14);Correlation=function(){},Correlation.pearson=function(e,t){var n={},o=e.length(),i=e.mean(),a=t.mean();n.r=e.add(-i).multiply(t.add(-a)).sum()/Math.sqrt(e.add(-i).pow(2).sum()*t.add(-a).pow(2).sum()),n.t=n.r*Math.sqrt((o-2)/(1-Math.pow(n.r,2))),n.df=o-2;var s=new r.T(n.df);return n.p=2*(1-s.distr(Math.abs(n.t))),n},e.exports.Correlation=Correlation},function(e,t,n){var r=n(14);Regression=function(){},Regression.linear=function(e,t){var n={};n.n=e.length();var o=e.mean(),i=t.mean(),a=e.add(-o),s=t.add(-i),l=a.pow(2).sum(),c=s.pow(2).sum(),A=a.multiply(s).sum();n.slope=A/l,n.intercept=i-n.slope*o;var u=t.add(e.multiply(n.slope).add(n.intercept).multiply(-1)).pow(2).sum();n.rse=Math.sqrt(u/(n.n-2));var h=new r.T(n.n-2);return n.slope_se=n.rse/Math.sqrt(l),n.slope_t=n.slope/n.slope_se,n.slope_p=2*(1-h.distr(Math.abs(n.slope_t))),n.intercept_se=n.rse/Math.sqrt(l)/Math.sqrt(n.n)*Math.sqrt(e.pow(2).sum()),n.intercept_t=n.intercept/n.intercept_se,n.intercept_p=2*(1-h.distr(Math.abs(n.intercept_t))),n.rs=Math.pow(A,2)/(l*c),n},e.exports.Regression=Regression},function(e,t,n){var r=n(23),o=n(14);StudentT=function(){},StudentT.test=function(e,t){return t instanceof r.Vector?this._twosample(e,t):this._onesample(e,t)},StudentT._twosample=function(e,t){var n={};n.se=Math.sqrt(e.variance()/e.length()+t.variance()/t.length()),n.t=(e.mean()-t.mean())/n.se,n.df=e.length()+t.length()-2;var r=new o.T(n.df);return n.p=2*(1-r.distr(Math.abs(n.t))),n},StudentT._onesample=function(e,t){var n={};n.sample=e,n.mu=t,n.se=Math.sqrt(n.sample.variance())/Math.sqrt(n.sample.length()),n.t=(n.sample.mean()-n.mu)/n.se,n.df=n.sample.length()-1;var r=new o.T(n.df);return n.p=2*(1-r.distr(Math.abs(n.t))),n},e.exports.StudentT=StudentT},function(e,t){Factor=function(e){this.levels=[],this.factors=[];for(var t=0;t<e.length;t++)-1!=(index=this.levels.indexOf(e[t]))?this.factors.push(index):(this.factors.push(this.levels.length),this.levels.push(e[t]))},Factor.prototype.group=function(e){for(var t=[],n=-1;-1!=(n=this.factors.indexOf(e,n+1));)t.push(n);return t},Factor.prototype.length=function(){return this.factors.length},Factor.prototype.groups=function(){return this.levels.length},e.exports.Factor=Factor},function(e,t,n){var r=n(23),o=n(303),i=(n(104),n(302)),a=n(103),s=n(14),l=n(301),c=n(300),A=n(52),u=n(299),h=n(298),d=n(297),f=n(296),p=n(295);e.exports.Vector=r.Vector,e.exports.Factor=o.Factor,e.exports.Matrix=o.Matrix,e.exports.Sequence=r.Sequence,e.exports.StudentT=i.StudentT,e.exports.Misc=a.Misc,e.exports.Numeric=A.Numeric,e.exports.Normal=s.Normal,e.exports.StandardNormal=s.StandardNormal,e.exports.T=s.T,e.exports.F=s.F,e.exports.Kolmogorov=s.Kolmogorov,e.exports.Regression=l.Regression,e.exports.Correlation=c.Correlation,e.exports.Anova=u.Anova,e.exports.Normality=h.Normality,e.exports.Confidence=d.Confidence,e.exports.Power=f.Power,e.exports.Nonparametric=p.Nonparametric},function(e,t,n){"use strict";var r=n(6).isInteger;t.name="partitionSelect",t.factory=function(e,t,o,i){var a=o(n(107));function s(e,t){return-a(e,t)}return i("partitionSelect",{"Array | Matrix, number":function(e,t){return l(e,t,a)},"Array | Matrix, number, string":function(e,t,n){if("asc"===n)return l(e,t,a);if("desc"===n)return l(e,t,s);throw new Error('Compare string must be "asc" or "desc"')},"Array | Matrix, number, function":l});function l(t,n,o){if(!r(n)||n<0)throw new Error("k must be a non-negative integer");if(e.isMatrix(t)){if(t.size().length>1)throw new Error("Only one dimensional matrices supported");return c(t.valueOf(),n,o)}if(Array.isArray(t))return c(t,n,o)}function c(e,t,n){if(t>=e.length)throw new Error("k out of bounds");for(var r=0,o=e.length-1;r<o;){for(var i=r,a=o,s=e[Math.floor(Math.random()*(o-r+1))+r];i<a;)if(n(e[i],s)>=0){var l=e[a];e[a]=e[i],e[i]=l,--a}else++i;n(e[i],s)>0&&--i,t<=i?o=i:r=i+1}return e[t]}}},function(e,t,n){"use strict";t.name="algorithm11",t.factory=function(e,t,r,o){var i=r(n(25)),a=e.SparseMatrix;return function(e,t,n,r){var s=e._values,l=e._index,c=e._ptr,A=e._size,u=e._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var h,d=A[0],f=A[1],p=i,g=0,m=n;"string"==typeof u&&(h=u,p=o.find(i,[h,h]),g=o.convert(0,h),t=o.convert(t,h),m=o.find(n,[h,h]));for(var v=[],y=[],b=[],I=new a({values:v,index:y,ptr:b,size:[d,f],datatype:h}),x=0;x<f;x++){b[x]=y.length;for(var w=c[x],C=c[x+1],E=w;E<C;E++){var S=l[E],M=r?m(t,s[E]):m(s[E],t);p(M,g)||(y.push(S),v.push(M))}}return b[f]=y.length,I}}},function(e,t,n){"use strict";var r=n(7).extend,o=n(56);t.name="multiply",t.factory=function(e,t,i,a){var s=n(17),l=i(n(15)),c=i(n(41)),A=i(n(54)),u=i(n(25)),h=i(n(306)),d=i(n(24)),f=e.DenseMatrix,p=e.SparseMatrix,g=a("multiply",r({"Array, Array":function(t,n){m(o.size(t),o.size(n));var r=g(l(t),l(n));return e.isMatrix(r)?r.valueOf():r},"Matrix, Matrix":function(e,t){var n=e.size(),r=t.size();return m(n,r),1===n.length?1===r.length?v(e,t,n[0]):y(e,t):1===r.length?I(e,t):x(e,t)},"Matrix, Array":function(e,t){return g(e,l(t))},"Array, Matrix":function(e,t){return g(l(e,t.storage()),t)},"Matrix, any":function(e,t){var n;switch(e.storage()){case"sparse":n=h(e,t,A,!1);break;case"dense":n=d(e,t,A,!1)}return n},"any, Matrix":function(e,t){var n;switch(t.storage()){case"sparse":n=h(t,e,A,!0);break;case"dense":n=d(t,e,A,!0)}return n},"Array, any":function(e,t){return d(l(e),t,A,!1).valueOf()},"any, Array":function(e,t){return d(l(t),e,A,!0).valueOf()},"any, any":A,"Array | Matrix | any, Array | Matrix | any, ...any":function(e,t,n){for(var r=g(e,t),o=0;o<n.length;o++)r=g(r,n[o]);return r}},A.signatures)),m=function(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)")}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)")}},v=function(e,t,n){if(0===n)throw new Error("Cannot multiply two empty vectors");var r,o=e._data,i=e._datatype,s=t._data,l=t._datatype,u=c,h=A;i&&l&&i===l&&"string"==typeof i&&(r=i,u=a.find(c,[r,r]),h=a.find(A,[r,r]));for(var d=h(o[0],s[0]),f=1;f<n;f++)d=u(d,h(o[f],s[f]));return d},y=function(e,t){switch(t.storage()){case"dense":return b(e,t)}throw new Error("Not implemented")},b=function(e,t){var n,r=e._data,o=e._size,i=e._datatype,s=t._data,l=t._size,u=t._datatype,h=o[0],d=l[1],p=c,g=A;i&&u&&i===u&&"string"==typeof i&&(n=i,p=a.find(c,[n,n]),g=a.find(A,[n,n]));for(var m=[],v=0;v<d;v++){for(var y=g(r[0],s[0][v]),b=1;b<h;b++)y=p(y,g(r[b],s[b][v]));m[v]=y}return new f({data:m,size:[d],datatype:n})},I=function(e,t){switch(e.storage()){case"dense":return w(e,t);case"sparse":return S(e,t)}},x=function(e,t){switch(e.storage()){case"dense":switch(t.storage()){case"dense":return C(e,t);case"sparse":return E(e,t)}break;case"sparse":switch(t.storage()){case"dense":return M(e,t);case"sparse":return k(e,t)}}},w=function(e,t){var n,r=e._data,o=e._size,i=e._datatype,s=t._data,l=t._datatype,u=o[0],h=o[1],d=c,p=A;i&&l&&i===l&&"string"==typeof i&&(n=i,d=a.find(c,[n,n]),p=a.find(A,[n,n]));for(var g=[],m=0;m<u;m++){for(var v=r[m],y=p(v[0],s[0]),b=1;b<h;b++)y=d(y,p(v[b],s[b]));g[m]=y}return new f({data:g,size:[u],datatype:n})},C=function(e,t){var n,r=e._data,o=e._size,i=e._datatype,s=t._data,l=t._size,u=t._datatype,h=o[0],d=o[1],p=l[1],g=c,m=A;i&&u&&i===u&&"string"==typeof i&&(n=i,g=a.find(c,[n,n]),m=a.find(A,[n,n]));for(var v=[],y=0;y<h;y++){var b=r[y];v[y]=[];for(var I=0;I<p;I++){for(var x=m(b[0],s[0][I]),w=1;w<d;w++)x=g(x,m(b[w],s[w][I]));v[y][I]=x}}return new f({data:v,size:[h,p],datatype:n})},E=function(e,t){var n=e._data,r=e._size,o=e._datatype,i=t._values,s=t._index,l=t._ptr,h=t._size,d=t._datatype;if(!i)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var f,g=r[0],m=h[1],v=c,y=A,b=u,I=0;o&&d&&o===d&&"string"==typeof o&&(f=o,v=a.find(c,[f,f]),y=a.find(A,[f,f]),b=a.find(u,[f,f]),I=a.convert(0,f));for(var x=[],w=[],C=[],E=new p({values:x,index:w,ptr:C,size:[g,m],datatype:f}),S=0;S<m;S++){C[S]=w.length;var M=l[S],k=l[S+1];if(k>M)for(var B=0,D=0;D<g;D++){for(var P,Q=D+1,T=M;T<k;T++){var G=s[T];B!==Q?(P=y(n[D][G],i[T]),B=Q):P=v(P,y(n[D][G],i[T]))}B!==Q||b(P,I)||(w.push(D),x.push(P))}}return C[m]=w.length,E},S=function(e,t){var n=e._values,r=e._index,o=e._ptr,i=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=t._data,h=t._datatype,d=e._size[0],f=t._size[0],g=[],m=[],v=[],y=c,b=A,I=u,x=0;i&&h&&i===h&&"string"==typeof i&&(s=i,y=a.find(c,[s,s]),b=a.find(A,[s,s]),I=a.find(u,[s,s]),x=a.convert(0,s));var w=[],C=[];v[0]=0;for(var E=0;E<f;E++){var S=l[E];if(!I(S,x))for(var M=o[E],k=o[E+1],B=M;B<k;B++){var D=r[B];C[D]?w[D]=y(w[D],b(S,n[B])):(C[D]=!0,m.push(D),w[D]=b(S,n[B]))}}for(var P=m.length,Q=0;Q<P;Q++){var T=m[Q];g[Q]=w[T]}return v[1]=m.length,new p({values:g,index:m,ptr:v,size:[d,1],datatype:s})},M=function(e,t){var n=e._values,r=e._index,o=e._ptr,i=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s,l=t._data,h=t._datatype,d=e._size[0],f=t._size[0],g=t._size[1],m=c,v=A,y=u,b=0;i&&h&&i===h&&"string"==typeof i&&(s=i,m=a.find(c,[s,s]),v=a.find(A,[s,s]),y=a.find(u,[s,s]),b=a.convert(0,s));for(var I=[],x=[],w=[],C=new p({values:I,index:x,ptr:w,size:[d,g],datatype:s}),E=[],S=[],M=0;M<g;M++){w[M]=x.length;for(var k=M+1,B=0;B<f;B++){var D=l[B][M];if(!y(D,b))for(var P=o[B],Q=o[B+1],T=P;T<Q;T++){var G=r[T];S[G]!==k?(S[G]=k,x.push(G),E[G]=v(D,n[T])):E[G]=m(E[G],v(D,n[T]))}}for(var R=w[M],_=x.length,V=R;V<_;V++){var N=x[V];I[V]=E[N]}}return w[g]=x.length,C},k=function(e,t){var n,r=e._values,o=e._index,i=e._ptr,s=e._datatype,l=t._values,u=t._index,h=t._ptr,d=t._datatype,f=e._size[0],g=t._size[1],m=r&&l,v=c,y=A;s&&d&&s===d&&"string"==typeof s&&(n=s,v=a.find(c,[n,n]),y=a.find(A,[n,n]));for(var b,I,x,w,C,E,S,M,k=m?[]:void 0,B=[],D=[],P=new p({values:k,index:B,ptr:D,size:[f,g],datatype:n}),Q=m?[]:void 0,T=[],G=0;G<g;G++){D[G]=B.length;var R=G+1;for(C=h[G],E=h[G+1],w=C;w<E;w++)if(M=u[w],m)for(I=i[M],x=i[M+1],b=I;b<x;b++)T[S=o[b]]!==R?(T[S]=R,B.push(S),Q[S]=y(l[w],r[b])):Q[S]=v(Q[S],y(l[w],r[b]));else for(I=i[M],x=i[M+1],b=I;b<x;b++)T[S=o[b]]!==R&&(T[S]=R,B.push(S));if(m)for(var _=D[G],V=B.length,N=_;N<V;N++){var F=B[N];k[N]=Q[F]}}return D[g]=B.length,P};return g.toTex={2:"\\left(${args[0]}"+s.operators.multiply+"${args[1]}\\right)"},g}},function(e,t){t.memoize=function(e,t){return function n(){"object"!=typeof n.cache&&(n.cache={});for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];var i=t?t(r):JSON.stringify(r);return i in n.cache?n.cache[i]:n.cache[i]=e.apply(e,r)}},t.maxArgumentCount=function(e){return Object.keys(e.signatures||{}).reduce(function(e,t){var n=(t.match(/,/g)||[]).length+1;return Math.max(e,n)},-1)},t.callWithRightArgumentCount=function(e,t,n){return Object.keys(e.signatures||{}).reduce(function(e,t){var n=(t.match(/,/g)||[]).length+1;return Math.max(e,n)},-1)}},function(e,t,n){"use strict";t.isBoolean=function(e){return"boolean"==typeof e}},function(e,t,n){"use strict";var r=n(11);t.name="algorithm04",t.factory=function(e,t,o,i){var a=o(n(25)),s=e.SparseMatrix;return function(e,t,n){var o=e._values,l=e._index,c=e._ptr,A=e._size,u=e._datatype,h=t._values,d=t._index,f=t._ptr,p=t._size,g=t._datatype;if(A.length!==p.length)throw new r(A.length,p.length);if(A[0]!==p[0]||A[1]!==p[1])throw new RangeError("Dimension mismatch. Matrix A ("+A+") must match Matrix B ("+p+")");var m,v=A[0],y=A[1],b=a,I=0,x=n;"string"==typeof u&&u===g&&(m=u,b=i.find(a,[m,m]),I=i.convert(0,m),x=i.find(n,[m,m]));var w,C,E,S,M,k=o&&h?[]:void 0,B=[],D=[],P=new s({values:k,index:B,ptr:D,size:[v,y],datatype:m}),Q=o&&h?[]:void 0,T=o&&h?[]:void 0,G=[],R=[];for(C=0;C<y;C++){D[C]=B.length;var _=C+1;for(S=c[C],M=c[C+1],E=S;E<M;E++)w=l[E],B.push(w),G[w]=_,Q&&(Q[w]=o[E]);for(S=f[C],M=f[C+1],E=S;E<M;E++)if(G[w=d[E]]===_){if(Q){var V=x(Q[w],h[E]);b(V,I)?G[w]=null:Q[w]=V}}else B.push(w),R[w]=_,T&&(T[w]=h[E]);if(Q&&T)for(E=D[C];E<B.length;)G[w=B[E]]===_?(k[E]=Q[w],E++):R[w]===_?(k[E]=T[w],E++):B.splice(E,1)}return D[y]=B.length,P}}},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o={"{":"\\{","}":"\\}","\\":"\\textbackslash{}","#":"\\#",$:"\\$","%":"\\%","&":"\\&","^":"\\textasciicircum{}",_:"\\_","~":"\\textasciitilde{}"},i={"":"\\--","":"\\---"," ":"~","\t":"\\qquad{}","\r\n":"\\newline{}","\n":"\\newline{}"},a=function(e,t){return r({},e,t)};e.exports=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.preserveFormatting,s=void 0!==n&&n,l=t.escapeMapFn,c=void 0===l?a:l,A=String(e),u="",h=c(r({},o),s?r({},i):{}),d=Object.keys(h),f=function(){var e=!1;d.forEach(function(t,n){e||A.length>=t.length&&A.slice(0,t.length)===t&&(u+=h[d[n]],A=A.slice(t.length,A.length),e=!0)}),e||(u+=A.slice(0,1),A=A.slice(1,A.length))};A;)f();return u}},function(e,t,n){"use strict";var r=n(60);e.exports=function(e){return Array.isArray(e)||r(e)}},function(e,t,n){"use strict";function r(e,t,n){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,arguments.length<3?(this.min=0,this.max=t):(this.min=t,this.max=n),void 0!==this.min&&this.index<this.min?this.message="Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?this.message="Index out of range ("+this.index+" > "+(this.max-1)+")":this.message="Index out of range ("+this.index+")",this.stack=(new Error).stack}r.prototype=new RangeError,r.prototype.constructor=RangeError,r.prototype.name="IndexError",r.prototype.isIndexError=!0,e.exports=r},function(e,t){t.format=function(e,n){if("function"==typeof n)return n(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var r="auto",o=void 0;switch(void 0!==n&&(n.notation&&(r=n.notation),"number"==typeof n?o=n:n.precision&&(o=n.precision)),r){case"fixed":return t.toFixed(e,o);case"exponential":return t.toExponential(e,o);case"auto":var i=.001,a=1e5;if(n&&n.exponential&&(void 0!==n.exponential.lower&&(i=n.exponential.lower),void 0!==n.exponential.upper&&(a=n.exponential.upper)),e.constructor.toExpNeg,e.constructor.toExpPos,e.constructor.config({toExpNeg:Math.round(Math.log(i)/Math.LN10),toExpPos:Math.round(Math.log(a)/Math.LN10)}),e.isZero())return"0";var s=e.abs();return(s.gte(i)&&s.lt(a)?e.toSignificantDigits(o).toFixed():t.toExponential(e,o)).replace(/((\.\d*?)(0+))($|e)/,function(){var e=arguments[2],t=arguments[4];return"."!==e?e+t:t});default:throw new Error('Unknown notation "'+r+'". Choose "auto", "exponential", or "fixed".')}},t.toExponential=function(e,t){return void 0!==t?e.toExponential(t-1):e.toExponential()},t.toFixed=function(e,t){return e.toFixed(t||0)}},function(e,t,n){"use strict";var r=n(58);t.name="fraction",t.factory=function(e,t,n,o){var i=o("fraction",{number:function(t){if(!isFinite(t)||isNaN(t))throw new Error(t+" cannot be represented as a fraction");return new e.Fraction(t)},string:function(t){return new e.Fraction(t)},"number, number":function(t,n){return new e.Fraction(t,n)},BigNumber:function(t){return new e.Fraction(t.toString())},Fraction:function(e){return e},Object:function(t){return new e.Fraction(t)},"Array | Matrix":function(e){return r(e,i)}});return i}},function(e,t,n){var r;!function(n){"use strict";var o={s:1,n:0,d:1};function i(e){var t=function(){var t=Error.apply(this,arguments);t.name=this.name=e,this.stack=t.stack,this.message=t.message},n=function(){};return n.prototype=Error.prototype,t.prototype=new n,t}var a=h.DivisionByZero=i("DivisionByZero"),s=h.InvalidParameter=i("InvalidParameter");function l(e,t){return isNaN(e=parseInt(e,10))&&c(),e*t}function c(){throw new s}var A=function(e,t){var n,r=0,i=1,s=1,A=0,u=0,h=0,d=1,f=1,p=0,g=1,m=1,v=1,y=1e7;if(void 0===e||null===e);else if(void 0!==t)s=(r=e)*(i=t);else switch(typeof e){case"object":"d"in e&&"n"in e?(r=e.n,i=e.d,"s"in e&&(r*=e.s)):0 in e?(r=e[0],1 in e&&(i=e[1])):c(),s=r*i;break;case"number":if(e<0&&(s=e,e=-e),e%1==0)r=e;else if(e>0){for(e>=1&&(e/=f=Math.pow(10,Math.floor(1+Math.log(e)/Math.LN10)));g<=y&&v<=y;){if(e===(n=(p+m)/(g+v))){g+v<=y?(r=p+m,i=g+v):v>g?(r=m,i=v):(r=p,i=g);break}e>n?(p+=m,g+=v):(m+=p,v+=g),g>y?(r=m,i=v):(r=p,i=g)}r*=f}else(isNaN(e)||isNaN(t))&&(i=r=NaN);break;case"string":if(null===(g=e.match(/\d+|./g))&&c(),"-"===g[p]?(s=-1,p++):"+"===g[p]&&p++,g.length===p+1?u=l(g[p++],s):"."===g[p+1]||"."===g[p]?("."!==g[p]&&(A=l(g[p++],s)),(++p+1===g.length||"("===g[p+1]&&")"===g[p+3]||"'"===g[p+1]&&"'"===g[p+3])&&(u=l(g[p],s),d=Math.pow(10,g[p].length),p++),("("===g[p]&&")"===g[p+2]||"'"===g[p]&&"'"===g[p+2])&&(h=l(g[p+1],s),f=Math.pow(10,g[p+1].length)-1,p+=3)):"/"===g[p+1]||":"===g[p+1]?(u=l(g[p],s),d=l(g[p+2],1),p+=3):"/"===g[p+3]&&" "===g[p+1]&&(A=l(g[p],s),u=l(g[p+2],s),d=l(g[p+4],1),p+=5),g.length<=p){s=r=h+(i=d*f)*A+f*u;break}default:c()}if(0===i)throw new a;o.s=s<0?-1:1,o.n=Math.abs(r),o.d=Math.abs(i)},u=function(e,t){if(!e)return t;if(!t)return e;for(;;){if(!(e%=t))return t;if(!(t%=e))return e}};function h(e,t){if(!(this instanceof h))return new h(e,t);A(e,t),e=h.REDUCE?u(o.d,o.n):1,this.s=o.s,this.n=o.n/e,this.d=o.d/e}h.REDUCE=1,h.prototype={s:1,n:0,d:1,abs:function(){return new h(this.n,this.d)},neg:function(){return new h(-this.s*this.n,this.d)},add:function(e,t){return A(e,t),new h(this.s*this.n*o.d+o.s*this.d*o.n,this.d*o.d)},sub:function(e,t){return A(e,t),new h(this.s*this.n*o.d-o.s*this.d*o.n,this.d*o.d)},mul:function(e,t){return A(e,t),new h(this.s*o.s*this.n*o.n,this.d*o.d)},div:function(e,t){return A(e,t),new h(this.s*o.s*this.n*o.d,this.d*o.n)},clone:function(){return new h(this)},mod:function(e,t){return isNaN(this.n)||isNaN(this.d)?new h(NaN):void 0===e?new h(this.s*this.n%this.d,1):(A(e,t),0===o.n&&0===this.d&&h(0,0),new h(this.s*o.d*this.n%(o.n*this.d),o.d*this.d))},gcd:function(e,t){return A(e,t),new h(u(o.n,this.n),o.d*this.d/u(o.d,this.d))},lcm:function(e,t){return A(e,t),0===o.n&&0===this.n?new h:new h(o.n*this.n/u(o.n,this.n),u(o.d,this.d))},ceil:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):new h(Math.ceil(e*this.s*this.n/this.d),e)},floor:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):new h(Math.floor(e*this.s*this.n/this.d),e)},round:function(e){return e=Math.pow(10,e||0),isNaN(this.n)||isNaN(this.d)?new h(NaN):new h(Math.round(e*this.s*this.n/this.d),e)},inverse:function(){return new h(this.s*this.d,this.n)},pow:function(e){return e<0?new h(Math.pow(this.s*this.d,-e),Math.pow(this.n,-e)):new h(Math.pow(this.s*this.n,e),Math.pow(this.d,e))},equals:function(e,t){return A(e,t),this.s*this.n*o.d==o.s*o.n*this.d},compare:function(e,t){A(e,t);var n=this.s*this.n*o.d-o.s*o.n*this.d;return(0<n)-(n<0)},divisible:function(e,t){return A(e,t),!(!(o.n*this.d)||this.n*o.d%(o.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t,n="",r=this.n,o=this.d;return this.s<0&&(n+="-"),1===o?n+=r:(e&&(t=Math.floor(r/o))>0&&(n+=t,n+=" ",r%=o),n+=r,n+="/",n+=o),n},toLatex:function(e){var t,n="",r=this.n,o=this.d;return this.s<0&&(n+="-"),1===o?n+=r:(e&&(t=Math.floor(r/o))>0&&(n+=t,r%=o),n+="\\frac{",n+=r,n+="}{",n+=o,n+="}"),n},toContinued:function(){var e,t=this.n,n=this.d,r=[];do{r.push(Math.floor(t/n)),e=t%n,t=n,n=e}while(1!==t);return r},toString:function(){var e,t=this.n,n=this.d;if(isNaN(t)||isNaN(n))return"NaN";h.REDUCE||(t/=e=u(t,n),n/=e);var r=function(e,t){for(;t%2==0;t/=2);for(;t%5==0;t/=5);if(1===t)return 0;for(var n=10%t,r=1;1!==n;r++)if(n=10*n%t,r>2e3)return 0;return r}(0,n),o=function(e,t,n){for(var r=1,o=function(e,t,n){for(var r=1;t>0;e=e*e%n,t>>=1)1&t&&(r=r*e%n);return r}(10,n,t),i=0;i<300;i++){if(r===o)return i;r=10*r%t,o=10*o%t}return 0}(0,n,r),i=-1===this.s?"-":"";if(i+=t/n|0,t%=n,(t*=10)&&(i+="."),r){for(var a=o;a--;)i+=t/n|0,t%=n,t*=10;for(i+="(",a=r;a--;)i+=t/n|0,t%=n,t*=10;i+=")"}else for(a=15;t&&a--;)i+=t/n|0,t%=n,t*=10;return i}},void 0===(r=function(){return h}.apply(t,[]))||(e.exports=r)}()},function(e,t,n){var r=n(316);r.prototype.type="Fraction",r.prototype.isFraction=!0,r.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},r.fromJSON=function(e){return new r(e)},t.name="Fraction",t.path="type",t.factory=function(e,t,n,o){return r}},function(e,t,n){"use strict";var r=n(7);function o(e,t,n){if(void 0!==e[t]&&!function(e,t){return-1!==e.indexOf(t)}(n,e[t])){var r=function(e,t){return e.map(function(e){return e.toLowerCase()}).indexOf(t.toLowerCase())}(n,e[t]);-1!==r?(console.warn('Warning: Wrong casing for configuration option "'+t+'", should be "'+n[r]+'" instead of "'+e[t]+'".'),e[t]=n[r]):console.warn('Warning: Unknown value "'+e[t]+'" for configuration option "'+t+'". Available options: '+n.map(JSON.stringify).join(", ")+".")}}t.name="config",t.math=!0,t.factory=function(e,t,n,i,a){var s=["Matrix","Array"],l=["number","BigNumber","Fraction"];function c(e){if(e){var n=r.map(t,r.clone);o(e,"matrix",s),o(e,"number",l),r.deepExtend(t,e);var i=r.map(t,r.clone),c=r.map(e,r.clone);return a.emit("config",i,n,c),i}return r.map(t,r.clone)}return c.MATRIX=s,c.NUMBER=l,c}},function(e,t,n){"use strict";function r(e,t,n,o){if(!(this instanceof r))throw new SyntaxError("Constructor must be called with the new operator");this.fn=e,this.count=t,this.min=n,this.max=o,this.message="Wrong number of arguments in function "+e+" ("+t+" provided, "+n+(void 0!=o?"-"+o:"")+" expected)",this.stack=(new Error).stack}r.prototype=new Error,r.prototype.constructor=Error,r.prototype.name="ArgumentsError",r.prototype.isArgumentsError=!0,e.exports=r},function(e,t,n){"use strict";var r=n(7).lazy,o=n(7).isFactory,i=n(7).traverse,a=n(319);t.math=!0,t.name="import",t.factory=function(e,t,n,s,l){function c(e,t,n){if(n.wrap&&"function"==typeof t&&(t=function(e){var t=function(){for(var t=[],n=0,r=arguments.length;n<r;n++){var o=arguments[n];t[n]=o&&o.valueOf()}return e.apply(l,t)};return e.transform&&(t.transform=e.transform),t}(t)),d(l[e])&&d(t))return t=n.override?s(e,t.signatures):s(l[e],t),l[e]=t,A(e,t),void l.emit("import",e,function(){return t});if(void 0===l[e]||n.override)return l[e]=t,A(e,t),void l.emit("import",e,function(){return t});if(!n.silent)throw new Error('Cannot import "'+e+'": already exists')}function A(e,t){t&&"function"==typeof t.transform?(l.expression.transform[e]=t.transform,f(e)&&(l.expression.mathWithTransform[e]=t.transform)):(delete l.expression.transform[e],f(e)&&(l.expression.mathWithTransform[e]=t))}function u(e,t){if("string"==typeof e.name){var o=e.name,a=o in l.expression.transform,c=e.path?i(l,e.path):l,A=c.hasOwnProperty(o)?c[o]:void 0,u=function(){var r=n(e);if(r&&"function"==typeof r.transform)throw new Error('Transforms cannot be attached to factory functions. Please create a separate function for it with exports.path="expression.transform"');if(d(A)&&d(r))return t.override||(r=s(A,r)),r;if(void 0===A||t.override)return r;if(!t.silent)throw new Error('Cannot import "'+o+'": already exists')};!1!==e.lazy?(r(c,o,u),a||("expression.transform"===e.path||p(e))&&r(l.expression.mathWithTransform,o,u)):(c[o]=u(),a||("expression.transform"===e.path||p(e))&&(l.expression.mathWithTransform[o]=u())),l.emit("import",o,u,e.path)}else n(e)}function h(t){return"function"==typeof t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t||null===t||t&&e.isUnit(t)||t&&e.isComplex(t)||t&&e.isBigNumber(t)||t&&e.isFraction(t)||t&&e.isMatrix(t)||t&&Array.isArray(t)}function d(e){return"function"==typeof e&&"object"==typeof e.signatures}function f(e){return!g.hasOwnProperty(e)}function p(e){return void 0===e.path&&!g.hasOwnProperty(e.name)}var g={expression:!0,type:!0,docs:!0,error:!0,json:!0,chain:!0};return function e(t,n){var r=arguments.length;if(1!==r&&2!==r)throw new a("import",r,1,2);if(n||(n={}),o(t))u(t,n);else if(Array.isArray(t))t.forEach(function(t){e(t,n)});else if("object"==typeof t){for(var i in t)if(t.hasOwnProperty(i)){var s=t[i];h(s)?c(i,s,n):o(t)?u(t,n):e(s,n)}}else if(!n.silent)throw new TypeError("Factory, Object, or Array expected")}},t.lazy=!0},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){"use strict";var r,o;void 0===(o="function"==typeof(r=function(){return function e(){function t(e){for(var t,n=0;n<g.types.length;n++){var r=g.types[n];if(r.name===e){t=r.test;break}}if(!t){var o;for(n=0;n<g.types.length;n++)if((r=g.types[n]).name.toLowerCase()==e.toLowerCase()){o=r.name;break}throw new Error('Unknown type "'+e+'"'+(o?'. Did you mean "'+o+'"?':""))}return t}function n(e){for(var t="",n=0;n<e.length;n++){var r=e[n];if(r.signatures&&""!=r.name)if(""==t)t=r.name;else if(t!=r.name){var o=new Error("Function names do not match (expected: "+t+", actual: "+r.name+")");throw o.data={actual:r.name,expected:t},o}}return t}function r(e,t,n,r,o){var i,a=c(r),s=o?o.split(","):null,l=e||"unnamed",u=s&&A(s,"any"),h={fn:e,index:n,actual:a,expected:s};i=s?t>n&&!u?"Unexpected type of argument in function "+l+" (expected: "+s.join(" or ")+", actual: "+a+", index: "+n+")":"Too few arguments in function "+l+" (expected: "+s.join(" or ")+", index: "+n+")":"Too many arguments in function "+l+" (expected: "+n+", actual: "+t+")";var d=new TypeError(i);return d.data=h,d}function o(e){this.name=e||"refs",this.categories={}}function i(e,t){if("string"==typeof e){var n=e.trim(),r="..."===n.substr(0,3);if(r&&(n=n.substr(3)),""===n)this.types=["any"];else{this.types=n.split("|");for(var o=0;o<this.types.length;o++)this.types[o]=this.types[o].trim()}}else{if(!Array.isArray(e)){if(e instanceof i)return e.clone();throw new Error("String or Array expected")}this.types=e}this.conversions=[],this.varArgs=r||t||!1,this.anyType=-1!==this.types.indexOf("any")}function a(e,t){var n;if("string"==typeof e)n=""!==e?e.split(","):[];else{if(!Array.isArray(e))throw new Error("string or Array expected");n=e}this.params=new Array(n.length),this.anyType=!1,this.varArgs=!1;for(var r=0;r<n.length;r++){var o=new i(n[r]);if(this.params[r]=o,o.anyType&&(this.anyType=!0),r===n.length-1)this.varArgs=o.varArgs;else if(o.varArgs)throw new SyntaxError('Unexpected variable arguments operator "..."')}this.fn=t}function s(e,t,n,r){this.path=e||[],this.param=e[e.length-1]||null,this.signature=t||null,this.childs=n||[],this.fallThrough=r||!1}function l(e,t){var n=new o,l=function(e){var t,n,r={},o=[];for(var i in e)if(e.hasOwnProperty(i)){if((t=new a(i,e[i])).ignore())continue;var s=t.expand();for(n=0;n<s.length;n++){var l=s[n],c=l.toString(),u=r[c];if(u){var h=a.compare(l,u);if(h<0)r[c]=l;else if(0===h)throw new Error('Signature "'+c+'" is defined twice')}else r[c]=l}}for(c in r)r.hasOwnProperty(c)&&o.push(r[c]);for(o.sort(function(e,t){return a.compare(e,t)}),n=0;n<o.length;n++)if((t=o[n]).varArgs)for(var d=t.params.length-1,f=t.params[d],p=0;p<f.types.length;){if(f.conversions[p])for(var g=f.types[p],m=0;m<o.length;m++){var v=o[m],y=v.params[d];if(v!==t&&y&&A(y.types,g)&&!y.conversions[d]){f.types.splice(p,1),f.conversions.splice(p,1),p--;break}}p++}return o}(t);if(0==l.length)throw new Error("No signatures provided");var c=function e(t,n,r){var o,a,l,c=n.length,u=[];for(o=0;o<t.length;o++)(a=t[o]).params.length!==c||l||(l=a),void 0!=a.params[c]&&u.push(a);u.sort(function(e,t){return i.compare(e.params[c],t.params[c])});var h=[];for(o=0;o<u.length;o++){var d=(a=u[o]).params[c],f=h.filter(function(e){return e.param.overlapping(d)})[0];if(f){if(f.param.varArgs)throw new Error('Conflicting types "'+f.param+'" and "'+d+'"');f.signatures.push(a)}else h.push({param:d,signatures:[a]})}var p=[];for(o=0;o<r.length;o++)r[o].paramsStartWith(n)&&p.push(r[o]);var g=!1;for(o=0;o<p.length;o++)if(!A(t,p[o])){g=!0;break}var m=new Array(h.length);for(o=0;o<h.length;o++){var v=h[o];m[o]=e(v.signatures,n.concat(v.param),p)}return new s(n,l,m,g)}(l,[],function(e){for(var t=[],n=0;n<e.length;n++)e[n].anyType&&t.push(e[n]);return t}(l)),u=[],h=(e||"").replace(/[^a-zA-Z0-9_$]/g,"_"),d=function(e){for(var t=[],n=0;n<e;n++)t[n]="arg"+n;return t}(function(e){for(var t=0,n=0;n<e.length;n++){var r=e[n].params.length;r>t&&(t=r)}return t}(l));u.push("function "+h+"("+d.join(", ")+") {"),u.push('  "use strict";'),u.push("  var name = "+JSON.stringify(e||"")+";"),u.push(c.toCode(n,"  ",!1)),u.push("}");var f=[n.toCode(),"return "+u.join("\n")].join("\n"),p=new Function(n.name,"createError",f)(n,r);return p.signatures=function(e){for(var t={},n=0;n<e.length;n++){var r=e[n];if(r.fn&&!r.hasConversions())t[r.params.join(",")]=r.fn}return t}(l),p}function c(e){for(var t,n=0;n<g.types.length;n++){var r=g.types[n];if("Object"===r.name)t=r;else if(r.test(e))return r.name}return t&&t.test(e)?t.name:"unknown"}function A(e,t){return-1!==e.indexOf(t)}function u(e){return e[e.length-1]}o.prototype.add=function(e,t){var n=t||"fn";this.categories[n]||(this.categories[n]=[]);var r=this.categories[n].indexOf(e);return-1==r&&(r=this.categories[n].length,this.categories[n].push(e)),n+r},o.prototype.toCode=function(){var e=[],t=this.name+".categories",n=this.categories;for(var r in n)if(n.hasOwnProperty(r))for(var o=n[r],i=0;i<o.length;i++)e.push("var "+r+i+" = "+t+"['"+r+"']["+i+"];");return e.join("\n")},i.compare=function(e,t){if(e.anyType)return 1;if(t.anyType)return-1;if(A(e.types,"Object"))return 1;if(A(t.types,"Object"))return-1;if(e.hasConversions()){if(t.hasConversions()){var n,r,o;for(n=0;n<e.conversions.length;n++)if(void 0!==e.conversions[n]){r=e.conversions[n];break}for(n=0;n<t.conversions.length;n++)if(void 0!==t.conversions[n]){o=t.conversions[n];break}return g.conversions.indexOf(r)-g.conversions.indexOf(o)}return 1}if(t.hasConversions())return-1;var i,a;for(n=0;n<g.types.length;n++)if(g.types[n].name===e.types[0]){i=n;break}for(n=0;n<g.types.length;n++)if(g.types[n].name===t.types[0]){a=n;break}return i-a},i.prototype.overlapping=function(e){for(var t=0;t<this.types.length;t++)if(A(e.types,this.types[t]))return!0;return!1},i.prototype.matches=function(e){return this.anyType||e.anyType||this.overlapping(e)},i.prototype.clone=function(){var e=new i(this.types.slice(),this.varArgs);return e.conversions=this.conversions.slice(),e},i.prototype.hasConversions=function(){return this.conversions.length>0},i.prototype.contains=function(e){for(var t=0;t<this.types.length;t++)if(e[this.types[t]])return!0;return!1},i.prototype.toString=function(e){for(var t=[],n={},r=0;r<this.types.length;r++){var o=this.conversions[r],i=e&&o?o.to:this.types[r];i in n||(n[i]=!0,t.push(i))}return(this.varArgs?"...":"")+t.join("|")},a.prototype.clone=function(){return new a(this.params.slice(),this.fn)},a.prototype.expand=function(){var e=[];return function t(n,r){if(r.length<n.params.length){var o,s,l,c=n.params[r.length];if(c.varArgs){for(s=c.clone(),o=0;o<g.conversions.length;o++)if(l=g.conversions[o],!A(c.types,l.from)&&A(c.types,l.to)){var u=s.types.length;s.types[u]=l.from,s.conversions[u]=l}t(n,r.concat(s))}else{for(o=0;o<c.types.length;o++)t(n,r.concat(new i(c.types[o])));for(o=0;o<g.conversions.length;o++)l=g.conversions[o],!A(c.types,l.from)&&A(c.types,l.to)&&((s=new i(l.from)).conversions[0]=l,t(n,r.concat(s)))}}else e.push(new a(r,n.fn))}(this,[]),e},a.compare=function(e,t){if(e.params.length>t.params.length)return 1;if(e.params.length<t.params.length)return-1;var n,r=e.params.length,o=0,a=0;for(n=0;n<r;n++)e.params[n].hasConversions()&&o++,t.params[n].hasConversions()&&a++;if(o>a)return 1;if(o<a)return-1;for(n=0;n<e.params.length;n++){var s=i.compare(e.params[n],t.params[n]);if(0!==s)return s}return 0},a.prototype.hasConversions=function(){for(var e=0;e<this.params.length;e++)if(this.params[e].hasConversions())return!0;return!1},a.prototype.ignore=function(){for(var e={},t=0;t<g.ignore.length;t++)e[g.ignore[t]]=!0;for(t=0;t<this.params.length;t++)if(this.params[t].contains(e))return!0;return!1},a.prototype.paramsStartWith=function(e){if(0===e.length)return!0;for(var t=u(this.params),n=u(e),r=0;r<e.length;r++){var o=this.params[r]||(t.varArgs?t:null),i=e[r]||(n.varArgs?n:null);if(!o||!i||!o.matches(i))return!1}return!0},a.prototype.toCode=function(e,t){for(var n=new Array(this.params.length),r=0;r<this.params.length;r++){var o=this.params[r],i=o.conversions[0];o.varArgs?n[r]="varArgs":n[r]=i?e.add(i.convert,"convert")+"(arg"+r+")":"arg"+r}var a=this.fn?e.add(this.fn,"signature"):void 0;return a?t+"return "+a+"("+n.join(", ")+"); // signature: "+this.params.join(", "):[].join("\n")},a.prototype.toString=function(){return this.params.join(", ")},s.prototype.toCode=function(e,n){var r=[];if(this.param){var o=this.path.length-1,i=this.param.conversions[0],a="// type: "+(i?i.from+" (convert to "+i.to+")":this.param);if(this.param.varArgs)if(this.param.anyType)r.push(n+"if (arguments.length > "+o+") {"),r.push(n+"  var varArgs = [];"),r.push(n+"  for (var i = "+o+"; i < arguments.length; i++) {"),r.push(n+"    varArgs.push(arguments[i]);"),r.push(n+"  }"),r.push(this.signature.toCode(e,n+"  ")),r.push(n+"}");else{for(var s=function(n,r){for(var o=[],i=0;i<n.length;i++)o[i]=e.add(t(n[i]),"test")+"("+r+")";return o.join(" || ")}.bind(this),l=this.param.types,c=[],A=0;A<l.length;A++)void 0===this.param.conversions[A]&&c.push(l[A]);r.push(n+"if ("+s(l,"arg"+o)+") { "+a),r.push(n+"  var varArgs = [arg"+o+"];"),r.push(n+"  for (var i = "+(o+1)+"; i < arguments.length; i++) {"),r.push(n+"    if ("+s(c,"arguments[i]")+") {"),r.push(n+"      varArgs.push(arguments[i]);");for(A=0;A<l.length;A++){var u=this.param.conversions[A];if(u){var h=e.add(t(l[A]),"test"),d=e.add(u.convert,"convert");r.push(n+"    }"),r.push(n+"    else if ("+h+"(arguments[i])) {"),r.push(n+"      varArgs.push("+d+"(arguments[i]));")}}r.push(n+"    } else {"),r.push(n+"      throw createError(name, arguments.length, i, arguments[i], '"+c.join(",")+"');"),r.push(n+"    }"),r.push(n+"  }"),r.push(this.signature.toCode(e,n+"  ")),r.push(n+"}")}else if(this.param.anyType)r.push(n+"// type: any"),r.push(this._innerCode(e,n));else{var f=this.param.types[0];h="any"!==f?e.add(t(f),"test"):null;r.push(n+"if ("+h+"(arg"+o+")) { "+a),r.push(this._innerCode(e,n+"  ")),r.push(n+"}")}}else r.push(this._innerCode(e,n));return r.join("\n")},s.prototype._innerCode=function(e,t){var n,r=[];for(this.signature&&(r.push(t+"if (arguments.length === "+this.path.length+") {"),r.push(this.signature.toCode(e,t+"  ")),r.push(t+"}")),n=0;n<this.childs.length;n++)r.push(this.childs[n].toCode(e,t));if(!this.fallThrough||this.param&&this.param.anyType){var o=this._exceptions(e,t);o&&r.push(o)}return r.join("\n")},s.prototype._exceptions=function(e,t){var n=this.path.length;if(0===this.childs.length)return[t+"if (arguments.length > "+n+") {",t+"  throw createError(name, arguments.length, "+n+", arguments["+n+"]);",t+"}"].join("\n");for(var r={},o=[],i=0;i<this.childs.length;i++){var a=this.childs[i];if(a.param)for(var s=0;s<a.param.types.length;s++){var l=a.param.types[s];l in r||a.param.conversions[s]||(r[l]=!0,o.push(l))}}return t+"throw createError(name, arguments.length, "+n+", arguments["+n+"], '"+o.join(",")+"');"};var h=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:function(e){return"object"==typeof e}},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],d={},f=[],p=[],g={config:d,types:h,conversions:f,ignore:p};return(g=l("typed",{Object:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(e[r]);return l(n(t),e)},"string, Object":l,"...Function":function(e){for(var t,r=n(e),o={},i=0;i<e.length;i++){var a=e[i];if("object"!=typeof a.signatures)throw(t=new TypeError("Function is no typed-function (index: "+i+")")).data={index:i},t;for(var s in a.signatures)if(a.signatures.hasOwnProperty(s))if(o.hasOwnProperty(s)){if(a.signatures[s]!==o[s])throw(t=new Error('Signature "'+s+'" is defined twice')).data={signature:s},t}else o[s]=a.signatures[s]}return l(r,o)}})).config=d,g.types=h,g.conversions=f,g.ignore=p,g.create=e,g.find=function(e,t){if(!e.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof t){n=t.split(",");for(var r=0;r<n.length;r++)n[r]=n[r].trim()}else{if(!Array.isArray(t))throw new TypeError("String array or a comma separated string expected");n=t}var o=n.join(","),i=e.signatures[o];if(i)return i;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+n.join(", ")+"))")},g.convert=function(e,t){var n=c(e);if(t===n)return e;for(var r=0;r<g.conversions.length;r++){var o=g.conversions[r];if(o.from===n&&o.to===t)return o.convert(e)}throw new Error("Cannot convert from "+n+" to "+t)},g.addType=function(e){if(!e||"string"!=typeof e.name||"function"!=typeof e.test)throw new TypeError("Object with properties {name: string, test: function} expected");g.types.push(e)},g.addConversion=function(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");g.conversions.push(e)},g}()})?r.apply(t,[]):r)||(e.exports=o)},function(e,t,n){var r=n(322),o=n(6).digits,i=n(61),a=n(60),s=function(){return s=r.create,r};t.create=function(e){e.isNumber=function(e){return"number"==typeof e},e.isComplex=function(t){return e.Complex&&t instanceof e.Complex||!1},e.isBigNumber=i,e.isFraction=function(t){return e.Fraction&&t instanceof e.Fraction||!1},e.isUnit=function(e){return e&&e.constructor.prototype.isUnit||!1},e.isString=function(e){return"string"==typeof e},e.isArray=Array.isArray,e.isMatrix=a,e.isDenseMatrix=function(e){return e&&e.isDenseMatrix&&e.constructor.prototype.isMatrix||!1},e.isSparseMatrix=function(e){return e&&e.isSparseMatrix&&e.constructor.prototype.isMatrix||!1},e.isRange=function(e){return e&&e.constructor.prototype.isRange||!1},e.isIndex=function(e){return e&&e.constructor.prototype.isIndex||!1},e.isBoolean=function(e){return"boolean"==typeof e},e.isResultSet=function(e){return e&&e.constructor.prototype.isResultSet||!1},e.isHelp=function(e){return e&&e.constructor.prototype.isHelp||!1},e.isFunction=function(e){return"function"==typeof e},e.isDate=function(e){return e instanceof Date},e.isRegExp=function(e){return e instanceof RegExp},e.isObject=function(e){return"object"==typeof e},e.isNull=function(e){return null===e},e.isUndefined=function(e){return void 0===e},e.isAccessorNode=function(e){return e&&e.isAccessorNode&&e.constructor.prototype.isNode||!1},e.isArrayNode=function(e){return e&&e.isArrayNode&&e.constructor.prototype.isNode||!1},e.isAssignmentNode=function(e){return e&&e.isAssignmentNode&&e.constructor.prototype.isNode||!1},e.isBlockNode=function(e){return e&&e.isBlockNode&&e.constructor.prototype.isNode||!1},e.isConditionalNode=function(e){return e&&e.isConditionalNode&&e.constructor.prototype.isNode||!1},e.isConstantNode=function(e){return e&&e.isConstantNode&&e.constructor.prototype.isNode||!1},e.isFunctionAssignmentNode=function(e){return e&&e.isFunctionAssignmentNode&&e.constructor.prototype.isNode||!1},e.isFunctionNode=function(e){return e&&e.isFunctionNode&&e.constructor.prototype.isNode||!1},e.isIndexNode=function(e){return e&&e.isIndexNode&&e.constructor.prototype.isNode||!1},e.isNode=function(e){return e&&e.isNode&&e.constructor.prototype.isNode||!1},e.isObjectNode=function(e){return e&&e.isObjectNode&&e.constructor.prototype.isNode||!1},e.isOperatorNode=function(e){return e&&e.isOperatorNode&&e.constructor.prototype.isNode||!1},e.isParenthesisNode=function(e){return e&&e.isParenthesisNode&&e.constructor.prototype.isNode||!1},e.isRangeNode=function(e){return e&&e.isRangeNode&&e.constructor.prototype.isNode||!1},e.isSymbolNode=function(e){return e&&e.isSymbolNode&&e.constructor.prototype.isNode||!1},e.isChain=function(e){return e&&e.constructor.prototype.isChain||!1};var t=s();return t.types=[{name:"number",test:e.isNumber},{name:"Complex",test:e.isComplex},{name:"BigNumber",test:e.isBigNumber},{name:"Fraction",test:e.isFraction},{name:"Unit",test:e.isUnit},{name:"string",test:e.isString},{name:"Array",test:e.isArray},{name:"Matrix",test:e.isMatrix},{name:"DenseMatrix",test:e.isDenseMatrix},{name:"SparseMatrix",test:e.isSparseMatrix},{name:"Range",test:e.isRange},{name:"Index",test:e.isIndex},{name:"boolean",test:e.isBoolean},{name:"ResultSet",test:e.isResultSet},{name:"Help",test:e.isHelp},{name:"function",test:e.isFunction},{name:"Date",test:e.isDate},{name:"RegExp",test:e.isRegExp},{name:"Object",test:e.isObject},{name:"null",test:e.isNull},{name:"undefined",test:e.isUndefined},{name:"OperatorNode",test:e.isOperatorNode},{name:"ConstantNode",test:e.isConstantNode},{name:"SymbolNode",test:e.isSymbolNode},{name:"ParenthesisNode",test:e.isParenthesisNode},{name:"FunctionNode",test:e.isFunctionNode},{name:"FunctionAssignmentNode",test:e.isFunctionAssignmentNode},{name:"ArrayNode",test:e.isArrayNode},{name:"AssignmentNode",test:e.isAssignmentNode},{name:"BlockNode",test:e.isBlockNode},{name:"ConditionalNode",test:e.isConditionalNode},{name:"IndexNode",test:e.isIndexNode},{name:"RangeNode",test:e.isRangeNode},{name:"Node",test:e.isNode}],t.conversions=[{from:"number",to:"BigNumber",convert:function(t){if(o(t)>15)throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+t+"). Use function bignumber(x) to convert to BigNumber.");return new e.BigNumber(t)}},{from:"number",to:"Complex",convert:function(t){return new e.Complex(t,0)}},{from:"number",to:"string",convert:function(e){return e+""}},{from:"BigNumber",to:"Complex",convert:function(t){return new e.Complex(t.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(e){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(t){return new e.Complex(t.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(t){if(new e.Fraction(t).valueOf()!==t)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+t+"). Use function fraction(x) to convert to Fraction.");return new e.Fraction(t)}},{from:"string",to:"number",convert:function(e){var t=Number(e);if(isNaN(t))throw new Error('Cannot convert "'+e+'" to a number');return t}},{from:"string",to:"BigNumber",convert:function(t){try{return new e.BigNumber(t)}catch(e){throw new Error('Cannot convert "'+t+'" to BigNumber')}}},{from:"string",to:"Fraction",convert:function(t){try{return new e.Fraction(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Fraction')}}},{from:"string",to:"Complex",convert:function(t){try{return new e.Complex(t)}catch(e){throw new Error('Cannot convert "'+t+'" to Complex')}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(t){return new e.BigNumber(+t)}},{from:"boolean",to:"Fraction",convert:function(t){return new e.Fraction(+t)}},{from:"boolean",to:"string",convert:function(e){return+e}},{from:"null",to:"number",convert:function(){return 0}},{from:"null",to:"string",convert:function(){return"null"}},{from:"null",to:"BigNumber",convert:function(){return new e.BigNumber(0)}},{from:"null",to:"Fraction",convert:function(){return new e.Fraction(0)}},{from:"Array",to:"Matrix",convert:function(t){return new e.DenseMatrix(t)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}],t}},function(e,t,n){var r=n(7).isFactory,o=n(323),i=n(112),a=n(320),s=n(318);t.create=function(e){if("function"!=typeof Object.create)throw new Error("ES5 not supported by this JavaScript engine. Please load the es5-shim and es5-sham library for compatibility.");var t=[],n=[],l=i.mixin({});l.type={},l.expression={transform:{},mathWithTransform:{}},l.typed=o.create(l.type);var c={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function A(e){if(!r(e))throw new Error("Factory object with properties `type`, `name`, and `factory` expected");var o,i=t.indexOf(e);return-1===i?(o=!0===e.math?e.factory(l.type,c,A,l.typed,l):e.factory(l.type,c,A,l.typed),t.push(e),n.push(o)):o=n[i],o}return l.import=A(a),l.config=A(s),l.expression.mathWithTransform.config=l.config,e&&l.config(e),l}},function(e,t){var n=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],r=607/128,o=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function i(e){if(e<0)return Number("0/0");for(var t=o[0],n=o.length-1;n>0;--n)t+=o[n]/(e+n);var i=e+r+.5;return.5*Math.log(2*Math.PI)+(e+.5)*Math.log(i)-i+Math.log(t)-Math.log(e)}e.exports=function e(t){if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*e(1-t));if(t>100)return Math.exp(i(t));t-=1;for(var r=n[0],o=1;o<9;o++)r+=n[o]/(t+o);var a=t+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(a,t+.5)*Math.exp(-a)*r},e.exports.log=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.VolcanoEntry=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.volcanoItemIndex=parseInt(t.volcanoItemIndex),t.hasOwnProperty("gene")?this.gene=parseInt(t.gene):t.hasOwnProperty("rppa")&&(this.rppa=parseInt(t.rppa)),this.x=0,this.y=0,t.hasOwnProperty("pValLog10")&&(this.pValLog10=+t.pValLog10),t.hasOwnProperty("log2FcTrimean")&&(this.log2FcTrimean=+t.log2FcTrimean),t.hasOwnProperty("log2FcMean")&&(this.log2FcMean=+t.log2FcMean),t.hasOwnProperty("pearsonZ")&&(this.pearsonZ=t.pearsonZ),t.hasOwnProperty("spearmanZ")&&(this.spearmanZ=t.spearmanZ),t.hasOwnProperty("pearson")&&(this.pearson=t.pearson),t.hasOwnProperty("spearman")&&(this.spearman=t.spearman),t.hasOwnProperty("maxExpression")&&(this.maxExpression=t.maxExpression),t.hasOwnProperty("numSelected")&&(this.numSelected=parseInt(t.numSelected)),t.hasOwnProperty("numInverted")&&(this.numInverted=parseInt(t.numInverted)),t.hasOwnProperty("numSwitched")&&(this.numSwitched=parseInt(t.numSwitched)),n>0){this.includedComparisons=new Set;for(var r=0;r<n;++r)1===parseInt(t[r.toString()])&&this.includedComparisons.add(r)}}return r(e,[{key:"setX",value:function(e){this.x=this[e]}},{key:"setY",value:function(e){this.y=this[e]}},{key:"getMag",value:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}},{key:"getBioIndex",value:function(){return this.hasOwnProperty("gene")?this.gene:this.rppa}},{key:"getGeneIndices",value:function(e){if(this.hasOwnProperty("gene"))return[this.gene];if(this.hasOwnProperty("rppa")){var t=[];return e.rppaAntibodies[this.rppa].geneIds.forEach(function(e){t.push(e)}),t}}},{key:"isPromising",value:function(){return this.hasOwnProperty("rppa")||Math.abs(this.pValLog10)>.3||Math.abs(this.log2FcMean)>.5||Math.abs(this.log2FcTrimean)>.5}},{key:"getComparisonSummary",value:function(e){var t=[];return this.hasOwnProperty("includedComparisons")&&this.includedComparisons.forEach(function(n){t.push(e.comparisonTypes[n])}),t.join(",")}},{key:"getName",value:function(e){return this.hasOwnProperty("gene")?e.genes.get(this.gene).geneName:e.rppaAntibodies[this.rppa].rppaName}},{key:"getHoverLabel",value:function(e){var t=this.getComparisonSummary(e);if(this.hasOwnProperty("gene")){var n=[];return e.genes.get(this.gene).cytobandIndices.forEach(function(t){n.push(e.cytobands[t].cytobandName)}),e.genes.get(this.gene).geneName+"\n("+n.join(",")+")\n"+t}var r=[];return e.rppaAntibodies[this.rppa].geneIds.forEach(function(t){r.push(e.genes.get(t).geneName)}),r=Array.from(new Set(r)).sort(),e.rppaAntibodies[this.rppa].rppaName+": "+r.join(",")+"\n"+t}},{key:"getLabel",value:function(e){if(this.hasOwnProperty("gene")){var t=[];return e.genes.get(this.gene).cytobandIndices.forEach(function(n){t.push(e.cytobands[n].cytobandName)}),e.genes.get(this.gene).getGeneCardsLinkPlain()+" ("+t.join(",")+")"}var n=[];return e.rppaAntibodies[this.rppa].geneIds.forEach(function(t){n.push(e.genes.get(t).getGeneCardsLinkPlain())}),e.rppaAntibodies[this.rppa].rppaName+": "+n.join(",")}},{key:"textExport_variant",value:function(e){var t=[];this.hasOwnProperty("gene")?t.push(e.genes.get(this.gene).geneName):this.hasOwnProperty("rppa")?t.push(e.rppaAntibodies[this.rppa].rppaName):t.push("NA"),t.push(this.pValLog10),t.push(this.log2FcTrimean),t.push(this.log2FcMean),t.push(this.numSelected),t.push(this.numInverted),t.push(this.numSwitched);var n=[];return this.includedComparisons.forEach(function(t){n.push(e.comparisonTypes[t])}),t.push(n.join(",")),t}},{key:"textExport_subcohort",value:function(e){var t=[];return this.hasOwnProperty("gene")?t.push(e.genes.get(this.gene).geneName):this.hasOwnProperty("rppa")?t.push(e.rppaAntibodies[this.rppa].rppaName):t.push("NA"),t.push(this.pValLog10),t.push(this.log2FcTrimean),t.push(this.log2FcMean),t}},{key:"textExport_correlation",value:function(e){var t=[];return this.hasOwnProperty("gene")?t.push(e.genes.get(this.gene).geneName):this.hasOwnProperty("rppa")?t.push(e.rppaAntibodies[this.rppa].rppaName):t.push("NA"),t.push(this.pearsonR),t.push(this.spearmanR),t}}],[{key:"generalHeaderExport",value:function(e){return"variant"===e?["Gene/Rppa","pValLog10","log2FcTrimean","log2FcMean","numSelected","numInverted","numSwitched","includedComparisons"]:"subcohort"===e?["Gene/Rppa","pValLog10","log2FcTrimean","log2FcMean"]:"correlation"===e?["Gene/Rppa","PearsonR","SpearmanR"]:void 0}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Volcano=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(13),s=n(326),l=n(1),c=n(115),A=n(113),u=n(105),h=n(62),d=n(114),f=n(63),p=n(273);function g(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var m=n(272);t.Volcano=function(){function t(e,n,o,i,a,s,l,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.selectionManager=i,this.references=n,this.cohortMetadata=o,this.volcanoPhenotype=a,this.mutexMode="Mutex"===this.volcanoPhenotype,this.mutexMode?this.truePhenotype="gene":(this.truePhenotype=this.volcanoPhenotype.replace("Expression",""),this.truePhenotype=this.truePhenotype.replace(this.truePhenotype[0],this.truePhenotype[0].toLowerCase())),this.volcanoTypePrefix=s,this.correlationMode="correlation"===this.volcanoTypePrefix,this.fontManager=l,this.textExportManager=c,this.volcanoId=""+this.volcanoTypePrefix+this.volcanoPhenotype+"Volcano",this.volcanoSVG=null,this.addHtml(),this.currentSubcohortIndex=0,this.tmpExpressions=new Map,this.anchorGeneId=null,this.anchorExpressions=[],this.displaySettings={maxX:0,maxXForced:0,minY:1e10,maxY:0,maxYForced:0,modifiedVolcanoAxisX:!1,modifiedVolcanoAxisY:!1,markedVolcanoItems:new Set,hiddenVolcanoItems:new Set,lastVolcanoItemIndex:-1,volcanoVbox:null,minDonors:0},this.displayAndControlElements={VolcanoPatientLimit:this.volcanoId+"PatientLimit",VolcanoCircleClass:this.volcanoId+"CircleClass",VolcanoRadius:this.volcanoId+"Radius",VolcanoFrame:this.volcanoId+"Frame",VolcanoTitle:this.volcanoId+"Title",VolcanoTitleFrame:this.volcanoId+"TitleFrame",VolcanoContent:this.volcanoId+"Content",VolcanoSvg:this.volcanoId+"Svg",VolcanoGeneMarkerClass:this.volcanoId+"GeneMarkerClass",VolcanoGeneMarkerHelperClass:this.volcanoId+"GeneMarkerHelperClass",VolcanoXRadioButton:this.volcanoId+"XRadioButton",VolcanoXRadioButtonAlt1:this.volcanoId+"XRadioButtonAlt1",VolcanoXRadioButtonAlt2:this.volcanoId+"XRadioButtonAlt2",VolcanoYRadioButton:this.volcanoId+"YRadioButton",VolcanoYRadioButtonAlt1:this.volcanoId+"YRadioButtonAlt1",VolcanoYRadioButtonAlt2:this.volcanoId+"YRadioButtonAlt2",VolcanoYRadioButtonAlt3:this.volcanoId+"YRadioButtonAlt3",VolcanoYRadioButtonAlt4:this.volcanoId+"YRadioButtonAlt4",VolcanoClearMarkedGenes:this.volcanoId+"ClearMarkedGenes",VolcanoResetAxis:this.volcanoId+"ResetAxis",VolcanoRecoverHiddenData:this.volcanoId+"RecoverHiddenData",VolcanoGoToGeneTad:this.volcanoId+"GoToGeneTad",VolcanoFoldChangeType:this.volcanoId+"FoldChangeType",VolcanoComparisonClassSelectionSubmit:this.volcanoId+"ComparisonClassSelectionSubmit",VolcanoIndices:this.volcanoId+"Indices"},this.volcanoTitle="",this.currentVolcanoIndex=-1,this.xFieldName="",this.yFieldName="",this.testName="";var A=this.setFieldNamesXY(),u=r(A,3);this.xFieldName=u[0],this.yFieldName=u[1],this.testName=u[2],this.currentComparisonClasses=[new Set,new Set],this.volcanoIndexToDataIndex=new Map,this.data=[],this.circleGroup=null,this.singleGeneExpression=null,this.singleRppaExpression=null,this.group1Index=0,this.group2Index=0,this.currentSubcohortIndex=0,this.currentSubcohortDonors=new Set,this.uniqueGroup1Donors=new Set,this.uniqueGroup2Donors=new Set,this.subcohort12commonDonors=new Set,this.rectStart={},this.rectEnd={},this.constructed=!1,this.minMaxExpression=1,this.validDonorsForComparison=new Set,this.enableControls()}return o(t,[{key:"checkboxTemplateGenerator",value:function(e,t,n){return'\n                <label class="custom-control custom-checkbox '+(n?"active":"")+'">\n                    <input id="allow_'+this.volcanoId+e+'" type="checkbox" class="custom-control-input" '+(n?"checked":"")+'>\n                    <span class="custom-control-indicator"></span>\n                    <span class="custom-control-description">'+t+"</span>\n                </label>"}},{key:"addHtml",value:function(){var t=[];t.push('<div class="input-group panel panel-default" id="'+this.volcanoId+'GeneClassSelectionGroup">'),t.push(this.checkboxTemplateGenerator("Coding","Coding",!0)),t.push(this.checkboxTemplateGenerator("LincRNA","lincRNA",!0)),t.push(this.checkboxTemplateGenerator("MiRNA","miRNA",!0)),t.push(this.checkboxTemplateGenerator("Pseudo","Pseudo",!1)),t.push(this.checkboxTemplateGenerator("IgtrGene","IG or T-Cell receptor Genes",!1)),t.push(this.checkboxTemplateGenerator("IgtrPseudoGene","IG or T-Cell receptor PseudoGenes",!1)),t.push(this.checkboxTemplateGenerator("Others","Others",!1)),t.push("</div>");var n=t.join(""),r='\n            <div class="card card-block panel panel-default">\n                <div class="input-group"><label for="'+this.volcanoId+'Radius" \n                    class="col-form-label"\n                    id="'+this.volcanoId+'RadiusLabel">Gene Radius : 1 </label>\n                    <input type="number"\n                        id="'+this.volcanoId+'Radius"\n                        name="'+this.volcanoId+'Radius"\n                        data-provide="slider"\n                        data-slider-min="0.5"\n                        data-slider-max="10"\n                        data-slider-step="0.5"\n                        data-slider-value="1"\n                        data-slider-tooltip="hide"\n                        data-slider-orientation="horizontal">\n                </div>\n            </div>',o='\n            <div class="input-group"><label for="'+this.volcanoId+'PatientLimit"\n                                            class="col-form-label"\n                                            id="'+this.volcanoId+'PatientLimitLabel">Min #Patients in either group : 1 </label>\n                <input type="number"\n                       id="'+this.volcanoId+'PatientLimit"\n                       name="'+this.volcanoId+'PatientLimit"\n                       data-provide="slider"\n                       data-slider-min="1"\n                       data-slider-max="25"\n                       data-slider-step="1"\n                       data-slider-value="1"\n                       data-slider-tooltip="hide"\n                       data-slider-orientation="horizontal">\n            </div>\n            <div class="input-group panel panel-default" id="'+this.volcanoId+'ComparisonClassSelectionGroup">\n                <button id="'+this.volcanoId+'ComparisonClassSelectionSubmit" type="button" class="btn btn-success">Launch Variant Analysis</button>\n                <br>\n                '+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("DirectSv","Gene-body SV hits",!0))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv0","SVs 0-TadOffset",!0))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv1","SVs 1-TadOffset",!0))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv2","SVs 2-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv3","SVs 3-TadOffset",!1))+"\n                <br>\n                "+this.checkboxTemplateGenerator("Amp","cnAmplifications",!0)+"\n                "+this.checkboxTemplateGenerator("Homdel","Homozygous Deletions",!0)+"\n                <br>\n                "+this.checkboxTemplateGenerator("CnvGain","Low-order cnGain",!1)+"\n                "+this.checkboxTemplateGenerator("CnvLoss","Low-order cnLoss",!1)+"\n                <br>\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("OffIndel0","Small-MidSized Indels 0-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("OffIndel1","Small-MidSized Indels 1-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("OffIndel2","Small-MidSized Indels 2-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("OffIndel3","Small-MidSized Indels 3-TadOffset",!1))+"\n                <br>\n                "+this.checkboxTemplateGenerator("Splicing","Splicing Small Variants",!1)+"\n                "+this.checkboxTemplateGenerator("FunctionalSmallVar","Functional Small Variants",!1)+"\n                "+this.checkboxTemplateGenerator("Synonymous","Synonymous SNV",!1)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Upstream","Upstream Small Variants",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Downstream","Downstream Small Variants",!1))+"\n                "+this.checkboxTemplateGenerator("UTR5","5'UTR",!1)+"\n                "+this.checkboxTemplateGenerator("UTR3","3'UTR",!1)+'\n            </div>\n            <br>\n            <div class="row-fluid input-group panel panel-default">\n                <div class="row-fluid input-group panel panel-default">\n                    <p>Fold change</p> \n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt1" name="'+this.volcanoId+'XRadioButton" value="log2FcTrimean">\n                    <label for="'+this.volcanoId+'XRadioButtonAlt1">Trimeans</label>\n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt2" name="'+this.volcanoId+'XRadioButton" value="log2FcMean" checked>\n                    <label for="'+this.volcanoId+'XRadioButtonAlt2">Means</label>\n                </div>\n                <br>\n                <div class="row-fluid input-group panel panel-default">\n                    <p>Statistical Significance</p>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt1" name="'+this.volcanoId+'YRadioButton" value="Ks">\n                    <label for="'+this.volcanoId+'YRadioButtonAlt1">Kolmogorov-Smirnov Test</label><br>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt2" name="'+this.volcanoId+'YRadioButton" value="Kw" checked>\n                    <label for="'+this.volcanoId+'YRadioButtonAlt2">Kruskal-Wallis Test</label><br>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt3" name="'+this.volcanoId+'YRadioButton" value="T">\n                    <label for="'+this.volcanoId+'YRadioButtonAlt3">T-test</label><br>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt4" name="'+this.volcanoId+'YRadioButton" value="Jf">\n                    <label for="'+this.volcanoId+"YRadioButtonAlt4\">Fisher's Exact Test on Jenks-Optimized Breaks</label>\n                </div>\n            </div>",i='\n            <div class="input-group panel panel-default" id="'+this.volcanoId+'VariantClassSelectionGroup">\n                <button id="'+this.volcanoId+'MutexSubmit" type="button" class="btn btn-success" style="display: none;">Launch Mutex Analysis</button>\n                <br>\n                <p>Gene-Level (will be combined per gene with an OR relation)</p>\n                '+this.checkboxTemplateGenerator("FunctionalSmallVar","Functional Small Variants",!0)+"\n                "+this.checkboxTemplateGenerator("Amp","cnAmplifications",!0)+"\n                "+this.checkboxTemplateGenerator("Homdel","Homozygous Deletions",!0)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("DirectSv","Gene-body SV hits",!1))+" \n                "+this.checkboxTemplateGenerator("Synonymous","Synonymous SNV",!1)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Upstream","Upstream Small Variants",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Downstream","Downstream Small Variants",!1))+"\n                "+this.checkboxTemplateGenerator("UTR5","5'UTR",!1)+"\n                "+this.checkboxTemplateGenerator("UTR3","3'UTR",!1)+"\n                "+this.checkboxTemplateGenerator("DoubleHitAlt1","DoubleHit (CNV/LOH+Functional SmallVar)",!1)+"\n                "+this.checkboxTemplateGenerator("DoubleHitAlt2","DoubleHit (CNV/LOH+Functional SmallVar/Direct SV)",!1)+"\n                "+this.checkboxTemplateGenerator("DoubleHitAlt3","DoubleHit (SmallVar+Direct SV)",!1)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("FusionCorrect","GeneFusion (correct orientation)",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("FusionIncorrect","GeneFusion (incorrect orientation)",!1))+"\n                <br>\n                "+(this.commonSettings.wesMode?"":"<p>TAD-Level</p>")+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv0","SVs 0-TadOffset",!0))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv1","SVs 1-TadOffset",!0))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv2","SVs 2-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("Sv3","SVs 3-TadOffset",!1))+"\n                "+(this.commonSettings.wesMode?"":"<br>")+"\n                <p>Cytoband-Level</p>\n                "+this.checkboxTemplateGenerator("GainCyto","CN Gain",!0)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("LOHLossCyto","CN Loss or LOH",!0))+"\n                "+this.checkboxTemplateGenerator("LossCyto","CN Loss",!1)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("LOHCyto","LOH",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("cnnLOHCyto","Copy-Neutral LOH",!1))+"\n                <br>\n                <p>Chromosome Arm-Level</p>\n                "+this.checkboxTemplateGenerator("GainArm","CN Gain",!0)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("LOHLossArm","CN Loss or LOH",!0))+"          \n                "+this.checkboxTemplateGenerator("LossArm","CN Loss",!1)+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("LOHArm","LOH",!1))+"\n                "+(this.commonSettings.wesMode?"":this.checkboxTemplateGenerator("cnnLOHArm","Copy-Neutral LOH",!1))+'\n                <br>\n            </div>\n            <div class="row-fluid" id="'+this.volcanoId+'SubcohortSelectorGroup1">\n                    <div class="col-md-12" style="background-color: #ffe6e6">\n                        <select class="form-control" title="'+this.volcanoId+'SubcohortSelection1" id="'+this.volcanoId+'SubcohortSelector1">\n                        </select>\n                    </div>\n                </div>\n                <br>\n                <div class="row-fluid" id="'+this.volcanoId+'SubcohortSelectorGroup2">\n                    <div class="col-md-12" style="background-color: #cce6ff">\n                        <select class="form-control" title="'+this.volcanoId+'SubcohortSelection2" id="'+this.volcanoId+'SubcohortSelector2">\n                        </select>\n                    </div>\n                </div>\n                <br>\n            </div>',a='\n            <div class="input-group">\n                <p>Select Gene from \'Operations on Genes, Cytobands and RPPA Antibodies\' for Correlation Analysis or a numerical metadata column from below</p>\n                <button id="'+this.volcanoId+'MetadataColumnSelectionSubmit" type="button" class="btn btn-success" style="display: none;">Launch Correlation Analysis from Metadata Entry</button>\n                <div class="row-fluid">\n                    <div class="col-md-12">\n                        <select class="form-control" title="'+this.volcanoId+'MetadataColumnSelection" id="'+this.volcanoId+'MetadataColumnSelector">\n                        </select>\n                    </div>\n                </div>\n                <br>\n                <br>\n                <div class="row-fluid">\n                    <div class="col-md-12">\n                        <select class="form-control" title="'+this.volcanoId+'SubcohortSelection1" id="'+this.volcanoId+'SubcohortSelector1">\n                        </select>\n                    </div>\n                </div>\n                <br>\n                <div class="row-fluid input-group panel panel-default">\n                    <p>X-Axis</p>\n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt1" name="'+this.volcanoId+'XRadioButton" value="pearson" checked>\n                    <label for="'+this.volcanoId+'XRadioButtonAlt1">Pearson Correlation</label>\n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt2" name="'+this.volcanoId+'XRadioButton" value="spearman">\n                    <label for="'+this.volcanoId+'XRadioButtonAlt2">Spearman Correlation</label>\n                </div>\n                <div class="card card-block panel panel-default">\n                    <div class="input-group"><label for="'+this.volcanoId+'MinMaxExpression" \n                        class="col-form-label"\n                        id="'+this.volcanoId+'MinMaxExpressionLabel">Min. Displayed Max. Expression : 1 </label>\n                        <input type="number"\n                            id="'+this.volcanoId+'MinMaxExpression"\n                            name="'+this.volcanoId+'MinMaxExpression"\n                            data-provide="slider"\n                            data-slider-min="1"\n                            data-slider-max="20"\n                            data-slider-step="0.1"\n                            data-slider-value="1"\n                            data-slider-tooltip="hide"\n                            data-slider-orientation="horizontal">\n                    </div>\n                </div>\n            </div>',s='\n            <div class="input-group">\n                <button id="'+this.volcanoId+'SubcohortSelectionSubmit" type="button" class="btn btn-success" style="display: none;">Launch Subcohort Analysis</button>\n                <br>\n                <div class="row-fluid" id="'+this.volcanoId+'SubcohortSelectorGroup1">\n                    <div class="col-md-12" style="background-color: #ffe6e6">\n                        <select class="form-control" title="'+this.volcanoId+'SubcohortSelection1" id="'+this.volcanoId+'SubcohortSelector1">\n                        </select>\n                    </div>\n                </div>\n                <br>\n                <div class="row-fluid" id="'+this.volcanoId+'SubcohortSelectorGroup2">\n                    <div class="col-md-12" style="background-color: #cce6ff">\n                        <select class="form-control" title="'+this.volcanoId+'SubcohortSelection2" id="'+this.volcanoId+'SubcohortSelector2">\n                        </select>\n                    </div>\n                </div>\n                <br> \n                <div class="row-fluid input-group panel panel-default">\n                    <p>Fold change</p>\n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt1" name="'+this.volcanoId+'XRadioButton" value="log2FcTrimean">\n                    <label for="'+this.volcanoId+'XRadioButtonAlt1">Trimeans</label>\n                    <input type="radio" id="'+this.volcanoId+'XRadioButtonAlt2" name="'+this.volcanoId+'XRadioButton" value="log2FcMean" checked>\n                    <label for="'+this.volcanoId+'XRadioButtonAlt2">Means</label>\n                </div>\n                <br>\n                <div class="row-fluid input-group panel panel-default">\n                    <p>Statistical Significance</p>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt1" name="'+this.volcanoId+'YRadioButton" value="Ks">\n                    <label for="'+this.volcanoId+'YRadioButtonAlt1">Kolmogorov-Smirnov Test</label>\n                    <a href="https://github.com/pieterprovoost/jerzy" target="_blank">Github</a>\n                    <br>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt2" name="'+this.volcanoId+'YRadioButton" value="Kw" checked>\n                    <label for="'+this.volcanoId+'YRadioButtonAlt2">Kruskal-Wallis Test</label><br>\n                    <input type="radio" id="'+this.volcanoId+'YRadioButtonAlt3" name="'+this.volcanoId+'YRadioButton" value="T">\n                    <label for="'+this.volcanoId+'YRadioButtonAlt3">T-test</label>\n                    <a href="https://github.com/pieterprovoost/jerzy" target="_blank">Github</a>\n                </div>\n            </div>',l="";"variant"===this.volcanoTypePrefix?l=o:"subcohort"===this.volcanoTypePrefix?l="Mutex"===this.volcanoPhenotype?i:s:"correlation"===this.volcanoTypePrefix&&(l=a);var c='<div class="row-fluid" id="'+this.volcanoId+'ProgressBarGroup" style="display:none">\n                <div class="progress">\n                    <div class="progress-bar" role="progressbar" id="'+this.volcanoId+'ProgressBar" \n                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">\n                    </div>\n                </div>\n            </div>\n            <button id="'+this.volcanoId+'RecoverHiddenData" type="button" class="btn btn-secondary btn" style="display:none">Recover Hidden Data Points</button>\n            <button id="'+this.volcanoId+'ResetAxis" type="button" class="btn btn-secondary btn" style="display:none">Reset Axis</button>',A='<div class="row-fluid" id="'+this.volcanoId+'MarkedEntriesListGroup" style="display:none">\n                <p>\n                    <a class="btn btn-primary" data-toggle="collapse" href="#'+this.volcanoId+'MarkedEntriesListCollapse" aria-expanded="false" aria-controls="'+this.volcanoId+'MarkedEntriesListCollapse" id="'+this.volcanoId+'MarkedEntriesListCollapseControl">\n                        Marked Entries\n                    </a>\n                </p>\n                <div class="collapse" id="'+this.volcanoId+'MarkedEntriesListCollapse">\n                    <button id="'+this.volcanoId+'LaunchConsensusPathDb" type="button" class="btn btn-secondary btn">ConsensusPathDB</button>\n                    <button id="'+this.volcanoId+'LaunchGsea" type="button" class="btn btn-secondary btn">GSEA/MSigDB</button>\n                    <button id="'+this.volcanoId+'LaunchReactome" type="button" class="btn btn-secondary btn">REACTOME</button>\n                    <button id="'+this.volcanoId+'LaunchDavid" type="button" class="btn btn-secondary btn">DAVID</button>\n                    <div id="'+this.volcanoId+'MarkedEntriesList">\n                    </div>                            \n                </div>\n            </div>',u='<div class="input-group" id="'+this.volcanoId+'Controls" style="display: none"></div>';e("#volcanoControls").append(u);var h=e("#"+this.volcanoId+"Controls");"Mutex"!==this.volcanoPhenotype&&h.append(n),h.append(r).append("<br>").append(c).append("<br>").append(l).append("<br>").append(A)}},{key:"enableControls",value:function(){var t=this,n=this;if((0,l.generalizedSliderEvents)(this.displayAndControlElements.VolcanoRadius,function(e){return e},"Gene Radius :",function(e){t.adjustRadius(12*e)}),["Coding","LincRNA","MiRNA","Pseudo","IgtrGene","IgtrPseudoGene","Others"].forEach(function(r){e("#allow_"+t.volcanoId+r).off("change").on("change",function(){setTimeout(function(){n.adjustVisibility()},0)})}),e("#"+this.displayAndControlElements.VolcanoResetAxis).off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),n.resetAxis(),setTimeout(function(){n.plotVolcano()},0),t.commonSettings.releaseLock())}),e("#"+this.volcanoId+"RecoverHiddenData").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),n.displaySettings.hiddenVolcanoItems.clear(),e("#"+t.volcanoId+"RecoverHiddenData").css("display","none"),setTimeout(function(){n.adjustVisibility()},0))}),e("input[name="+this.displayAndControlElements.VolcanoXRadioButton+"]").change(function(){var e=t.setFieldNamesXY(),n=r(e,3);t.xFieldName=n[0],t.yFieldName=n[1],t.testName=n[2],t.constructed&&setTimeout(function(){t.updateMaximums(),t.plotVolcano()},0)}),e("input[name="+this.displayAndControlElements.VolcanoYRadioButton+"]").change(function(){var e=t.setFieldNamesXY(),n=r(e,3);t.xFieldName=n[0],t.yFieldName=n[1],t.testName=n[2],t.constructed&&("variant"===t.volcanoTypePrefix?setTimeout(function(){t.launchVariantAnalysis()},0):"subcohort"===t.volcanoTypePrefix?setTimeout(function(){t.launchSubcohortAnalysis()},0):"correlation"===t.volcanoTypePrefix&&setTimeout(function(){t.updateMaximums(),t.plotVolcano()},0))}),"variant"===this.volcanoTypePrefix){if(!this.commonSettings.wesMode)for(var o=["Sv","OffIndel"],i=function(r){for(var i=o[r],a=function(o){e("#allow_"+t.volcanoId+i+o).on("change.bootstrapSwitch",function(t){if(e("#allow_"+n.volcanoId+i+o).is(":checked")){for(var a=0;a<o;++a){var s=e("#allow_"+n.volcanoId+i+a);s.is(":checked")||s.prop("checked",!0).parent().addClass("active")}if(0===r){var l=e("#allow_"+n.volcanoId+"DirectSv");l.is(":checked")||l.prop("checked",!0).parent().addClass("active")}}})},s=1;s<4;++s)a(s);var l=function(r){e("#allow_"+t.volcanoId+i+r).on("change.bootstrapSwitch",function(t){if(!e("#allow_"+n.volcanoId+i+r).is(":checked"))for(var o=r;o<4;++o){var a=e("#allow_"+n.volcanoId+i+o);a.is(":checked")&&a.prop("checked",!1).parent().removeClass("active")}})};for(s=0;s<3;++s)l(s);0===r&&e("#allow_"+t.volcanoId+"DirectSv").on("change.bootstrapSwitch",function(t){if(!e("#allow_"+n.volcanoId+"DirectSv").is(":checked"))for(var r=0;r<4;++r){var o=e("#allow_"+n.volcanoId+i+r);o.is(":checked")&&o.prop("checked",!1).parent().removeClass("active")}})},a=0;a<o.length;++a)i(a);e("#allow_"+this.volcanoId+"CnvGain").on("change.bootstrapSwitch",function(t){if(e("#allow_"+n.volcanoId+"CnvGain").is(":checked")){var r=e("#allow_"+n.volcanoId+"Amp");r.is(":checked")||r.prop("checked",!0).parent().addClass("active")}}),e("#allow_"+this.volcanoId+"CnvLoss").on("change.bootstrapSwitch",function(t){if(e("#allow_"+n.volcanoId+"CnvLoss").is(":checked")){var r=e("#allow_"+n.volcanoId+"Homdel");r.is(":checked")||r.prop("checked",!0).parent().addClass("active")}}),(0,l.generalizedSliderEvents)(this.displayAndControlElements.VolcanoPatientLimit,function(e){return e},"Min #Patients in either group :",function(e){t.displaySettings.minDonors=e,t.adjustVisibility()}),e("#"+this.displayAndControlElements.VolcanoComparisonClassSelectionSubmit).off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),setTimeout(function(){n.launchVariantAnalysis()},0))})}if(e("#"+this.volcanoId+"LaunchConsensusPathDb").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),(0,l.selectTextFromDivAndCopy)(t.volcanoId+"MarkedEntriesList"),window.open("http://cpdb.molgen.mpg.de/CPDB/fct_annot","_blank"),t.commonSettings.fastRelease())}),e("#"+this.volcanoId+"LaunchGsea").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),(0,l.selectTextFromDivAndCopy)(t.volcanoId+"MarkedEntriesList"),window.open("http://software.broadinstitute.org/gsea/msigdb/annotate.jsp","_blank"),t.commonSettings.fastRelease())}),e("#"+this.volcanoId+"LaunchReactome").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),(0,l.selectTextFromDivAndCopy)(t.volcanoId+"MarkedEntriesList"),window.open("https://reactome.org/PathwayBrowser/#TOOL=AT","_blank"),t.commonSettings.fastRelease())}),e("#"+this.volcanoId+"LaunchDavid").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),(0,l.selectTextFromDivAndCopy)(t.volcanoId+"MarkedEntriesList"),window.open("https://david.ncifcrf.gov/gene2gene.jsp","_blank"),t.commonSettings.fastRelease())}),"subcohort"===this.volcanoTypePrefix)if(e("#"+this.volcanoId+"SubcohortSelector1").off("change").on("change",function(){var t=parseInt(this.value),r=parseInt(e("#"+n.volcanoId+"SubcohortSelector2").val());-1===t||t===r?(e("#"+n.volcanoId+"VolcanoSubcohortSelectionSubmit").css("display","none"),e("#"+n.volcanoId+"MutexSubmit").css("display","none")):-1!==r&&(e("#"+n.volcanoId+"SubcohortSelectionSubmit").css("display","inline"),e("#"+n.volcanoId+"MutexSubmit").css("display","inline"))}),e("#"+this.volcanoId+"SubcohortSelector2").off("change").on("change",function(){var t=parseInt(e("#"+n.volcanoId+"SubcohortSelector1").val()),r=parseInt(this.value);-1===r||t===r?(e("#"+n.volcanoId+"VolcanoSubcohortSelectionSubmit").css("display","none"),e("#"+n.volcanoId+"MutexSubmit").css("display","none")):-1!==t&&(e("#"+n.volcanoId+"SubcohortSelectionSubmit").css("display","inline"),e("#"+n.volcanoId+"MutexSubmit").css("display","inline"))}),"Mutex"===this.volcanoPhenotype){for(var s=function(r){e("#allow_"+t.volcanoId+"Sv"+r).on("change.bootstrapSwitch",function(t){if(e("#allow_"+n.volcanoId+"Sv"+r).is(":checked"))for(var o=0;o<r;++o){var i=e("#allow_"+n.volcanoId+"Sv"+o);i.is(":checked")||i.prop("checked",!0).parent().addClass("active")}})},c=1;c<4;++c)s(c);var A=function(r){e("#allow_"+t.volcanoId+"Sv"+r).on("change.bootstrapSwitch",function(t){if(!e("#allow_"+n.volcanoId+"Sv"+r).is(":checked"))for(var o=r;o<4;++o){var i=e("#allow_"+n.volcanoId+"Sv"+o);i.is(":checked")&&i.prop("checked",!1).parent().removeClass("active")}})};for(c=0;c<3;++c)A(c);e("#"+this.volcanoId+"MutexSubmit").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),setTimeout(function(){n.launchMutexAnalysis()},0))})}else e("#"+this.volcanoId+"SubcohortSelectionSubmit").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),setTimeout(function(){n.launchSubcohortAnalysis()},0))});else"correlation"===this.volcanoTypePrefix&&(e("#"+this.volcanoId+"MetadataColumnSelector").off("change").on("change",function(){"-1"===this.value?e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","none"):-1===parseInt(e("#"+n.volcanoId+"SubcohortSelector1").val())?e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","none"):e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","inline")}),e("#"+this.volcanoId+"SubcohortSelector1").off("change").on("change",function(){"-1"===this.value?e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","none"):"-1"===e("#"+n.volcanoId+"MetadataColumnSelector").val()?e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","none"):e("#"+n.volcanoId+"MetadataColumnSelectionSubmit").css("display","inline")}),e("#"+this.volcanoId+"MetadataColumnSelectionSubmit").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var n=e("#"+t.volcanoId+"MetadataColumnSelector").val().replace(/;/g," ");setTimeout(function(){t.launchCorrelationAnalysisFromMetadataColumn(n)},0)}}),(0,l.generalizedSliderEvents)(this.volcanoId+"MinMaxExpression",function(e){return e},"Min. Displayed Max. Expression :",function(e){t.minMaxExpression=e,t.adjustVisibility()}));var u=["volcanoControls",this.volcanoId+"Controls","selectorControlsCollapseControl","volcanoSpecificGeneSelectorControls","geneSelectorMarkers","cytobandSelectorMarkers","gotoGeneVariants","gotoCytoband","geneSelectorControlsForMarkedGenesVolcanoSpecific","volcanoSpecificCytobandSelectorControls","cytobandSelectorMarkersOuter","geneSelectorMarkersOuter","svgDownloader"];"correlation"===this.volcanoTypePrefix&&u.push("correlationVolcanoSpecificGeneSelectorControls"),e("#"+this.volcanoId+"ContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,l.switchElements)(u,[])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,l.switchElements)(u,[])}).off("shown.bs.tab").on("shown.bs.tab",function(){if(e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,l.switchElements)([],u),t.displaySettings.markedVolcanoItems.size>0&&(e("#geneSelectorControlsForMarkedGenes").css("display","inline"),""!=e("#cytobandSelector").val()&&e("#clearMarkedGenesOnCytoband").css("display","inline"),e("#volcanoClearGene").css("display","inline")),"subcohort"===t.volcanoTypePrefix)e("#"+t.volcanoId+"SubcohortSelector1").empty().append('<option value="-1" style="background-color: #ffe6e6">Select Subcohort 1</option>'),e("#"+t.volcanoId+"SubcohortSelector2").empty().append('<option value="-1" style="background-color: #cce6ff">Select Subcohort 2</option>'),t.selectionManager.cohortFullDonors.size,t.selectionManager.registeredSubcohortNames.forEach(function(n,r,o){var i=t.selectionManager.registeredSubcohorts.get(r).size;e("#"+t.volcanoId+"SubcohortSelector1").append("<option value="+r+' style="background-color: #ffe6e6">'+n+" ("+i+"/"+t.selectionManager.cohortFullDonors.size+")</option>"),e("#"+t.volcanoId+"SubcohortSelector2").append("<option value="+r+' style="background-color: #cce6ff">'+n+" ("+i+"/"+t.selectionManager.cohortFullDonors.size+")</option>")});else if("correlation"===t.volcanoTypePrefix){var n=t.selectionManager.cohortFullDonors.size;e("#"+t.volcanoId+"SubcohortSelector1").empty().append('<option value="-1">Select Subcohort</option>'),t.selectionManager.registeredSubcohortNames.forEach(function(r,o,i){var a=t.selectionManager.registeredSubcohorts.get(o).size;e("#"+t.volcanoId+"SubcohortSelector1").append("<option value="+o+">"+r+" ("+a+"/"+n+")</option>")}),e("#"+t.volcanoId+"MetadataColumnSelector").empty().append('<option value="-1">Select Numerical Metadata Column</option>'),t.cohortMetadata.metadataDataTypes.forEach(function(n,r,o){if("numeric"===n){for(var i=!1,a=0;a<t.cohortMetadata.metadata.length;++a){var s=t.cohortMetadata.metadata[a][r];t.commonSettings.undefinedValues.has(s)||s<0&&(i=!0)}i||e("#"+t.volcanoId+"MetadataColumnSelector").append("<option value="+r.replace(/ /g,";")+">"+r+"</option>")}})}t.fontManager.setAvailableFontSettings("volcano"),t.textExportManager.setAvailableExportSettings("volcano")})}},{key:"cleanup",value:function(){for(var t=this,n=function(e){var n=t.data[e];n.getGeneIndices(t.references).forEach(function(e){t.references.genes.get(e).currentVolcanoContributions.get(t.displayAndControlElements.VolcanoIndices).delete(n.volcanoItemIndex)})},r=0;r<this.data.length;++r)n(r);this.data.length=0,this.currentComparisonClasses=[new Set,new Set],this.displaySettings.maxX=0,this.displaySettings.maxXForced=0,this.displaySettings.maxY=0,this.displaySettings.maxYForced=0,this.displaySettings.modifiedVolcanoAxisX=!1,this.displaySettings.modifiedVolcanoAxisY=!1,this.displaySettings.hiddenVolcanoItems=new Set,this.displaySettings.lastVolcanoItemIndex=-1,this.displaySettings.volcanoVbox=null,this.displaySettings.minDonors=0,this.displaySettings.hiddenVolcanoItems.clear(),this.anchorExpressions.length=0,e("#"+this.volcanoId+"RecoverHiddenData").css("display","none"),e("#"+this.displayAndControlElements.VolcanoResetAxis).css("display","none")}},{key:"launchMutexAnalysis",value:function(){var t=this;if(this.cleanup(),this.clearMarkedGenes(),e("#"+this.volcanoId+"SubcohortMutexSelectionSubmit").css("display","none"),this.group1Index=parseInt(e("#"+this.volcanoId+"SubcohortSelector1").val()),this.group2Index=parseInt(e("#"+this.volcanoId+"SubcohortSelector2").val()),this.uniqueGroup1Donors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group1Index))).filter(function(e){return!t.selectionManager.registeredSubcohorts.get(t.group2Index).has(e)})),this.uniqueGroup2Donors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group2Index))).filter(function(e){return!t.selectionManager.registeredSubcohorts.get(t.group1Index).has(e)})),0===this.uniqueGroup1Donors.size&&0!==this.uniqueGroup2Donors.size)this.uniqueGroup1Donors=this.selectionManager.registeredSubcohorts.get(this.group1Index);else if(0!==this.uniqueGroup1Donors.size&&0===this.uniqueGroup2Donors.size)this.uniqueGroup2Donors=this.selectionManager.registeredSubcohorts.get(this.group2Index);else if(0===this.uniqueGroup1Donors.size&&0===this.uniqueGroup2Donors.size)return void this.commonSettings.releaseLock();this.uniqueGroup1Donors=this.selectionManager.registeredSubcohorts.get(this.group1Index),this.uniqueGroup2Donors=this.selectionManager.registeredSubcohorts.get(this.group2Index),this.subcohort12commonDonors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group1Index))).filter(function(e){return t.selectionManager.registeredSubcohorts.get(t.group2Index).has(e)})),this.validDonorsForComparison=new Set([].concat(g(this.uniqueGroup1Donors),g(this.uniqueGroup2Donors)));var n=this.fetchChromosomeArmLevelMutexData();this.fetchCytobandLevelMutexData(n),this.fetchTadLevelMutexData(),this.fetchGeneLevelMutexData()}},{key:"fetchChromosomeArmLevelMutexData",value:function(){var t=this,n=new Map;if(e("#allow_"+this.volcanoId+"GainArm").is(":checked"))for(var r=1;r<this.references.chromosomeArms.length;++r){var o=this.references.chromosomeArms[r];if(o.chromosomeIndex>24)break;var i=o.cnvGainDonorContributorIndices,a=new Set([].concat(g(i)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(a.size>0){var s=p.VolcanoMutexEntry.createVolcanoMutexEntryChromosomeArm(o.chromosomeArmIndex,i,a,this.uniqueGroup1Donors,this.uniqueGroup2Donors,1);-1!==s.pValLog10&&(this.data.push(s),n.has(o.chromosomeArmIndex)||n.set(o.chromosomeArmIndex,new Map),n.get(o.chromosomeArmIndex).set(1,s.pValLog10))}}if(e("#allow_"+this.volcanoId+"LOHLossArm").is(":checked"))for(var l=1;l<this.references.chromosomeArms.length;++l){var c=this.references.chromosomeArms[l];if(c.chromosomeIndex>24)break;var A=new Set([].concat(g(c.cnvLossDonorContributorIndices),g(c.lohDonorContributorIndices))),u=new Set([].concat(g(A)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(u.size>0){var h=p.VolcanoMutexEntry.createVolcanoMutexEntryChromosomeArm(c.chromosomeArmIndex,A,u,this.uniqueGroup1Donors,this.uniqueGroup2Donors,5);-1!==h.pValLog10&&(this.data.push(h),n.has(c.chromosomeArmIndex)||n.set(c.chromosomeArmIndex,new Map),n.get(c.chromosomeArmIndex).set(5,h.pValLog10))}}if(e("#allow_"+this.volcanoId+"LOHArm").is(":checked"))for(var d=1;d<this.references.chromosomeArms.length;++d){var f=this.references.chromosomeArms[d];if(f.chromosomeIndex>24)break;var m=f.lohDonorContributorIndices,v=new Set([].concat(g(m)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(v.size>0){var y=p.VolcanoMutexEntry.createVolcanoMutexEntryChromosomeArm(f.chromosomeArmIndex,v,this.uniqueGroup1Donors,this.uniqueGroup2Donors,3);-1!==y.pValLog10&&(this.data.push(y),n.has(f.chromosomeArmIndex)||n.set(f.chromosomeArmIndex,new Map),n.get(f.chromosomeArmIndex).set(3,y.pValLog10))}}if(e("#allow_"+this.volcanoId+"LossArm").is(":checked"))for(var b=1;b<this.references.chromosomeArms.length;++b){var I=this.references.chromosomeArms[b].chromosomeArmIndex;if(I.chromosomeIndex>24)break;var x=I.cnvLossDonorContributorIndices,w=new Set([].concat(g(x)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(w.size>0){var C=p.VolcanoMutexEntry.createVolcanoMutexEntryChromosomeArm(I.chromosomeArmIndex,x,w,this.uniqueGroup1Donors,this.uniqueGroup2Donors,2);-1!==C.pValLog10&&(this.data.push(C),n.has(I.chromosomeArmIndex)||n.set(I.chromosomeArmIndex,new Map),n.get(I.chromosomeArmIndex).set(2,C.pValLog10))}}if(e("#allow_"+this.volcanoId+"cnnLOHArm").is(":checked"))for(var E=1;E<this.references.chromosomeArms.length;++E){var S=this.references.chromosomeArms[E];if(S.chromosomeIndex>24)break;var M=S.cnnLohDonorContributorIndices,k=new Set([].concat(g(M)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(k.size>0){var B=p.VolcanoMutexEntry.createVolcanoMutexEntryChromosomeArm(S.chromosomeArmIndex,k,this.uniqueGroup1Donors,this.uniqueGroup2Donors,4);-1!==B.pValLog10&&(this.data.push(B),n.has(S.chromosomeArmIndex)||n.set(S.chromosomeArmIndex,new Map),n.get(S.chromosomeArmIndex).set(4,B.pValLog10))}}return n}},{key:"fetchCytobandLevelMutexData",value:function(t){var n=this;if(e("#allow_"+this.volcanoId+"GainCyto").is(":checked"))for(var r=1;r<this.references.cytobands.length;++r){var o=this.references.cytobands[r];if(o.chromosomeIndex>24)break;var i=o.cnvGainDonorContributorIndices,a=new Set([].concat(g(i)).filter(function(e){return n.validDonorsForComparison.has(e)}));if(a.size>0){var s=p.VolcanoMutexEntry.createVolcanoMutexEntryCytoband(o.cytobandIndex,i,a,this.uniqueGroup1Donors,this.uniqueGroup2Donors,1);if(-1!==s.pValLog10){if(t.has(o.chromosomeIndex)&&t.get(o.chromosomeIndex).has(1)&&t.get(o.chromosomeIndex).get(1)>s.pValLog10)continue;this.data.push(s)}}}if(e("#allow_"+this.volcanoId+"LOHLossCyto").is(":checked"))for(var l=1;l<this.references.cytobands.length;++l){var c=this.references.cytobands[l];if(c.chromosomeIndex>24)break;var A=new Set([].concat(g(c.cnvLossDonorContributorIndices),g(c.lohDonorContributorIndices))),u=new Set([].concat(g(A)).filter(function(e){return n.validDonorsForComparison.has(e)}));if(u.size>0){var h=p.VolcanoMutexEntry.createVolcanoMutexEntryCytoband(c.cytobandIndex,A,u,this.uniqueGroup1Donors,this.uniqueGroup2Donors,5);if(-1!==h.pValLog10){if(t.has(c.chromosomeIndex)&&t.get(c.chromosomeIndex).has(5)&&t.get(c.chromosomeIndex).get(5)>h.pValLog10)continue;this.data.push(h)}}}if(e("#allow_"+this.volcanoId+"LossCyto").is(":checked"))for(var d=1;d<this.references.cytobands.length;++d){var f=this.references.cytobands[d];if(f.chromosomeIndex>24)break;var m=f.cnvLossDonorContributorIndices,v=new Set([].concat(g(m)).filter(function(e){return n.validDonorsForComparison.has(e)}));if(v.size>0){var y=p.VolcanoMutexEntry.createVolcanoMutexEntryCytoband(f.cytobandIndex,m,v,this.uniqueGroup1Donors,this.uniqueGroup2Donors,2);if(-1!==y.pValLog10){if(t.has(f.chromosomeIndex)&&t.get(f.chromosomeIndex).has(2)&&t.get(f.chromosomeIndex).get(2)>y.pValLog10)continue;this.data.push(y)}}}if(e("#allow_"+this.volcanoId+"LOHCyto").is(":checked"))for(var b=1;b<this.references.cytobands.length;++b){var I=this.references.cytobands[b];if(I.chromosomeIndex>24)break;var x=I.lohDonorContributorIndices,w=new Set([].concat(g(x)).filter(function(e){return n.validDonorsForComparison.has(e)}));if(w.size>0){var C=p.VolcanoMutexEntry.createVolcanoMutexEntryCytoband(I.cytobandIndex,x,w,this.uniqueGroup1Donors,this.uniqueGroup2Donors,3);if(-1!==C.pValLog10){if(t.has(I.chromosomeIndex)&&t.get(I.chromosomeIndex).has(3)&&t.get(I.chromosomeIndex).get(3)>C.pValLog10)continue;this.data.push(C)}}}if(e("#allow_"+this.volcanoId+"cnnLOHCyto").is(":checked"))for(var E=1;E<this.references.cytobands.length;++E){var S=this.references.cytobands[E];if(S.chromosomeIndex>24)break;var M=S.cnnLohDonorContributorIndices,k=new Set([].concat(g(M)).filter(function(e){return n.validDonorsForComparison.has(e)}));if(k.size>0){var B=p.VolcanoMutexEntry.createVolcanoMutexEntryCytoband(S.cytobandIndex,M,k,this.uniqueGroup1Donors,this.uniqueGroup2Donors,4);if(-1!==B.pValLog10){if(t.has(S.chromosomeIndex)&&t.get(S.chromosomeIndex).has(4)&&t.get(S.chromosomeIndex).get(4)>B.pValLog10)continue;this.data.push(B)}}}}},{key:"fetchTadLevelMutexData",value:function(){var t=this,n=0;if(e("#allow_"+this.volcanoId+"Sv0").is(":checked")){e("#allow_"+this.volcanoId+"Sv3").is(":checked")?n=3:e("#allow_"+this.volcanoId+"Sv2").is(":checked")?n=2:e("#allow_"+this.volcanoId+"Sv1").is(":checked")&&(n=1);for(var r=1;r<this.references.tads.length;++r){var o=this.references.tads[r];if(o.chromosomeIndex>24)break;var i=o.svDonorContributorIndicesOffset0;n>0&&(i=new Set([].concat(g(i),g(o.svDonorContributorIndicesOffset1)))),n>1&&(i=new Set([].concat(g(i),g(o.svDonorContributorIndicesOffset2)))),n>2&&(i=new Set([].concat(g(i),g(o.svDonorContributorIndicesOffset3))));var a=new Set([].concat(g(i)).filter(function(e){return t.validDonorsForComparison.has(e)}));if(a.size>0){var s=p.VolcanoMutexEntry.createVolcanoMutexEntryTad(o.tadIndex,i,a,this.uniqueGroup1Donors,this.uniqueGroup2Donors,6);-1!==s.pValLog10&&this.data.push(s)}}}}},{key:"determineCurrentGeneMutTypes",value:function(){var t=new Set;return e("#allow_"+this.volcanoId+"FunctionalSmallVar").is(":checked")&&[12,13,32,33,34,35,36,37,38,39,40,41,42,43,24,25,26,29,30,31].forEach(function(e){t.add(e)}),e("#allow_"+this.volcanoId+"UTR5").is(":checked")&&[4,5,6,23].forEach(function(e){t.add(e)}),e("#allow_"+this.volcanoId+"UTR3").is(":checked")&&[1,2,3].forEach(function(e){t.add(e)}),e("#allow_"+this.volcanoId+"Amp").is(":checked")&&t.add(7),e("#allow_"+this.volcanoId+"Homdel").is(":checked")&&t.add(15),e("#allow_"+this.volcanoId+"Synonymous").is(":checked")&&t.add(48),e("#allow_"+this.volcanoId+"DoubleHitAlt1").is(":checked")&&t.add(57),this.commonSettings.wesMode||(e("#allow_"+this.volcanoId+"Upstream").is(":checked")&&[52,53,54].forEach(function(e){t.add(e)}),e("#allow_"+this.volcanoId+"Downstream").is(":checked")&&[9,10,11].forEach(function(e){t.add(e)}),e("#allow_"+this.volcanoId+"DirectSv").is(":checked")&&t.add(8),e("#allow_"+this.volcanoId+"DoubleHitAlt2").is(":checked")&&t.add(58),e("#allow_"+this.volcanoId+"DoubleHitAlt3").is(":checked")&&t.add(59),e("#allow_"+this.volcanoId+"FusionCorrect").is(":checked")&&t.add(60),e("#allow_"+this.volcanoId+"FusionIncorrect").is(":checked")&&t.add(61)),t}},{key:"fetchGeneLevelMutexData",value:function(){var t=this.determineCurrentGeneMutTypes(),n=["`Gene"].concat(Array.from(t).sort().map(String)).join("`, `")+"`",r=this;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:"geneRecurrence",columnsToSelect:n,keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var n=parseInt(e.Gene);if(r.references.genes.has(n)){var o=new f.VariantRecurrenceEntryGene(e,t);if(o.isValid){var i=o.geneId,a=new Set;o.contributions.forEach(function(e,t,n){e.forEach(function(e){a.add(e)})});var s=new Set([].concat(g(a)).filter(function(e){return r.validDonorsForComparison.has(e)}));if(s.size>0){var l=p.VolcanoMutexEntry.createVolcanoMutexEntryGene(i,a,s,r.uniqueGroup1Donors,r.uniqueGroup2Donors);-1!==l.pValLog10&&r.data.push(l)}}}}),r.addVolcanoIndices(),r.setDataXfield(),r.setDataYfield(),r.updateMaximums(),r.plotVolcano()},error:function(e){console.error(e)}})}},{key:"launchSubcohortAnalysis",value:function(){var t=this;if(this.cleanup(),this.clearMarkedGenes(),e("#"+this.volcanoId+"SubcohortSelectionSubmit").css("display","none"),this.group1Index=parseInt(e("#"+this.volcanoId+"SubcohortSelector1").val()),this.group2Index=parseInt(e("#"+this.volcanoId+"SubcohortSelector2").val()),this.uniqueGroup1Donors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group1Index))).filter(function(e){return!t.selectionManager.registeredSubcohorts.get(t.group2Index).has(e)})),this.uniqueGroup2Donors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group2Index))).filter(function(e){return!t.selectionManager.registeredSubcohorts.get(t.group1Index).has(e)})),0===this.uniqueGroup1Donors.size&&0!==this.uniqueGroup2Donors.size)this.uniqueGroup1Donors=this.selectionManager.registeredSubcohorts.get(this.group1Index);else if(0!==this.uniqueGroup1Donors.size&&0===this.uniqueGroup2Donors.size)this.uniqueGroup2Donors=this.selectionManager.registeredSubcohorts.get(this.group2Index);else if(0===this.uniqueGroup1Donors.size&&0===this.uniqueGroup2Donors.size)return void this.commonSettings.releaseLock();this.subcohort12commonDonors=new Set([].concat(g(this.selectionManager.registeredSubcohorts.get(this.group1Index))).filter(function(e){return t.selectionManager.registeredSubcohorts.get(t.group2Index).has(e)})),this.validDonorsForComparison=new Set([].concat(g(this.uniqueGroup1Donors),g(this.uniqueGroup2Donors))),"GeneExpression"===this.volcanoPhenotype?(e("#"+this.volcanoId+"ProgressBarGroup").css("display","inline"),e("#"+this.volcanoId+"ProgressBar").css("width","0%"),this.callNextSubcohortBatch(0,99)):"RppaExpression"===this.volcanoPhenotype?this.callNextSubcohortBatch(-1,-1):"MethylomeBeta"===this.volcanoPhenotype&&(e("#"+this.volcanoId+"ProgressBarGroup").css("display","inline"),e("#"+this.volcanoId+"ProgressBar").css("width","0%"))}},{key:"callNextSubcohortBatch",value:function(t,n){-1!==t&&e("#"+this.volcanoId+"ProgressBar").css("width",100*t/(n+5)+"%"),this.getBatchForSubcohortAnalysis(t,n)}},{key:"getBatchForSubcohortAnalysis",value:function(t,n){var r="*";-1!==t&&(this.references.geneBatchInfo.has(t)||(t===n?(this.addVolcanoIndices(),this.setDataXfield(this.xFieldName),this.setDataYfield(this.yFieldName),this.updateMaximums(),this.plotVolcano(),this.commonSettings.releaseLock()):this.callNextSubcohortBatch(t+1,n)),r=this.references.geneBatchInfo.get(t).join(","));var o=this;e.ajax({url:o.commonSettings.baseUrl+"/php/getDataFromDbPOST.php",type:"POST",dataType:"json",data:{cohort:o.cohortMetadata.cohortName,suffix:o.truePhenotype+"Expressions",columnsToSelect:"*",keyColumn:o.truePhenotype,keysToSearchRaw:r},error:function(e){o.commonSettings.releaseLock(),console.error(e)},success:function(e){o.processSubcohortBatch(e),t<n?o.callNextSubcohortBatch(t+1,n):(o.addVolcanoIndices(),o.setDataXfield(o.xFieldName),o.setDataYfield(o.yFieldName),o.updateMaximums(),o.plotVolcano(),o.commonSettings.releaseLock())}})}},{key:"processSubcohortBatch",value:function(e){var t=this.truePhenotype,n=e.length,r=this.testName+"Test";if(0!==n){var o=[];this.uniqueGroup1Donors.forEach(function(t){e[0].hasOwnProperty(t.toString())&&o.push(t.toString())});var i=[];this.uniqueGroup2Donors.forEach(function(t){e[0].hasOwnProperty(t.toString())&&i.push(t.toString())});for(var a=o.length,l=i.length,c=new Array(a),h=new Array(a),d=new Array(l),f=new Array(l),p=0;p<n;++p){for(var g=!1,m=0;m<a;++m)c[m]=+e[p][o[m]],h[m]=Math.pow(2,c[m]),g||h[m]>=2&&(g=!0);for(var v=0;v<l;++v)d[v]=+e[p][i[v]],f[v]=Math.pow(2,d[v]),g||f[v]>=2&&(g=!0);var y=+e[p][t];if(g){for(var b=0,I=0;I<10&&(b=u.StatsTests[r](c,d,100*Math.pow(2,I),1e3*Math.pow(2,I)),this.commonSettings.undefinedValues.has(b));++I)9===I&&(b=0);if(0!==b){var x={log2FcTrimean:(0,A.trimeanFc)(h,f),log2FcMean:(0,A.meanFc)(h,f),pValLog10:b};x[t]=y,this.data.push(new s.VolcanoEntry(x,0))}}}}}},{key:"processSubcohortBatchBck",value:function(e){for(var t=this,n=this.truePhenotype,r=function(r){var o=[],i=[];if(t.uniqueGroup1Donors.forEach(function(t){if(e[r].hasOwnProperty(t.toString())){var n=+e[r][t.toString()];o.push(Math.pow(2,n))}}),t.uniqueGroup2Donors.forEach(function(t){if(e[r].hasOwnProperty(t.toString())){var n=+e[r][t.toString()];i.push(Math.pow(2,n))}}),Math.max.apply(Math,o)>=2||Math.max.apply(Math,i)>=2){for(var a=+e[r][n],l=0,c=0;c<10&&(l=u.StatsTests[t.testName+"Test"](o,i,100*Math.pow(2,c),1e3*Math.pow(2,c)),t.commonSettings.undefinedValues.has(l));++c)9===c&&(l=0);var h={log2FcTrimean:(0,A.trimeanFc)(o,i),log2FcMean:(0,A.meanFc)(o,i),pValLog10:l};h[n]=a,0!==h.pValLog10&&t.data.push(new s.VolcanoEntry(h,0))}},o=0;o<e.length;++o)r(o)}},{key:"addVolcanoIndices",value:function(){for(var e=this,t=function(t){e.data[t].volcanoItemIndex=t,e.data[t].getGeneIndices(e.references).forEach(function(n){e.references.genes.get(n).currentVolcanoContributions.has(e.displayAndControlElements.VolcanoIndices)||e.references.genes.get(n).currentVolcanoContributions.set(e.displayAndControlElements.VolcanoIndices,new Set),e.references.genes.get(n).currentVolcanoContributions.get(e.displayAndControlElements.VolcanoIndices).add(t)})},n=0;n<this.data.length;++n)t(n)}},{key:"launchVariantAnalysis",value:function(){var t=this;e("#"+this.volcanoId+"ProgressBarGroup").css("display","inline"),e("#"+this.volcanoId+"ProgressBar").css("width","0%"),e("#"+this.displayAndControlElements.VolcanoComparisonClassSelectionSubmit).css("display","none");var n=this.inferComparisonClasses();if(n!==this.currentComparisonClasses){this.cleanup();var r=new Set([].concat(g(n[0])).filter(function(e){return!t.currentComparisonClasses[0].has(e)})),o=new Set([].concat(g(n[1])).filter(function(e){return!t.currentComparisonClasses[1].has(e)}));r.size>0&&this.markObsoleteVolcanoData(Array.from(r)),this.currentComparisonClasses=n,setTimeout(function(){t.addNewVariantVolcanoData(o)},0)}}},{key:"inferComparisonClasses",value:function(){var t=this,n=new Set,r=new Set;return Array.from(this.references.comparisonTypesReverse.keys()).forEach(function(o){e("#allow_"+t.volcanoId+o).is(":checked")?r.add(t.references.comparisonTypesReverse.get(o)):n.add(t.references.comparisonTypesReverse.get(o))}),[n,r]}},{key:"markObsoleteVolcanoData",value:function(e){for(var t=[],n=0;n<this.data.length;++n){for(var r=!1,o=0;o<e.length;++o)if(this.data[n].includedComparisons.has(e[o])){r=!0;break}r?this.references.genes.get(this.data[n].gene).currentVolcanoContributions.get(this.displayAndControlElements.VolcanoIndices).delete(this.data[n].volcanoItemIndex):t.push(this.data[n])}this.data=t}},{key:"addNewVariantVolcanoData",value:function(t){var n=this,r=Array.from(n.currentComparisonClasses[0]).map(function(e){return"`"+e+"`"}).join(","),o=Array.from(t).map(function(e){return"`"+e+"`"}).join(",");e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromVolcanoDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:n.truePhenotype+"ExpressionSummary"+this.testName,blacklistedClasses:r,mandatoryClasses:o},error:function(e){n.commonSettings.releaseLock(),console.error(e)},success:function(e){setTimeout(function(){n.processNewVariantData(e)},0)}})}},{key:"processNewVariantData",value:function(t){this.callNextVariantDataBatch(0,0,0,t),this.setDataXfield(this.xFieldName),this.setDataYfield(this.yFieldName),this.markDuplicateVolcanoData(),this.updateMaximums(),this.plotVolcano(),this.commonSettings.releaseLock(),e("#"+this.displayAndControlElements.VolcanoComparisonClassSelectionSubmit).css("display","inline")}},{key:"callNextVariantDataBatch",value:function(t,n,r,o){var i=this;setTimeout(function(){e("#"+i.volcanoId+"ProgressBar").css("width",parseInt(t)+"%")},0),this.processNewVariantDataBatch(n,r,o)}},{key:"processNewVariantDataBatch",value:function(e,t,n){for(var r=this,o=1.2*n.length,i=this.references.comparisonTypes.length,a=t,l=e,c=0,A=function(){var e=new s.VolcanoEntry(n[l],i);if(e.isPromising()){var t=!1;e.getGeneIndices(r.references).forEach(function(n){r.references.genes.has(n)&&(t=!0,r.references.genes.get(n).currentVolcanoContributions.has(r.displayAndControlElements.VolcanoIndices)||r.references.genes.get(n).currentVolcanoContributions.set(r.displayAndControlElements.VolcanoIndices,new Set([])),r.references.genes.get(n).currentVolcanoContributions.get(r.displayAndControlElements.VolcanoIndices).add(e.volcanoItemIndex))}),t&&r.data.push(e)}if(c=100*l/o,++l,c>5*a)return a+=1,"break"};l<n.length&&"break"!==A(););l<n.length&&this.callNextVariantDataBatch(c,l,a,n)}},{key:"markDuplicateVolcanoData",value:function(){var e=this;this.data.sort(function(e,t){if(e.getBioIndex()<t.getBioIndex())return-1;if(e.getBioIndex()>t.getBioIndex())return 1;var n=e.getMag(),r=t.getMag();return n>r?-1:n<r?1:e.includedComparisons.size<t.includedComparisons.size?-1:e.includedComparisons.size>t.includedComparisons.size?1:-1});for(var t=-1,n=[],r=function(r){var o=e.data[r].getBioIndex();o!==t?(n.push(e.data[r]),t=o):e.data[r].getGeneIndices(e.references).forEach(function(t){e.references.genes.get(t).currentVolcanoContributions.get(e.displayAndControlElements.VolcanoIndices).delete(e.data[r].volcanoItemIndex)})},o=0;o<this.data.length;++o)r(o);this.data=n}},{key:"updateMaximums",value:function(){var e=this;this.volcanoIndexToDataIndex.clear(),this.displaySettings.maxX=0,this.displaySettings.maxY=0,this.displaySettings.minY=1e10;for(var t=this.data.length,n=0;n<t;++n){var r=Math.abs(this.data[n].x),o=this.data[n].y;r>this.displaySettings.maxX&&(this.displaySettings.maxX=r),o>this.displaySettings.maxY&&(this.displaySettings.maxY=o),o<this.displaySettings.minY&&(this.displaySettings.minY=o),this.volcanoIndexToDataIndex.set(this.data[n].volcanoItemIndex,n)}var i=new Set;this.displaySettings.markedVolcanoItems.forEach(function(t){e.volcanoIndexToDataIndex.has(t)||i.add(t)}),i.forEach(function(t){e.displaySettings.markedVolcanoItems.delete(t)}),this.displaySettings.maxXForced=this.displaySettings.maxX,this.displaySettings.maxYForced=this.displaySettings.maxY}},{key:"adjustRadius",value:function(e){[].forEach.call(document.getElementsByClassName(this.displayAndControlElements.VolcanoCircleClass),function(t){var n=parseInt(t.getAttribute("si")),r=(0,i.symbol)().type(function(){return i.symbols[n]}).size(function(){return e})();t.setAttribute("d",r)})}},{key:"adjustVisibility",value:function(){var t=+document.getElementById(this.displayAndControlElements.VolcanoFrame).getAttribute("width"),n=this;this.circleGroup.selectAll("."+this.displayAndControlElements.VolcanoCircleClass).style("display",function(){if((0,i.select)(this).attr("id").endsWith("dummy"))return"none";var r=(0,i.select)(this).datum();if(n.displaySettings.hiddenVolcanoItems.has(r.volcanoItemIndex))return e("#"+n.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+r.volcanoItemIndex).length&&n.hideVolcanoItem(r.volcanoItemIndex),"none";var o="none",a=!0;"correlation"===n.volcanoTypePrefix&&r.maxExpression<n.minMaxExpression&&(a=!1);var s=!0;if("variant"===n.volcanoTypePrefix&&(s=r.numSelected>=n.displaySettings.minDonors&&r.numInverted>=n.displaySettings.minDonors),s&&a){var l=!0;if(n.displaySettings.modifiedVolcanoAxisX){var c=+this.getAttribute("cx");l=0<=c&&Math.abs(c)<=t}if(l){var A=!0;n.displaySettings.modifiedVolcanoAxisY&&(A=+this.getAttribute("cy")>=0),A&&(o="inline")}}if("inline"===o&&"Mutex"!==n.volcanoPhenotype){for(var u=r.getGeneIndices(n.references),h=!1,d=0;d<u.length;++d){var f=n.references.genes.get(u[d]).geneTypeIndex,p=n.references.geneTypes[f].geneSupertype;if(e("#allow_"+n.volcanoId+p).is(":checked")){h=!0;break}}h||(o="none")}var g=e("#"+n.displayAndControlElements.VolcanoGeneMarkerClass+"_"+r.volcanoItemIndex);if(g.length){g.css("display",o);var m=e("#"+n.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+r.volcanoItemIndex+"_dragbridge");m.length&&m.css("display",o)}return o}),this.commonSettings.releaseLock()}},{key:"markAllGenesOnCytobandsContainingGene",value:function(e){var t=this,n=new Set;this.references.genes.get(e).cytobandIndices.forEach(function(e){t.references.cytobands[e].getGeneIndices(t.references).forEach(function(e){n.add(e)})}),n.forEach(function(e){t.markGene(e,-1,!0)}),this.updateMarkedVolcanoItemDisplay()}},{key:"markAllGenesOnCytoband",value:function(e){var t=this;this.references.cytobands[e].getGeneIndices(this.references).forEach(function(e){t.references.genes.get(e).currentVolcanoContributions.has(t.displayAndControlElements.VolcanoIndices)&&t.references.genes.get(e).currentVolcanoContributions.get(t.displayAndControlElements.VolcanoIndices).forEach(function(e){e!==t.displaySettings.lastVolcanoItemIndex&&t.markVolcanoItem(e,!0)})}),this.updateMarkedVolcanoItemDisplay()}},{key:"hideAllGenesOnCytobandsContainingGene",value:function(t){var n=this,r=new Set;this.references.genes.get(t).cytobandIndices.forEach(function(e){n.references.cytobands[e].getGeneIndices(n.references).forEach(function(e){r.add(e)})});var o=!1;r.forEach(function(e){if(n.references.genes.get(e).currentVolcanoContributions.has(n.displayAndControlElements.VolcanoIndices)){var t=n.references.genes.get(e).currentVolcanoContributions.get(n.displayAndControlElements.VolcanoIndices);t.size>0&&(o=!0),t.forEach(function(e){n.displaySettings.hiddenVolcanoItems.add(e)})}}),o&&(setTimeout(function(){n.adjustVisibility()},0),e("#"+this.displayAndControlElements.VolcanoRecoverHiddenData).css("display","inline"))}},{key:"hideAllGenesOnCytoband",value:function(t){var n=this,r=!1;this.references.cytobands[t].getGeneIndices(this.references).forEach(function(e){if(n.references.genes.get(e).currentVolcanoContributions.has(n.displayAndControlElements.VolcanoIndices)){var t=n.references.genes.get(e).currentVolcanoContributions.get(n.displayAndControlElements.VolcanoIndices);t.size>0&&(r=!0),t.forEach(function(e){n.displaySettings.hiddenVolcanoItems.add(e)})}}),r&&(setTimeout(function(){n.adjustVisibility()},0),e("#"+this.displayAndControlElements.VolcanoRecoverHiddenData).css("display","inline"))}},{key:"hideVolcanoItem",value:function(t){this.displaySettings.hiddenVolcanoItems.add(t),e("#"+this.displayAndControlElements.VolcanoCircleClass+"_"+t).css("display","none"),e("#"+this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).length&&this.markVolcanoItem(t,!1)}},{key:"premarkVolcanoItem",value:function(t){var n=this,o=document.getElementById(this.displayAndControlElements.VolcanoSvg).getBoundingClientRect().width,a=this.generateScalesXY(o),s=r(a,2),l=s[0],c=(s[1],3*+e("#"+this.displayAndControlElements.VolcanoRadius).val()),A=e("#"+this.displayAndControlElements.VolcanoCircleClass+"_"+t),u=+A.attr("cx"),h=+A.attr("cy")-c;this.circleGroup.append("path").attr("class",this.displayAndControlElements.VolcanoGeneMarkerHelperClass).attr("id",this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker").attr("cx",u).attr("cy",h).attr("si",0).attr("transform",function(e){return"Mutex"!==n.volcanoPhenotype?"translate("+u+","+h+") rotate(45)":"translate("+u+","+h+")"}).style("display","none");var d=e("#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker"),f=+d.attr("cx"),p=+d.attr("cy"),g=f+c,m=(0,i.path)();m.moveTo(g,p),m.lineTo(l(1.25*this.displaySettings.maxXForced),p),m.closePath(),this.volcanoSVG.append("path").attr("class",this.displayAndControlElements.VolcanoGeneMarkerHelperClass).attr("id",this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).attr("d",m).style("display","none");var v=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("markedElementLabels").generateFontCssText();this.volcanoSVG.append("text").style("dominant-baseline","middle").attr("id",this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).attr("class","markerText "+this.displayAndControlElements.VolcanoGeneMarkerClass).style("alignment-baseline","middle").append("textPath").attr("xlink:href","#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).style("dominant-baseline","middle").style("alignment-baseline","middle").style("text-anchor","start").attr("startOffset","0%").style("font",v).html(this.data[this.volcanoIndexToDataIndex.get(t)].getLabel(this.references));var y={labelWidth:1.05*+document.getElementById(this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).getBBox().width,labelStartX:g,labelStartY:p};return e("#"+this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).remove(),e("#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).remove(),d.remove(),y}},{key:"plotVolcanoMark",value:function(t,n){var r=this,o=this,a=n.labelWidth,s=n.labelStartX,l=n.labelStartY,c=3*+e("#"+this.displayAndControlElements.VolcanoRadius).val(),A=e("#"+this.displayAndControlElements.VolcanoCircleClass+"_"+t),u=+A.attr("cx"),h=+A.attr("cy")-c;this.circleGroup.append("path").attr("class",this.displayAndControlElements.VolcanoGeneMarkerHelperClass).attr("id",this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker").attr("cx",u).attr("cy",h).attr("si",0).attr("transform",function(e){return"Mutex"!==r.volcanoPhenotype?"translate("+u+","+h+") rotate(45)":"translate("+u+","+h+")"}).style("display","none");var d=+e("#"+this.displayAndControlElements.VolcanoCircleClass+"_dummy").attr("cx"),f=(0,i.path)();s>=d?(f.moveTo(s+c,l),f.lineTo(s+c+a,l)):(f.moveTo(s-c-a,l),f.lineTo(s-c,l)),f.closePath(),this.volcanoSVG.append("path").attr("class",this.displayAndControlElements.VolcanoGeneMarkerHelperClass).attr("id",this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).attr("d",f).style("display","none");var p=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("markedElementLabels").generateFontCssText();this.volcanoSVG.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("class","markerText "+this.displayAndControlElements.VolcanoGeneMarkerClass).attr("id",this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).attr("textWidth",a).append("textPath").attr("xlink:href","#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).style("dominant-baseline","middle").style("alignment-baseline","middle").style("display",A.css("display")).style("font",p).html(this.data[this.volcanoIndexToDataIndex.get(t)].getLabel(this.references)).call((0,i.drag)().on("start",function(){e("#"+o.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_dragbridge").remove()}).on("drag",function(){var n=i.event.x,a=i.event.y;(0,i.select)("#"+o.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker").attr("cx",n).attr("cy",a);var s=+e("#"+o.displayAndControlElements.VolcanoCircleClass+"_dummy").attr("cx"),l=(0,i.path)(),A=+e("#"+r.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).attr("textWidth");n>=s?(l.moveTo(n+c,a),l.lineTo(n+c+A,a)):(l.moveTo(n-c-A,a),l.lineTo(n-c,a)),l.closePath(),(0,i.select)("#"+o.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).attr("d",l);var u=e("#"+o.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t);u.hide(),setTimeout(function(){u.show()},10)}).on("end",function(){var n=e("#"+o.displayAndControlElements.VolcanoCircleClass+"_"+t),r=+n.attr("cx"),a=r>=d?r+c:r-c,s=+n.attr("cy"),l=e("#"+o.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker"),A=+l.attr("cx"),u=+l.attr("cy"),h=A>=d?A+c:A-c;u>s?u-=c:u<s&&(u+=2*c);var f=+e("#"+o.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t).attr("textWidth");A>=d?A<a&&(A+f<a?(h+=f,a-=2*c):(h+=.5*f,a-=c,u>s?s+=c:s-=c)):A>a&&(A-f>a?(h-=f,a+=2*c):(h-=.5*f,a+=c,u>s?s+=c:s-=c));var p=(0,i.path)();p.moveTo(a,s),p.lineTo(h,u),p.closePath(),o.volcanoSVG.append("path").attr("class",o.displayAndControlElements.VolcanoGeneMarkerHelperClass).attr("id",o.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_dragbridge").attr("d",p).style("stroke","Black").style("display","inline")}))}},{key:"markVolcanoItem",value:function(t,n){var r=e("#"+this.displayAndControlElements.VolcanoGeneMarkerClass+"_"+t);if(r.length)return r.remove(),e("#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_dragbridge").remove(),e("#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t+"_premarker").remove(),e("#"+this.displayAndControlElements.VolcanoGeneMarkerHelperClass+"_"+t).remove(),e("#vennContentVolcano").empty(),e("#geneExpressionContentVolcano").empty(),e("#rppaExpressionSelectorVolcano").empty(),e("#rppaExpressionContentVolcano").empty(),e("#volcanoGeneDescription").html(""),e("#volcanoGeneDescriptionPaneControl").css("display","none"),e("#volcanoClearGene").css("display","none"),e('.nav-tabs a[href="#controlsPane"]').tab("show"),this.displaySettings.markedVolcanoItems.delete(t),this.displaySettings.lastVolcanoItemIndex=-1,0===this.displaySettings.markedVolcanoItems.size&&(e("#geneSelectorControlsForMarkedGenes").css("display","none"),e("#clearMarkedGenesOnCytoband").css("display","none")),!1;e("#geneSelectorControlsForMarkedGenes").css("display","inline"),e("#volcanoClearGene").css("display","inline"),""!=e("#cytobandSelector").val()&&e("#clearMarkedGenesOnCytoband").css("display","inline"),this.displaySettings.markedVolcanoItems.add(t),this.displaySettings.lastVolcanoIndex=t;var o=this.premarkVolcanoItem(t);if(this.plotVolcanoMark(t,o),n){this.currentVolcanoIndex=t;var i=this.readTadOffsetsForPhenotypePlots();this.drawSinglePhenotypePlots(t,i[0],i[1])}return!0}},{key:"readTadOffsetsForPhenotypePlots",value:function(){var t=-1,n=-1;if("variant"===this.volcanoTypePrefix)for(var r=0;r<4;++r)e("#allow_"+this.volcanoId+"OffIndel"+r).is(":checked")&&(n=r),e("#allow_"+this.volcanoId+"Sv"+r).is(":checked")&&(t=r);else t=1,n=-1;return e("#svTadOffsetSelectorVolcano").val(""+t),e("#offIndelTadOffsetSelectorVolcano").val(""+n),[t,n]}},{key:"drawVennDiagram",value:function(e){var t=this.data[this.volcanoIndexToDataIndex.get(e)],n=m.VennDiagram(),r=this.selectionManager.registeredSubcohortNames.get(this.group1Index),o=this.selectionManager.registeredSubcohortNames.get(this.group2Index);(0,i.select)("#vennContentVolcano").datum(t.generateVennSets(this.references,r,o,this.subcohort12commonDonors)).call(n)}},{key:"drawSinglePhenotypePlots",value:function(t,n,r){var o=this,i=this;if(e("#svTadOffsetSelectorVolcano").off("change").on("change",function(){var t=parseInt(this.value),n=parseInt(e("#offIndelTadOffsetSelectorVolcano").val());i.drawSinglePhenotypePlots(i.currentVolcanoIndex,t,n)}),e("#offIndelTadOffsetSelectorVolcano").off("change").on("change",function(){var t=parseInt(e("#svTadOffsetSelectorVolcano").val()),n=parseInt(this.value);i.drawSinglePhenotypePlots(i.currentVolcanoIndex,t,n)}),e("#vennContentVolcano").empty(),e("#geneExpressionSelectorVolcano").empty(),e("#geneExpressionContentVolcano").empty(),e("#rppaExpressionSelectorVolcano").empty(),e("#rppaExpressionContentVolcano").empty(),e("#geneExpressionSelectorVolcanoGroup").css("display","none"),e("#rppaExpressionSelectorVolcanoGroup").css("display","none"),"gene"!==this.truePhenotype||this.mutexMode){if(this.mutexMode){var a=this.data[this.volcanoIndexToDataIndex.get(t)];if(this.drawVennDiagram(t),3===a.mutexEntryType){var s=a.identifier;if(this.singleGeneExpression=new c.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!0,"gene",s,null,n,r,this.group1Index,this.group2Index,i.fontManager),this.cohortMetadata.rppaExpressionAvailable){var l=this.references.genes.get(s).rppaIds;if(l.length>0){e("#rppaExpressionSelectorVolcano").append("<option value=-1>Select RPPA Rppa</option>");var A=[];l.forEach(function(e){o.references.rppaAntibodies[e].geneIds.forEach(function(e){A.push(e)})}),(A=Array.from(new Set(A)).sort()).length>1&&(e("#geneExpressionSelectorVolcanoGroup").css("display","inline"),e("#geneExpressionSelectorVolcano").append("<option value="+s+">"+this.references.genes.get(s).geneName+"</option>"),A.forEach(function(t){e("#geneExpressionSelectorVolcano").append("<option value="+t+">"+o.references.genes.get(t).geneName+"</option>")}),e("#geneExpressionSelectorVolcano").off("change").on("change",function(){i.singleGeneExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"gene",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager)})),l.forEach(function(t){e("#rppaExpressionSelectorVolcano").append("<option value="+t+">"+o.references.rppaAntibodies[t].rppaName+"</option>")}),e("#rppaExpressionSelectorVolcano").off("change").on("change",function(){-1!==parseInt(this.value)&&(i.singleRppaExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"rppa",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager))})}}}}else if("rppa"===this.truePhenotype&&!this.correlationMode){var u=this.data[this.volcanoIndexToDataIndex.get(t)].rppa;this.singleRppaExpression=new c.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!0,"rppa",u,null,n,r,this.group1Index,this.group2Index,i.fontManager);var h=[],d=this.data[this.volcanoIndexToDataIndex.get(t)].getGeneIndices(this.references);d.forEach(function(e){o.references.genes.get(e).rppaIds.forEach(function(e){h.push(e)})}),(h=Array.from(new Set(h)).sort()).length>0&&(h.forEach(function(e){o.references.rppaAntibodies[e].geneIds.forEach(function(e){d.push(e)})}),d=Array.from(new Set(d)).sort(),e("#geneExpressionSelectorVolcanoGroup").css("display","inline"),e("#geneExpressionSelectorVolcano").append("<option value=-1>Select Gene</option>"),d.forEach(function(t){e("#geneExpressionSelectorVolcano").append("<option value="+t+">"+o.references.genes.get(t).geneName+"</option>")}),e("#geneExpressionSelectorVolcano").off("change").on("change",function(){-1!==parseInt(this.value)&&(i.singleGeneExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"gene",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager))}),h.length>1&&(e("#rppaExpressionSelectorVolcanoGroup").css("display","inline"),h.forEach(function(t){e("#rppaExpressionSelectorVolcano").append("<option value="+t+">"+o.references.rppaAntibodies[t].rppaName+"</option>")}),e("#rppaExpressionSelectorVolcano").off("change").on("change",function(){i.singleRppaExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"rppa",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager)})))}}else{var f=this.data[this.volcanoIndexToDataIndex.get(t)].gene;if(this.correlationMode&&this.anchorGeneId!==f?this.singleGeneExpression=new c.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!0,"gene",this.anchorGeneId,f,n,r,this.group1Index,this.group2Index,i.fontManager):this.singleGeneExpression=new c.SinglePhenotypeExpression(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,!0,"gene",f,null,n,r,this.group1Index,this.group2Index,i.fontManager),this.cohortMetadata.rppaExpressionAvailable&&!this.correlationMode){var p=this.references.genes.get(f).rppaIds;if(p.length>0){e("#rppaExpressionSelectorVolcano").append("<option value=-1>Select RPPA Rppa</option>");var g=[];p.forEach(function(e){o.references.rppaAntibodies[e].geneIds.forEach(function(e){g.push(e)})}),(g=Array.from(new Set(g)).sort()).length>1&&(e("#geneExpressionSelectorVolcanoGroup").css("display","inline"),e("#geneExpressionSelectorVolcano").append("<option value="+f+">"+this.references.genes.get(f).geneName+"</option>"),g.forEach(function(t){e("#geneExpressionSelectorVolcano").append("<option value="+t+">"+o.references.genes.get(t).geneName+"</option>")}),e("#geneExpressionSelectorVolcano").off("change").on("change",function(){i.singleGeneExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"gene",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager)})),p.forEach(function(t){e("#rppaExpressionSelectorVolcano").append("<option value="+t+">"+o.references.rppaAntibodies[t].rppaName+"</option>")}),e("#rppaExpressionSelectorVolcano").off("change").on("change",function(){-1!==parseInt(this.value)&&(i.singleRppaExpression=new c.SinglePhenotypeExpression(i.commonSettings,i.references,i.cohortMetadata,i.selectionManager,!0,"rppa",parseInt(this.value),null,n,r,i.group1Index,i.group2Index,i.fontManager))})}}}}},{key:"markGene",value:function(t,n,r){var o=this,i=this.references.genes.get(t).currentVolcanoContributions.get(this.displayAndControlElements.VolcanoIndices);if(void 0!==i&&0!==i.size){var a=this,s=!1;-1===n&&(n=Array.from(i)[0]),this.displaySettings.lastVolcanoItemIndex=n,s=a.markVolcanoItem(n,!r),i.forEach(function(e){e!==n&&(s=a.markVolcanoItem(e,!1))}),s||(i.forEach(function(e){o.displaySettings.markedVolcanoItems.delete(e)}),e("#geneSelectorControlsForMarkedGenes").css("display","none"),e("#clearMarkedGenesOnCytoband").css("display","none"),this.displaySettings.lastVolcanoItemIndex=-1),r||(e("#volcanoGeneDescriptionPaneControl").css("display","inline"),e('.nav-tabs a[href="#volcanoGeneDescriptionPane"]').tab("show"),e("#volcanoAddGeneExpressionToMetadata").css("display","inline"),e("#volcanoAddGeneVariantsToMetadata").css("display","inline"),this.updateMarkedVolcanoItemDisplay())}}},{key:"updateMarkedVolcanoItemDisplay",value:function(){var t=this;if(0===this.displaySettings.markedVolcanoItems.size)e("#"+this.volcanoId+"MarkedEntriesListGroup").css("display","none"),e("#"+this.volcanoId+"MarkedEntriesList").empty();else{var n=[];this.displaySettings.markedVolcanoItems.forEach(function(e){var r=t.volcanoIndexToDataIndex.get(e);n.push(t.data[r].getName(t.references))}),e("#"+this.volcanoId+"MarkedEntriesListGroup").css("display","inline"),e("#"+this.volcanoId+"MarkedEntriesList").html(n.join("<br>"))}}},{key:"removeLastMarkedGene",value:function(){-1!==this.displaySettings.lastVolcanoItemIndex&&this.markVolcanoItem(this.displaySettings.lastVolcanoItemIndex,!1)}},{key:"hideLastMarkedGene",value:function(){-1!==this.displaySettings.lastVolcanoItemIndex&&this.hideVolcanoItem(this.displaySettings.lastVolcanoItemIndex)}},{key:"clearMarkedGenes",value:function(){var t=this,n=[];this.displaySettings.markedVolcanoItems.forEach(function(e){n.push(e)}),n.forEach(function(e){t.markVolcanoItem(e,!1)}),this.displaySettings.markedVolcanoItems.clear(),e("#geneSelectorControlsForMarkedGenes").css("display","none"),e("#volcanoClearGene").css("display","none"),e("#clearMarkedGenesOnCytoband").css("display","none"),this.updateMarkedVolcanoItemDisplay()}},{key:"setCurrentGeneAsTopY",value:function(){var t=this;-1!==this.currentVolcanoIndex&&(this.displaySettings.maxYForced=Math.abs(this.data[this.volcanoIndexToDataIndex.get(this.currentVolcanoIndex)].y),this.displaySettings.modifiedVolcanoAxisY=!0,e("#"+this.displayAndControlElements.VolcanoResetAxis).css("display","inline"),setTimeout(function(){t.plotVolcano()},0))}},{key:"setCurrentGeneAsTopX",value:function(){var t=this;if(-1!==this.currentVolcanoIndex){var n=Math.abs(this.data[this.volcanoIndexToDataIndex.get(this.currentVolcanoIndex)].x);this.displaySettings.maxXForced=n*(1.05/1.1),this.displaySettings.modifiedVolcanoAxisX=!0,e("#"+this.displayAndControlElements.VolcanoResetAxis).css("display","inline"),setTimeout(function(){t.plotVolcano()},0)}}},{key:"pubmedCurrentGene",value:function(){var e=this;this.data[this.volcanoIndexToDataIndex.get(this.currentVolcanoIndex)].getGeneIndices().forEach(function(t){e.references.genes.get(t).searchInPubMed(e.cohortMetadata.diseaseNameAlternatives)})}},{key:"addCurrentGeneExpressionToMetadata",value:function(){var t=this;-1!==this.currentVolcanoIndex&&(e("#volcanoAddGeneExpressionToMetadata").css("display","none"),this.data[this.volcanoIndexToDataIndex.get(this.currentVolcanoIndex)].getGeneIndices().forEach(function(e){t.cohortMetadata.addGeneExpressionToMetadata(e)}))}},{key:"addCurrentGeneVariantsToMetadata",value:function(){var t=this;-1!==this.currentVolcanoIndex&&(e("#volcanoAddGeneVariantsToMetadata").css("display","none"),this.data[this.volcanoIndexToDataIndex.get(this.currentVolcanoIndex)].getGeneIndices().forEach(function(e){t.cohortMetadata.addGeneVariantsToMetadata(e)}))}},{key:"resetAxis",value:function(){var t=this;this.displaySettings.maxXForced=this.displaySettings.maxX,this.displaySettings.maxYForced=this.displaySettings.maxY,e("#"+this.displayAndControlElements.VolcanoResetAxis).css("display","none"),setTimeout(function(){t.plotVolcano()},0)}},{key:"cleanupPlot",value:function(){(0,i.select)("#"+this.displayAndControlElements.VolcanoSvg).selectAll("*").remove(),e("#"+this.displayAndControlElements.VolcanoSvg).remove(),e("#"+this.displayAndControlElements.VolcanoContent).empty(),e("#"+this.volcanoId+"ProgressBarGroup").css("display","none"),e("#"+this.volcanoId+"ProgressBar").css("width","0%"),this.constructed=!1}},{key:"plotTitle",value:function(){var t=this;e("#"+this.displayAndControlElements.VolcanoTitle).remove(),e("#"+this.displayAndControlElements.VolcanoTitleFrame).remove();var n=.7*e("#"+this.displayAndControlElements.VolcanoContent+"Pre").width(),r=(0,i.path)();r.moveTo(0,-3),r.lineTo(n,-3),r.closePath(),this.volcanoSVG.append("path").attr("id",this.displayAndControlElements.VolcanoTitleFrame).attr("d",r),this.volcanoTitle="","subcohort"===this.volcanoTypePrefix?"Mutex"!==this.volcanoPhenotype?this.volcanoTitle=this.cohortMetadata.getCohortTitleSubcohortExpressionMode(this.volcanoPhenotype,this.selectionManager.registeredSubcohorts.get(this.group1Index),this.selectionManager.registeredSubcohorts.get(this.group2Index),this.selectionManager.registeredSubcohortNames.get(this.group1Index),this.selectionManager.registeredSubcohortNames.get(this.group2Index)):this.volcanoTitle=this.cohortMetadata.getCohortTitleSubcohortMutexMode(this.selectionManager.registeredSubcohorts.get(this.group1Index),this.selectionManager.registeredSubcohorts.get(this.group2Index),this.selectionManager.registeredSubcohortNames.get(this.group1Index),this.selectionManager.registeredSubcohortNames.get(this.group2Index)):"variant"===this.volcanoTypePrefix?this.volcanoTitle=this.cohortMetadata.getCohortTitleExpressionMode(this.volcanoPhenotype)+" "+Array.from(this.currentComparisonClasses[1]).map(function(e){return t.references.comparisonTypes[e]}).join(" & "):"correlation"===this.volcanoTypePrefix&&(this.volcanoTitle=this.cohortMetadata.getCohortTitleCorrelationMode(this.volcanoPhenotype,this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex),this.selectionManager.registeredSubcohortNames.get(this.currentSubcohortIndex),this.anchorGeneId));var o=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("title").generateFontCssText();this.volcanoSVG.append("text").append("textPath").attr("class","markerTextCohort").attr("xlink:href","#"+this.displayAndControlElements.VolcanoTitleFrame).attr("id",this.displayAndControlElements.VolcanoTitle).style("text-anchor","start").attr("startOffset","0%").style("display","inline").style("font",o).html(this.volcanoTitle)}},{key:"plotAxis",value:function(){var t=this;e("#"+this.volcanoId+"YAxis").remove(),e("#"+this.volcanoId+"YAxisTitle").remove(),e("#"+this.volcanoId+"XAxis").remove(),e("#"+this.volcanoId+"XAxisTitle").remove();var n=+e("#"+this.displayAndControlElements.VolcanoCircleClass+"_dummy").attr("cy"),o=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("xAxisLabels").generateFontCssText(),a=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("yAxisLabels").generateFontCssText(),s=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("xAxisTitle").generateFontCssText(),c=this.fontManager.fontTree.get("volcanoFontTargetSelector").get("yAxisTitle").generateFontCssText(),A=.7*e("#"+this.displayAndControlElements.VolcanoContent+"Pre").width(),u=this.generateScalesXY(A),h=r(u,2),d=h[0],f=h[1];this.volcanoSVG.append("g").attr("id",this.volcanoId+"YAxis").attr("class","axis axis--y").call((0,i.axisLeft)(f).tickFormat(function(e){return"variant"===t.volcanoTypePrefix?Math.pow(10,-e).toExponential(3):"subcohort"===t.volcanoTypePrefix?Math.exp(-e).toExponential(3):"correlation"===t.volcanoTypePrefix?e:void 0})).selectAll("text").style("font",a);var p=this.yFieldName,g=(0,l.getTestFullName)(this.testName);p=g.length>0?p+" ("+g+")":"&#124;"+p+"&#124;",this.volcanoSVG.append("text").attr("class","markerText").attr("id",this.volcanoId+"YAxisTitle").attr("transform","rotate(-90)").attr("y",0-n/10).attr("x",0-n/2).attr("dy","1em").style("font",c).style("text-anchor","middle").html(p),this.volcanoSVG.append("g").attr("id",this.volcanoId+"XAxis").attr("class","axis axis--x").call((0,i.axisBottom)(d)).attr("transform","translate(0,"+n+")").style("font",o);var m=this.xFieldName;"correlation"!==this.volcanoTypePrefix&&(m="Fold Change by Difference of "+m),this.volcanoSVG.append("text").attr("class","markerText").attr("id",this.volcanoId+"XAxisTitle").attr("y",1.03*n).attr("x",n/2).attr("dy","1em").style("font",s).style("text-anchor","middle").text(m)}},{key:"resetSelectionRect",value:function(){this.rectStart={},this.rectEnd={},e("#"+this.volcanoTypePrefix+this.volcanoPhenotype+"VolcanoSelectBox").remove()}},{key:"plotVolcano",value:function(){var t=this,n=this;this.cleanupPlot();var o=e("#"+this.displayAndControlElements.VolcanoContent+"Pre").width();this.displaySettings.volcanoVbox=.1*-o+" "+.02*-o+" "+.8*o+" "+.8*o,this.volcanoSVG=(0,i.select)("#"+this.displayAndControlElements.VolcanoContent).classed("svg-container",!0).append("svg").classed("svg-content-responsive",!0).attr("viewBox",this.displaySettings.volcanoVbox).attr("id",this.displayAndControlElements.VolcanoSvg).attr("preserveAspectRatio","xMaxYMin meet").attr("width","95%").attr("height","95%"),this.volcanoSVG.on("mousedown",function(){n.rectStart=(0,i.mouse)(this),n.rectStart.x>n.svgWidth||n.rectStart.y>n.targetHeight?n.resetSelectionRect():n.rectStart.x<0||n.rectStart.y<0?n.resetSelectionRect():n.volcanoSVG.append("rect").attr("id",n.volcanoId+"SelectBox").attr("x",n.rectStart[0]).attr("y",n.rectStart[1]).attr("width",0).attr("height",0).style("fill","none").style("stroke","Black").style("stroke-width",.6)}).on("mousemove",function(){var e=n.volcanoSVG.select("#"+n.volcanoId+"SelectBox");if(!e.empty()){var t=(0,i.mouse)(this),r={x:+e.attr("x"),y:+e.attr("y"),width:+e.attr("width"),height:+e.attr("height")},o={x:t[0]-r.x,y:t[1]-r.y};o.x<1||2*o.x<r.width?(r.x=t[0],r.width-=o.x):r.width=o.x,o.y<1||2*o.y<r.height?(r.y=t[1],r.height-=o.y):r.height=o.y,e.attr("x",r.x).attr("y",r.y).attr("width",r.width).attr("height",r.height)}}).on("mouseup",function(){if(n.volcanoSVG.select("#"+n.volcanoId+"SelectBox").remove(),!n.commonSettings.interactionLock)if(n.commonSettings.lock(),n.rectEnd=(0,i.mouse)(this),n.rectEnd.x>n.svgWidth||n.rectEnd.y>n.targetHeight)n.resetSelectionRect();else if(n.rectEnd.x<0||n.rectEnd.y<0)n.resetSelectionRect();else{var t=.7*e("#"+n.displayAndControlElements.VolcanoContent+"Pre").width(),o=n.generateScalesXY(t),a=r(o,2),s=a[0],l=a[1],c=[s.invert(n.rectStart[0]),s.invert(n.rectEnd[0])].sort(function(e,t){return e<t?-1:e>t?1:-1}),A=[l.invert(n.rectStart[1]),l.invert(n.rectEnd[1])].sort(function(e,t){return e<t?-1:e>t?1:-1});if("correlation"!==n.volcanoTypePrefix)for(var u=0;u<n.data.length;++u){var h=n.data[u].volcanoItemIndex,d=n.data[u].x,f=n.data[u].y;n.displaySettings.markedVolcanoItems.has(h)||n.displaySettings.hiddenVolcanoItems.has(h)||A[0]<f&&f<A[1]&&c[0]<d&&d<c[1]&&n.markVolcanoItem(h,!1)}else for(var p=0;p<n.data.length;++p){var g=n.data[p].volcanoItemIndex,m=n.data[p].x,v=Math.abs(n.data[p].y);n.displaySettings.markedVolcanoItems.has(g)||n.displaySettings.hiddenVolcanoItems.has(g)||A[0]<v&&v<A[1]&&c[0]<m&&m<c[1]&&n.markVolcanoItem(g,!1)}n.updateMarkedVolcanoItemDisplay(),n.rectStart={},n.rectEnd={},n.commonSettings.releaseLock()}});var a=.7*o,s=n.generateScalesXY(a),l=r(s,2),c=l[0],A=l[1];this.volcanoSVG.append("rect").attr("id",this.displayAndControlElements.VolcanoFrame).attr("x",0).attr("y",0).attr("height",a).attr("width",a).style("stroke","Black").style("fill","none").style("stroke-width",1).on("click",function(){n.commonSettings.interactionLock||(n.commonSettings.fastLock(),this.setAttribute("display","none"),n.commonSettings.fastRelease())}),this.plotTitle(),setTimeout(function(){},0),this.circleGroup=this.volcanoSVG.append("g"),this.circleGroup.append("path").attr("class",this.displayAndControlElements.VolcanoCircleClass).attr("id",this.displayAndControlElements.VolcanoCircleClass+"_dummy").attr("cx",c(0)).attr("cy",A(0)).attr("si",0).attr("transform","translate("+c(0)+","+A(0)+") rotate(45)").style("display","none"),this.circleGroup.selectAll("."+this.displayAndControlElements.VolcanoCircleClass).data(this.data).enter().append("path").attr("class",this.displayAndControlElements.VolcanoCircleClass).attr("id",function(e){return t.displayAndControlElements.VolcanoCircleClass+"_"+e.volcanoItemIndex}).attr("cx",function(e){return c(e.x)}).attr("cy",function(e){return A(Math.abs(e.y))}).attr("si",function(e){return"Mutex"!==t.volcanoPhenotype?3:e.mutexEntryType}).attr("transform",function(e){return"Mutex"!==t.volcanoPhenotype?"translate("+c(e.x)+","+A(Math.abs(e.y))+") rotate(45)":"translate("+c(e.x)+","+A(Math.abs(e.y))+")"}).style("fill",function(e){for(var n=e.getGeneIndices(t.references),r=0;r<n.length;++r)if(t.references.genes.get(n[r]).cancerGene)return"#e41a1c";return"#377eb8"}).append("svg:title").text(function(e){return e.getHoverLabel(t.references)}),this.circleGroup.on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock(),e("#vennContentVolcano").empty(),e("#geneExpressionContentVolcano").empty(),e("#rppaExpressionContentVolcano").empty();var n=(0,i.select)(i.event.target).datum(),r=null;try{r=n.getGeneIndices(t.references)}catch(e){}null!==r&&(r.length>0?(e("#tadOffsetSelectorVolcanoGroup").css("display","inline"),r.forEach(function(e){t.markGene(e,n.volcanoItemIndex,!1)})):(e("#tadOffsetSelectorVolcanoGroup").css("display","none"),e('.nav-tabs a[href="#volcanoGeneDescriptionPane"]').tab("show"),t.drawVennDiagram(n.volcanoItemIndex),t.markVolcanoItem(n.volcanoItemIndex,!1))),t.commonSettings.fastRelease()}}),this.replotAllMarked(),this.adjustRadius(12*+e("#"+this.displayAndControlElements.VolcanoRadius).val()),this.plotAxis(),this.constructed=!0,setTimeout(function(){t.adjustVisibility()},0)}},{key:"replotAllMarked",value:function(){var e=this,t=[];this.displaySettings.markedVolcanoItems.forEach(function(e){t.push(e)}),this.clearMarkedGenes(),this.displaySettings.markedVolcanoItems.clear(),t.forEach(function(t){e.markVolcanoItem(t,!1)})}},{key:"getMarkedGeneList",value:function(){var t=this,n=new Set;this.displaySettings.markedVolcanoItems.forEach(function(r){"none"!==e("#"+t.displayAndControlElements.VolcanoCircleClass+"_"+r).css("display")&&t.data[t.volcanoIndexToDataIndex.get(r)].getGeneIndices().forEach(function(e){n.add(e)})});var r=[];return n.forEach(function(e){r.push(t.references.genes.get(e).geneName)}),r}},{key:"saveVolcanoSvg",value:function(){(0,l.saveSvg)(this.displayAndControlElements.VolcanoSvg,this.volcanoTitle.replace(/ /g,"_")+"_"+this.volcanoId+".svg")}},{key:"setDataXfield",value:function(e){for(var t=0;t<this.data.length;++t)this.data[t].setX(e)}},{key:"setDataYfield",value:function(e){for(var t=0;t<this.data.length;++t)this.data[t].setY(e)}},{key:"generateScalesXY",value:function(e){return[(0,i.scaleLinear)().domain([1.1*-this.displaySettings.maxXForced,1.1*this.displaySettings.maxXForced]).range([0,e]),(0,i.scaleLinear)().domain([0,1.05*this.displaySettings.maxYForced]).range([e,0])]}},{key:"setFieldNamesXY",value:function(){var t=e("input[name="+this.displayAndControlElements.VolcanoXRadioButton+"]:checked").val(),n="pValLog10",r=e("input[name="+this.displayAndControlElements.VolcanoYRadioButton+"]:checked").val();if("correlation"===this.volcanoTypePrefix){var o=e("#"+this.displayAndControlElements.VolcanoXRadioButtonAlt1).val(),i=e("#"+this.displayAndControlElements.VolcanoXRadioButtonAlt2).val();n=t===o?i:o,r=""}return[t,n,r]}},{key:"launchCorrelationAnalysisFromMetadataColumn",value:function(t){var n=this;this.commonSettings.lock(),this.cleanup(),this.clearMarkedGenes();var r=new Map,o=[],i=new Set;e("#"+this.volcanoId+"MetadataColumnSelectionSubmit").css("display","none"),this.currentSubcohortIndex=+e("#"+this.volcanoId+"SubcohortSelector1").val(),this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex).forEach(function(e){if("+"===n.cohortMetadata.metadata[e].RNA){var a=n.cohortMetadata.metadata[e][t];n.commonSettings.undefinedValues.has(a)||(i.add(e),n.currentSubcohortDonors.add(e.toString()),n.anchorExpressions.push({expression:a,donorIndex:e}),r.set(e,a),o.push(new d.SingleDonorVariantContribution(e,62,a)))}}),this.anchorExpressions=this.anchorExpressions.sort(function(e,t){return e.donorIndex<t.donorIndex?-1:e.donorIndex>t.donorIndex?1:-1});for(var a=Number.MAX_VALUE,s=Number.MIN_VALUE,l=0;l<this.anchorExpressions.length;++l){var c=this.anchorExpressions[l].expression;c<a&&(a=c),c>s&&(s=c)}if(a<0){for(var A=0;A<this.anchorExpressions.length;++A)this.anchorExpressions[A].expression-=a;s-=a}if(s>10)for(var u=0;u<this.anchorExpressions.length;++u)this.anchorExpressions[u].expression=Math.log2(this.anchorExpressions[u].expression+1);this.anchorGeneId=-1;var f={geneId:-1,chromosomeIndex:0,startPos:0,endPos:0,geneTypeIndex:0,cytobandIndices:"0",tadIndices:"0",rppaIds:".",geneName:t,cancerGene:!1,batch:-1,reactomePathwayIds:".",expressions:r,singleDonorVariantContributions:o};this.references.genes.has(-1)&&this.references.genes.delete(-1),this.references.genes.set(-1,new h.GeneEntry(f)),this.callNextBatchForCorrelationAnalysis(0,99)}},{key:"launchCorrelationAnalysis",value:function(t){var n=this;this.commonSettings.lock(),this.anchorGeneId=t,this.currentSubcohortIndex=+e("#"+this.volcanoId+"SubcohortSelector1").val(),-1===this.currentSubcohortIndex&&(e("#"+this.volcanoId+"SubcohortSelector1").val("0"),this.currentSubcohortIndex=0),this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex).forEach(function(e){n.currentSubcohortDonors.add(e.toString())}),this.cleanup(),this.clearMarkedGenes();var r=(0,a.queue)();r.defer(function(e){n.getExpressionsForCorrelationAnalysis(t,e)}),r.awaitAll(function(){if(e("#"+n.truePhenotype+"CorrelationAnalysisSubmit").css("display","none"),n.anchorExpressions=n.tmpExpressions.get(t),void 0===n.anchorExpressions)return n.anchorExpressions=[],n.cleanup(),void n.commonSettings.releaseLock();n.anchorExpressions=n.anchorExpressions.sort(function(e,t){return e.donorIndex<t.donorIndex?-1:e.donorIndex>t.donorIndex?1:-1}),n.callNextBatchForCorrelationAnalysis(0,99)})}},{key:"getExpressionsForCorrelationAnalysis",value:function(t,n){var r=this;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:r.truePhenotype+"Expressions",columnsToSelect:"*",keyColumn:r.truePhenotype,keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){if(r.tmpExpressions.clear(),e.length>0)for(var t=function(t){var n=e[t],o=[],i=0;Object.keys(n).forEach(function(e,t){if(e!==r.truePhenotype&&"varianceRank"!==e&&r.currentSubcohortDonors.has(e)){var a=+n[e];a>i&&(i=a),o.push({expression:a,donorIndex:+e})}}),(i>=1||0===r.anchorExpressions.length)&&r.tmpExpressions.set(n[r.truePhenotype],o)},o=0;o<e.length;++o)t(o);n()}})}},{key:"finalizeCorrelationAnalysis",value:function(){this.addVolcanoIndices(),this.setDataXfield(this.xFieldName),this.setDataYfield(this.yFieldName),this.updateMaximums(),this.plotVolcano(),this.commonSettings.releaseLock()}},{key:"callNextBatchForCorrelationAnalysis",value:function(e,t){this.getBatchForCorrelationAnalysis(e,t)}},{key:"getBatchForCorrelationAnalysis",value:function(e,t){var n=this,r="*";if(-1!==e){if(this.references.geneBatchInfo.has(e)||e<=t&&this.callNextBatchForCorrelationAnalysis(e+1,t),e>t)return void this.finalizeCorrelationAnalysis();var o=this.references.geneBatchInfo.get(e);r=o.join(",")}var i=(0,a.queue)();i.defer(function(e){n.getExpressionsForCorrelationAnalysis(r,e)}),i.awaitAll(function(){n.processCurrentBatchForCorrelationAnalysis(),n.callNextBatchForCorrelationAnalysis(e+1,t)})}},{key:"processCurrentBatchForCorrelationAnalysis",value:function(){var e=this;this.tmpExpressions.forEach(function(t,n,r){var o=0;t.forEach(function(e){e.expression>o&&(o=e.expression)});var i=e.truePhenotype,a={pearson:(0,A.pearsonCorrelation)(e.anchorExpressions,t,"expression"),spearman:(0,A.spearmanCorrelation)(e.anchorExpressions,t,25),maxExpression:o};a[i]=n,e.data.push(new s.VolcanoEntry(a,0))})}},{key:"textExport",value:function(){var e=[];e.push(s.VolcanoEntry.generalHeaderExport(this.volcanoTypePrefix));for(var t="textExport_"+this.volcanoTypePrefix,n=0;n<this.data.length;++n){var r=this.data[n].volcanoItemIndex,o=document.getElementById(this.displayAndControlElements.VolcanoCircleClass+"_"+r);null!==o&&"inline"===o.style.display&&e.push(this.data[n][t](this.references))}return e}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.VariantViz=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(1);t.VariantViz=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.focusedMode=e,this.references=null,this.cohortMetadata=null,this.selectionManager=null,this.fontManager=null,this.selectedSubcohortIndex=null,this.svg=null,this.data=[],this.elementGroup=null,this.elementTracerGroup=null,this.svMode=!1,this.elementClassPrefix="",this.selectedDonors=new Set,this.currentIndex=-1,this.constructed=!1,this.blacklistedIndices=new Set,this.anyVdjTra=!1,this.lockDisplay=!1,this.vdjCountMapper=new Map}return o(t,[{key:"init",value:function(t,n,r,o,i,a,s,l){if(this.commonSettings=t,this.references=n,this.cohortMetadata=r,this.selectionManager=o,this.fontManager=i,this.selectedSubcohortIndex=a,this.selectedDonors=this.selectionManager.registeredSubcohorts.get(this.selectedSubcohortIndex),this.svg=t.mainSvg,this.data=s,this.indexMapper=new Map,this.focusedMode)for(var c=0;c<s.length;++c)this.indexMapper.set(this.data[c].getIndex(),c);this.elementGroup=this.svg.append("g"),this.labelGroup=this.svg.append("g"),this.elementTracerGroup=this.svg.append("g"),this.svMode="smallVariant"!==l,this.vdjSvMode="vdjSv"===l,this.vdjSvMode&&this.data.length>0&&(this.anyVdjTra=!0,e("#vdjTraModeGroup").css("display","inline")),this.vdjCountMapper.clear(),this.elementClassPrefix=l,this.constructed=!0,this.estimateInitialEvent()}},{key:"estimateInitialEvent",value:function(){if(this.data.length>0){for(var e=!1,t=0;t<this.data.length;++t)if(!this.blacklistedIndices.has(t)&&this.selectedDonors.has(this.data[t].donorIndex)){this.currentIndex=t,e=!0;break}e||this.destroy()}}},{key:"destroy",value:function(){this.constructed&&(e("#"+this.elementClassPrefix+"Counter").html("NONE FOUND"),e("#"+this.elementClassPrefix+"Description").html(""),this.constructed=!1,this.lockDisplay=!1,this.currentIndex=-1,this.elementGroup.selectAll("*").remove(),this.labelGroup.selectAll("*").remove(),this.elementTracerGroup.selectAll("*").remove())}},{key:"enableControls",value:function(){var t=this;this.constructed&&(this.elementGroup.on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();var e=(0,i.select)(i.event.target).datum(),n=0;try{n=e.getIndex()}catch(e){return console.error(e),void t.commonSettings.fastRelease()}var r=n;t.focusedMode&&t.indexMapper.has(n)&&(r=t.indexMapper.get(n)),t.goToEntry(r),t.commonSettings.fastRelease()}}),e("#"+this.elementClassPrefix+"Blacklist").off("click").on("click",function(){t.blacklistEvent(t.currentIndex),e('.nav-tabs a[href="#controlsPane"]').tab("show")}),e("#"+this.elementClassPrefix+"SweepLeft").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();for(var e=0,n=!1;e<t.data.length;){if(t.sweepLeft(),!t.blacklistedIndices.has(t.currentIndex)&&t.selectedDonors.has(t.data[t.currentIndex].donorIndex)){n=!0;break}++e}n&&t.goToEntry(t.currentIndex),t.commonSettings.fastRelease()}}),e("#"+this.elementClassPrefix+"SweepRight").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.fastLock();for(var e=0,n=!1;e<t.data.length;){if(t.sweepRight(),!t.blacklistedIndices.has(t.currentIndex)&&t.selectedDonors.has(t.data[t.currentIndex].donorIndex)){n=!0;break}++e}n&&t.goToEntry(t.currentIndex),t.commonSettings.fastRelease()}}),e("#"+this.elementClassPrefix+"DescriptionPaneControl").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.lock(),-1!==t.currentIndex&&t.goToEntry(t.currentIndex),t.commonSettings.releaseLock())}),this.vdjSvMode&&this.plotVdjMarkers())}},{key:"cleanup",value:function(){this.constructed&&(this.elementGroup.selectAll("*").remove(),this.labelGroup.selectAll("*").remove())}},{key:"sweepLeft",value:function(){0!==this.currentIndex?this.currentIndex-=1:this.currentIndex=this.data.length-1}},{key:"sweepRight",value:function(){this.currentIndex!==this.data.length-1?this.currentIndex+=1:this.currentIndex=0}},{key:"goToEntry",value:function(t){var n=e("#"+this.elementClassPrefix+"Description");n.empty(),this.currentIndex=t;var r=this.data[this.currentIndex].annotate(this.references,this.cohortMetadata);this.addTracer(this.data[this.currentIndex]),e("#"+this.elementClassPrefix+"DescriptionPaneControl").css("display","inline"),n.html(r),e("#"+this.elementClassPrefix+"Counter").html(this.currentIndex+1+"/"+this.data.length),e('.nav-tabs a[href="#'+this.elementClassPrefix+'DescriptionPane"]').tab("show")}},{key:"plot",value:function(){var e=this;this.constructed&&(this.cleanup(),this.vdjSvMode?this.anyVdjTra&&(this.elementGroup.selectAll("*").data(this.data).enter().append("path").attr("id",function(t){return e.elementClassPrefix+"_"+t.getIndex()}).attr("class",function(t){return t.vdjGrade>0?"variant9":"variant"+e.references.variantVizTypes[t.eventTypeVizIndex].variantVizTypeIndex}),this.updateOpacity(0),this.updateVisibility(),this.updatePaths()):(this.svMode,this.elementGroup.selectAll("*").data(this.data).enter().append("path").attr("class",function(t){return"variant"+e.references.variantVizTypes[t.eventTypeVizIndex].variantVizTypeIndex}),this.updateOpacity(0),this.updateVisibility(),this.updatePaths()))}},{key:"plotVdjMarkers",value:function(){var e=this;if(this.constructed){var t=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("cytobandAndGeneLabels").generateFontCssText();this.labelGroup.selectAll("*").remove();for(var n=function(t){var n=e.data[t];if(e.blacklistedIndices.has(n.getIndex()))return"continue";if(!e.selectedDonors.has(n.donorIndex))return"continue";if(0===n.vdjTargets.length)return"continue";var r=n.vdjGrade;n.vdjTargets.forEach(function(t){if(e.vdjCountMapper.has(t)||e.vdjCountMapper.set(t,new Map),e.vdjCountMapper.get(t).has(n.donorIndex)){var o=e.vdjCountMapper.get(t).get(n.donorIndex);r<o&&e.vdjCountMapper.get(t).set(n.donorIndex,r)}else e.vdjCountMapper.get(t).set(n.donorIndex,r)})},r=0;r<this.data.length;++r)n(r);var o=function(n){var r=e.data[n].getVdjLabel(e.references,null),o="vdjSvLabel_"+e.data[n].getIndex(),a=e.data[n].vdjGrade,s="vdjSvLabelPre_"+e.data[n].getIndex();e.labelGroup.append("text").attr("id",s).style("display","none").append("textPath").attr("class","vdjSvLabel").attr("xlink:href","#"+e.elementClassPrefix+"_"+e.data[n].getIndex()).attr("vdjTarget",r).attr("vdjGrade",a).attr("class","vdjSvLabel").attr("id",o).style("display","none").style("font",t).on("click",function(){e.data[n].vdjTargets.forEach(function(t){e.references.genes.get(t).launchDefaultDb()})}).on("contextmenu",function(){i.event.preventDefault(),e.blacklistEvent(e.data[n].getIndex())})};for(r=0;r<this.data.length;++r)o(r)}}},{key:"switchVdjMode",value:function(){this.constructed&&!this.lockDisplay&&(this.anyVdjTra?e("#vdjTraMode").is(":checked")?this.replotVdjLabels():(this.updateVisibility(),this.labelGroup.selectAll("*").style("display","none")):e("#vdjTraMode").is(":checked")?this.elementGroup.selectAll("*").style("display","none"):this.updateVisibility())}},{key:"replotVdjLabels",value:function(){this.labelGroup.selectAll("*").style("display","none");var t=this,n=new Set;this.elementGroup.selectAll("*").style("display",function(){var r=(0,i.select)(this).datum();if(t.blacklistedIndices.has(r.getIndex()))return"none";if(!t.selectedDonors.has(r.donorIndex))return"none";if(r.vdjGrade>t.commonSettings.maxVdjGrade)return"none";var o=e(this).attr("id"),a=o.replace(t.elementClassPrefix,"vdjSvLabel"),s=o.replace(t.elementClassPrefix,"vdjSvLabelPre"),l=e("#"+a),c=e("#"+s),A=r.getVdjLabel(t.references,t.vdjCountMapper,t.commonSettings.maxVdjGrade);l.text(A);var u=l.attr("vdjTarget");return n.has(u)?(l.css("display","none"),c.css("display","none")):(l.css("display","inline"),c.css("display","inline"),n.add(u)),"inline"})}},{key:"blacklistEvent",value:function(t){this.constructed&&(e("#vdjSvLabel_"+t).remove(),this.tracerCleanup(),this.blacklistedIndices.add(t),this.estimateInitialEvent(),this.updateVisibility(),this.anyVdjTra&&e("#vdjTraMode").is(":checked")&&this.switchVdjMode())}},{key:"updateOpacity",value:function(){if(this.constructed){var e=this;this.svMode?this.elementGroup.selectAll("*").style("opacity",function(){var t=(0,i.select)(this).datum(),n=1;return!e.focusedMode&&e.commonSettings.hyperzoomMode<2&&t.eventTypeVizIndex<6&&(n=t.clonality/e.commonSettings.transparencyScaling),n}):this.elementGroup.selectAll("*").style("opacity",1)}}},{key:"updatePaths",value:function(){if(this.constructed){this.elementTracerGroup.selectAll("*").remove();var e=this;this.elementGroup.selectAll("*").attr("d",function(){var t=(0,i.select)(this).datum(),n=.15;e.svMode&&(n=t.getEventHeight());var o=(0,i.path)();if(7!==t.eventTypeIndex){var s=e.references.genomicTheta(t.startChrIndex,t.startPos),l=e.references.genomicTheta(t.endChrIndex,t.endPos),c=(0,a.polarToCartesian)(e.commonSettings.svRadius,s),A=r(c,2),u=A[0],h=A[1],d=(0,a.polarToCartesian)(e.commonSettings.svRadius,l),f=r(d,2),p=f[0],g=f[1],m=(0,a.polarToCartesian)((1-n)*e.commonSettings.svRadius,.5*(s+l)),v=r(m,2),y=v[0],b=v[1];o.moveTo(u,h),o.quadraticCurveTo(y,b,p,g)}else{var I=e.references.genomicTheta(t.startChrIndex,t.startPos),x=e.references.genomicTheta(t.endChrIndex,t.endPos),w=(0,a.polarToCartesian)(e.commonSettings.svRadius,x),C=r(w,2),E=C[0],S=C[1],M=(0,a.polarToCartesian)(e.commonSettings.svRadius,I),k=r(M,2),B=k[0],D=k[1],P=(0,a.polarToCartesian)((1-n)*e.commonSettings.svRadius,.5*(x+I)),Q=r(P,2),T=Q[0],G=Q[1];o.moveTo(E,S),o.quadraticCurveTo(T,G,B,D)}return o})}}},{key:"updateVisibility",value:function(){if(this.constructed){var t=this,n=e("#vdjTraMode").is(":checked");this.svMode?(new Set,this.elementGroup.selectAll("*").style("display",function(){var e=(0,i.select)(this).datum();if(t.blacklistedIndices.has(e.getIndex()))return"none";if(!t.selectedDonors.has(e.donorIndex))return"none";if(6===e.eventTypeVizIndex||7===e.eventTypeVizIndex){if(e.vdjGrade<=t.commonSettings.maxVdjGrade)return"inline";if(n)return"none"}else if(n)return"none";return!t.focusedMode&&e.maxRecurrence<t.commonSettings.minRecurrence?"none":"inline"})):this.elementGroup.selectAll("*").style("display","inline")}}},{key:"targetedIndexedDisplay",value:function(t){this.constructed&&(this.elementGroup.selectAll("*").style("display",function(){var e=(0,i.select)(this).datum();return t.has(e.getIndex())?"inline":"none"}),this.vdjSvMode&&(this.labelGroup.selectAll("*").style("display","none"),t.forEach(function(t){e("#vdjSvLabel_"+t).css("display","inline"),e("#vdjSvLabelPre_"+t).css("display","inline")})))}},{key:"tracerCleanup",value:function(){this.constructed&&this.elementTracerGroup.selectAll("*").remove()}},{key:"addTracer",value:function(t){var n=this;if(this.constructed){this.references.tracerMultiCleanup();var o=.15;(this.svMode||this.vdjSvMode)&&(o=t.getEventHeight());var s=this.references.genomicTheta(t.startChrIndex,t.startPos),l=this.references.genomicTheta(t.endChrIndex,t.endPos),c=(0,a.polarToCartesian)(this.commonSettings.svRadius,s),A=r(c,2),u=A[0],h=A[1],d=(0,a.polarToCartesian)(this.commonSettings.svRadius,l),f=r(d,2),p=f[0],g=f[1],m=(0,a.polarToCartesian)((1-o)*this.commonSettings.svRadius,.5*(s+l)),v=r(m,2),y=v[0],b=v[1],I=(0,i.path)();I.moveTo(u,h),I.quadraticCurveTo(y,b,p,g),this.elementTracerGroup.append("path").attr("class","dummyEvents").attr("id","dummyEvent").attr("d",I).style("display","none");for(var x=e("#dummyEvent")[0],w=[],C=[0,.2,.4,.6,.8,1],E=0;E<C.length;E++){var S=C[E],M=x.getPointAtLength(x.getTotalLength()*S);w.push([M.x,M.y])}this.elementTracerGroup.selectAll(".markerCircle").data(w).enter().append("circle").attr("class","markerCircle").attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}).attr("r",this.commonSettings.eventMarkerRadius).on("contextmenu",function(){i.event.preventDefault(),n.elementTracerGroup.selectAll("*").remove()})}}},{key:"hideAll",value:function(){this.constructed&&(this.lockDisplay=!0,this.elementGroup.selectAll("*").style("display","none"),this.labelGroup.selectAll("*").remove(),this.tracerCleanup())}},{key:"textExport",value:function(){for(var e=[],t=0;t<this.data.length;++t)e.push(this.data[t].textExport(this.references,this.cohortMetadata));return e}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.VizManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(328),i=n(13),a=n(117),s=n(119),l=n(116),c=n(1);t.VizManager=function(){function t(e,n,r,i,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.selectionManager=i,this.fontManager=a,this.selectedSubcohortIndex=s,this.cohortData=l,this.svViz=new o.VariantViz(!1),this.vdjSvViz=new o.VariantViz(!1),this.midSizedSvViz=new o.VariantViz(!1),this.svVizFocused=new o.VariantViz(!0),this.vdjSvVizFocused=new o.VariantViz(!0),this.midSizedSvVizFocused=new o.VariantViz(!0),this.smallVarVizFocused=new o.VariantViz(!0),this.svViz.init(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.selectedSubcohortIndex,this.cohortData.Svs,"sv"),this.vdjSvViz.init(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.selectedSubcohortIndex,this.cohortData.VdjSvs,"vdjSv"),this.midSizedSvViz.init(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.selectedSubcohortIndex,this.cohortData.midSizedSvs,"midSizedSv"),this.variantVizControls()}return r(t,[{key:"variantVizControls",value:function(){var t=this;(0,c.generalizedSliderEvents)("maxVdjGrade",function(e){return e},"Max IG/T-cell Receptor Rearrangement Grade:",function(n){t.commonSettings.maxVdjGrade=n,t.svViz.updateVisibility(),t.svVizFocused.updateVisibility(),e("#vdjTraMode").is(":checked")&&(t.vdjSvViz.replotVdjLabels(),t.vdjSvVizFocused.replotVdjLabels()),t.vdjSvViz.updateVisibility(),t.vdjSvVizFocused.updateVisibility()}),(0,c.generalizedSliderEvents)("minRec",function(e){return e},"Min SV Event<br/> Recurrence:",function(e){t.commonSettings.minRecurrence=e,t.updateVisibility()}),(0,c.generalizedSliderEvents)("transparencyScaling",function(e){return e},"<br/>Transparency<br/>Scaling:",function(e){t.commonSettings.transparencyScaling=e,t.updateOpacity()}),e("#vdjTraMode").off("change").on("change",function(){t.svViz.switchVdjMode(),t.vdjSvViz.switchVdjMode(),t.midSizedSvViz.switchVdjMode(),t.svVizFocused.switchVdjMode(),t.vdjSvVizFocused.switchVdjMode(),t.midSizedSvVizFocused.switchVdjMode(),t.smallVarVizFocused.switchVdjMode()})}},{key:"updateVisibility",value:function(){var e=this;setTimeout(function(){e.svViz.updateVisibility()},0),setTimeout(function(){e.vdjSvViz.updateVisibility()},0),setTimeout(function(){e.midSizedSvViz.updateVisibility()},0),setTimeout(function(){e.svVizFocused.updateVisibility()},0),setTimeout(function(){e.vdjSvVizFocused.updateVisibility()},0),setTimeout(function(){e.midSizedSvVizFocused.updateVisibility()},0),setTimeout(function(){e.smallVarVizFocused.updateVisibility()},0)}},{key:"updateOpacity",value:function(){var e=this;setTimeout(function(){e.svViz.updateOpacity()},0),setTimeout(function(){e.vdjSvViz.updateOpacity()},0),setTimeout(function(){e.midSizedSvViz.updateOpacity()},0),setTimeout(function(){e.svVizFocused.updateOpacity()},0),setTimeout(function(){e.vdjSvVizFocused.updateOpacity()},0),setTimeout(function(){e.midSizedSvVizFocused.updateOpacity()},0),setTimeout(function(){e.smallVarVizFocused.updateOpacity()},0)}},{key:"plot",value:function(){var e=this;setTimeout(function(){e.svViz.plot(),e.svViz.enableControls()},0),setTimeout(function(){e.vdjSvViz.plot(),e.vdjSvViz.enableControls()},0),setTimeout(function(){e.midSizedSvViz.plot(),e.midSizedSvViz.enableControls()},0)}},{key:"plotFocused",value:function(){var e=this;setTimeout(function(){e.svVizFocused.plot(),e.svVizFocused.enableControls()},0),setTimeout(function(){e.vdjSvVizFocused.plot(),e.vdjSvVizFocused.enableControls()},0),setTimeout(function(){e.midSizedSvVizFocused.plot(),e.midSizedSvVizFocused.enableControls()},0)}},{key:"plotFocusedSmallVariant",value:function(){var e=this;setTimeout(function(){e.smallVarVizFocused.plot(),e.smallVarVizFocused.enableControls()},0)}},{key:"updateAngles",value:function(){var e=this;setTimeout(function(){e.svViz.updatePaths()},0),setTimeout(function(){e.vdjSvViz.updatePaths()},0),setTimeout(function(){e.midSizedSvViz.updatePaths()},0),setTimeout(function(){e.svVizFocused.updatePaths()},0),setTimeout(function(){e.vdjSvVizFocused.updatePaths()},0),setTimeout(function(){e.midSizedSvVizFocused.updatePaths()},0),setTimeout(function(){e.smallVarVizFocused.updatePaths()},0),this.commonSettings.hyperzoomMode>1&&this.updateOpacity()}},{key:"preparePlotForFocus",value:function(){var t=this;this.resetFocusViz(),this.svViz.hideAll(),this.midSizedSvViz.hideAll(),this.vdjSvViz.hideAll(),e("#vdjTraMode").prop("checked",!1).parent().removeClass("active"),e("#resetFocus").css("display","inline").off("click").on("click",function(){t.resetView()})}},{key:"resetView",value:function(){var t=this;e("#geneRecDescription").empty(),e("#cytobandDescription").empty(),e("#tadDescription").empty(),this.resetFocusViz(),setTimeout(function(){t.svViz.updateVisibility()},0),setTimeout(function(){t.vdjSvViz.updateVisibility()},0),setTimeout(function(){t.midSizedSvViz.updateVisibility()},0)}},{key:"resetFocusViz",value:function(){this.svViz.lockDisplay=!1,this.vdjSvViz.lockDisplay=!1,this.midSizedSvViz.lockDisplay=!1,this.svVizFocused.destroy(),this.vdjSvVizFocused.destroy(),this.midSizedSvVizFocused.destroy(),this.smallVarVizFocused.destroy(),this.svVizFocused=new o.VariantViz(!0),this.vdjSvVizFocused=new o.VariantViz(!0),this.midSizedSvVizFocused=new o.VariantViz(!0),this.smallVarVizFocused=new o.VariantViz(!0),this.svViz.enableControls(),this.midSizedSvViz.enableControls(),this.vdjSvViz.enableControls(),e("#resetFocus").css("display","none")}},{key:"focusOnCytoband",value:function(t){var n=this;this.preparePlotForFocus();var r=new a.VariantFetcher(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,[0]),o=(0,i.queue)();o.defer(function(e){r.getVariantDataForVariantPlotsFromCytobandIndex(t,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.svVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("svData"),"sv"),n.vdjSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("vdjSvData"),"vdjSv"),n.midSizedSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("midSizedSvData"),"midSizedSv"),n.plotFocused(),e("#fetchSmallVariantsFromCytoband").off("click").on("click",function(){e("#fetchSmallVariantsFromCytoband").css("display","none"),e("#smallVariantDescriptionPaneControl").css("display","inline");var r=new a.VariantFetcher(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,[0]),o=(0,i.queue)();o.defer(function(e){r.getSmallVariantDataForVariantPlotsFromCytobandIndex(t,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.smallVarVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("smallVariantData"),"smallVariant"),n.plotFocusedSmallVariant()})})})}},{key:"focusOnTad",value:function(t){var n=this;this.preparePlotForFocus();var r=new a.VariantFetcher(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,[0]),o=(0,i.queue)();o.defer(function(e){r.getVariantDataForVariantPlotsFromTadIndices([t],1,0,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.svVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("svData"),"sv"),n.vdjSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("vdjSvData"),"vdjSv"),n.midSizedSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("midSizedSvData"),"midSizedSv"),n.plotFocused(),e("#fetchSmallVariantsFromTad").off("click").on("click",function(){e("#fetchSmallVariantsFromTad").css("display","none"),e("#smallVariantDescriptionPaneControl").css("display","inline");var r=new a.VariantFetcher(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,[0]),o=(0,i.queue)();o.defer(function(e){r.getSmallVariantDataForVariantPlotsFromTadIndices([t],1,0,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.smallVarVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("smallVariantData"),"smallVariant"),n.plotFocusedSmallVariant()})})})}},{key:"focusOnGene",value:function(t){var n=this;this.preparePlotForFocus();var r=new a.VariantFetcher(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,[0,t]),o=(0,i.queue)();o.defer(function(e){r.getVariantDataForVariantPlotsFromGeneId(t,1,0,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.svVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("svData"),"sv"),n.vdjSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("vdjSvData"),"vdjSv"),n.midSizedSvVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("midSizedSvData"),"midSizedSv"),n.plotFocused(),e("#fetchSmallVariantsFromGene").off("click").on("click",function(){e("#fetchSmallVariantsFromGene").css("display","none"),e("#smallVariantDescriptionPaneControl").css("display","inline");var r=new a.VariantFetcher(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,[0,t]),o=(0,i.queue)();o.defer(function(e){r.getSmallVariantDataForVariantPlotsFromGeneId(t,1,0,n.selectedSubcohortIndex,e)}),o.awaitAll(function(){n.smallVarVizFocused.init(n.commonSettings,n.references,n.cohortMetadata,n.selectionManager,n.fontManager,n.selectedSubcohortIndex,r.variantsForVariantPlots.get(0).get("smallVariantData"),"smallVariant"),n.plotFocusedSmallVariant()})})})}},{key:"tracerCleanup",value:function(){this.svViz.tracerCleanup(),this.vdjSvViz.tracerCleanup(),this.midSizedSvViz.tracerCleanup(),this.svVizFocused.tracerCleanup(),this.vdjSvVizFocused.tracerCleanup(),this.midSizedSvVizFocused.tracerCleanup(),this.smallVarVizFocused.tracerCleanup()}},{key:"textExport",value:function(e){if("sv"===e){var t,n,r,o=[s.VariantEntrySv.generalHeaderExport()];t=this.svVizFocused.constructed?this.svVizFocused.textExport():this.svViz.textExport(),n=this.vdjSvVizFocused.constructed?this.vdjSvVizFocused.textExport():this.vdjSvViz.textExport(),r=this.midSizedSvVizFocused.constructed?this.midSizedSvVizFocused.textExport():this.midSizedSvViz.textExport();for(var i=0;i<t.length;++i)o.push(t[i]);for(var a=0;a<n.length;++a)o.push(n[a]);for(var c=0;c<r.length;++c)o.push(r[c]);return o}if("smallVar"===e){var A=[l.VariantEntrySnv.generalHeaderExport()],u=null;this.smallVarVizFocused.constructed&&(u=this.smallVarVizFocused.textExport());for(var h=0;h<u.length;++h)A.push(u[h]);return A}}},{key:"adjustVdjMarkerFont",value:function(){var e=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("cytobandAndGeneLabels").generateFontCssText();this.vdjSvVizFocused.constructed&&this.vdjSvVizFocused.labelGroup.selectAll("*").style("font",e),this.vdjSvViz.constructed&&this.vdjSvViz.labelGroup.selectAll("*").style("font",e)}}]),t}()}).call(this,n(0))},function(e,t,n){!function(e){"use strict";function t(e){return e}function n(e,t){return"translate("+e+","+t+")"}function r(){return!this.__axis}function o(e,o,i){var a=[],s=null,l=null,c=6,A=6,u=12;function h(e){return n.apply(n,d(e))}function d(e,t){return t=void 0===t?o:t,[Math.sin(e)*t,-Math.cos(e)*t]}function f(n){var f=null==s?e.ticks?e.ticks.apply(e,a):e.domain():s,p=null==l?e.tickFormat?e.tickFormat.apply(e,a):t:l,g=Math.max(c,0)+u,m=e.range(),v=(e.bandwidth?function(e){var t=e.bandwidth()/2;return e.round()&&(t=Math.round(t)),function(n){return e(n)+t}}:t)(e.copy()),y=n.selection?n.selection():n,b=y.selectAll(".domain").data([null]),I=y.selectAll(".tick").data(f,e).order(),x=I.exit(),w=I.enter().append("g").attr("class","tick"),C=I.select("line"),E=I.select("text");b=b.merge(b.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),I=I.merge(w),C=C.merge(w.append("line").attr("stroke","#000")),E=E.merge(w.append("text").attr("fill","#000").attr("dy",".35em").attr("text-anchor","middle")),n!==y&&(b=b.transition(n),I=I.transition(n),C=C.transition(n),E=E.transition(n),x=x.transition(n).attr("opacity",0).attr("transform",function(e){return isFinite(e=v(e))?h(e):this.getAttribute("transform")}),w.attr("opacity",0).attr("transform",function(e){var t=this.parentNode.__axis;return h(t&&isFinite(t=t(e))?t:v(e))})),x.remove(),b.attr("d","M"+d(m[0],o+A*(i?1:-1)).join(",")+"L"+d(m[0]).join(",")+(Math.abs(m[1]-m[0])>=2*Math.PI?"A"+[o,o,0,1,1].concat(d(m[0]+Math.PI)).join(",")+"A"+[o,o,0,1,1].concat(d(m[0])).join(","):"")+"A"+[o,o,0,Math.abs(m[1]-m[0])%(2*Math.PI)>Math.PI?1:0,m[1]>m[0]?1:0].concat(d(m[1])).join(",")+"L"+d(m[1],o+A*(i?1:-1)).join(",")),I.attr("opacity",1).attr("transform",function(e){return h(v(e))}),C.attr("x1",0).attr("y1",0).attr("x2",function(e){return d(v(e),c)[0]*(i?1:-1)}).attr("y2",function(e){return d(v(e),c)[1]*(i?1:-1)}),E.attr("x",function(e){return d(v(e),g)[0]*(i?1:-1)}).attr("y",function(e){return d(v(e),g)[1]*(i?1:-1)}).text(p),y.filter(r).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif"),y.each(function(){this.__axis=v})}return f.scale=function(t){return arguments.length?(e=t,f):e},f.ticks=function(){return a=Array.prototype.slice.call(arguments),f},f.tickArguments=function(e){return arguments.length?(a=null==e?[]:Array.prototype.slice.call(e),f):a.slice()},f.tickValues=function(e){return arguments.length?(s=null==e?null:Array.prototype.slice.call(e),f):s&&s.slice()},f.tickFormat=function(e){return arguments.length?(l=e,f):l},f.tickSize=function(e){return arguments.length?(c=A=+e,f):c},f.tickSizeInner=function(e){return arguments.length?(c=+e,f):c},f.tickSizeOuter=function(e){return arguments.length?(A=+e,f):A},f.tickPadding=function(e){return arguments.length?(u=+e,f):u},f}e.axisRadialInner=function(e,t){return o(e,t,!1)},e.axisRadialOuter=function(e,t){return o(e,t,!0)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.HorizontalAxis=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(12),a=n(330),s=n(8),l=n(1);t.HorizontalAxis=function(){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.fontManager=r}return o(t,[{key:"generate",value:function(){for(var t=this,n=this.commonSettings.mainSvg,o=[".radialAxis1",".radialAxis2",".radialAxis3",".radialAxis4",".chrLabel",".chrArmLabel"],c=0;c<o.length;++c)n.selectAll(o[c]).remove();var A=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("chromosomeLabels"),u=A.generateFontCssText(),h=A.fontSize,d=(0,i.format)(".2s"),f=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("horizontalAxisLabels").generateFontCssText();this.references.chromosomes.forEach(function(e){var o=0<e.chromosomeIndex&&e.chromosomeIndex<24,i=0<e.chromosomeIndex&&e.chromosomeIndex<28,c=(0,l.getAngles)(e,t.references),A=r(c,2),p=A[0],g=A[1],m=(0,s.scaleLinear)().domain([e.startPos,e.endPos]).range([p,g]);if(o&&e.coefficient>=.25){var v=(0,a.axisRadialOuter)(m,t.commonSettings.chromosomeAxisRadius).tickFormat(d).tickValues((0,l.range)(1,e.endPos,2e7)).tickSize(4),y=(0,a.axisRadialOuter)(m,t.commonSettings.chromosomeAxisRadius).tickFormat(d).tickValues([e.endPos]).tickSize(4);n.append("g").attr("class","radialAxis1").call(v.tickFormat("")),n.append("g").attr("class","radialAxis2").call(y).style("font",f)}var b=(0,a.axisRadialOuter)(m,t.commonSettings.chromosomeAxisRadius).tickFormat(d).tickValues([.5*(e.startPos+e.endPos)]).tickSize(0),I=Number.MIN_VALUE,x=Number.MAX_VALUE;e.daughterCoefficients.forEach(function(e,t,n){e>I&&(I=e),e<x&&(x=e)});var w=i&&e.coefficient>=.25&&I<4&&I/x<4;n.append("g").attr("class","radialAxis3").call(b).style("font",u).style("font-size",w?h+"px":"0px")}),n.selectAll(".radialAxis3").data(this.references.chromosomes).each(function(t){0<t.chromosomeIndex&&t.chromosomeIndex<28?e(e(e(this).children()[1]).children()[1]).attr("class","chrLabel").html(t.chromosomeName.replace("s37d5","").replace("MT","M").replace("NC_007605","EBV")):e(this).css("display","none")}),this.references.chromosomeArms.forEach(function(e){var o=(0,l.getAngles)(e,t.references),i=r(o,2),c=i[0],A=i[1],f=(0,s.scaleLinear)().domain([e.startPos,e.endPos]).range([c,A]),p=(0,a.axisRadialOuter)(f,t.commonSettings.chromosomeAxisRadius).tickFormat(d).tickValues([.5*(e.startPos+e.endPos)]).tickSize(0),g=Number.MIN_VALUE,m=Number.MAX_VALUE;t.references.chromosomes[e.chromosomeIndex].daughterCoefficients.forEach(function(e,t,n){e>g&&(g=e),e<m&&(m=e)});var v=g>=4||g/m>=4;n.append("g").attr("class","radialAxis4").call(p).style("font",u).style("font-size",v?h+"px":"0px")}),n.selectAll(".radialAxis4").data(this.references.chromosomeArms).each(function(t){0<t.chromosomeIndex&&t.chromosomeIndex<25?e(e(e(this).children()[1]).children()[1]).attr("class","chrArmLabel").html(t.chromosomeArmName):e(this).css("display","none")}),this.commonSettings.markedGenes.size>0&&(n.selectAll(".radialAxis1").style("display","none"),n.selectAll(".radialAxis2").style("display","none"))}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WheelCytoband=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(1);t.WheelCytoband=function(){function t(e,n,r,o,i,a,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.fontManager=s,this.wheelWidth=o,this.defaultInnerRadius=r,this.cytobandWidth=0,this.fragileSiteOuterRadius=0,this.fragileSiteInnerRadius=0,this.geneInnerRadius=0,this.geneOuterRadius=0,this.svg=this.commonSettings.mainSvg,this.data=i,this.elementGroup=this.svg.append("g"),this.elementGroupAux=this.svg.append("g"),this.elementGroupMarkerHelpersGenes=this.svg.append("g"),this.elementGroupMarkerHelpersCytobands=this.svg.append("g"),this.elementGroupMarkersGenes=this.svg.append("g"),this.elementGroupMarkersCytobands=this.svg.append("g"),this.elementClassPrefix=a,this.elementIndexPrefix=a+"_Index"}return o(t,[{key:"enableControls",value:function(){var e=this;this.elementGroup.on("click",function(){if(!e.commonSettings.interactionLock){e.commonSettings.fastLock();try{e.references.emitCytobandClick((0,i.select)(i.event.target).datum().getIndex())}catch(t){return console.error(t),void e.commonSettings.fastRelease()}e.commonSettings.fastRelease()}}),this.elementGroup.on("contextmenu",function(){if(i.event.preventDefault(),!e.commonSettings.interactionLock){e.commonSettings.fastLock();var t=(0,i.select)(i.event.target).datum().cytobandIndex;e.addCytobandLabel(t),e.commonSettings.fastRelease()}}),this.elementGroupMarkersGenes.on("click",function(){e.commonSettings.interactionLock||(e.commonSettings.fastLock(),e.references.genes.get(parseInt((0,i.select)(i.event.target).attr("geneInd"))).launchDefaultDb(),e.commonSettings.fastRelease())}),this.elementGroupMarkersCytobands.on("click",function(){e.commonSettings.interactionLock||(e.commonSettings.fastLock(),e.references.cytobands[parseInt((0,i.select)(i.event.target).attr("cytInd"))].launchDefaultDb(),e.commonSettings.fastRelease())}),this.elementGroupMarkersGenes.on("contextmenu",function(){i.event.preventDefault(),e.commonSettings.interactionLock||(e.commonSettings.lock(),e.removeGeneLabel(parseInt((0,i.select)(i.event.target).attr("geneInd"))),e.commonSettings.releaseLock())}),this.elementGroupMarkersCytobands.on("contextmenu",function(){i.event.preventDefault(),e.commonSettings.interactionLock||(e.commonSettings.fastLock(),e.removeCytobandLabel(parseInt((0,i.select)(i.event.target).attr("cytInd"))),e.commonSettings.fastRelease())})}},{key:"setNormalRadii",value:function(){this.cytobandWidth=this.wheelWidth,this.cytobandInnerRadius=this.defaultInnerRadius,this.cytobandOuterRadius=this.cytobandInnerRadius+this.wheelWidth-this.commonSettings.wheelGap,this.fragileSiteOuterRadius=this.cytobandInnerRadius-.25*this.commonSettings.wheelGap,this.fragileSiteInnerRadius=this.fragileSiteOuterRadius-.5*this.commonSettings.wheelGap,this.geneInnerRadius=this.cytobandOuterRadius+.25*this.commonSettings.wheelGap,this.geneOuterRadius=this.geneInnerRadius+.5*this.commonSettings.wheelGap}},{key:"setHyperzoomRadii",value:function(){this.cytobandWidth=.5*this.wheelWidth,this.cytobandInnerRadius=this.defaultInnerRadius-this.commonSettings.wheelGap,this.cytobandOuterRadius=this.cytobandInnerRadius+this.cytobandWidth,this.fragileSiteOuterRadius=0,this.fragileSiteInnerRadius=0,this.geneInnerRadius=this.cytobandOuterRadius+.25*this.cytobandWidth,this.geneOuterRadius=this.geneInnerRadius+.5*this.cytobandWidth}},{key:"cleanup",value:function(){var e=this;["chr"+this.elementClassPrefix,"gene"+this.elementClassPrefix,"fra"+this.elementClassPrefix,this.elementClassPrefix].forEach(function(t){e.svg.selectAll("."+t).remove()})}},{key:"auxCleanup",value:function(){var e=this;["chr"+this.elementClassPrefix,"gene"+this.elementClassPrefix,"fra"+this.elementClassPrefix].forEach(function(t){e.svg.selectAll("."+t).remove()})}},{key:"plot",value:function(){var e=this;this.cleanup(),this.elementGroup.selectAll("."+this.elementClassPrefix).data(this.data).enter().append("path").attr("class",function(t){return"cytBlck"+e.references.cytobands[t.cytobandIndex].colourIndex}).classed(this.elementClassPrefix,!0).attr("id",function(t){return e.elementIndexPrefix+"_"+t.cytobandIndex}).append("svg:title").text(function(e){return e.cytobandName}),this.updatePaths()}},{key:"updatePaths",value:function(){var e=this;this.auxCleanup(),this.assessHyperzoom(),this.commonSettings.isAnyMarked()?(this.realignSvgAddMarkers(),setTimeout(function(){e.plotGeneLabels()},0),setTimeout(function(){e.plotCytobandLabels()},0)):this.realignSvgRemoveMarkers(),this.commonSettings.hyperzoomMode<2?setTimeout(function(){e.addFragileSites()},0):setTimeout(function(){e.addSelectedGenes()},0),setTimeout(function(){e.addChromosomeFrames()},0);var t=this;setTimeout(function(){e.elementGroup.selectAll("."+e.elementClassPrefix).attr("d",function(){var e=(0,i.select)(this).datum();return(0,i.arc)().innerRadius(t.cytobandInnerRadius).outerRadius(t.cytobandOuterRadius).startAngle(t.references.genomicTheta(e.chromosomeIndex,e.startPos)).endAngle(t.references.genomicTheta(e.chromosomeIndex,e.endPos))()})},0)}},{key:"assessHyperzoom",value:function(){var e=this;this.commonSettings.hyperzoomDisplayedGenes.clear(),this.commonSettings.hyperzoomMarkedGenes.clear(),this.commonSettings.hyperzoomMarkedCytobands.clear(),this.commonSettings.hyperzoomMode=0,this.references.cytobands.forEach(function(t){if(t.chromosomeIndex<24){t.coefficient>=256&&(t.coefficient>=512?e.commonSettings.hyperzoomMode=3:0===e.commonSettings.hyperzoomMode&&(e.commonSettings.hyperzoomMode=2),t.getGeneIndices(e.references).forEach(function(t){if(e.references.genes.get(t).cancerGene)e.commonSettings.hyperzoomDisplayedGenes.add(t);else{var n=e.references.geneTypes[e.references.genes.get(t).geneTypeIndex].geneSupertype;"Coding"!==n&&"IgtrGene"!==n||e.commonSettings.hyperzoomDisplayedGenes.add(t)}}));var n=(0,a.getAngles)(t,e.references),o=r(n,2),i=o[0],s=o[1];t.coefficient/t.coefficientInit>=6&&s-i>.02&&(e.commonSettings.hyperzoomMarkedCytobands.add(t.cytobandIndex),0===e.commonSettings.hyperzoomMode&&(e.commonSettings.hyperzoomMode=1))}}),this.commonSettings.hyperzoomMode>0?(this.setHyperzoomRadii(),this.commonSettings.hyperzoomMode>=2&&this.commonSettings.hyperzoomDisplayedGenes.forEach(function(t){e.commonSettings.hyperzoomMarkedGenes.add(t)})):(this.commonSettings.hyperzoomDisplayedGenes.clear(),this.commonSettings.hyperzoomMarkedGenes.clear(),this.commonSettings.hyperzoomMarkedCytobands.clear(),this.setNormalRadii())}},{key:"addFragileSites",value:function(){var e=this;this.elementGroupAux.selectAll(".fra"+this.elementClassPrefix).data(this.references.fragileSites).enter().append("path").attr("class","fra"+this.elementClassPrefix).attr(this.elementIndexPrefix,function(e){return"fra"+e.fragileSiteIndex}).style("fill","Purple").style("stroke","None").attr("d",function(t){return(0,i.arc)().innerRadius(t.fragileSiteInnerRadius).outerRadius(t.fragileSiteOuterRadius).startAngle(e.references.genomicTheta(t.chromosomeIndex,t.startPos)).endAngle(e.references.genomicTheta(t.chromosomeIndex,t.endPos))()})}},{key:"addSelectedGenes",value:function(){var e=this,t=[];this.commonSettings.hyperzoomDisplayedGenes.forEach(function(e){t.push(e)});var n=this;this.elementGroupAux.selectAll(".gene"+this.elementClassPrefix).data(t).enter().append("path").classed("gene"+this.elementClassPrefix,!0).attr(this.elementIndexPrefix,function(e){return"gene"+e}).style("fill","Green").style("stroke","Black").attr("d",function(){var e=n.references.genes.get((0,i.select)(this).datum());return(0,i.arc)().innerRadius(n.geneInnerRadius).outerRadius(n.geneOuterRadius).startAngle(n.references.genomicTheta(e.chromosomeIndex,e.startPos)).endAngle(n.references.genomicTheta(e.chromosomeIndex,e.endPos))()}).append("svg:title").text(function(t){return e.references.genes.get(t).geneName})}},{key:"plotGeneLabels",value:function(){var t=this;this.elementGroupMarkerHelpersGenes.selectAll(".geneMarkerHelper").remove(),this.elementGroupMarkersGenes.selectAll(".geneMarker").remove(),this.commonSettings.markedGenes.size>0||this.commonSettings.hyperzoomMarkedGenes.size>0||this.commonSettings.volcanoMarkedGenes.size>0?e("#geneSelectorControlsForMarkedGenes").css("display","inline"):e("#geneSelectorControlsForMarkedGenes").css("display","none"),this.commonSettings.markedGenes.forEach(function(e){t.plotSingleGeneLabel(e)}),this.commonSettings.hyperzoomMarkedGenes.forEach(function(e){t.plotSingleGeneLabel(e)})}},{key:"plotSingleGeneLabel",value:function(t){var n=this,o=e("#geneMarker_"+t);if(o.length)return o.remove(),e("#geneMarkerHelper_"+t+"_dragbridge").remove(),e("#geneMarkerHelper_"+t).remove(),this.commonSettings.markedGenes.delete(t),0===this.commonSettings.markedGenes.size&&e("#geneSelectorControlsForMarkedGenes").css("display","none"),!1;var s=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("cytobandAndGeneLabels").generateFontCssText(),l=this.references.genomicTheta(1,1),c=this.references.genes.get(t).getMidAngle(this.references),A=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5,l),u=r(A,2),h=u[0],d=u[1],f=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5+100,l),p=r(f,2),g=p[0],m=p[1],v=Math.sqrt(Math.pow(g-h,2)+Math.pow(m-d,2)),y=(0,a.polarToCartesian)(0,c),b=r(y,2),I=b[0],x=b[1],w=c/Math.PI%2>1;this.elementGroupMarkerHelpersGenes.append("path").attr("class","geneMarkerHelper").attr("id","geneMarkerHelper_"+t+"pre").attr("d",function(){var e=(0,i.path)();return w?(e.moveTo(g,m),e.lineTo(h,d)):(e.moveTo(h,d),e.lineTo(g,m)),e}).style("display","none"),this.elementGroupMarkersGenes.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("id","geneMarker_"+t+"pre").append("textPath").attr("class","geneMarkerText").attr("class","geneMarker").attr("geneInd",t).attr("xlink:href","#geneMarkerHelper_"+t+"pre").style("display","inline").style("font",s).text(this.references.genes.get(t).geneName);var C=document.getElementById("geneMarker_"+t+"pre").getBBox(),E=Math.sqrt(Math.pow(C.width,2)+Math.pow(C.height,2))/v;e("#geneMarkerHelper_"+t+"pre").remove(),e("#geneMarker_"+t+"pre").remove();var S=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5,c),M=r(S,2),k=M[0],B=M[1],D=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5+100*E,c),P=r(D,2),Q=P[0],T=P[1];this.elementGroupMarkerHelpersGenes.append("path").attr("class","geneMarkerHelper").attr("id","geneMarkerHelper_"+t).attr("d",function(){var e=(0,i.path)();return w?(e.moveTo(Q,T),e.lineTo(k,B)):(e.moveTo(k,B),e.lineTo(Q,T)),e}).style("display","none"),this.elementGroupMarkersGenes.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").append("textPath").attr("class","geneMarkerText").attr("class","geneMarker").attr("id","geneMarker_"+t).attr("geneInd",t).attr("xlink:href","#geneMarkerHelper_"+t).style("display","inline").style("font",s).text(this.references.genes.get(t).geneName).call((0,i.drag)().on("start",function(){e("#geneMarkerHelper_"+t+"_dragbridge").remove()}).on("drag",function(){var n=i.event.x,o=i.event.y,s=(0,a.cartesianToPolar)(I,x,n,o),l=r(s,2),c=l[0],A=l[1],u=(0,a.polarToCartesian)(c-5+100*E,A),h=r(u,2),d=h[0],f=h[1],p=(0,i.path)();A/Math.PI%2>1?(p.moveTo(d,f),p.lineTo(n,o)):(p.moveTo(n,o),p.lineTo(d,f)),(0,i.select)("#geneMarkerHelper_"+t).attr("d",p);var g=e("#geneMarkerHelper_"+t);g.hide(),setTimeout(function(){g.show()},10)}).on("end",function(){var e=(0,a.polarToCartesian)(n.commonSettings.chromosomeAxisRadius,c),o=r(e,2),s=o[0],l=o[1],A=i.event.x,u=i.event.y,h=(0,i.path)();h.moveTo(s,l),h.lineTo(A,u),h.closePath(),n.elementGroupMarkerHelpersGenes.append("path").attr("class","geneMarkerHelper").attr("id","geneMarkerHelper_"+t+"_dragbridge").attr("d",h).style("stroke","Black").style("display","inline")}))}},{key:"addGeneLabel",value:function(e){this.commonSettings.isAnyMarked()||this.realignSvgAddMarkers(),this.commonSettings.markedGenes.add(e),this.plotSingleGeneLabel(e)}},{key:"clearMarkedGenes",value:function(){var e=this,t=[];this.commonSettings.markedGenes.forEach(function(e){t.push(e)}),this.commonSettings.hyperzoomMarkedGenes.forEach(function(e){t.push(e)}),t.forEach(function(t){e.removeGeneLabel(t)})}},{key:"removeGeneLabel",value:function(t){this.commonSettings.markedGenes.has(t)&&this.commonSettings.markedGenes.delete(t),this.commonSettings.hyperzoomMarkedGenes.has(t)&&this.commonSettings.hyperzoomMarkedGenes.delete(t),this.commonSettings.isAnyMarked()||this.realignSvgRemoveMarkers(),0===this.commonSettings.markedGenes.size&&0===this.commonSettings.hyperzoomMarkedGenes.size&&e("#geneSelectorControlsForMarkedGenes").css("display","none"),e("#geneMarker_"+t).remove(),e("#geneMarkerHelper_"+t).remove(),e("#geneMarkerHelper_"+t+"_dragbridge").remove()}},{key:"removeCytobandLabel",value:function(t){this.commonSettings.markedCytobands.has(t)&&this.commonSettings.markedCytobands.delete(t),this.commonSettings.hyperzoomMarkedCytobands.has(t)&&this.commonSettings.hyperzoomMarkedCytobands.delete(t),this.commonSettings.isAnyMarked()||this.realignSvgRemoveMarkers(),0===this.commonSettings.markedCytobands.size&&e("#clearMarkedCytobands").css("display","none"),e("#cytobandMarker_"+t).remove(),e("#cytobandMarkerHelper_"+t).remove(),e("#cytobandMarkerHelper_"+t+"_dragbridge").remove()}},{key:"removeAllGeneLabels",value:function(){this.commonSettings.markedGenes.clear(),this.commonSettings.hyperzoomMarkedGenes.clear(),this.elementGroupMarkerHelpersGenes.selectAll(".geneMarkerHelper").remove(),this.elementGroupMarkersGenes.selectAll(".geneMarker").remove(),this.commonSettings.isAnyMarked()||this.realignSvgRemoveMarkers(),e("#geneSelectorControlsForMarkedGenes").css("display","none")}},{key:"removeAllCytobandLabels",value:function(){this.commonSettings.markedCytobands.clear(),this.commonSettings.hyperzoomMarkedCytobands.clear(),this.elementGroupMarkerHelpersCytobands.selectAll(".cytobandMarkerHelper").remove(),this.elementGroupMarkersCytobands.selectAll(".cytobandMarker").remove(),this.commonSettings.isAnyMarked()||this.realignSvgRemoveMarkers(),e("#clearMarkedCytobands").css("display","none")}},{key:"addCytobandLabel",value:function(e){this.commonSettings.isAnyMarked()||this.realignSvgAddMarkers(),this.commonSettings.markedCytobands.add(e),this.plotSingleCytobandLabel(e)}},{key:"plotSingleCytobandLabel",value:function(t){var n=this,o=e("#cytobandMarker_"+t);if(o.length)return o.remove(),e("#cytobandMarkerHelper_"+t+"_dragbridge").remove(),e("#cytobandMarkerHelper_"+t).remove(),this.commonSettings.markedCytobands.delete(t),!1;var s=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("cytobandAndGeneLabels").generateFontCssText(),l=this.references.genomicTheta(1,1),c=this.references.cytobands[t].getMidAngle(this.references),A=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5,l),u=r(A,2),h=u[0],d=u[1],f=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5+100,l),p=r(f,2),g=p[0],m=p[1],v=Math.sqrt(Math.pow(g-h,2)+Math.pow(m-d,2)),y=(0,a.polarToCartesian)(0,c),b=r(y,2),I=b[0],x=b[1],w=c/Math.PI%2>1;this.elementGroupMarkerHelpersCytobands.append("path").attr("class","cytobandMarkerHelper").attr("id","cytobandMarkerHelper_"+t+"pre").attr("d",function(){var e=(0,i.path)();return w?(e.moveTo(g,m),e.lineTo(h,d)):(e.moveTo(h,d),e.lineTo(g,m)),e}).style("display","none"),this.elementGroupMarkersCytobands.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("id","cytobandMarker_"+t+"pre").append("textPath").attr("cytInd",t).attr("class","cytobandMarkerText").attr("class","cytobandMarker").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("xlink:href","#cytobandMarkerHelper_"+t+"pre").style("display","inline").style("font",s).text(this.references.cytobands[t].cytobandName);var C=document.getElementById("cytobandMarker_"+t+"pre").getBBox(),E=Math.sqrt(Math.pow(C.width,2)+Math.pow(C.height,2))/v;e("#cytobandMarker_"+t+"pre").remove(),e("#cytobandMarkerHelper_"+t+"pre").remove();var S=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5,c),M=r(S,2),k=M[0],B=M[1],D=(0,a.polarToCartesian)(this.commonSettings.chromosomeAxisRadius+5+100*E,c),P=r(D,2),Q=P[0],T=P[1];this.elementGroupMarkerHelpersCytobands.append("path").attr("class","cytobandMarkerHelper").attr("id","cytobandMarkerHelper_"+t).attr("d",function(){var e=(0,i.path)();return w?(e.moveTo(Q,T),e.lineTo(k,B)):(e.moveTo(k,B),e.lineTo(Q,T)),e}).style("display","none"),this.elementGroupMarkersCytobands.append("text").style("dominant-baseline","middle").style("alignment-baseline","middle").append("textPath").attr("id","cytobandMarker_"+t).attr("cytInd",t).attr("class","cytobandMarkerText").attr("class","cytobandMarker").style("dominant-baseline","middle").style("alignment-baseline","middle").attr("xlink:href","#cytobandMarkerHelper_"+t).style("display","inline").style("font",s).text(this.references.cytobands[t].cytobandName).call((0,i.drag)().on("start",function(){e("#cytobandMarkerHelper_"+t+"_dragbridge").remove()}).on("drag",function(){var n=i.event.x,o=i.event.y,s=(0,a.cartesianToPolar)(I,x,n,o),l=r(s,2),c=l[0],A=l[1],u=(0,a.polarToCartesian)(c-5+100*E,A),h=r(u,2),d=h[0],f=h[1],p=A/Math.PI%2>1,g=(0,i.path)();p?(g.moveTo(d,f),g.lineTo(n,o)):(g.moveTo(n,o),g.lineTo(d,f)),(0,i.select)("#cytobandMarkerHelper_"+t).attr("d",g);var m=e("#cytobandMarkerHelper_"+t);m.hide(),setTimeout(function(){m.show()},10)}).on("end",function(){var e=(0,a.polarToCartesian)(n.commonSettings.chromosomeAxisRadius,c),o=r(e,2),s=o[0],l=o[1],A=i.event.x,u=i.event.y,h=(0,i.path)();h.moveTo(s,l),h.lineTo(A,u),h.closePath(),n.elementGroupMarkerHelpersCytobands.append("path").attr("class","cytobandMarkerHelper").attr("id","cytobandMarkerHelper_"+t+"_dragbridge").attr("d",h).style("stroke","Black").style("display","inline")}))}},{key:"plotCytobandLabels",value:function(){var t=this;this.elementGroupMarkerHelpersCytobands.selectAll(".cytobandMarkerHelper").remove(),this.elementGroupMarkersCytobands.selectAll(".cytobandMarker").remove(),this.commonSettings.markedCytobands.size>0||this.commonSettings.hyperzoomMarkedCytobands.size>0?(e("#clearMarkedCytobands").css("display","inline"),this.commonSettings.markedCytobands.forEach(function(e){t.plotSingleCytobandLabel(e)}),this.commonSettings.hyperzoomMarkedCytobands.forEach(function(e){t.plotSingleCytobandLabel(e)})):e("#clearMarkedCytobands").css("display","none")}},{key:"realignSvgAddMarkers",value:function(){var t=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("title").generateFontCssText(.8);this.svg.selectAll(".radialAxis1").style("display","none"),this.svg.selectAll(".radialAxis2").style("display","none"),this.svg.attr("viewBox","-500 -500 1000 1000"),e("#cohortNameSvg").css("font",t),e("#cohortNameSvgLine2").css("font",t)}},{key:"realignSvgRemoveMarkers",value:function(){var t=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("title").generateFontCssText(.8);this.elementGroupMarkerHelpersGenes.selectAll(".geneMarkerHelper").remove(),this.elementGroupMarkersGenes.selectAll(".geneMarker").remove(),this.elementGroupMarkerHelpersCytobands.selectAll(".cytobandMarkerHelper").remove(),this.elementGroupMarkersCytobands.selectAll(".cytobandMarker").remove(),this.svg.selectAll(".radialAxis1").style("display","inline"),this.svg.selectAll(".radialAxis2").style("display","inline"),this.svg.attr("viewBox","-500 -460 1000 1000"),e("#cohortNameSvg").css("font",t),e("#cohortNameSvgLine2").css("font",t)}},{key:"addChromosomeFrames",value:function(){var e=this;this.elementGroupAux.selectAll(".chr"+this.elementClassPrefix).data(this.references.chromosomes).enter().append("path").attr("class","chr"+this.elementClassPrefix).attr(this.elementIndexPrefix,function(e){return"chr"+e.chromosomeIndex}).style("fill","None").style("stroke",function(e){return e.chromosomeIndex>0&&e.chromosomeIndex<28?"Black":"None"}).attr("d",function(){var t=(0,i.select)(this).datum();return(0,i.arc)().innerRadius(e.cytobandInnerRadius).outerRadius(e.cytobandOuterRadius).startAngle(e.references.genomicTheta(t.chromosomeIndex,t.startPos)).endAngle(e.references.genomicTheta(t.chromosomeIndex,t.endPos))()})}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WheelRecurrence=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(8),i=n(1);function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.WheelRecurrence=function(){function e(t,n,r,o,i,a,s,l,c,A,u,h,d,f,p,g,m){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.commonSettings=t,this.references=n,this.selectionManager=r,this.selectedSubcohortIndex=o,this.selectedDiffSubcohortIndex=i,this.fontManager=m,this.selectedDonors=this.selectionManager.registeredSubcohorts.get(this.selectedSubcohortIndex),this.diffDonors=new Set,-1!==this.selectedDiffSubcohortIndex&&(this.diffDonors=this.selectionManager.registeredSubcohorts.get(this.selectedDiffSubcohortIndex)),this.innerRadius=a,this.wheelWidth=s,this.halfMode=u,h||(this.wheelWidth-=this.commonSettings.wheelGap),this.outerRadius=this.innerRadius+this.wheelWidth,this.svg=t.mainSvg,this.data=l,this.dataFields=c,this.dataMode=A,this.elementGroup=this.svg.append("g"),this.inverseMode=h,this.elementClassPrefix=d,this.svg.selectAll(this.elementClassPrefix).remove(),this.elementClassPrefixVerticalAxis1=this.elementClassPrefix+"_va1",this.elementClassPrefixVerticalAxis2=this.elementClassPrefix+"_va2",this.elementIndexPrefix=this.elementClassPrefix+"_Index",this.maxRecurrence=f,this.forcedMaxRecurrence=Math.max(2,this.maxRecurrence),this.allowedMutationTypes=g,this.singlePatientMode=1===this.selectedDonors.size}return r(e,[{key:"enableControls",value:function(){var e=this;this.elementGroup.on("click",function(){if(!e.commonSettings.interactionLock){e.commonSettings.fastLock();try{var t=(0,o.select)(o.event.target).datum().getIndex();"gene"!==e.dataMode?e.references.emitTadClick(t,e.dataFields):e.references.emitGeneClick(t,e.allowedMutationTypes)}catch(t){return console.error(t),void e.commonSettings.fastRelease()}e.commonSettings.fastRelease()}}),this.elementGroup.on("contextmenu",function(){if(o.event.preventDefault(),!e.commonSettings.interactionLock){if(e.commonSettings.lock(),"gene"===e.dataMode){var t=(0,o.select)(o.event.target).datum().getIndex();e.references.emitGeneLabel(t)}e.commonSettings.releaseLock()}})}},{key:"cleanup",value:function(){var e=this;[this.elementClassPrefix,"chr"+this.elementClassPrefix,this.elementClassPrefixVerticalAxis1,this.elementClassPrefixVerticalAxis2].forEach(function(t){e.svg.selectAll("."+t).remove()})}},{key:"plot",value:function(){this.cleanup();var e=this,t="ind"===this.dataMode||"cnv"===this.dataMode||"cnvloh"===this.dataMode||"cnnloh"===this.dataMode?function(e){return e.chromosomeIndex<24}:function(e){return!0},n="gene"===this.dataMode?function(e){return e.geneName}:function(t){var n=[];return t.cytobandIndices.forEach(function(t){n.push(e.references.cytobands[t].cytobandName)}),n.join(",")};this.elementGroup.selectAll("."+this.elementClassPrefix).data(this.data).enter().append("path").filter(t).attr("class",this.elementClassPrefix).attr(this.elementIndexPrefix,function(e){return e.getIndex()}).style("stroke-width",.1).append("svg:title").text(n),this.updatePaths()}},{key:"updateForcedMaxRecurrence",value:function(e){this.forcedMaxRecurrence=e,this.updatePaths()}},{key:"resetForcedMaxRecurrence",value:function(){this.updateForcedMaxRecurrence(this.maxRecurrence)}},{key:"updatePaths",value:function(){var e=this,t=this;this.addChromosomeFrames(),this.addVerticalAxis(),this.inverseMode?setTimeout(function(){var n=(0,o.scaleLinear)().domain([0,1]).range((0,i.discreteColour)(2).reverse()),r=new Map;e.elementGroup.selectAll("."+e.elementClassPrefix).attr("d",function(){var e=(0,o.select)(this).datum(),n=t.getAngles(e),i=t.calculateRecurrence(e)/t.forcedMaxRecurrence;r.set(e.getIndex(),i);var a=t.outerRadius-Math.min(1,i)*t.wheelWidth;return(0,o.arc)().innerRadius(a).outerRadius(t.outerRadius).startAngle(n[0]).endAngle(n[1])()}).attr("stroke",function(){var e=(0,o.select)(this).datum();return n(r.get(e.getIndex()))}).attr("fill",function(){var e=(0,o.select)(this).datum();return n(r.get(e.getIndex()))})},0):setTimeout(function(){var n=(0,o.scaleLinear)().domain([0,1]).range((0,i.discreteColour)(2)),r=new Map;e.elementGroup.selectAll("."+e.elementClassPrefix).attr("d",function(){var e=(0,o.select)(this).datum(),n=t.getAngles(e),i=t.calculateRecurrence(e)/t.forcedMaxRecurrence;r.set(e.getIndex(),i);var a=t.innerRadius+Math.min(1,i)*t.wheelWidth;return(0,o.arc)().innerRadius(t.innerRadius).outerRadius(a).startAngle(n[0]).endAngle(n[1])()}).attr("stroke",function(){var e=(0,o.select)(this).datum();return"gene"===t.dataMode&&1===t.selectedDonors.size?e.cancerGene?"red":"blue":n(r.get(e.getIndex()))}).attr("fill",function(){var e=(0,o.select)(this).datum();return"gene"===t.dataMode&&1===t.selectedDonors.size?e.cancerGene?"red":"blue":n(r.get(e.getIndex()))})},0)}},{key:"addVerticalAxis",value:function(){var e=this;[this.elementClassPrefixVerticalAxis1,this.elementClassPrefixVerticalAxis2].forEach(function(t){e.svg.selectAll("."+t).remove()});for(var t=new Set,n=1;n<29;++n)t.add(n);var r=this.inverseMode?this.outerRadius:this.innerRadius,a=this.inverseMode?this.innerRadius:this.outerRadius,s=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("verticalAxisLabels").generateFontCssText();this.references.chromosomes.forEach(function(n){if(t.has(n.chromosomeIndex)){var l=e.references.genomicTheta(n.chromosomeIndex,n.startPos),c=(0,o.scaleLinear)().domain([0,e.forcedMaxRecurrence]).range([r,a]),A=[];A=e.halfMode?[Math.max(1,Math.round(.33*e.forcedMaxRecurrence)),Math.max(3,e.forcedMaxRecurrence)]:(0,i.range)(0,Math.max(3,e.forcedMaxRecurrence)+1,Math.max(1,(Math.max(3,e.forcedMaxRecurrence)-2)/4)).slice(1,5);var u=(0,o.axisBottom)(c).tickSize(2.5).tickArguments([3]).tickValues(A),h=1!==n.chromosomeIndex?n.chromosomeIndex-2:85,d=0;d=1!==n.chromosomeIndex?e.references.genomicTheta(e.references.chromosomes[h].chromosomeIndex,e.references.chromosomes[h].endPos):d/Math.PI%1*Math.PI;var f=(l-.5*Math.PI)*(180/Math.PI);28===n.chromosomeIndex?e.svg.append("g").attr("class",e.elementClassPrefixVerticalAxis1).attr("transform","rotate("+f+")").call(u.tickSize(0).tickPadding(1)).style("font",s):e.svg.append("g").attr("class",e.elementClassPrefixVerticalAxis2).attr("transform","rotate("+f+")").call(u.tickFormat(""))}})}},{key:"addChromosomeFrames",value:function(){var e=this;if(["chr"+this.elementClassPrefix].forEach(function(t){e.svg.selectAll("."+t).remove()}),"off"!==this.dataMode){var t=this;this.elementGroup.selectAll(".chr"+this.elementClassPrefix).data(this.references.chromosomes).enter().append("path").attr("class","chr"+this.elementClassPrefix).attr(this.elementIndexPrefix,function(e){return"chr"+e.chromosomeIndex}).attr("d",function(){var e=(0,o.select)(this).datum(),n=t.getAngles(e);return(0,o.arc)().innerRadius(t.innerRadius).outerRadius(t.outerRadius).startAngle(n[0]).endAngle(n[1])()}).style("fill","None").style("stroke",function(e){return 0===e.chromosomeIndex||e.chromosomeIndex>23?"None":"Black"})}}},{key:"calculateRecurrence",value:function(e){var t=this,n=new Set;"gene"!==this.dataMode?this.dataFields.forEach(function(t){e[t].forEach(function(e){n.add(e)})}):e[this.dataFields[0]].forEach(function(e,r){t.allowedMutationTypes.has(r)&&e.forEach(function(e){n.add(e)})});var r=new Set([].concat(a(n)).filter(function(e){return t.selectedDonors.has(e)}));if(-1!==this.selectedDiffSubcohortIndex){var o=new Set([].concat(a(n)).filter(function(e){return t.diffDonors.has(e)}));return Math.max(0,r.size-o.size)}return r.size}},{key:"getAngles",value:function(e){var t=this.references.genomicTheta(e.chromosomeIndex,e.startPos),n=this.references.genomicTheta(e.chromosomeIndex,e.endPos);if("gene"===this.dataMode&&n-t<.01){var r=.5*(t+n);t=r-.005,n=r+.005}return[t,n]}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WheelContainer=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(333),i=n(332),a=n(1),s=n(62),l=n(118);function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.WheelContainer=function(){function t(e,n,r,o,i,a,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.selectionManager=r,this.selectedSubcohortIndex=o,this.selectedDiffSubcohortIndex=i,this.fontManager=l,this.selectedDonors=this.selectionManager.registeredSubcohorts.get(this.selectedSubcohortIndex),this.diffDonors=new Set,-1!==this.selectedDiffSubcohortIndex&&(this.diffDonors=this.selectionManager.registeredSubcohorts.get(this.selectedDiffSubcohortIndex)),this.currentInnerRadius=0,this.currentWheelWidth=0,this.currentDataMode="off",this.currentTadOffset=0,this.wheel1=void 0,this.wheel2=void 0,this.wheelIndex=a,this.currentPureMaxRecurrence=0,this.maxRecurrenceAdjustmentSliderId="maxRecWheel"+this.wheelIndex,this.numDonors=s,this.allowedMutationTypes=new Set,this.data=null}return r(t,[{key:"enableControls",value:function(){void 0!==this.wheel1&&this.wheel1.enableControls(),void 0!==this.wheel2&&this.wheel2.enableControls(),this.updateSlider()}},{key:"plot",value:function(){"off"!==this.currentDataMode&&(void 0!==this.wheel1&&this.wheel1.plot(),void 0!==this.wheel2&&this.wheel2.plot())}},{key:"reset",value:function(){void 0!==this.wheel1&&(this.wheel1.cleanup(),this.wheel1=void 0),void 0!==this.wheel2&&(this.wheel2.cleanup(),this.wheel2=void 0),this.data=null}},{key:"updateAngles",value:function(){void 0!==this.wheel1&&this.wheel1.updatePaths(),void 0!==this.wheel2&&this.wheel2.updatePaths()}},{key:"updateWheel",value:function(t,n,r,o,i,s,l){var c=this;this.currentPureMaxRecurrence=0;var A=i!==this.currentTadOffset||this.currentInnerRadius!==n||this.currentDataMode!==t||"gene"===t&&!(0,a.eqSet)(this.allowedMutationTypes,s);if(this.currentDataMode=t,this.currentInnerRadius=n,this.currentWheelWidth=r,this.currentTadOffset=i,A){if("cyt"!==this.currentDataMode){"gene"===this.currentDataMode&&(this.allowedMutationTypes=s);var u=this.generateDataFields(!1,!1);e("#"+this.maxRecurrenceAdjustmentSliderId+"Label").html(""),o.forEach(function(e){var t=c.calculateRecurrence(e,u);t>c.currentPureMaxRecurrence&&(c.currentPureMaxRecurrence=t)}),e("#"+this.maxRecurrenceAdjustmentSliderId+"Group").css("display","inline")}else e("#"+this.maxRecurrenceAdjustmentSliderId+"Group").css("display","none");this.setWheels(o,!l)}}},{key:"updateSlider",value:function(){var t=this;e("#"+this.maxRecurrenceAdjustmentSliderId+"Label").html("Max Displayed<br/>"+this.currentDataMode+" Recurrence: "+this.currentPureMaxRecurrence),e("#"+this.maxRecurrenceAdjustmentSliderId).slider("setAttribute","data-slider-max",t.numDonors).slider("setAttribute","max",t.numDonors).slider("setValue",parseInt(t.currentPureMaxRecurrence)).off("change").on("change",function(){if("cyt"!==this.currentDataMode){var n=+e(this).val();e("#"+t.maxRecurrenceAdjustmentSliderId+"Label").html("Max Displayed<br/>"+t.currentDataMode+" Recurrence: "+n),void 0!==t.wheel1&&t.wheel1.updateForcedMaxRecurrence(n),void 0!==t.wheel2&&t.wheel2.updateForcedMaxRecurrence(n)}})}},{key:"setWheels",value:function(e,t){void 0!==this.wheel1&&this.wheel1.cleanup(),void 0!==this.wheel2&&this.wheel2.cleanup(),this.wheel1=void 0,this.wheel2=void 0,"cnv"!==this.currentDataMode&&"cnvloh"!==this.currentDataMode?"cyt"!==this.currentDataMode?this.wheel1=new o.WheelRecurrence(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,this.currentInnerRadius,this.currentWheelWidth,e,this.generateDataFields(!1,!1),this.currentDataMode,!1,!1,this.currentDataMode+"_w"+this.wheelIndex,this.currentPureMaxRecurrence,"maxRecWheel"+this.wheelIndex,this.allowedMutationTypes,this.fontManager):this.wheel1=new i.WheelCytoband(this.commonSettings,this.references,this.currentInnerRadius,this.currentWheelWidth,e,this.currentDataMode+"_w"+this.wheelIndex,this.fontManager):(this.wheel1=new o.WheelRecurrence(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,this.currentInnerRadius,Math.round((this.currentWheelWidth-this.commonSettings.wheelGap)/2),e,this.generateDataFields(!0,!1),this.currentDataMode,!0,!0,this.currentDataMode+"l_w"+this.wheelIndex,this.currentPureMaxRecurrence,"maxRecWheel"+this.wheelIndex,this.allowedMutationTypes,this.fontManager),this.wheel2=new o.WheelRecurrence(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,this.currentInnerRadius+Math.round((this.currentWheelWidth-this.commonSettings.wheelGap)/2),Math.round((this.currentWheelWidth-this.commonSettings.wheelGap)/2)+this.commonSettings.wheelGap,e,this.generateDataFields(!1,!0),this.currentDataMode,!0,!1,this.currentDataMode+"g_w"+this.wheelIndex,this.currentPureMaxRecurrence,"maxRecWheel"+this.wheelIndex,this.allowedMutationTypes,this.fontManager)),t&&(void 0!==this.wheel1&&this.wheel1.plot(),void 0!==this.wheel2&&this.wheel2.plot()),this.enableControls()}},{key:"calculateRecurrence",value:function(e,t){var n=this,r=new Set;"gene"!==this.currentDataMode?t.forEach(function(t){e[t].forEach(function(e){r.add(e)})}):e[t[0]].forEach(function(e,t){n.allowedMutationTypes.has(t)&&e.forEach(function(e){r.add(e)})});var o=new Set([].concat(c(r)).filter(function(e){return n.selectedDonors.has(e)}));if(-1!==this.selectedDiffSubcohortIndex){var i=new Set([].concat(c(r)).filter(function(e){return n.diffDonors.has(e)}));return Math.max(0,o.size-i.size)}return o.size}},{key:"generateDataFields",value:function(e,t){if("cnv"===this.currentDataMode)return e&&!t?["cnvLossDonorContributorIndices"]:t&&!e?["cnvGainDonorContributorIndices"]:["cnvGainDonorContributorIndices","cnvLossDonorContributorIndices"];if("cnvloh"===this.currentDataMode)return e&&!t?["cnvLossDonorContributorIndices","lohDonorContributorIndices"]:t&&!e?["cnvGainDonorContributorIndices"]:["cnvGainDonorContributorIndices","cnvLossDonorContributorIndices","lohDonorContributorIndices"];if("sv"===this.currentDataMode){for(var n=[],r=0;r<=this.currentTadOffset;++r)n.push("svDonorContributorIndicesOffset"+r);return n}if("loh"===this.currentDataMode)return["lohDonorContributorIndices"];if("cnnloh"===this.currentDataMode)return["cnnLohDonorContributorIndices"];if("ind"===this.currentDataMode){for(var o=[],i=0;i<=this.currentTadOffset;++i)o.push("indelDonorContributorIndicesOffset"+i);return o}return"gene"===this.currentDataMode?["currentDonorContributions"]:[]}},{key:"replotVerticalAxis",value:function(){void 0!==this.wheel1&&this.wheel1.addVerticalAxis(),void 0!==this.wheel2&&this.wheel2.addVerticalAxis()}},{key:"replotGeneLabels",value:function(){this.wheel1.plotGeneLabels()}},{key:"markGene",value:function(e){this.wheel1.addGeneLabel(e)}},{key:"clearMarkedGenes",value:function(){this.wheel1.clearMarkedGenes()}},{key:"markCytoband",value:function(e){this.wheel1.addCytobandLabel(e)}},{key:"clearMarkedCytobands",value:function(){this.wheel1.removeAllCytobandLabels()}},{key:"textExport",value:function(e){var t=[];if("gene"===this.currentDataMode){var n=Array.from(this.allowedMutationTypes).sort();t.push(s.GeneEntry.generalHeaderExport(this.references,n));for(var r=0;r<this.wheel1.data.length;++r)if(25!==this.references.tads[this.wheel1.data[r].tadIndex].chromosomeIndex){var o=this.wheel1.data[r].textExport(this.references,e,n);o.length>0&&t.push(o)}}else if("cnv"===this.currentDataMode||"cnvloh"===this.currentDataMode||"cnnloh"===this.currentDataMode||"loh"===this.currentDataMode){t.push(l.TadEntry.generalHeaderExportCnv());for(var i=0;i<this.wheel1.data.length;++i)if(25!==this.references.tads[this.wheel1.data[i].tadIndex].chromosomeIndex){var a=this.wheel1.data[i].textExportCnv(e,this.references);a.length>0&&t.push(a)}}else if("sv"===this.currentDataMode){t.push(l.TadEntry.generalHeaderExportSv());for(var c=0;c<this.wheel1.data.length;++c)if(25!==this.references.tads[this.wheel1.data[c].tadIndex].chromosomeIndex){var A=this.wheel1.data[c].textExportSv(e,this.references,this.currentTadOffset);A.length>0&&t.push(A)}}else{if("ind"!==this.currentDataMode)return[];t.push(l.TadEntry.generalHeaderExportIndel());for(var u=0;u<this.wheel1.data.length;++u)if(25!==this.references.tads[this.wheel1.data[u].tadIndex].chromosomeIndex){var h=this.wheel1.data[u].textExportIndel(this.references,e);h.length>0&&t.push(h)}}return t}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.WheelManager=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(334),i=n(13),a=n(1),s=n(331);function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.WheelManager=function(){function t(n,r,i,a,l,c,A,u){var h=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=n,this.references=r,this.cohortMetadata=i,this.selectionManager=a,this.selectedSubcohortIndex=l,this.selectedDiffSubcohortIndex=c,this.cohortData=A,this.fontManager=u,e("#wheelControls").empty();for(var d=1;d<5;++d)this.addWheelHtml(d);e("#wheelControls").append('<button id="submitWheelChoices" type="button" class="btn btn-success">Submit Wheel Choices</button>'),this.cohortMetadata.presetWheelSelectors(),this.wheelClasses=["off","off","off","off"],this.wheels=[new o.WheelContainer(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,1,0,this.fontManager),new o.WheelContainer(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,2,0,this.fontManager),new o.WheelContainer(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,3,0,this.fontManager),new o.WheelContainer(this.commonSettings,this.references,this.selectionManager,this.selectedSubcohortIndex,this.selectedDiffSubcohortIndex,4,0,this.fontManager)];for(var f=0;f<4;++f)this.wheels[f].numDonors=this.cohortMetadata.metadata.length;this.currentGeneMutTypes=new Set,this.wheelGeneMutTypes=[new Set,new Set,new Set,new Set],this.tadOffsets=[parseInt(document.getElementById("tadOffsetWheel1Selector").value),parseInt(document.getElementById("tadOffsetWheel2Selector").value),parseInt(document.getElementById("tadOffsetWheel3Selector").value),parseInt(document.getElementById("tadOffsetWheel4Selector").value)],this.controls(),this.horizontalAxisGenerator=new s.HorizontalAxis(this.commonSettings,this.references,this.fontManager),e("#submitWheelChoices").off("click").on("click",function(){h.resetWheelViz()})}return r(t,[{key:"resetWheelViz",value:function(){var e=this,t=(0,i.queue)();t.defer(function(t){e.readGeneMutTypes(t)}),t.awaitAll(function(){var t=e.commonSettings.svRadius;e.readWheelChoices(!1),t!==e.commonSettings.svRadius&&e.references.currentCohort.vizManager.plot()})}},{key:"markGene",value:function(e){for(var t=3;t>=0;--t)if("cyt"===this.wheelClasses[t]){this.wheels[t].markGene(e);break}}},{key:"replotGeneLabels",value:function(){for(var e=3;e>=0;--e)if("cyt"===this.wheelClasses[e]){this.wheels[e].replotGeneLabels();break}}},{key:"markCytobandsCarryingGene",value:function(e){var t=this;this.references.genes.get(e).cytobandIndices.forEach(function(e){t.markCytoband(e)})}},{key:"markAllGenesOnCytoband",value:function(e){for(var t=this,n=3;n>=0;--n)if("cyt"===this.wheelClasses[n]){this.references.cytobands[e].getGeneIndices(this.references).forEach(function(e){t.markGene(e)});break}}},{key:"markAllGenesOnCytobandsContainingGene",value:function(e){var t=this,n=new Set;this.references.genes.get(e).cytobandIndices.forEach(function(e){t.references.cytobands[e].getGeneIndices(t.references).forEach(function(e){n.add(e)})}),n.forEach(function(e){t.markGene(e,-1,!0)})}},{key:"clearMarkedGenes",value:function(){for(var e=3;e>=0;--e)if("cyt"===this.wheelClasses[e]){this.wheels[e].clearMarkedGenes();break}}},{key:"replotVerticalAxis",value:function(){for(var e=0;e<4;++e)"cyt"!==this.wheelClasses[e]&&this.wheels[e].replotVerticalAxis()}},{key:"markCytoband",value:function(e){for(var t=3;t>=0;--t)if("cyt"===this.wheelClasses[t]){this.wheels[t].markCytoband(e);break}}},{key:"clearMarkedCytobands",value:function(){for(var e=3;e>=0;--e)if("cyt"===this.wheelClasses[e]){this.wheels[e].clearMarkedCytobands();break}}},{key:"addWheelHtml",value:function(t){var n='<div id="wheel'+t+'Controls">\n                        <p>\n                            <a class="btn btn-primary" data-toggle="collapse" href="#wheel'+t+'Collapse" aria-expanded="false" aria-controls="wheel'+t+'Collapse">\n                                Wheel '+t+" Controls "+(1===t?"(innermost)":"")+" "+(4===t?"(outermost)":"")+'\n                            </a>\n                        </p>\n                        <div class="collapse" id="wheel'+t+'Collapse">\n                            <div class="input-group" id="wheel'+t+'selector">\n                                <select class="form-control" title="wheel'+t+'" id="wheelSelector'+t+'">\n                                </select>\n                                <div class="input-group" id="tadOffsetWheel'+t+'Group">\n                                    <label for="tadOffsetWheel'+t+'Selector" class="col-form-label">TadOffset:</label>\n                                    <select class="form-control" title="wheel'+t+'" id="tadOffsetWheel'+t+'Selector">\n                                        <option value="0">0</option>\n                                        <option value="1" selected>1</option>\n                                        <option value="2">2</option>\n                                        <option value="3">3</option>\n                                    </select>\n                                </div>\n                                <div class="input-group" id="geneMutTypesWheel'+t+'">\n                                    <br>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeFunctionalWheel'+t+'" type="checkbox" class="custom-control-input" checked>\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">Functional SmallVar</span>\n                                    </label>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeUTR5Wheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">UTR5 SmallVar</span>\n                                    </label>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeUTR3Wheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">UTR3 SmallVar</span>\n                                    </label>\n                                    '+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeUpstreamWheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">Upstream SmallVar</span></label>')+"\n                                    "+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeDownstreamWheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">Downstream SmallVar</span></label>')+"\n                                    "+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeDirectSvWheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">Direct SV</span></label>')+'\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeAmpWheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">Amplification</span>\n                                    </label>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeHomdelWheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">HomDel</span>\n                                    </label>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeSynonymousWheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">Synonymous SNV</span>\n                                    </label>\n                                    <label class="custom-control custom-checkbox active">\n                                        <input id="includeDoubleHitAlt1Wheel'+t+'" type="checkbox" class="custom-control-input">\n                                        <span class="custom-control-indicator"></span>\n                                        <span class="custom-control-description">\n                                            DoubleHit (CNV/LOH+Functional SmallVar)\n                                        </span>\n                                    </label>\n                                    '+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeDoubleHitAlt2Wheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">DoubleHit (CNV/LOH+Functional SmallVar/Direct SV)</span></label>')+"\n                                    "+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeDoubleHitAlt3Wheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">DoubleHit (SmallVar+Direct SV)</span></label>')+"\n                                    "+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeFusionCorrectWheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">GeneFusion (correct orientation)</span></label>')+"\n                                    "+(this.commonSettings.wesMode?"":'<label class="custom-control custom-checkbox active"><input id="includeFusionIncorrectWheel'+t+'" type="checkbox" class="custom-control-input"><span class="custom-control-indicator"></span><span class="custom-control-description">GeneFusion (incorrect orientation)</span></label>')+"\n                                </div>\n                            </div>\n                        </div>";e("#wheelControls").append(n)}},{key:"readGeneMutTypes",value:function(t){for(var n=this,r=[],o=1;o<=4;++o)r[o-1]=document.getElementById("wheelSelector"+o).value;if(!new Set(r).has("cyt"))return window.alert('At least one wheel has to be "cytobands"'),!1;for(var s=[new Set,new Set,new Set,new Set],c=function(t){"gene"===r[t-1]&&(e("#includeFunctionalWheel"+t).is(":checked")&&[12,13,32,33,34,35,36,37,38,39,40,41,42,43,24,25,26,29,30,31].forEach(function(e){s[t-1].add(e)}),e("#includeUTR5Wheel"+t).is(":checked")&&[4,5,6,23].forEach(function(e){s[t-1].add(e)}),e("#includeUTR3Wheel"+t).is(":checked")&&[1,2,3].forEach(function(e){s[t-1].add(e)}),e("#includeAmpWheel"+t).is(":checked")&&s[t-1].add(7),e("#includeHomdelWheel"+t).is(":checked")&&s[t-1].add(15),e("#includeSynonymousWheel"+t).is(":checked")&&s[t-1].add(48),e("#includeDoubleHitAlt1Wheel"+t).is(":checked")&&s[t-1].add(57),n.commonSettings.wesMode||(e("#includeUpstreamWheel"+t).is(":checked")&&[52,53,54].forEach(function(e){s[t-1].add(e)}),e("#includeDownstreamWheel"+t).is(":checked")&&[9,10,11].forEach(function(e){s[t-1].add(e)}),e("#includeDirectSvWheel"+t).is(":checked")&&s[t-1].add(8),e("#includeDoubleHitAlt2Wheel"+t).is(":checked")&&s[t-1].add(58),e("#includeDoubleHitAlt3Wheel"+t).is(":checked")&&s[t-1].add(59),e("#includeFusionCorrectWheel"+t).is(":checked")&&s[t-1].add(60),e("#includeFusionIncorrectWheel"+t).is(":checked")&&s[t-1].add(61)))},A=1;A<=4;++A)c(A);var u=new Set([].concat(l(s[0]),l(s[1]),l(s[2]),l(s[3])));this.wheelClasses=r,this.wheelGeneMutTypes=s,this.tadOffsets=[parseInt(document.getElementById("tadOffsetWheel1Selector").value),parseInt(document.getElementById("tadOffsetWheel2Selector").value),parseInt(document.getElementById("tadOffsetWheel3Selector").value),parseInt(document.getElementById("tadOffsetWheel4Selector").value)];var h=!1;if(u.size>0&&((0,a.eqSet)(u,this.commonSettings.currentGeneMutTypes)||(this.commonSettings.currentGeneMutTypes=u,h=!0)),h){var d=(0,i.queue)();d.defer(function(e){n.cohortData.fetchCurrentGeneVariantData(e)}),d.awaitAll(function(){t(null)})}else t(null)}},{key:"readWheelChoices",value:function(t){for(var n=this,r=0,o=0;o<4;++o)"cyt"!==this.wheelClasses[o]&&"off"!==this.wheelClasses[o]&&(r+=1);var i=[60,60,60,45],a={sv:i[r],ind:i[r],cnv:i[r],loh:i[r],cnnloh:i[r],cnvloh:i[r],gene:i[r],cyt:[25,25,15,15][r],off:5},s=this.commonSettings.chromosomeAxisRadius-a[this.wheelClasses[3]],l=s-a[this.wheelClasses[2]],c=l-a[this.wheelClasses[1]],A=c-a[this.wheelClasses[0]],u=A-this.commonSettings.wheelGap;this.commonSettings.svRadius!==u&&(this.commonSettings.svRadius=u);for(var h=[A,c,l,s],d=[a[this.wheelClasses[0]],a[this.wheelClasses[1]],a[this.wheelClasses[2]],a[this.wheelClasses[3]]],f=function(e){if("gene"!==n.wheelClasses[e]){var r="cyt"===n.wheelClasses[e]?n.references.cytobands:n.references.tads;setTimeout(function(){n.wheels[e].updateWheel(n.wheelClasses[e],h[e],d[e],r,n.tadOffsets[e],n.wheelGeneMutTypes[e],t)},0)}},p=0;p<4;++p)f(p);if(this.commonSettings.currentGeneMutTypes.size>0)for(var g=function(e){"gene"===n.wheelClasses[e]&&setTimeout(function(){n.wheels[e].updateWheel(n.wheelClasses[e],h[e],d[e],n.cohortData.currentGeneMutRecurrence,n.tadOffsets[e],n.wheelGeneMutTypes[e],t)},0)},m=0;m<4;++m)g(m);var v=e("#variantViewTsvExportTargetSelector");v.empty(),v.append('<option value="-1">Select Export Target</option>');for(var y=0;y<4;++y)"cyt"!==this.wheelClasses[y]&&v.append('<option value="wheel'+(y+1)+'Recurrence">Wheel '+(y+1)+" Recurrence ("+this.wheelClasses[y]+")</option>");return v.append('<option value="visibleSv">Visible Structural Variant Data</option>'),v.append('<option value="visibleSmallvar">Visible Small Variant Data</option>'),!0}},{key:"updateAngles",value:function(){var e=this;setTimeout(function(){e.horizontalAxisGenerator.generate()},0);for(var t=function(t){setTimeout(function(){e.wheels[t].updateAngles()},0)},n=0;n<4;++n)t(n)}},{key:"plot",value:function(){var e=this;setTimeout(function(){e.horizontalAxisGenerator.generate()},0);for(var t=function(t){setTimeout(function(){e.wheels[t].plot()},0)},n=0;n<4;++n)t(n)}},{key:"controls",value:function(){for(var t=function(t){e("#wheelSelector"+t).off("change").on("change",function(){"gene"===this.value?(0,a.switchElements)([],["geneMutTypesWheel"+t]):(e("#includeFunctionalWheel"+t).prop("checked",!0),e("#includeDirectSvWheel"+t).prop("checked",!1),e("#includeDownstreamWheel"+t).prop("checked",!1),e("#includeSynonymousWheel"+t).prop("checked",!1),e("#includeUpstreamWheel"+t).prop("checked",!1),e("#includeUTR3Wheel"+t).prop("checked",!1),e("#includeUTR5Wheel"+t).prop("checked",!1),e("#includeAmpWheel"+t).prop("checked",!1),e("#includeHomdelWheel"+t).prop("checked",!1),(0,a.switchElements)(["geneMutTypesWheel"+t],[])),"sv"===this.value||"ind"===this.value?(0,a.switchElements)([],["tadOffsetWheel"+t+"Group"]):(0,a.switchElements)(["tadOffsetWheel"+t+"Group"],[]),"cyt"===this.value?(0,a.switchElements)(["maxRecWheel"+t+"Group"],[]):(0,a.switchElements)([],["maxRecWheel"+t+"Group"])})},n=1;n<=4;++n)t(n)}},{key:"addGeneLabel",value:function(e){for(var t=0;t<4;++t)if("cyt"===this.wheelClasses[t])return void this.wheels[t].wheel1.addGeneLabel(e,!1)}},{key:"textExport",value:function(e){return this.wheels[e].textExport(this.cohortMetadata)}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantRecurrenceEntryIndel=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tadIndex=parseInt(t.tadIndex),this.offset0donors=[],""!==t.offset0donors&&t.offset0donors.split(",").forEach(function(e){n.offset0donors.push(parseInt(e))}),this.offset1donors=[],""!==t.offset1donors&&t.offset1donors.split(",").forEach(function(e){n.offset1donors.push(parseInt(e))}),this.offset2donors=[],""!==t.offset2donors&&t.offset2donors.split(",").forEach(function(e){n.offset2donors.push(parseInt(e))}),this.offset3donors=[],""!==t.offset3donors&&t.offset3donors.split(",").forEach(function(e){n.offset3donors.push(parseInt(e))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantRecurrenceEntrySv=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tadIndex=parseInt(t.tadIndex),this.offset0donors=[],""!==t.offset0donors&&t.offset0donors.split(",").forEach(function(e){n.offset0donors.push(parseInt(e))}),this.offset1donors=[],""!==t.offset1donors&&t.offset1donors.split(",").forEach(function(e){n.offset1donors.push(parseInt(e))}),this.offset2donors=[],""!==t.offset2donors&&t.offset2donors.split(",").forEach(function(e){n.offset2donors.push(parseInt(e))}),this.offset3donors=[],""!==t.offset3donors&&t.offset3donors.split(",").forEach(function(e){n.offset3donors.push(parseInt(e))})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariantRecurrenceEntryCnv=function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tadIndex=parseInt(t.tadIndex),this.lossDonors=[],""!==t.lossDonors&&t.lossDonors.split(",").forEach(function(e){n.lossDonors.push(parseInt(e))}),this.gainDonors=[],""!==t.gainDonors&&t.gainDonors.split(",").forEach(function(e){n.gainDonors.push(parseInt(e))}),this.lohDonors=[],""!==t.lohDonors&&t.lohDonors.split(",").forEach(function(e){n.lohDonors.push(parseInt(e))})}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.CohortData=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(13),a=n(63),s=n(338),l=n(337),c=n(336),A=n(120),u=n(119);function h(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.CohortData=function(){function t(e,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.cohortMetadata=r,this.Svs=[],this.VdjSvs=[],this.midSizedSvs=[],this.currentGeneMutRecurrence=[],this.currentSingleGeneRecurrence={},this.currentSmallVariants=new Map}return o(t,[{key:"fetchRecData",value:function(e){var t=this,n=(0,i.queue)();n.defer(function(e){t.fetchTadRecurrenceCnvData(e)}),n.defer(function(e){t.fetchTadRecurrenceSvData(e)}),n.defer(function(e){t.fetchTadRecurrenceIndelData(e)}),n.awaitAll(function(){e(null)})}},{key:"fetchVarData",value:function(e){var t=this,n=(0,i.queue)();n.defer(function(e){t.fetchSvData(e)}),n.defer(function(e){t.fetchMidSizedSvData(e)}),n.defer(function(e){t.fetchOffIndelData(e)}),n.awaitAll(function(){e(null)})}},{key:"findSvsSimilarToNewVdjPool",value:function(e,t,n,o,i){for(var a=t.length,s=n.length,l=[],c=[],A=new Set,u=0;u<a;++u){for(var h=t[u],d=h.donorIndex,f=0;f<s;++f)if(!A.has(f)){var p=n[f];if(d===p.donorIndex)if(6===h.eventTypeIndex){var g=h.svSimilarity(p,-1),m=r(g,2),v=m[0],y=m[1];v&&(l.push(p),l[l.length-1].transformToVdjSv(h,y,i,o),A.add(f))}else if(7===h.eventTypeIndex){var b=h.svSimilarity(p,1),I=r(b,2),x=I[0],w=I[1];x&&(l.push(p),l[l.length-1].transformToVdjSv(h,w,i,o),A.add(f))}}e.push(h)}for(var C=0;C<s;++C)A.has(C)||c.push(n[C]);return[l.length,l,c]}},{key:"fetchSvData",value:function(t){if(this.commonSettings.wesMode)t(null);else{var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"cohortAllSvs",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){var o=[],i=[];e.forEach(function(e){var t=new u.VariantEntrySv(e,n.references);6===t.eventTypeVizIndex||7===t.eventTypeVizIndex?i.push(t):o.push(t)});var a=i.slice();if(i.length=0,a.length>0){for(var s=1;;){var l=n.findSvsSimilarToNewVdjPool(i,a,o,n.references,s),c=r(l,3),A=c[0],d=c[1],f=c[2];if(0===A)break;a=d,o=f,s+=1}n.VdjSvs=i,n.Svs=o}else n.VdjSvs=[],n.Svs=o;if(n.VdjSvs.length>0){n.cohortMetadata.metadataDataTypes.set("vdjTargets","multicategorical"),n.cohortMetadata.metadataDataPossibleValues.set("vdjTargets",new Set),n.cohortMetadata.metadataDataPossibleValues.get("vdjTargets").add("NONE");for(var p=0;p<n.cohortMetadata.metadata.length;++p)n.cohortMetadata.metadata[p].vdjTargets=new Set;n.cohortMetadata.addPossibleMetadataColumn("vdjTargets")}if(n.VdjSvs.length>0){for(var g=new Map,m=0;m<n.VdjSvs.length;++m)g.set(n.VdjSvs[m].svIndex,m),n.VdjSvs[m].svIndex=m;for(var v=0;v<n.VdjSvs.length;++v){var y=n.VdjSvs[v];y.vdjGrade>0&&(y.parentVdjIndex=g.get(y.parentVdjIndex))}for(var b=function(e){for(var t=n.VdjSvs[e],r=[],o=t.parentVdjIndex;-1!==o;)r.push(o),o=n.VdjSvs[o].parentVdjIndex;var i=n.VdjSvs[e].donorIndex,a=n.VdjSvs[e].svIndex;t.tadIndicesOffset0.forEach(function(o){n.references.tads[o].cytobandIndices.forEach(function(e){n.references.cytobands[e].vdjSvDonorContributorIndices.add(i)}),n.references.tads[o].offset0VdjSvIndices.push(a),r.forEach(function(e){n.references.tads[o].offset0VdjSvIndices.push(e)});var s=new Set([].concat(h(n.references.tads[o].svDonorContributorIndicesOffset0),h(n.references.tads[o].svDonorContributorIndicesOffset1))).size;s>t.maxRecurrence&&(n.VdjSvs[e].maxRecurrence=s)}),t.tadIndicesOffset1.forEach(function(o){n.references.tads[o].offset1VdjSvIndices.push(a),r.forEach(function(e){n.references.tads[o].offset1VdjSvIndices.push(e)});var i=new Set([].concat(h(n.references.tads[o].svDonorContributorIndicesOffset0),h(n.references.tads[o].svDonorContributorIndicesOffset1))).size;i>t.maxRecurrence&&(n.VdjSvs[e].maxRecurrence=i)}),t.tadIndicesOffset2.forEach(function(e){n.references.tads[e].offset2VdjSvIndices.push(a),r.forEach(function(t){n.references.tads[e].offset2VdjSvIndices.push(t)})}),t.tadIndicesOffset3.forEach(function(e){n.references.tads[e].offset3VdjSvIndices.push(a),r.forEach(function(t){n.references.tads[e].offset3VdjSvIndices.push(t)})}),t.vdjTargets.forEach(function(e){var t=n.references.genes.get(e).geneName;n.cohortMetadata.metadataDataPossibleValues.get("vdjTargets").add(t),n.cohortMetadata.metadata[i].vdjTargets.add(t)})},I=0;I<n.VdjSvs.length;++I)b(I);for(var x=0;x<n.cohortMetadata.metadata.length;++x){var w=Array.from(n.cohortMetadata.metadata[x].vdjTargets).sort().join(";");0===n.cohortMetadata.metadata[x].vdjTargets.size&&(w="NONE"),n.cohortMetadata.metadata[x].vdjTargets=w}n.cohortMetadata.refreshMetadata()}for(var C=function(e){n.Svs[e].svIndex=e,n.Svs[e].tadIndicesOffset0.forEach(function(t){n.references.tads[t].offset0SvIndices.push(n.Svs[e].svIndex);var r=new Set([].concat(h(n.references.tads[t].svDonorContributorIndicesOffset0),h(n.references.tads[t].svDonorContributorIndicesOffset1))).size;r>n.Svs[e].maxRecurrence&&(n.Svs[e].maxRecurrence=r)}),n.Svs[e].tadIndicesOffset1.forEach(function(t){n.references.tads[t].offset1SvIndices.push(n.Svs[e].svIndex);var r=new Set([].concat(h(n.references.tads[t].svDonorContributorIndicesOffset0),h(n.references.tads[t].svDonorContributorIndicesOffset1))).size;r>n.Svs[e].maxRecurrence&&(n.Svs[e].maxRecurrence=r)}),n.Svs[e].tadIndicesOffset2.forEach(function(t){n.references.tads[t].offset2SvIndices.push(n.Svs[e].svIndex)}),n.Svs[e].tadIndicesOffset3.forEach(function(t){n.references.tads[t].offset3SvIndices.push(n.Svs[e].svIndex)})},E=0;E<n.Svs.length;++E)C(E);t(null)},error:function(e){console.error(e)}})}}},{key:"fetchMidSizedSvData",value:function(t){if(this.commonSettings.wesMode)t(null);else{var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"cohortAllSvsMidSize",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new u.VariantEntrySv(e,n.references);t.tadIndicesOffset0.forEach(function(e){n.references.tads[e].offset0MidSvIndices.push(t.svIndex);var r=new Set([].concat(h(n.references.tads[e].indelDonorContributorIndicesOffset0),h(n.references.tads[e].indelDonorContributorIndicesOffset1))).size;r>t.maxRecurrence&&(t.maxRecurrence=r)}),t.tadIndicesOffset1.forEach(function(e){n.references.tads[e].offset1MidSvIndices.push(t.svIndex);var r=new Set([].concat(h(n.references.tads[e].indelDonorContributorIndicesOffset0),h(n.references.tads[e].indelDonorContributorIndicesOffset1))).size;r>t.maxRecurrence&&(t.maxRecurrence=r)}),t.tadIndicesOffset2.forEach(function(e){n.references.tads[e].offset2MidSvIndices.push(t.svIndex)}),t.tadIndicesOffset3.forEach(function(e){n.references.tads[e].offset3MidSvIndices.push(t.svIndex)}),n.midSizedSvs.push(t)}),t(null)},error:function(e){console.error(e)}})}}},{key:"fetchOffIndelData",value:function(t){if(this.commonSettings.wesMode)t(null);else{var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"cohortAllIndels",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new A.VariantEntryIndel(e,n.references);t.hasOwnProperty("tadIndicesOffset0")&&t.tadIndicesOffset0.forEach(function(e){n.references.tads[e].offset0IndelIndices.push(t.indelIndex)}),t.hasOwnProperty("tadIndicesOffset1")&&t.tadIndicesOffset1.forEach(function(e){n.references.tads[e].offset1IndelIndices.push(t.indelIndex)}),t.hasOwnProperty("tadIndicesOffset2")&&t.tadIndicesOffset2.forEach(function(e){n.references.tads[e].offset2IndelIndices.push(t.indelIndex)}),t.hasOwnProperty("tadIndicesOffset3")&&t.tadIndicesOffset3.forEach(function(e){n.references.tads[e].offset3IndelIndices.push(t.indelIndex)})}),t(null)},error:function(e){console.error(e)}})}}},{key:"fetchTadRecurrenceSvData",value:function(t){if(this.commonSettings.wesMode)t(null);else{var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"tadRecurrenceSv",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new l.VariantRecurrenceEntrySv(e);t.offset0donors.forEach(function(e){n.references.tads[t.tadIndex].svDonorContributorIndicesOffset0.add(e)}),t.offset1donors.forEach(function(e){n.references.tads[t.tadIndex].svDonorContributorIndicesOffset1.add(e)}),t.offset2donors.forEach(function(e){n.references.tads[t.tadIndex].svDonorContributorIndicesOffset2.add(e)}),t.offset3donors.forEach(function(e){n.references.tads[t.tadIndex].svDonorContributorIndicesOffset3.add(e)})}),t(null)},error:function(e){console.error(e)}})}}},{key:"fetchTadRecurrenceCnvData",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"tadRecurrenceCnv",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new s.VariantRecurrenceEntryCnv(e);t.lossDonors.forEach(function(e){n.references.tads[t.tadIndex].cnvLossDonorContributorIndices.add(e)}),t.gainDonors.forEach(function(e){n.references.tads[t.tadIndex].cnvGainDonorContributorIndices.add(e)}),t.lohDonors.forEach(function(e){n.references.tads[t.tadIndex].lohDonorContributorIndices.add(e),n.references.tads[t.tadIndex].cnvGainDonorContributorIndices.has(e)||n.references.tads[t.tadIndex].cnvLossDonorContributorIndices.has(e)||n.references.tads[t.tadIndex].cnnLohDonorContributorIndices.add(e)})}),t(null)},error:function(e){console.error(e)}})}},{key:"assessChromosomeArmLevelCnvEffects",value:function(){for(var e=1;e<this.references.chromosomeArms.length&&24!==this.references.chromosomeArms[e].chromosomeIndex;++e)this.references.chromosomeArms[e].assessChromosomeArmLevelCnvEffects(this.references)}},{key:"assessFocalCnvEffects",value:function(){for(var e=this,t=function(t){var n=e.references.tads[t];if(24===n.chromosomeIndex)return"break";var r=e.references.chromosomeArms[e.references.cytobands[n.cytobandIndices[0]].chromosomeArmIndex];n.cnvLossFocalDonorContributorIndices=new Set([].concat(h(n.cnvLossDonorContributorIndices)).filter(function(e){return!r.cnvLossDonorContributorIndices.has(e)})),n.cnvGainFocalDonorContributorIndices=new Set([].concat(h(n.cnvGainDonorContributorIndices)).filter(function(e){return!r.cnvGainDonorContributorIndices.has(e)})),n.lohFocalDonorContributorIndices=new Set([].concat(h(n.lohDonorContributorIndices)).filter(function(e){return!r.lohDonorContributorIndices.has(e)})),n.cnnLohFocalDonorContributorIndices=new Set([].concat(h(n.cnnLohDonorContributorIndices)).filter(function(e){return!r.cnnLohDonorContributorIndices.has(e)}))},n=1;n<this.references.tads.length&&"break"!==t(n);++n);}},{key:"propagateTadCnvsToCytobands",value:function(){for(var e=this,t=function(t){var n=e.references.cytobands[t];if(24===n.chromosomeIndex)return"break";for(var r=n.firstTadIndex;r<=n.lastTadIndex;++r){var o=e.references.tads[r];o.cnvLossDonorContributorIndices.forEach(function(e){n.cnvLossDonorContributorIndices.add(e)}),o.cnvGainDonorContributorIndices.forEach(function(e){n.cnvGainDonorContributorIndices.add(e)}),o.lohDonorContributorIndices.forEach(function(e){n.lohDonorContributorIndices.add(e)}),o.cnnLohDonorContributorIndices.forEach(function(e){n.cnnLohDonorContributorIndices.add(e)}),o.cnvLossFocalDonorContributorIndices.forEach(function(e){n.cnvLossFocalDonorContributorIndices.add(e)}),o.cnvGainFocalDonorContributorIndices.forEach(function(e){n.cnvGainFocalDonorContributorIndices.add(e)}),o.lohFocalDonorContributorIndices.forEach(function(e){n.lohFocalDonorContributorIndices.add(e)}),o.cnnLohFocalDonorContributorIndices.forEach(function(e){n.cnnLohFocalDonorContributorIndices.add(e)})}},n=0;n<this.references.cytobands.length&&"break"!==t(n);++n);}},{key:"propagateTadSvsToCytobands",value:function(){for(var e=this,t=function(t){var n=e.references.cytobands[t];if(24===n.chromosomeIndex)return"break";for(var r=n.firstTadIndex;r<=n.lastTadIndex;++r)e.references.tads[r].svDonorContributorIndicesOffset0.forEach(function(n){e.references.cytobands[t].svDonorContributorIndices.add(n)})},n=1;n<this.references.cytobands.length&&"break"!==t(n);++n);}},{key:"fetchTadRecurrenceIndelData",value:function(t){if(this.commonSettings.wesMode)t(null);else{var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortMetadata.cohortName,suffix:"tadRecurrenceIndel",columnsToSelect:"*",keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=new c.VariantRecurrenceEntryIndel(e);t.offset0donors.forEach(function(e){n.references.tads[t.tadIndex].indelDonorContributorIndicesOffset0.add(e)}),t.offset1donors.forEach(function(e){n.references.tads[t.tadIndex].indelDonorContributorIndicesOffset1.add(e)}),t.offset2donors.forEach(function(e){n.references.tads[t.tadIndex].indelDonorContributorIndicesOffset2.add(e)}),t.offset3donors.forEach(function(e){n.references.tads[t.tadIndex].indelDonorContributorIndicesOffset3.add(e)})}),t(null)},error:function(e){console.error(e)}})}}},{key:"fetchCurrentGeneVariantData",value:function(t){this.currentGeneMutRecurrence.length=0;var n=["`Gene"].concat(Array.from(this.commonSettings.currentGeneMutTypes).sort().map(String)).join("`, `")+"`",r=this;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:"geneRecurrence",columnsToSelect:n,keyColumn:"",keysToSearchRaw:"*"},success:function(e){e.forEach(function(e){var t=parseInt(e.Gene);if(r.references.genes.has(t)){var n=new a.VariantRecurrenceEntryGene(e,r.commonSettings.currentGeneMutTypes);if(n.isValid){var o=r.references.genes.get(t);o.addCurrentDonorContributions(n.contributions),r.currentGeneMutRecurrence.push(o)}}}),t(null)},error:function(e){console.error(e)}})}},{key:"fetchSingleGeneRecurrenceData",value:function(t,n){this.currentSingleGeneRecurrence={};var r=this;e.ajax({url:r.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:r.cohortMetadata.cohortName,suffix:"geneRecurrence",columnsToSelect:"*",keyColumn:"Gene",keysToSearchRaw:n},success:function(e){r.currentSingleGeneRecurrence=e[0],t(null)},error:function(e){console.error(e)}})}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.ComplexSelectionTreeNode=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.allUsedSelections=[],t.hasOwnProperty("rules")){this.leaves=[],this.donorIndices=new Set,this.condition=t.condition;for(var r=0;r<t.rules.length;++r)this.leaves.push(new e(t.rules[r],n)),this.allUsedSelections.push(this.leaves[r].allUsedSelections[0])}else{var i="equal"!==t.operator,a=t.value;this.allUsedSelections.push(a),this.donorIndices=i?new Set([].concat(o(n.cohortFullDonors)).filter(function(e){return!n.registeredSubcohorts.get(a).has(e)})):n.registeredSubcohorts.get(a)}}return r(e,[{key:"compress",value:function(){var e=this;if(this.hasOwnProperty("leaves")){for(var t=0;t<this.leaves.length;++t)this.leaves[t].hasOwnProperty("leaves")&&this.leaves[t].compress();if("AND"===this.condition)for(var n=function(t){e.leaves[t].donorIndices=new Set([].concat(o(e.leaves[t-1].donorIndices)).filter(function(n){return e.leaves[t].donorIndices.has(n)}))},r=1;r<this.leaves.length;++r)n(r);else if("OR"===this.condition)for(var i=1;i<this.leaves.length;++i)this.leaves[i].donorIndices=new Set([].concat(o(this.leaves[i].donorIndices),o(this.leaves[i-1].donorIndices)));this.donorIndices=this.leaves[this.leaves.length-1].donorIndices}}}]),e}()},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.MetadataEntry=function(){function t(r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=new Set([void 0,NaN,"NA","N.A",""]),a=!1,s=!1;r.hasOwnProperty("publicationDonor")&&(r.privateDonor=r.donor,r.donor=r.publicationDonor),i.has(r["OS.time"])||(r.hasOwnProperty("_EVENT")?(r.censoredOS=r["OS.time"],a=!0,i.has(r._EVENT)?r.OS="0":"1"===r._EVENT?r.OS="1":r.OS="0"):i.has(r.OS)?i.has(r.censoredOS)||(a=!0,r.OS="0"):(a=!0,r.OS="1")),"1"===r.OS?(r.OS=r.censoredOS,r.censoredOS="NA"):(r.OS="NA",a&&(s=!0));var l=1;Object.entries(r).forEach(function(t){var r=n(t,2),a=r[0],s=r[1];a=a.trim(),i.has(s)&&(s=NaN),e.isNumeric(s)&&(s=+s);var c=a.replace(/_/g," ").replace(/\./g," ");if(o[c]=s,c.startsWith("COSMIC sig ")&&(l-=s,"COSMIC sig 30"===c)){o["COSMIC sig unknown"]=l<1&&l>0?l:0;var A=o["SNV load"];if(i.has(A)){for(var u=1;u<31;++u)o["COSMIC sig "+u+" Muts"]="";o["COSMIC sig unknown Muts"]=""}else{for(var h=1;h<31;++h)o["COSMIC sig "+h+" Muts"]=o["SNV load"]*o["COSMIC sig "+h];o["COSMIC sig unknown Muts"]=o["SNV load"]*o["COSMIC sig unknown"]}}}),this.survivalAvailable=a,this.survivalCensored=s}return r(t,[{key:"textExport",value:function(e){var t=this,n=[this.donor];return e.forEach(function(e,r,o){"donor"!==r&&n.push(t[r])}),n}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(341),a=n(1),s=n(8),l=n(124),c=n(122),A=n(340);function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.Metadata=function(){function t(e,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.commonSettings=e,this.references=n,this.selectionManager=r,this.cohortName=o,this.textExportManager=i,this.metadata=[],this.maxIndex=0,this.possibleMetadataColumns=new Map,this.possibleMetadataColumnsReverse=new Map,this.metadataDataTypes=new Map,this.metadataDataPossibleValues=new Map,this.categoricalColumnsUsedForSubcohorting=new Set,this.donors=new Set,this.svAvailable=0,this.cnvAvailable=0,this.smallVarAvailable=0,this.geneExpressionAvailable=0,this.rppaExpressionAvailable=0,this.methylomeArrayAvailable=0,this.survivalAvailable=0,this.anyVariantAvailable=0,this.smallVarAvailableDonors=new Set,this.anyVariantAvailableDonors=new Set,this.geneExpressionAvailableDonors=new Set,this.rppaExpressionAvailableDonors=new Set,this.methylomeArrayAvailableDonors=new Set,this.survivalAvailableDonors=new Set}return o(t,[{key:"addPossibleMetadataColumn",value:function(t){if(!this.possibleMetadataColumns.has(t)){this.possibleMetadataColumns.set(t,this.maxIndex),this.possibleMetadataColumnsReverse.set(this.maxIndex,t);var n=this.metadataDataTypes.get(t);"categorical"!==n&&"multicategorical"!==n||this.updateCategoricalToSelectionControls(),this.maxIndex+=1,e("#flexiblePlotAddNewestMetadataColumn").click()}}},{key:"getCohortTitle",value:function(){return this.cohortName+"("+this.donors.size+")"}},{key:"getCohortTitleExpressionMode",value:function(e){return e.startsWith("Gene")?this.cohortName+"("+this.geneExpressionAvailable+"/"+this.donors.size+")":e.startsWith("Rppa")?this.cohortName+"("+this.rppaExpressionAvailable+"/"+this.donors.size+")":void 0}},{key:"getCohortTitleCorrelationMode",value:function(e,t,n,r){var o=this,i="Gene"===e.replace("Expression","")?"RNA":"Rppa",a=0,s=0;return t.forEach(function(e){"+"===o.metadata[e][i]&&(a+=1)}),this.donors.forEach(function(e){"+"===o.metadata[e][i]&&(s+=1)}),this.donors.size!==t.size?this.cohortName+"("+s+"/"+this.donors.size+") "+n+":"+a+"/"+t.size+" Correlations vs "+this.references.genes.get(r).geneName:this.cohortName+"("+s+"/"+this.donors.size+") Correlations vs "+this.references.genes.get(r).geneName}},{key:"getCohortTitleSubcohortExpressionMode",value:function(e,t,n,r,o){var i=this,a="Gene"===e.replace("Expression","")?"RNA":"Rppa",s=0,l=0;return t.forEach(function(e){"+"===i.metadata[e][a]&&(s+=1)}),n.forEach(function(e){"+"===i.metadata[e][a]&&(l+=1)}),this.cohortName+"("+this.donors.size+") "+r+": "+s+"/"+t.size+" vs "+o+": "+l+"/"+n.size}},{key:"getCohortTitleSubcohortMutexMode",value:function(e,t,n,r){return this.cohortName+"("+this.donors.size+") "+n+": "+e.size+" vs "+r+": "+t.size}},{key:"fetchCohortInformation",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromFile.php",type:"GET",dataType:"json",data:{cohort:n.cohortName,suffix:"cohortInformation"},success:function(e){e.forEach(function(e){n.diseaseNameAlternatives=e.diseaseNameAlternatives.split(","),n.cohortAllIndelsTable=e.cohortAllIndelsTable,n.cohortAllSnvsTable=e.cohortAllSnvsTable,n.cohortAllSvsTable=e.cohortAllSvsTable,n.cohortAllSvsMidSizeTable=e.cohortAllSvsMidSizeTable,n.geneRecurrenceTable=e.geneRecurrenceTable,n.tadRecurrenceCnvTable=e.tadRecurrenceCnvTable,n.tadRecurrenceSvTable=e.tadRecurrenceSvTable,n.tadRecurrenceIndelTable=e.tadRecurrenceIndelTable,void 0!==e.geneExpressionsTable&&(n.geneExpressionQuantity=e.geneExpressionQuantity,n.geneExpressionsTable=e.geneExpressionsTable,n.variantGeneExpressionTable=e.geneExpressionSummaryTable,n.GeneExpressionCrossCorrelationsTable=e.geneExpressionCrossCorrelationsTable,n.variantGeneExpressionTtestTable=e.geneExpressionSummaryTtestTable),void 0!==e.rppaExpressionsTable&&(n.rppaExpressionQuantity=e.rppaExpressionQuantity,n.rppaExpressionsTable=e.rppaExpressionsTable,n.variantRppaExpressionTable=e.rppaExpressionSummaryTable,n.variantRppaExpressionTtestTable=e.rppaExpressionSummaryTtestTable)}),t(null)},error:function(e){console.error(e),t(e)}})}},{key:"fetchCohortMetadata",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromFile.php",type:"GET",dataType:"json",data:{cohort:n.cohortName,suffix:"cohortMetadata"},success:function(o){o.forEach(function(t){var o=new i.MetadataEntry(t),a=!1;n.metadata[o.index]=o,e("#singleDonorSelector").append("<option value="+o.index+">"+o.donor+"</option>"),Object.entries(o).forEach(function(e){var t=r(e,2),o=t[0];t[1],n.addPossibleMetadataColumn(o)}),n.donors.add(o.index),n.selectionManager.cohortFullDonors.add(o.index),"+"===o.CNV&&(n.cnvAvailable+=1,a=!0),n.commonSettings.wesMode||"+"===o.SV&&(n.svAvailable+=1,a=!0),"+"===o.SNV&&(n.smallVarAvailable+=1,n.smallVarAvailableDonors.add(o.index),a=!0),"+"===o.Indel&&(n.smallVarAvailable+=1,n.smallVarAvailableDonors.add(o.index),a=!0),"+"===o.RNA&&(n.geneExpressionAvailable+=1,n.geneExpressionAvailableDonors.add(o.index)),"+"===o.Rppa&&(n.rppaExpressionAvailable+=1,n.rppaExpressionAvailableDonors.add(o.index)),"+"===o.MethylationArray&&(n.methylomeArrayAvailable+=1,n.methylomeArrayAvailableDonors.add(o.index)),o.survivalAvailable&&(n.survivalAvailable+=1,n.survivalAvailableDonors.add(o.index)),a&&(n.anyVariantAvailable+=1,n.anyVariantAvailableDonors.add(o.index))}),n.chooseColClasses(),n.enableControls(),n.updateCategoricalToSelectionControls(),e("#cohortMetadataContentControl").css("display","inline"),t(null)},error:function(e){console.error(e),t(e)}})}},{key:"enableControls",value:function(){var t=this,n=this,r=["metadataControls","selectorControlsCollapseControl"];e("#cohortMetadataContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,a.switchElements)(r,[])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,a.switchElements)(r,[])}).off("shown.bs.tab").on("shown.bs.tab",function(){e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,a.switchElements)([],r),t.refreshMetadata(),e("#miniSelectionBuilderArea").empty(),e("#complexSelectionWarningSpace").empty(),t.textExportManager.setAvailableExportSettings("metadata")}),e("#metadataMiniSelectionColumnSelector").off("change").on("change",function(){if("Select Column"!==this.value){e("#miniSelectionBuilderArea").empty();var t=n.metadataDataTypes.get(this.value);"categorical"===t?n.launchCategoricalMiniSelectionHelper(this.value):"multicategorical"===t?n.launchMultiCategoricalMiniSelectionHelper(this.value):"numeric"===t&&n.launchNumericMiniSelectionHelper(this.value)}})}},{key:"setupComplexSelectionQueryBuilder",value:function(){var t=this;e("#complexSelectionWarningSpace").empty().append('Caution: the "NOT-" mode include cases with missing data or NaNs');var n=this;if(2!==this.selectionManager.registeredSubcohortNames.size){this.selectionManager.registeredSubcohortNames.size>3&&e("#complexSelectionQueryBuilder").queryBuilder("destroy"),e("#complexSelectionCollapseControl").css("display","inline");var r={};this.selectionManager.registeredSubcohortNames.forEach(function(e,t,n){r[t]=e}),e("#complexSelectionQueryBuilder").empty().queryBuilder({filters:[{id:"subcohort",label:"Subcohort",type:"integer",input:"select",values:r,operators:["equal"]}]}),e("#complexSelectionName").off("change").on("change",function(){n.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#complexSelectionQueryBuilderGet").css("display","none"):e("#complexSelectionQueryBuilderGet").css("display","inline")}),e("#complexSelectionQueryBuilderReset").off("click").on("click",function(){t.commonSettings.interactionLock||(t.commonSettings.fastLock(),e("#complexSelectionQueryBuilder").queryBuilder("reset"),t.commonSettings.fastRelease())}),e("#complexSelectionQueryBuilderGet").css("display","none").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.lock();var n=new A.ComplexSelectionTreeNode(e("#complexSelectionQueryBuilder").queryBuilder("getRules"),t.selectionManager);n.compress();for(var r=new Set,o=0;o<n.allUsedSelections.length;++o){var i=n.allUsedSelections[o];if(t.selectionManager.subcohortIndexToItsUnknown.has(i)){var a=t.selectionManager.subcohortIndexToItsUnknown.get(i);t.selectionManager.registeredSubcohorts.get(a).forEach(function(e){r.add(e)})}}var s=e("#complexSelectionName"),l=s.val();s.empty(),t.finalizeSelection(new Set([].concat(u(n.donorIndices)).filter(function(e){return!r.has(e)})),r,l,"complexSelectionWarningSpace"),t.commonSettings.releaseLock()}})}}},{key:"updateSelectionToCategoricalControls",value:function(){var t=this;e("#selectionToCategoricalCollapseControl").css("display","inline"),e("#selectionToCategoricalCheckboxes").empty(),this.selectionManager.registeredSubcohortNames.forEach(function(n,r,o){t.selectionManager.fullCohortSubcohortIndices.has(r)||e("#selectionToCategoricalCheckboxes").append('\n                    <label class="custom-control custom-checkbox active">\n                        <input id="includeSelection'+r+'" type="checkbox" class="custom-control-input">\n                        <span class="custom-control-indicator"></span>\n                        <span class="custom-control-description">'+n+"</span>\n                    </label><br>\n                ")}),e("#selectionToCategoricalSubmit").off("click").on("click",function(){if(!t.commonSettings.interactionLock){t.commonSettings.lock();var n=[],r=[];t.selectionManager.registeredSubcohortNames.forEach(function(t,o,i){e("#includeSelection"+o).is(":checked")&&(n.push(o),r.push(t))}),t.createCategoricalVariableFromSelections(n,r),t.refreshMetadata(),t.commonSettings.releaseLock()}})}},{key:"updateCategoricalToSelectionControls",value:function(){var t=this;e("#categoricalToSelectionCollapseControl").css("display","inline");var n=e("#categoricalToSelectionCollapse");n.empty();var r=[],o=[];this.possibleMetadataColumns.forEach(function(e,n,i){if(!n.startsWith("Selection_")&&!t.categoricalColumnsUsedForSubcohorting.has(e)){var a=t.metadataDataTypes.get(n);"categorical"!==a&&"multicategorical"!==a||(r.push(n),o.push(e))}});for(var i=r.length,a=0;a<i;++a){var s=r[a],l=o[a];n.append('\n                            <button id="categoricalToSelectionSubmit_'+l+'" type="button" class="btn btn-success">'+s+"</button>\n                        ")}for(var c=function(n){var i=r[n],a=o[n];e("#categoricalToSelectionSubmit_"+a).off("click").on("click",function(){t.commonSettings.lock(),t.categoricalColumnsUsedForSubcohorting.add(a),t.createSelectionsFromMetadataColumn(i),t.refreshMetadata(),t.commonSettings.releaseLock()})},A=0;A<i;++A)c(A)}},{key:"createSelectionsFromMetadataColumn",value:function(e){for(var t=this,n=this.getMissingDonors(e),r=[],o=0;o<this.metadata.length;++o)n.has(o)||r.push(o);this.metadataDataPossibleValues.get(e).forEach(function(o){for(var i=e+"_"+o,a=new Set,s=0;s<r.length;++s)for(var l=r[s],c=t.metadata[l][e].split(";"),A=0;A<c.length;++A)if(o===c[A]){a.add(t.metadata[l].index);break}t.finalizeSingleSelection(a,n,i)&&t.updateSelectionToCategoricalControls()})}},{key:"createCategoricalVariableFromSelections",value:function(e,t){for(var n=t.join(";"),r=0;r<e.length;++r)this.selectionManager.metadataColumnsRelatedToSubcohorts.get(e[r]).push(n);this.metadataDataPossibleValues.set("Selection_"+n,new Set);for(var o=!1,i=0;i<this.metadata.length;++i){for(var a=[],s=0;s<e.length;++s)this.selectionManager.registeredSubcohorts.get(e[s]).has(this.metadata[i].index)&&a.push(t[s]);var l="other";a.length>0&&(l=a.join(";"),a>0&&(o=!0)),this.metadata[i]["Selection_"+n]=l,this.metadataDataPossibleValues.get("Selection_"+n).add(l)}o?this.metadataDataTypes.set("Selection_"+n,"multicategorical"):this.metadataDataTypes.set("Selection_"+n,"categorical"),this.addPossibleMetadataColumn("Selection_"+n),this.updateSelectionToCategoricalControls()}},{key:"launchCategoricalMiniSelectionHelper",value:function(t){var n=this,r=this,o=[],i=new Map,a=0;this.metadataDataPossibleValues.get(t).forEach(function(e){i.set(e,a),o.push('<div class="input-group">\n                            <label class="custom-control custom-checkbox">\n                                <input id="metadataAllow'+a+'" type="checkbox" class="custom-control-input">\n                                <span class="custom-control-indicator"></span>\n                                <span class="custom-control-description">'+e+"</span>\n                            </label>\n                        </div>"),a+=1}),o.push('\n                    <div class="row" id="metadataNumericSelectionModeSelectorGroup">\n                        <div class="col-md-8">\n                            <input type="text" class="form-control" id="metadataSelectionName" placeholder="Name Selection (enter to confirm)">\n                        </div>\n                        <div class="col-md-4">\n                            <button id="metadataSubmitCategoricalChoices" type="button" class="btn btn-secondary btn" style="display: none;">Submit choices</button>\n                        </div>\n                    </div>'),e("#miniSelectionBuilderArea").append(o.join("")),e("#metadataSelectionName").off("change").on("change",function(){r.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#metadataSubmitCategoricalChoices").css("display","none"):e("#metadataSubmitCategoricalChoices").css("display","inline")}),e("#metadataSubmitCategoricalChoices").off("click").on("click",function(){if(!n.commonSettings.interactionLock){n.commonSettings.lock();var r=e("#metadataSelectionName").val(),o=new Set;n.metadataDataPossibleValues.get(t).forEach(function(t){var n=i.get(t);e("#metadataAllow"+n).is(":checked")&&o.add(t)});for(var a=parseInt(e("#miniSelectionBuilderSubgroupSelector").val()),s=n.selectionManager.registeredSubcohorts.get(a),l=[],c=n.getMissingDonors(t),A=0;A<n.metadata.length;++A)s.has(A)?l.push(A):c.add(n.metadata[A].index);for(var u=new Set,h=0;h<l.length;++h){var d=l[h];o.has(n.metadata[d][t])&&u.add(n.metadata[d].index)}n.finalizeSelection(u,c,r,"miniSelectionBuilderArea"),n.commonSettings.releaseLock()}})}},{key:"launchMultiCategoricalMiniSelectionHelper",value:function(t){var n=this,r=this,o=[],i=new Map,a=0;this.metadataDataPossibleValues.get(t).forEach(function(e){i.set(e,a),o.push('<div class="input-group">\n                            <label class="custom-control custom-checkbox">\n                                <input id="metadataAllow'+a+'" type="checkbox" class="custom-control-input">\n                                <span class="custom-control-indicator"></span>\n                                <span class="custom-control-description">'+e+"</span>\n                            </label>\n                        </div>"),a+=1}),o.push('\n                    <div class="row" id="metadataNumericSelectionModeSelectorGroup">\n                        <div class="col-md-8">\n                            <input type="text" class="form-control" id="metadataSelectionName" placeholder="Name Selection (enter to confirm)">\n                        </div>\n                        <div class="col-md-4">\n                            <button id="metadataSubmitCategoricalChoices" type="button" class="btn btn-secondary btn" style="display: none;">Submit choices</button>\n                        </div>\n                    </div>'),e("#miniSelectionBuilderArea").append(o.join("")),e("#metadataSelectionName").off("change").on("change",function(){r.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#metadataSubmitCategoricalChoices").css("display","none"):e("#metadataSubmitCategoricalChoices").css("display","inline")}),e("#metadataSubmitCategoricalChoices").off("click").on("click",function(){if(!n.commonSettings.interactionLock){n.commonSettings.lock();var r=e("#metadataSelectionName").val(),o=new Set;n.metadataDataPossibleValues.get(t).forEach(function(t){var n=i.get(t);e("#metadataAllow"+n).is(":checked")&&o.add(t)});for(var a=parseInt(e("#miniSelectionBuilderSubgroupSelector").val()),s=n.selectionManager.registeredSubcohorts.get(a),l=[],c=n.getMissingDonors(t),A=0;A<n.metadata.length;++A)s.has(A)?l.push(A):c.add(n.metadata[A].index);for(var u=new Set,h=0;h<l.length;++h)for(var d=l[h],f=n.metadata[d][t].split(";"),p=0;p<f.length;++p)if(o.has(f[p])){u.add(n.metadata[d].index);break}n.finalizeSelection(u,c,r,"miniSelectionBuilderArea"),n.commonSettings.releaseLock()}})}},{key:"launchNumericMiniSelectionHelper",value:function(n){var r=this,o=this,i=[];i.push('\n                <div class="row" id="metadataNumericSelectionModeSelectorGroup">\n                    <div class="col-md-6">\n                        <select class="form-control" title="metadataNumericSelectionModeSelection" id="metadataNumericSelectionModeSelector">\n                            <option value="0"><</option>\n                            <option value="1"><=</option>\n                            <option value="2">=</option>\n                            <option value="3">>=</option>\n                            <option value="4">></option>\n                            <option value="5">between</option>\n                        </select>\n                    </div>\n                    <div class="col-md-6">        \n                        <label class="custom-control custom-checkbox">\n                                <input id="metadataAllowNans" type="checkbox" class="custom-control-input">\n                                <span class="custom-control-indicator"></span>\n                                <span class="custom-control-description">Allow NaNs/empty values</span>\n                            </label>\n                    </div>\n                </div>'),i.push('\n                    <div class="input-group" id="numericSelectionPossibleValuesSelectorGroup">\n                        <select class="form-control" title="numericSelectionPossibleValuesSelection" id="numericSelectionPossibleValuesSelector">\n                        </select>\n                    </div>'),i.push('\n                    <div class="input-group" id="numericSelectionPossibleValuesSecondarySelectorGroup" style="display: none;">\n                        <select class="form-control" title="numericSelectionPossibleValuesSecondarySelection" id="numericSelectionPossibleValuesSecondarySelector">\n                        </select>\n                    </div>'),i.push('<div id="numericHelperPlotContainer" class="container-fluid"></div>'),i.push('\n                    <div class="row" id="metadataNumericSelectionModeSelectorGroup">\n                        <div class="col-md-8">\n                            <input type="text" class="form-control" id="metadataSelectionName" placeholder="Name Selection (enter to confirm)">\n                        </div>\n                        <div class="col-md-4">\n                            <button id="metadataSubmitNumericChoices" type="button" class="btn btn-secondary btn" style="display: none;">Submit choices</button>\n                        </div>\n                    </div>'),e("#miniSelectionBuilderArea").append(i.join(""));for(var a=new Map,s=this.getObservedNumericValues(n),l=0;l<s.length;++l)e("#numericSelectionPossibleValuesSelector").append('<option value="'+l+'">'+s[l]+"</option>"),e("#numericSelectionPossibleValuesSecondarySelector").append('<option value="'+l+'">'+s[l]+"</option>"),a.set(s[l],l);var c=this.getCurrentValidValues.apply(this,u(t.getCurrentNumericConfiguration(n,s))),A=t.getTmpPlotObjects(s,c);this.numericMiniSelectionHelperPlot(A,n,a),e("#numericSelectionPossibleValuesSelector").off("change").on("change",function(){var e=r.getObservedNumericValues(n),o=r.getCurrentValidValues.apply(r,u(t.getCurrentNumericConfiguration(n,e))),i=t.getTmpPlotObjects(e,o);r.numericMiniSelectionHelperPlot(i,n,a)}),e("#numericSelectionPossibleValuesSecondarySelector").off("change").on("change",function(){var e=r.getObservedNumericValues(n),o=r.getCurrentValidValues.apply(r,u(t.getCurrentNumericConfiguration(n,e))),i=t.getTmpPlotObjects(e,o);r.numericMiniSelectionHelperPlot(i,n,a)}),e("#metadataNumericSelectionModeSelector").off("change").on("change",function(){"5"!=this.value?e("#numericSelectionPossibleValuesSecondarySelectorGroup").css("display","none"):e("#numericSelectionPossibleValuesSecondarySelectorGroup").css("display","inline");var r=o.getObservedNumericValues(n),i=o.getCurrentValidValues.apply(o,u(t.getCurrentNumericConfiguration(n,r))),s=t.getTmpPlotObjects(r,i);o.numericMiniSelectionHelperPlot(s,n,a)}),e("#metadataSelectionName").off("change").on("change",function(){o.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#metadataSubmitNumericChoices").css("display","none"):e("#metadataSubmitNumericChoices").css("display","inline")}),e("#metadataSubmitNumericChoices").off("click").on("click",function(){if(!r.commonSettings.interactionLock){r.commonSettings.lock();var o=e("#metadataSelectionName").val(),i=r.getObservedNumericValues(n),a=r.predictNumericalSelectionOutcome.apply(r,u(t.getCurrentNumericConfiguration(n,i))),s=r.getMissingDonors(n);e("#metadataAllowNans").is(":checked")&&(a=a.concat(s),s.clear());for(var l=new Set(a),c=parseInt(e("#miniSelectionBuilderSubgroupSelector").val()),A=r.selectionManager.registeredSubcohorts.get(c),h=0;h<r.metadata.length;++h)A.has(h)||(s.add(r.metadata[h].index),l.delete(r.metadata[h].index));r.finalizeSelection(l,s,o,"miniSelectionBuilderArea"),r.commonSettings.releaseLock()}})}},{key:"getMissingDonors",value:function(e){for(var t=new Set,n=0;n<this.metadata.length;++n){var r=this.metadata[n][e];this.commonSettings.undefinedValues.has(r)&&t.add(this.metadata[n].index)}return t}},{key:"getObservedNumericValues",value:function(e){for(var t=new Set,n=0;n<this.metadata.length;++n){var r=this.metadata[n][e];this.commonSettings.undefinedValues.has(r)||t.add(r)}var o=Array.from(t);return o.sort(function(e,t){return e<t?-1:e>t?1:-1}),o}},{key:"getCurrentValidValues",value:function(e,t,n,r){for(var o=new Set(this.predictNumericalSelectionOutcome(e,t,n,r)),i=new Set,a=0;a<this.metadata.length;++a){var s=this.metadata[a][e];this.commonSettings.undefinedValues.has(s)||o.has(a)&&i.add(s)}return i}},{key:"predictNumericalSelectionOutcome",value:function(t,n,r,o){for(var i=[],a=0;a<this.metadata.length;++a){var s=this.metadata[a][t];this.commonSettings.undefinedValues.has(s)?e("#metadataAllowNans").is(":checked")&&i.push(this.metadata[a].index):0===n?s<r&&i.push(this.metadata[a].index):1===n?s<=r&&i.push(this.metadata[a].index):2===n?s===r&&i.push(this.metadata[a].index):3===n?s>=r&&i.push(this.metadata[a].index):4===n?s>r&&i.push(this.metadata[a].index):5===n&&(r<o?s>=r&&s<=o&&i.push(this.metadata[a].index):s>=o&&s<=r&&i.push(this.metadata[a].index))}return i}},{key:"numericMiniSelectionHelperPlot",value:function(n,r,o){var i=this;e("#numericHelperPlotContainer").empty();var a=e("#rightSide").width(),A=.08*-a+" "+.03*-a+" "+a+" "+a,h=(0,s.select)("#numericHelperPlotContainer").classed("svg-container",!0).append("svg").classed("container-fluid",!0).classed("wrap",!0).classed("svg-content-responsive",!0).attr("viewBox",A).attr("id","numericHelperPlot").attr("preserveAspectRatio","none").attr("width","100%").attr("height","100%"),d=h.append("g"),f=h.append("g").attr("id","numericHelperPlotSupports"),p=.99*e("#numericHelperPlot").width(),g=(0,l.scaleLinear)().domain([0,n.length]).range([0,.95*p]),m=0;n.forEach(function(e){e.y>m&&(m=e.y)});var v=1.25;n.length>100?v=.5:n.length>50&&(v=.75);var y=7.25*v*.4,b=(0,l.scaleLinear)().domain([0,1.1*m]).range([p,.05*p]);f.append("rect").attr("x",0).attr("y",0).attr("height",p).attr("width",p).style("stroke","Black").style("fill","none").style("stroke-width",1),f.append("g").attr("class","axis axis--y").call((0,c.axisLeft)(b).tickSize(4)).selectAll("text").attr("y",0).attr("dy",".1em").style("font","12px Verdana"),d.selectAll(".numericHelperCircles").data(n).enter().append("circle").attr("class","numericHelperCircles").style("stroke",function(e){return e.selected?"Red":"Black"}).style("fill",function(e){return e.selected?"Red":"Black"}).attr("cx",function(e){return g(e.x)}).attr("cy",function(e){return b(e.y)}).attr("r",y),d.on("click",function(){if(!i.commonSettings.interactionLock){i.commonSettings.lock();var n=(0,s.select)(s.event.target).datum();e("#numericSelectionPossibleValuesSelector").val(o.get(n.y)),e("#numericSelectionPossibleValuesSecondarySelector").val(o.get(n.y));var a=i.getObservedNumericValues(r),l=i.getCurrentValidValues.apply(i,u(t.getCurrentNumericConfiguration(r,a))),c=t.getTmpPlotObjects(a,l);i.numericMiniSelectionHelperPlot(c,r,o),i.commonSettings.releaseLock()}})}},{key:"createMultipleGroups",value:function(e,t,n,o,i){var a=this;this.selectionManager.clusteringPrefixToSubcohortIndices.set(o,[]);for(var s=e.length,l=[],c=0;c<s;++c){var A="p_"+i+"_"+o+"_cluster"+(c+1),u=new Set(e[c]),h=this.finalizeSingleSelection(u,t,A);if(h){var d=r(h,7),f=(d[0],d[1],d[2],d[3],d[4],d[5]),p=d[6];f.forEach(function(e){a.selectionManager.clusteringPrefixToSubcohortIndices.get(o).push(e)}),l.push(p)}}this.setupComplexSelectionQueryBuilder(),this.updateSelectionToCategoricalControls(),this.refreshMetadata(),this.commonSettings.fastLock(),n&&(l.forEach(function(e){a.references.currentCohort.flexiblePlotManager.subplotModules.get(i).shadeSubcohortSilent(e,1)}),this.references.currentCohort.flexiblePlotManager.subplotModules.get(i).addSubcohortShades()),this.references.currentCohort.flexiblePlotManager.subplotModules.get(i).addPlotDataPoints(),this.references.currentCohort.flexiblePlotManager.subplotModules.get(i).remarkDonors(),this.commonSettings.fastRelease()}},{key:"cleanupSubcohortRelatedColumns",value:function(e){var t=this;this.references.currentCohort.flexiblePlotManager.removeSubcohortShade(e),this.selectionManager.metadataColumnsRelatedToSubcohorts.get(e).forEach(function(e){t.cleanupColumn(e)})}},{key:"cleanupColumn",value:function(e){this.metadataDataPossibleValues.delete(e),this.possibleMetadataColumns.delete(e),this.metadataDataTypes.delete(e);for(var t=this.metadata.length,n=0;n<t;++n)delete this.metadata[n][e];this.references.currentCohort.flexiblePlotManager.removeMetadataColumn()}},{key:"finalizeSingleSelection",value:function(t,n,r){var o=this,i="NOT-"+r,a="UNKNOWN-"+r,s=new Set([].concat(u(this.donors)).filter(function(e){return!n.has(e)&&!t.has(e)})),l=-1;if(t.size>0&&t.size!==this.donors.size){var c=Array.from(t).map(function(e){return o.metadata[e].donor}),A=Array.from(n).map(function(e){return o.metadata[e].donor}),h=Array.from(s).map(function(e){return o.metadata[e].donor}),d=[],f=[];if(this.selectionManager.registeredSubcohortNamesSet.has(r))return-1;e("#heatmapSubcohortMarkerGroup").css("display","inline");var p=-1,g=-1,m=-1;if(t.size>0){for(var v="Selection_"+r,y=0;y<this.metadata.length;++y)t.has(y)?this.metadata[y][v]="YES":this.metadata[y][v]="NO";this.metadataDataPossibleValues.set(v,new Set(["YES","NO"])),this.metadataDataTypes.set(v,"categorical"),this.addPossibleMetadataColumn(v),this.selectionManager.addNewSubcohort(t,r,this.metadata.length),p=this.selectionManager.currentMaxIndex,l=this.selectionManager.currentMaxIndex,d.push(this.selectionManager.currentMaxIndex),f.push(r),this.selectionManager.metadataColumnsRelatedToSubcohorts.get(this.selectionManager.currentMaxIndex).push(v)}if(n.size>0){for(var b="Selection_"+a,I=0;I<this.metadata.length;++I)n.has(I)?this.metadata[I][b]="YES":this.metadata[I][b]="NO";this.metadataDataPossibleValues.set(b,new Set(["YES","NO"])),this.metadataDataTypes.set(b,"categorical"),this.addPossibleMetadataColumn(b),this.selectionManager.addNewSubcohort(n,a,this.metadata.length),g=this.selectionManager.currentMaxIndex,d.push(this.selectionManager.currentMaxIndex),f.push(a),this.selectionManager.metadataColumnsRelatedToSubcohorts.get(this.selectionManager.currentMaxIndex).push(b)}if(s.size>0){for(var x="Selection_"+i,w=0;w<this.metadata.length;++w)s.has(w)?this.metadata[w][x]="YES":this.metadata[w][x]="NO";this.metadataDataPossibleValues.set(x,new Set(["YES","NO"])),this.metadataDataTypes.set(x,"categorical"),this.addPossibleMetadataColumn(x),this.selectionManager.addNewSubcohort(s,i,this.metadata.length),m=this.selectionManager.currentMaxIndex,d.push(this.selectionManager.currentMaxIndex),f.push(i),this.selectionManager.metadataColumnsRelatedToSubcohorts.get(this.selectionManager.currentMaxIndex).push(x)}return this.selectionManager.registeredSubcohorts.size>2&&(this.geneExpressionAvailable>1&&e("#subcohortGeneExpressionVolcanoContentPaneControl").css("display","inline"),this.rppaExpressionAvailable>1&&e("#subcohortRppaExpressionVolcanoContentPaneControl").css("display","inline"),e("#subcohortMutexVolcanoContentPaneControl").css("display","inline")),-1!==p&&(-1!==g&&this.selectionManager.subcohortIndexToItsUnknown.set(p,g),-1!==m&&this.selectionManager.subcohortIndexToItsNegative.set(p,m)),-1!==m&&(-1!==g&&this.selectionManager.subcohortIndexToItsUnknown.set(m,g),-1!==p&&this.selectionManager.subcohortIndexToItsNegative.set(m,p)),d.length>1&&this.createCategoricalVariableFromSelections(d,f),[c,A,h,a,i,d,l]}return-2}},{key:"finalizeSelection",value:function(t,n,o,i){var a=this.finalizeSingleSelection(t,n,o);if(-2===a){var s="<p>0 donors or entire cohort in the requested selection, no action taken</p>";return e("#"+i).empty().append(s),[s]}if(-1===a){var l="<p>A subcohort with the same name exists, no action taken</p>";return e("#"+i).empty().append(l),[l]}var c=r(a,7),A=c[0],u=c[1],h=c[2],d=c[3],f=c[4],p=(c[5],c[6],"<p>"+o+" -> Selected "+t.size+" donors: "+A.join(",")+"</p><br>"),g="<p>"+d+" -> Selected "+n.size+" donors: "+u.join(",")+"</p><br>",m="<p>"+f+" -> Selected "+h.length+" donors: "+h.join(",")+"</p>";return this.setupComplexSelectionQueryBuilder(),e("#"+i).empty().append(p).append(g).append(m),this.updateSelectionToCategoricalControls(),this.refreshMetadata(),[p,g,m]}},{key:"chooseColClasses",value:function(){var t=this,n=new Set,r=new Set;this.possibleMetadataColumns.forEach(function(o,i,a){for(var s="categorical",l=!0,c=!0,A=new Set,u=0;u<t.metadata.length;++u)if(!t.commonSettings.undefinedValues.has(t.metadata[u][i])){if(A.add(t.metadata[u][i]),!e.isNumeric(t.metadata[u][i])&&(l=!1,"string"==typeof t.metadata[u][i]||t.metadata[u][i]instanceof String)){var h=t.metadata[u][i].split(";");if(h.length>0){for(var d=0,f=0;f<h.length;++f)""!==h[f]&&(d+=1);d>1&&(s="multicategorical")}}c=!1}if(c){for(var p=0;p<t.metadata.length;++p)delete t.metadata[p][i];n.add(i),r.add(o)}else{if(l&&A!=new Set(["0","1"])){s="numeric";for(var g=0;g<t.metadata.length;++g)t.metadata[g][i]=+t.metadata[g][i]}else for(var m=0;m<t.metadata.length;++m)"NaN"===t.metadata[m][i].toString()&&(t.metadata[m][i]="NA");t.metadataDataTypes.set(i,s),t.metadataDataPossibleValues.set(i,new Set([]));for(var v=0;v<t.metadata.length;++v)t.metadataDataPossibleValues.get(i).add(t.metadata[v][i])}}),r.forEach(function(e){t.possibleMetadataColumnsReverse.delete(e)}),n.forEach(function(e){t.possibleMetadataColumns.delete(e)});for(var o=0;o<this.metadata.length;++o)this.metadata[o].index=parseInt(this.metadata[o].index)}},{key:"prepareLabelText",value:function(e,t){var n=this,r=[this.metadata[e].donor];return t.forEach(function(t){r.push(t+": "+n.metadata[e][t])}),r.join(", ")}},{key:"prepareHoverText",value:function(e,t){var n=this,r=[this.metadata[e].donor];return t.forEach(function(t){r.push(t+": "+n.metadata[e][t])}),r.join("\n")}},{key:"refreshMetadata",value:function(){this.drawMetadataGrid();var t=e("#metadataMiniSelectionColumnSelector");t.empty(),t.append('<option value="-1">Select Column</option>'),this.possibleMetadataColumns.forEach(function(e,n,r){t.append('<option value="'+n+'">'+n+"</option>")})}},{key:"drawMetadataGrid",value:function(){var t=this,n=e("#mainContent").css("width"),r=[];this.possibleMetadataColumns.forEach(function(e,n,o){r.push({field:n,title:n,sortable:!0,type:"categorical"===t.metadataDataTypes.get(n)?"text":"numeric"})}),e("#cohortMetadataTable").bootstrapTable("destroy").bootstrapTable({width:+n.replace("px",""),height:20*+n.replace("px",""),data:this.metadata,columns:r,showColumns:!0,fixedColumns:!0,fixedNumber:1,search:!0,showExport:!0}).bootstrapTable("refresh")}},{key:"presetWheelSelectors",value:function(){e("#wheelSelector1").empty(),e("#wheelSelector2").empty(),e("#wheelSelector3").empty(),e("#wheelSelector4").empty();var t=[];this.commonSettings.wesMode&&(e("#geneMutTypesWheel1").css("display","none"),e("#tadOffsetWheel1Group").css("display","none")),this.svAvailable>0&&t.push('<option value="sv">SV recurrence</option>'),this.cnvAvailable>0&&(t.push('<option value="cnv">CNV recurrence</option>'),this.commonSettings.wesMode||(t.push('<option value="loh">LOH recurrence</option>'),t.push('<option value="cnnloh">copy-neutral LOH recurrence</option>'),t.push('<option value="cnvloh">CNV+LOH(as Loss) recurrence</option>'))),t.push('<option value="cyt">Cytobands</option>'),(this.svAvailable>0||this.smallVarAvailable>0)&&(this.commonSettings.wesMode||t.push('<option value="ind">Indel recurrence</option>'),t.push('<option value="gene">GeneMut recurrence</option>')),t.push('<option value="off">Off</option>'),t.forEach(function(t){e("#wheelSelector1").append(t),e("#wheelSelector2").append(t),e("#wheelSelector3").append(t),e("#wheelSelector4").append(t)}),e("#wheelSelector1").val("off"),e("#wheelSelector2").val("off"),e("#wheelSelector3").val("cyt"),e("#geneMutTypesWheel3").css("display","none"),e("#tadOffsetWheel3Group").css("display","none"),e("#wheelSelector4").val("off"),this.svAvailable>0&&(e("#wheelSelector1").val("sv"),e("#geneMutTypesWheel1").css("display","none")),this.cnvAvailable>0&&(e("#wheelSelector2").val("cnv"),e("#geneMutTypesWheel2").css("display","none"),e("#tadOffsetWheel2Group").css("display","none")),this.smallVarAvailable>0&&(e("#wheelSelector4").val("gene"),e("#tadOffsetWheel4Group").css("display","none"))}},{key:"addGeneExpressionToMetadata",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortName,suffix:"geneExpressions",columnsToSelect:"*",keyColumn:"gene",keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){var r=e[0];if(void 0!==r){var o=n.references.genes.get(t).geneName+"_expression";n.metadataDataPossibleValues.set(o,new Set),Object.keys(r).forEach(function(e,t){if("gene"!==e&&"varianceRank"!==e){var i=parseInt(e),a=+r[e];n.metadata[i][o]=a,n.metadataDataPossibleValues.get(o).add(a)}}),n.metadataDataTypes.set(o,"numeric"),n.addPossibleMetadataColumn(o),n.refreshMetadata(),n.resetGeneSelector()}else n.resetGeneSelector()}})}},{key:"addRppaExpressionToMetadata",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortName,suffix:"rppaExpressions",columnsToSelect:"*",keyColumn:"rppa",keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){if(e.length>0){var r=e[0],o=n.references.rppaAntibodies[t].rppaName+"_expression";n.metadataDataPossibleValues.set(o,new Set),Object.keys(r).forEach(function(e,t){if("rppa"!==e&&"varianceRank"!==e){var i=parseInt(e),a=+r[e];n.metadata[i][o]=a,n.metadataDataPossibleValues.get(o).add(a)}}),n.metadataDataTypes.set(o,"numeric"),n.addPossibleMetadataColumn(o),n.refreshMetadata()}n.resetRppaSelector()}})}},{key:"addChromosomeArmVariantsToMetadata",value:function(e){var t=this;if(e>0){var n=new Map,o=this.references.chromosomeArms[e];if([["cnvLoss","CN loss"],["cnvGain","CN gain"],["loh","LOH"],["cnnLoh","CNN LOH"]].forEach(function(e){var t=r(e,2),i=t[0],a=t[1];o[i+"DonorContributorIndices"].forEach(function(e){n.has(e)||n.set(e,[]),n.get(e).push(a)})}),0===n.size)return void console.error(o);var i=o.chromosomeArmName+"_variants";this.metadataDataPossibleValues.set(i,new Set);var a=new Set;n.forEach(function(e,n,r){t.metadata[n][i]=e.join(";"),e.forEach(function(e){t.metadataDataPossibleValues.get(i).add(e)}),a.add(n)}),this.donors.forEach(function(e){a.has(e)||(t.metadata[e][i]="NONE",t.metadataDataPossibleValues.get(i).add("NONE"))}),this.metadataDataTypes.set(i,"multicategorical"),this.addPossibleMetadataColumn(i)}this.refreshMetadata(),this.resetChromosomeArmSelector()}},{key:"addCytobandVariantsToMetadata",value:function(e){var t=this;if(e>0){var n=new Map,o=this.references.cytobands[e];if([["vdjSv","VDJ SV"],["sv","SV"],["cnvLoss","CN loss"],["cnvGain","CN gain"],["loh","LOH"],["cnnLoh","CNN LOH"]].forEach(function(e){var t=r(e,2),i=t[0],a=t[1];o[i+"DonorContributorIndices"].forEach(function(e){n.has(e)||n.set(e,[]),n.get(e).push(a)})}),0===n.size)return;var i=o.cytobandName+"_variants";this.metadataDataPossibleValues.set(i,new Set);var a=new Set;n.forEach(function(e,n,r){t.metadata[n][i]=e.join(";"),e.forEach(function(e){t.metadataDataPossibleValues.get(i).add(e)}),a.add(n)}),this.donors.forEach(function(e){a.has(e)||(t.metadata[e][i]="NONE",t.metadataDataPossibleValues.get(i).add("NONE"))}),this.metadataDataTypes.set(i,"multicategorical"),this.addPossibleMetadataColumn(i)}this.refreshMetadata(),this.resetCytobandSelector()}},{key:"addGeneVariantsToMetadata",value:function(t){var n=this;e.ajax({url:n.commonSettings.baseUrl+"/php/getDataFromDb.php",type:"GET",dataType:"json",data:{cohort:n.cohortName,suffix:"geneRecurrence",columnsToSelect:"*",keyColumn:"gene",keysToSearchRaw:t},error:function(e){console.error(e)},success:function(e){var r=new Map,o=e[0],i=n.references.genes.get(t).geneName+"_variants";n.metadataDataPossibleValues.set(i,new Set),Object.keys(o).forEach(function(e,t){if("Gene"!==e){var n=parseInt(e);""!==o[e]&&o[e].split(",").map(function(e){return parseInt(e)}).forEach(function(e){r.has(e)||r.set(e,[]),r.get(e).push(n)})}});var a=new Set;r.forEach(function(e,t,r){var o=e.map(function(e){return n.references.variantTypes[e].variantType});n.metadata[t][i]=o.join(";"),o.forEach(function(e){n.metadataDataPossibleValues.get(i).add(e)}),a.add(t)}),n.donors.forEach(function(e){a.has(e)||(n.metadata[e][i]="NONE",n.metadataDataPossibleValues.get(i).add("NONE"))}),n.metadataDataTypes.set(i,"multicategorical"),n.addPossibleMetadataColumn(i),n.refreshMetadata(),n.resetGeneSelector()}})}},{key:"resetChromosomeArmSelector",value:function(){["allChromosomeArmSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.chromosomeArmInputAwesompleteCurrentChromosomeArm=-1,e("#chromosomeArmSelector").val("")}},{key:"resetCytobandSelector",value:function(){["allCytobandSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.cytobandInputAwesompleteCurrentCytoband=-1,e("#cytobandSelector").val("")}},{key:"resetGeneSelector",value:function(){["allGeneSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.geneInputAwesompleteCurrentGene=-1,e("#geneSelector").val("")}},{key:"resetRppaSelector",value:function(){["allAntibodySelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.rppaInputAwesompleteCurrentRppa=-1,e("#antibodySelector").val("")}},{key:"generalHeaderExport",value:function(){var e=["Donor"];return this.possibleMetadataColumns.forEach(function(t,n,r){"donor"!==n&&e.push(n)}),e}},{key:"textExport",value:function(){var e=this,t=[this.generalHeaderExport()];return this.metadata.forEach(function(n){var r=n.textExport(e.possibleMetadataColumns);t.push(r)}),t}}],[{key:"getCurrentNumericConfiguration",value:function(t,n){return[t,parseInt(e("#metadataNumericSelectionModeSelector").val()),n[parseInt(e("#numericSelectionPossibleValuesSelector").val())],n[parseInt(e("#numericSelectionPossibleValuesSecondarySelector").val())]]}},{key:"getTmpPlotObjects",value:function(e,t){for(var n=[],r=0;r<e.length;++r)n.push({x:r+1,y:e[r],selected:t.has(e[r])});return n}}]),t}()}).call(this,n(0))},function(e,t){!function(t){"use strict";var n={},r={};function o(e){(function(e){var r=function(e){for(var t=[],n="1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm",r=n.length,o=0;o<=63;o++)t.push(n[Math.floor(Math.random()*r)]);return t.join("")}(),o=e.html_id&&"string"==typeof e.html_id?e.html_id:t.default_html_id,i=o+"-"+r,a=c(e.z_index,1e3),s=A(e.color,"rgba(0, 0, 0, 0.7)"),l=null;return Object.defineProperties(this,{uniq_id:{value:r},uniq_html_id:{value:i},html_id:{enumerable:!0,value:o},z_index:{enumerable:!0,get:function(){return a},set:c},color:{enumerable:!0,get:function(){return s},set:A},element:{enumerable:!0,get:function(){return l},set:function(e){if(!(null===e||e instanceof HTMLElement))throw new TypeError("A Veil's element must be an instance of HTMLElement");return l=e}}}),Object.seal(this),n[o]=this;function c(e,t){return a="number"==typeof e?Math.abs(Math.floor(e)):e&&"string"==typeof e&&parseFloat(e)===Number(e)?Math.abs(Math.floor(Number(e))):t||a}function A(e,t){return s="string"==typeof e?e:t||s}}).call(this,e||{})}return o.get=i,o.destroy=function(e){var t=i(e);return t&&(t.remove(),delete n[t.html_id]),!0},o.prototype.inject=function(){var e=this,n=r[e.html_id]={};(n.veil_selector='[data-id="'+e.uniq_html_id+'"]',document.querySelector(n.veil_selector))||(n.loading_class=e.html_id+"-loading-"+e.uniq_id,-1!==document.documentElement.className.indexOf(" "+n.loading_class)||(document.documentElement.className+=" "+n.loading_class,n.activated_class=t.package_name+"-activated "+e.html_id+"-activated "+e.html_id+"-activated-"+e.uniq_id,n.activated_selector="."+e.html_id+"-activated-"+e.uniq_id,n.changing_state_class=t.package_name+"-activated "+e.html_id+"-changing_state "+e.html_id+"-changing_state-"+e.uniq_id,n.changing_state_selector="."+e.html_id+"-changing_state-"+e.uniq_id,document.body?o():document.addEventListener("DOMContentLoaded",o)));return!0;function o(){return e.element=document.body.appendChild(function(){var r=document.createElement("div");return r.id=e.html_id,r.className=t.package_name,r.setAttribute("data-id",e.uniq_html_id),r.style=["position: fixed;","top: 0;","left: 0;","right: 0;","bottom: 0;"].join(" "),r.appendChild(function(){var t=document.createElement("style");return t.appendChild(document.createTextNode([n.veil_selector+" { z-index: -1; background-color: "+e.color+"; opacity: 0; transition-property: opacity; transition-duration: 0.5s; transition-timing-function: linear; transition-delay: 0s; }",n.changing_state_selector+" { z-index: "+e.z_index+"; }",n.activated_selector+" { z-index: "+e.z_index+"; opacity: 1; }"].join("\n"))),t}()),r}()),e.element.addEventListener("transitionend",function(){(function(){var e=r[this.html_id];return!e&&a(),this.element.className=this.element.className.replace(" "+e.changing_state_class,""),!0}).call(e)}),document.documentElement.className=document.documentElement.className.replace(" "+n.loading_class,""),e.element}},o.prototype.remove=function(){return this.element.parentElement.removeChild(this.element),this.element=null,delete r[this.html_id],!0},o.prototype.is_activated=function(){var e=r[this.html_id];return!e&&a(),this.element.className.indexOf(e.activated_class)>=0},o.prototype.is_deactivated=function(){var e=r[this.html_id];return!e&&a(),-1===this.element.className.indexOf(e.activated_class)},o.prototype.activate=function(){var e=r[this.html_id];return!e&&a(),this.is_deactivated()&&(this.element.className=t.package_name+" "+e.changing_state_class+" "+e.activated_class),!0},o.prototype.deactivate=function(){var e=r[this.html_id];return!e&&a(),this.is_activated()&&(this.element.className=t.package_name+" "+e.changing_state_class),!0},o.prototype.toggle=function(){return this.is_activated()?this.deactivate():this.activate()},Object.freeze(o),function(t){try{e.exports=t}catch(e){window.Veil=t}return!0}(o);function i(e){return n[e||t.default_html_id]}function a(){throw new Error("Veils must be inject()ed before they can do anything")}}({package_name:"html-veil",default_html_id:"veil"})},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.CommonSettings=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(1),s=function(e){return e&&e.__esModule?e:{default:e}}(n(343));t.CommonSettings=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(0,a.cleanup)(),this.wesMode=e,this.baseUrl=window.location.protocol+"//"+window.location.host+"/"+window.location.pathname.split("/")[1],this.cohortName=null,this.markedCytobands=new Set,this.markedGenes=new Set,this.hyperzoomDisplayedGenes=new Set,this.hyperzoomMarkedGenes=new Set,this.hyperzoomMarkedCytobands=new Set,this.volcanoMarkedGenes=new Set,this.mainSvgContainerId="#mainContent",this.variantLandscapeSvgId="variantLandscapeSVG",this.mainSvg=(0,i.select)(this.mainSvgContainerId).classed("svg-container",!0).append("svg").classed("svg-content-responsive",!0).attr("viewBox",this.isAnyMarked()?"-500 -500 1000 1000":"-500 -460 1000 1000").attr("id",this.variantLandscapeSvgId).attr("preserveAspectRatio","xMidYMid meet").attr("width","95%").attr("height","95%"),this.svRadius=0,this.wheelGap=5,this.chromosomeAxisRadius=440,this.currentGeneMutTypes=new Set;var n=(0,a.polarToCartesian)(320,0),o=r(n,2),l=o[0],c=o[1],A=(0,a.polarToCartesian)(325,.01),u=r(A,2),h=u[0],d=u[1];this.eventMarkerRadius=Math.sqrt(Math.pow(l-h,2)+Math.pow(c-d,2)),this.transparencyScaling=3,this.minRecurrence=1,this.interactionLock=!1,this.hyperzoomMode=0,this.maxVdjGrade=0,this.undefinedValues=new Set([void 0,NaN,"NA","N.A","N.A.","",1/0]),this.veil=new s.default}return o(t,[{key:"resetCohortSvg",value:function(){this.mainSvg=(0,i.select)(this.mainSvgContainerId).classed("svg-container",!0).append("svg").classed("svg-content-responsive",!0).attr("viewBox",this.isAnyMarked()?"-500 -500 1000 1000":"-500 -460 1000 1000").attr("id",this.variantLandscapeSvgId).attr("preserveAspectRatio","xMinYMin slice").attr("width","95%").attr("height","95%")}},{key:"isAnyMarked",value:function(){return this.markedGenes.size>0||this.hyperzoomMarkedGenes.size>0||this.markedCytobands.size>0||this.hyperzoomMarkedCytobands.size>0}},{key:"lock",value:function(){this.interactionLock=!0,this.veil.inject(),this.veil.activate(),t.lockCommon()}},{key:"fastLock",value:function(){this.interactionLock=!0,t.lockCommon()}},{key:"releaseLock",value:function(){this.interactionLock=!1;try{this.veil.remove()}catch(e){}t.releaseCommon()}},{key:"fastRelease",value:function(){this.interactionLock=!1,t.releaseCommon()}}],[{key:"lockCommon",value:function(){e("#expressionContentPaneControl").addClass("disabled"),e("#mainContentControl").addClass("disabled"),e("#cohortMetadataContentControl").addClass("disabled"),e("#flexiblePlotsContentPaneControl").addClass("disabled"),e("#heatmapContentPaneControl").addClass("disabled"),e("#survivalContentPaneControl").addClass("disabled"),e("#phenotypeExpressionContentPaneControl").addClass("disabled"),e("#correlationGeneExpressionVolcanoContentPaneControl").addClass("disabled"),e("#variantGeneExpressionVolcanoContentPaneControl").addClass("disabled"),e("#subcohortGeneExpressionVolcanoContentPaneControl").addClass("disabled"),e("#subcohortMutexVolcanoContentPaneControl").addClass("disabled"),e("#variantRppaExpressionVolcanoContentPaneControl").addClass("disabled"),e("#subcohortRppaExpressionVolcanoContentPaneControl").addClass("disabled")}},{key:"releaseCommon",value:function(){e("#expressionContentPaneControl").removeClass("disabled"),e("#mainContentControl").removeClass("disabled"),e("#cohortMetadataContentControl").removeClass("disabled"),e("#flexiblePlotsContentPaneControl").removeClass("disabled"),e("#heatmapContentPaneControl").removeClass("disabled"),e("#survivalContentPaneControl").removeClass("disabled"),e("#phenotypeExpressionContentPaneControl").removeClass("disabled"),e("#correlationGeneExpressionVolcanoContentPaneControl").removeClass("disabled"),e("#variantGeneExpressionVolcanoContentPaneControl").removeClass("disabled"),e("#subcohortGeneExpressionVolcanoContentPaneControl").removeClass("disabled"),e("#subcohortMutexVolcanoContentPaneControl").removeClass("disabled"),e("#variantRppaExpressionVolcanoContentPaneControl").removeClass("disabled"),e("#subcohortRppaExpressionVolcanoContentPaneControl").removeClass("disabled")}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.SelectionManager=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.cohortFullDonors=new Set,this.registeredSubcohorts=new Map,this.subcohortIndexToItsUnknown=new Map,this.subcohortIndexToItsNegative=new Map,this.registeredSubcohortNames=new Map,this.registeredSubcohortNamesSet=new Map("",-1),this.clusteringPrefixToSubcohortIndices=new Map,this.metadataColumnsRelatedToSubcohorts=new Map,this.fullCohortSubcohortIndices=new Set,this.currentMaxIndex=-1,this.cohortName=null}return n(t,[{key:"setCohortName",value:function(e){this.cohortName=e}},{key:"addNewSubcohort",value:function(t,n,r){var o=this,i=this.currentMaxIndex+1;this.registeredSubcohortNames.set(i,n),this.registeredSubcohortNamesSet.set(n,i),this.registeredSubcohorts.set(i,new Set),this.metadataColumnsRelatedToSubcohorts.set(i,[]),t.forEach(function(e){o.registeredSubcohorts.get(i).add(e)});var a=this.cohortName+"_"+n+" ("+t.size+"/"+r+")";e("#subcohortDiffSelector").append("<option value="+i+">DIFFERENCE FROM "+a+"</option>"),["#subcohortSelector","#groupSelectorSinglePhenotypeSelector1","#groupSelectorSinglePhenotypeSelector2","#heatmapSubcohortMarkerSelector","#miniSelectionBuilderSubgroupSelector","#flexibleSubcohortMarkerSelector","#subcohortSelectorFlexiblePlotGrid","#subcohortSelectorFlexiblePlotGridDefault","#flexibleSubcohortSelector","#flexibleSubcohortSelectorManifold"].forEach(function(t){e(t).append("<option value="+i+">"+a+"</option>")}),this.currentMaxIndex=i}},{key:"removeSubcohort",value:function(t,n){this.registeredSubcohorts.delete(t);var r=this.registeredSubcohortNames.get(t);this.registeredSubcohortNames.delete(t),this.registeredSubcohortNamesSet.delete(r),["subcohortDiffSelector","subcohortSelector","groupSelectorSinglePhenotypeSelector1","groupSelectorSinglePhenotypeSelector2","heatmapSubcohortMarkerSelector","miniSelectionBuilderSubgroupSelector","subcohortSelectorFlexiblePlotGrid","subcohortSelectorFlexiblePlotGridDefault","flexibleSubcohortSelector","flexibleSubcohortSelectorManifold"].forEach(function(n){e("#"+n+" option[value='"+t+"']").remove()}),n.cleanupSubcohortRelatedColumns(t),this.metadataColumnsRelatedToSubcohorts.delete(t)}},{key:"cleanupSubcohortCluster",value:function(e,t){var n=this,r=[];return this.clusteringPrefixToSubcohortIndices.get(e).forEach(function(e){n.removeSubcohort(e,t),r.push(e)}),this.clusteringPrefixToSubcohortIndices.delete(e),r}}]),t}()}).call(this,n(0))},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.Cohort=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(8),a=n(345),s=n(344),l=n(342),c=n(13),A=n(63),u=n(339),h=n(335),d=n(329),f=n(327),p=n(271),g=n(1),m=n(270),v=n(269),y=n(267),b=n(266),I=n(249);function x(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}t.Cohort=function(){function t(n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.cohortName=r,e("#cohortTitle").html("Loading "+this.cohortName),e("#cohortSelectorGroup").css("display","none"),this.commonSettings=new s.CommonSettings(o),(0,g.transitionToVariantScreen)(this.commonSettings),this.commonSettings.lock(),this.references=n,this.references.registerCohort(this),this.fontManager=new v.FontManager,this.fontManager.registerCohort(this),this.textExportManager=new y.TsvExportManager,this.textExportManager.registerCohort(this),this.selectionManager=new a.SelectionManager,this.cohortMetadata=new l.Metadata(this.commonSettings,this.references,this.selectionManager,this.cohortName,this.textExportManager,this.textExportManager),this.cohortData=new u.CohortData(this.commonSettings,this.references,this.cohortMetadata),this.flexiblePlotManager=new I.FlexiblePlotManagerNew(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.textExportManager),this.heatmapManager=null,this.singlePhenotypePlotManager=null,this.survivalPlotManager=null,this.wheelManager=null,this.vizManager=null,this.correlationGeneExpressionVolcano=null,this.variantGeneExpressionVolcano=null,this.subcohortGeneExpressionVolcano=null,this.subcohortMutexVolcano=null,this.variantRppaExpressionVolcano=null,this.subcohortRppaExpressionVolcano=null,this.currentSubcohortIndex=0,this.selectedDiffSubcohortIndex=0,e("#mainContentControl").css("display","inline"),e("#fontControlsCollapseControl").css("display","inline"),e("#tsvExportControlsCollapseControl").css("display","inline"),this.populateCohort()}return o(t,[{key:"enableControls",value:function(){var t=this;e("#mainContentControl").css("display","inline");var n=["subcohortSelectorGroup","cytobandDescriptionPaneControl","svDescriptionPaneControl","midSizedSvDescriptionPaneControl","vdjSvDescriptionPaneControl","smallVariantDescriptionPaneControl","tadDescriptionPaneControl","geneRecDescriptionPaneControl","selectorControlsCollapseControl","variantVizSpecificGeneSelectorControls","geneSelectorMarkers","geneSelectorMarkersOuter","cytobandSelectorMarkers","cytobandSelectorMarkersOuter","gotoGeneVariants","gotoCytoband","variantVizSpecificCytobandSelectorControls","variantDisplayControls","svgDownloader"];e("#mainContentControl").hasClass("active")&&(0,g.switchElements)([],n),e("#mainContentPane").off("hide.bs.tab").on("hide.bs.tab",function(){(0,g.switchElements)(n,[])}).off("hidden.bs.tab").on("hidden.bs.tab",function(){(0,g.switchElements)(n,[])}).off("shown.bs.tab").on("shown.bs.tab",function(){e('.nav-tabs a[href="#controlsPane"]').tab("show"),(0,g.switchElements)([],n),t.cohortData.VdjSvs.length>0?(e("#maxVdjGrade").slider("setValue",0),e("#maxVdjGradeLabel").html("Max IG/T-cell Receptor Rearrangement Grade: 0"),e("#vdjSvDescriptionPaneControl").css("display","inline")):e("#vdjSvDescriptionPaneControl").css("display","none"),t.fontManager.setAvailableFontSettings("variantView"),t.textExportManager.setAvailableExportSettings("variantView")}),e("#svgDownloader").off("click").on("click",function(){if(t.commonSettings.lock(),e("#mainContentControl").hasClass("active")){var n=t.generateTitle(t.currentSubcohortIndex,t.selectedDiffSubcohortIndex).join("_")+".svg";(0,g.saveSvg)(t.commonSettings.variantLandscapeSvgId,n)}else if(e("#phenotypeExpressionContentPaneControl").hasClass("active"))t.singlePhenotypePlotManager.savePhenotypeSvg();else if(e("#survivalContentPaneControl").hasClass("active"))t.survivalPlotManager.saveSurvivalSvg();else if(e("#flexiblePlotsContentPaneControl").hasClass("active"))t.flexiblePlotManager.saveFlexibleSvg();else{var r=t.determineCurrentVolcano();null!==r&&r.saveVolcanoSvg()}t.commonSettings.releaseLock()}),e("#singleDonorSelector").off("change").on("change",function(){-1===parseInt(this.value)?e("#plotSingleDonor").css("display","none"):e("#plotSingleDonor").css("display","inline")}),e("#plotSingleDonor").off("click").on("click",function(){var n=parseInt(e("#singleDonorSelector").val());t.plotSingleDonor(n)}),this.fontManager.setAvailableFontSettings("variantView"),this.textExportManager.setAvailableExportSettings("variantView")}},{key:"plotSingleDonor",value:function(e){var t=this.cohortMetadata.metadata[e].donor;if(this.selectionManager.registeredSubcohortNamesSet.has(t)){var n=this.selectionManager.registeredSubcohortNames.get(t);this.launchAnalysis(n,-1)}else this.selectionManager.addNewSubcohort(new Set([e]),this.cohortMetadata.metadata[e].donor,this.cohortMetadata.metadata.length),this.cohortMetadata.refreshMetadata(),this.launchAnalysis(this.selectionManager.currentMaxIndex,-1)}},{key:"populateCohort",value:function(){var e=this,t=(0,c.queue)();t.defer(function(t){e.cohortMetadata.fetchCohortInformation(t)}),t.defer(function(t){e.cohortMetadata.fetchCohortMetadata(t)}),t.awaitAll(function(t){if(t)console.error(t);else{e.postMetadataSteps();var n=(0,c.queue)();n.defer(function(t){e.wheelManager.readGeneMutTypes(t)}),n.awaitAll(function(){var t=(0,c.queue)();t.defer(function(t){e.cohortData.fetchRecData(t)}),t.awaitAll(function(){e.postRecurrenceSteps();var t=(0,c.queue)();t.defer(function(t){e.cohortData.fetchVarData(t)}),t.awaitAll(function(){e.postVariantSteps()})})})}})}},{key:"postMetadataSteps",value:function(){this.angleControls(),this.subcohortControls();for(var t=new Set,n=new Set,r=0;r<this.cohortMetadata.metadata.length;++r)t.add(r),this.cohortMetadata.metadata[r].hasOwnProperty("HealthySample")&&"-"!==this.cohortMetadata.metadata[r].HealthySample||n.add(r);this.selectionManager.setCohortName(this.cohortMetadata.cohortName),this.selectionManager.addNewSubcohort(n,"WholeCohort",this.cohortMetadata.metadata.length),this.selectionManager.fullCohortSubcohortIndices.add(this.selectionManager.currentMaxIndex),t.size>n.size&&(this.selectionManager.addNewSubcohort(t,"WholeCohortAndHealthyTissue",this.cohortMetadata.metadata.length),this.selectionManager.fullCohortSubcohortIndices.add(this.selectionManager.currentMaxIndex)),this.wheelManager=new h.WheelManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,0,-1,this.cohortData,this.fontManager),this.determineMinSvRec(0);var o=!1;this.cohortMetadata.geneExpressionAvailable>1&&(this.variantGeneExpressionVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"GeneExpression","variant",this.fontManager,this.textExportManager),this.subcohortGeneExpressionVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"GeneExpression","subcohort",this.fontManager,this.textExportManager),this.correlationGeneExpressionVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"GeneExpression","correlation",this.fontManager,this.textExportManager),e("#variantGeneExpressionVolcanoContentPaneControl").css("display","inline"),e("#correlationGeneExpressionVolcanoContentPaneControl").css("display","inline"),o=!0),this.cohortMetadata.rppaExpressionAvailable>1?(this.variantRppaExpressionVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"RppaExpression","variant",this.fontManager,this.textExportManager),this.subcohortRppaExpressionVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"RppaExpression","subcohort",this.fontManager,this.textExportManager),e("#variantRppaExpressionVolcanoContentPaneControl").css("display","inline"),e("#volcanorppaExpressionControlsAux").css("display","inline"),e("#antibodySelectorGroup").css("display","inline"),e("#selectorControlsCollapseControl").html("Operations on Cytobands, Genes and RPPA Antibodies"),o=!0):e("#selectorControlsCollapseControl").html("Operations on Cytobands and Genes"),o&&(e("#phenotypeExpressionContentPaneControl").css("display","inline"),this.singlePhenotypePlotManager=new m.SinglePhenotypeExpressionManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.textExportManager)),this.cohortMetadata.geneExpressionAvailable>2||this.cohortMetadata.methylomeArrayAvailable>2||this.cohortMetadata.cnvAvailable>2||this.cohortMetadata.svAvailable>2?(this.heatmapManager=new b.HeatmapManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,this.textExportManager),e("#heatmapContentPaneControl").css("display","inline"),this.flexiblePlotManager.enableManifoldControls(),this.flexiblePlotManager.enablePCAControls(),this.flexiblePlotManager.enableTSNEControls(),this.flexiblePlotManager.enableUMAPControls(),this.heatmapManager.enableControls(),e("#PCACollapseControl").css("display","inline"),e("#tSNECollapseControl").css("display","inline")):(e("#PCACollapseControl").css("display","none"),e("#tSNECollapseControl").css("display","none")),this.cohortMetadata.survivalAvailable>1&&(e("#survivalContentPaneControl").css("display","inline"),this.survivalPlotManager=new p.SurvivalPlotManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager)),e("#flexiblePlotsContentPaneControl").css("display","inline"),this.subcohortMutexVolcano=new f.Volcano(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,"Mutex","subcohort",this.fontManager,this.textExportManager),this.registerVolcanoCommonControls(),this.flexiblePlotManager.initialize()}},{key:"postRecurrenceSteps",value:function(){this.wheelManager.readWheelChoices(!0),e("#cohortTitle").html(""),e("#introInfo").empty(),e("#cohortSelectorGroup").css("display","inline"),e("#subcohortSelectorGroup").css("display","inline"),this.plotTitle(0),this.wheelManager.plot(),this.registerSelectorControls()}},{key:"postVariantSteps",value:function(){this.vizManager=new d.VizManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,this.fontManager,0,this.cohortData),this.cohortData.assessChromosomeArmLevelCnvEffects(),this.cohortData.assessFocalCnvEffects(),this.cohortData.propagateTadCnvsToCytobands(),this.cohortData.propagateTadSvsToCytobands(),this.vizManager.plot(0),this.enableControls(),this.commonSettings.releaseLock()}},{key:"cleanupCohort",value:function(){e("#cohortTitle").html("Cleaning-up "+this.cohortName),delete this.selectionManager,this.references.resetCohortContributions(),this.fontManager.resetCohortContributions(),this.textExportManager.resetCohortContributions(),this.resetChromosomeArmSelector(),this.resetGeneSelector(),this.resetRppaSelector(),this.resetCytobandSelector()}},{key:"determineMinSvRec",value:function(t){for(var n=0,r=0;r<this.cohortMetadata.metadata.length;++r)this.selectionManager.registeredSubcohorts.get(t).has(this.cohortMetadata.metadata[r].index)&&"+"===this.cohortMetadata.metadata[r].SV&&(n+=1);var o=Math.ceil(n/5);this.commonSettings.minRecurrence=o,e("#minRec").slider().slider("setAttribute","data-slider-max",this.cohortMetadata.metadata.length).slider("setAttribute","max",this.cohortMetadata.metadata.length).slider("setValue",o),e("#minRecLabel").html("Min SV Event<br/> Recurrence: "+o)}},{key:"launchAnalysis",value:function(t,n){var r=this;this.currentSubcohortIndex=t,this.selectedDiffSubcohortIndex=n,this.determineMinSvRec(t),e("#mainContent").empty(),this.commonSettings.resetCohortSvg(),this.plotTitle(t,n),this.wheelManager=new h.WheelManager(this.commonSettings,this.references,this.cohortMetadata,this.selectionManager,t,n,this.cohortData,this.fontManager);var o=(0,c.queue)();o.defer(function(e){r.wheelManager.readGeneMutTypes(e)}),o.awaitAll(function(){r.wheelManager.readWheelChoices(!0),r.vizManager=new d.VizManager(r.commonSettings,r.references,r.cohortMetadata,r.selectionManager,r.fontManager,t,r.cohortData),setTimeout(function(){r.wheelManager.plot()},0),setTimeout(function(){r.vizManager.plot()},0)})}},{key:"resetSelections",value:function(){e("#svTadDescriptionPaneControl").css("display","none"),e("#indelTadDescriptionPaneControl").css("display","none"),e("#variantDescriptionPaneControl").css("display","none"),e("#cnvTadDescriptionPaneControl").css("display","none"),e("#cytobandDescriptionPaneControl").css("display","none"),e("#expressionContentPaneControl").addClass("disabled"),e("#expressionContentPane").removeAttr("data-toggle"),e("#survivalContentPaneControl").addClass("disabled"),e("#survivalContentPane").removeAttr("data-toggle"),e("#igTraMode").prop("checked",!1)}},{key:"generateTitle",value:function(e,t){var n=this,r="",o=new Set([].concat(x(this.selectionManager.registeredSubcohorts.get(e))).filter(function(e){return n.cohortMetadata.anyVariantAvailableDonors.has(e)}));if(o.size>1)r=0!==e?this.cohortName+"_"+this.selectionManager.registeredSubcohortNames.get(e)+"("+o.size+"/"+this.cohortMetadata.donors.size+")":this.cohortName+"("+o.size+"/"+this.cohortMetadata.donors.size+")";else{var i=Array.from(o)[0];r=this.cohortName+":("+this.cohortMetadata.metadata[i].donor+"/"+this.cohortMetadata.donors.size+")"}var a=[r];return r.length>20&&((a=r.split("("))[0].length>20?(a=r.split("-"))[1]="-"+a[1]:a[1]="("+a[1]),a}},{key:"plotTitle",value:function(t){var n=this.generateTitle(t),r=this.commonSettings.mainSvg,o=this.commonSettings.markedGenes.size>0?-460:-500,a=(0,i.path)();a.moveTo(-470,o+60),a.lineTo(500,o+60),a.closePath(),e("#cohortNameFrame").remove(),r.append("path").attr("id","cohortNameFrame").attr("d",a);var s=this.fontManager.fontTree.get("variantViewFontTargetSelector").get("title").generateFontCssText();if(e("#cohortNameSvg").remove(),r.append("text").append("textPath").attr("class","markerTextCohort").attr("xlink:href","#cohortNameFrame").attr("id","cohortNameSvg").style("dominant-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("display","inline").style("font",s).html(n[0]),2===n.length){var l=1.2*e("#cohortNameSvg").get(0).getBoundingClientRect().height,c=(0,i.path)();c.moveTo(-470,o+60+l),c.lineTo(500,o+60+l),c.closePath(),e("#cohortNameFrame2").remove(),e("#cohortNameSvgLine2").remove(),r.append("path").attr("id","cohortNameFrame2").attr("d",c),r.append("text").append("textPath").attr("class","markerTextCohort").attr("xlink:href","#cohortNameFrame2").attr("id","cohortNameSvgLine2").style("dominant-baseline","hanging").style("text-anchor","start").attr("startOffset","0%").style("display","inline").style("font",s).html(n[1])}}},{key:"angleControls",value:function(){var t=this,n=this;this.resetChromosomeSliders(),(0,g.generalizedSliderEvents)("rotationAngleSelector",function(e){return e},"Rotation Angle:",function(e){t.references.offsetRadians=parseInt(e)*(Math.PI/180),t.updateAngles()});for(var r=function(e){(0,g.generalizedSliderEvents)("armcoeff"+e,function(e){return Math.pow(2,e-7)+"x"},n.references.chromosomeArms[e].chromosomeArmName+":",function(r){var o=Math.pow(2,r-7);t.references.chromosomeArms[e].coefficient=o;var i=n.references.chromosomeArms[e];t.references.chromosomes[i.chromosomeIndex].daughterCoefficients.set(i.chromosomeArmIndex,o);for(var a=i.firstCytobandIndex;a<=i.lastCytobandIndex;++a)t.references.cytobands[a].coefficient=o;t.updateAngles()})},o=1;o<49;++o)r(o);var i=function(r){(0,g.generalizedSliderEvents)("coeff"+r,function(e){return Math.pow(2,e-7)+"x"},n.references.chromosomes[r].chromosomeName+":",function(o){var i=o,a=Math.pow(2,i-7);t.references.chromosomes[r].coefficient=a;for(var s=n.references.chromosomes[r],l=s.firstCytobandIndex;l<=s.lastCytobandIndex;++l)t.references.cytobands[l].coefficient=a;for(var c=t.references.chromosomes[r].firstChromosomeArmIndex;c<=t.references.chromosomes[r].lastChromosomeArmIndex;++c)e("#armcoeff"+c).slider("setValue",i),e("#armcoeff"+c+"Label").html(n.references.chromosomeArms[c].chromosomeArmName+": "+a+"x");t.updateAngles()})};for(o=1;o<28;++o)i(o);(0,g.generalizedSliderEvents)("coeff28",function(e){return Math.pow(2,e-7)+"x"},"GL*:",function(e){for(var n=Math.pow(2,e-7),r=28;r<t.references.chromosomes.length;++r){t.references.chromosomes[r].coefficient=n;for(var o=t.references.chromosomes[r],i=o.firstCytobandIndex;i<=o.lastCytobandIndex;++i)t.references.cytobands[i].coefficient=n}t.updateAngles()}),e("#resetChrs").off("click").on("click",function(){n.references.cytobands.forEach(function(e){e.resetCoefficient()}),n.references.chromosomes.forEach(function(e){e.resetCoefficient()}),n.resetChromosomeSliders(),setTimeout(function(){n.updateAngles()},0)}),e("#resetChrArms").off("click").on("click",function(){n.references.cytobands.forEach(function(e){e.resetCoefficient()}),n.references.chromosomes.forEach(function(e){e.resetCoefficient()}),n.resetChromosomeSliders(),setTimeout(function(){n.updateAngles()},0)})}},{key:"subcohortControls",value:function(){var t=this;e("#subcohortSelector").off("change").on("change",function(){var n=parseInt(this.value),r=parseInt(e("#subcohortDiffSelector").val());n!==r&&t.launchAnalysis(n,r)}),e("#subcohortDiffSelector").off("change").on("change",function(){var n=parseInt(this.value),r=parseInt(e("#subcohortSelector").val());r!==n&&t.launchAnalysis(r,n)})}},{key:"resetChromosomeSliders",value:function(){for(var t=1;t<28;++t){var n=this.references.chromosomes[t].coefficientInit,r=Math.log2(n)+7;e("#coeff"+t).slider().slider("setValue",r),e("#coeff"+t+"Label").html(this.references.chromosomes[t].chromosomeName+": "+n+"x")}var o=this.references.chromosomes[28].coefficientInit,i=Math.log2(o)+7;e("#coeff28").slider("setValue",i),e("#coeff28Label").html("GL*: "+o+"x");for(var a=1;a<49;++a){var s=this.references.chromosomeArms[a].coefficientInit,l=Math.log2(s)+7;e("#armcoeff"+a).slider().slider("setValue",l),e("#armcoeff"+a+"Label").html(this.references.chromosomeArms[a].chromosomeArmName+": "+s+"x")}e("#rotationAngleSelector").val("0"),e("#rotationAngleSelectorLabel").html("Rotation Angle: 0")}},{key:"updateAngles",value:function(){this.references.assessCurrentCumulativeSizes(),this.wheelManager.updateAngles(),this.vizManager.updateAngles()}},{key:"selectTad",value:function(t,n){this.vizManager.tracerCleanup();var o=this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex),i=this.references.tads[t].annotate(this.cohortMetadata,this.references,o,n),a=r(i,2),s=a[0],l=a[1];e("#tadDescription").html(s),e('.nav-tabs a[href="#tadDescriptionPane"]').tab("show"),e("#fetchSmallVariantsFromTad").css("display","inline"),this.registerTadControls(t,n,l),this.vizManager.focusOnTad(t)}},{key:"registerTadControls",value:function(t,n,r){var o=this;e("#geneInTadSelector").empty().append("<option value=0>Select Gene</option>"),this.references.tads[t].geneIndices.forEach(function(t){e("#geneInTadSelector").append("<option value="+t+">"+o.references.genes.get(t).geneName+"</option>")}),e("#tadDescriptionPaneControl").css("display","inline"),e("#svDescriptionPaneControl").css("display","inline"),e("#cytobandDescriptionPaneControl").css("display","none"),e("#resetFocus").css("display","inline");var i=this,a=this.references.tads[t].cytobandIndices,s=0,l=[];a.forEach(function(e){var t=o.references.cytobands[e].coefficient;t>s&&(s=t),l.push(o.references.cytobands[e].cytobandName)});var c=Math.log2(s)+7,A=l.join(", ");e("#coeffCurrentTadLabel").html(A+": "+s+"x"),e("#coeffCurrentTad").slider("setValue",c).off("change").on("change",function(){var t=Math.pow(2,+e(this).val()-7);e("#coeffCurrentTadLabel").html(A+": "+t+"x")}).off("slideStop").on("slideStop",function(){var t=Math.pow(2,+e(this).val()-7);a.forEach(function(e){i.references.cytobands[e].coefficient=t}),setTimeout(function(){i.updateAngles()},0)});var u=t-1;0===u&&(u=3486),e("#tadSweepLeft").off("click").on("click",function(){o.selectTad(u,n)});var h=t+1;3487===h&&(h=1),e("#tadSweepRight").off("click").on("click",function(){o.selectTad(h,n)}),e("#createSubcohortFromTadRecurrence").css("display","none").off("click").on("click",function(){var t=new Set([].concat(x(o.cohortMetadata.anyVariantAvailableDonors)).filter(function(e){return!o.selectionManager.registeredSubcohorts.get(o.currentSubcohortIndex).has(e)})),n=e("#tadRecurrenceSubcohortSelectionName"),i=n.val();o.cohortMetadata.finalizeSelection(r,t,i,"subcohortSelectionFromTadRecurrenceDescription"),n.val("")}),e("#tadRecurrenceSubcohortSelectionName").off("change").on("change",function(){i.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#createSubcohortFromTadRecurrence").css("display","none"):e("#createSubcohortFromTadRecurrence").css("display","inline")})}},{key:"selectCytoband",value:function(t){this.vizManager.tracerCleanup(),e('.nav-tabs a[href="#cytobandDescriptionPane"]').tab("show"),e("#fetchSmallVariantsFromCytoband").css("display","inline"),this.registerCytobandControls(t),e("#cytobandDescription").html(this.references.cytobands[t].annotate(this.references,this.cohortMetadata)),this.vizManager.focusOnCytoband(t)}},{key:"registerCytobandControls",value:function(t){var n=this;e("#geneInCytobandSelector").empty().append("<option value=0>Select Gene</option>"),this.references.cytobands[t].getGeneIndices(this.references).forEach(function(t){e("#geneInCytobandSelector").append("<option value="+t+">"+n.references.genes.get(t).geneName+"</option>")}),e("#tadDescriptionPaneControl").css("display","none"),e("#cytobandDescriptionPaneControl").css("display","inline"),e("#resetFocus").css("display","inline"),e("#svDescriptionPaneControl").css("display","inline");var r=this,o=this.references.cytobands[t].coefficient,i=Math.log2(o)+7;e("#coeffCurrentCytobandLabel").html(this.references.cytobands[t].cytobandName+": "+o+"x"),this.selectionManager.currentCytoband=t,e("#coeffCurrentCytoband").slider("setValue",i).off("change").on("change",function(){var n=Math.pow(2,+e(this).val()-7);e("#coeffCurrentCytobandLabel").html(r.references.cytobands[t].cytobandName+": "+n+"x")}).off("slideStop").on("slideStop",function(){r.references.cytobands[t].coefficient=Math.pow(2,+e(this).val()-7),setTimeout(function(){r.updateAngles()},0)}),e("#submitCytobandChoices").off("click").on("click",function(){});var a=t-1;0===a&&(a=this.references.cytobands.length-1),e("#cytobandSweepLeft").off("click").on("click",function(){n.selectCytoband(a)});var s=t+1;s===this.references.cytobands.length&&(s=1),e("#markCytobandFromDesc").css("display","inline").off("click").on("click",function(){n.wheelManager.markCytoband(t),e("#markCytobandFromDesc").css("display","none")}),e("#cytobandSweepRight").off("click").on("click",function(){n.selectCytoband(s)})}},{key:"selectGeneRecurrence",value:function(t,n){var r=this;if(this.vizManager.tracerCleanup(),e("#fetchSmallVariantsFromGene").css("display","inline"),e("#resetFocus").css("display","inline"),e("#svDescriptionPaneControl").css("display","inline"),e("#geneRecDescriptionPaneControl").css("display","inline"),e("#tadDescriptionPaneControl").css("display","none"),e("#cytobandDescriptionPaneControl").css("display","none"),this.references.genes.has(t)){var o=(0,c.queue)();o.defer(function(e){r.cohortData.fetchSingleGeneRecurrenceData(e,t)}),o.awaitAll(function(){r.registerGeneControls(t,n),r.vizManager.focusOnGene(t)})}}},{key:"registerGeneControls",value:function(t,n){for(var o=this,i=new Set,a=0;a<this.references.variantTypes.length-1;++a)i.add(a);var s=new A.VariantRecurrenceEntryGene(this.cohortData.currentSingleGeneRecurrence,i),l=this.references.genes.get(t),c=this.selectionManager.registeredSubcohorts.get(this.currentSubcohortIndex),u=l.annotateDonorContributions(this.cohortMetadata,this.references,s.contributions,n,c),h=r(u,2),d=h[0],f=h[1];e("#geneRecDescription").html(d);var p=this.references.genes.get(t).cytobandIndices,g=0,m=[];p.forEach(function(e){var t=o.references.cytobands[e].coefficient;t>g&&(g=t),m.push(o.references.cytobands[e].cytobandName)});var v=Math.log2(g)+7,y=m.join(", ");e("#coeffCurrentGeneLabel").html(y+": "+g+"x");var b=this;e("#coeffCurrentGene").slider("setValue",v).off("change").on("change",function(){var t=Math.pow(2,+e(this).val()-7);e("#coeffCurrentGeneLabel").html(y+": "+t+"x")}).off("slideStop").on("slideStop",function(){var t=Math.pow(2,+e(this).val()-7);p.forEach(function(e){b.references.cytobands[e].coefficient=t}),setTimeout(function(){b.updateAngles()},0)}),e("#addGeneExpressionToMetadataFromDesc").css("display","inline").off("click").on("click",function(){o.cohortMetadata.addGeneExpressionToMetadata(t,o.flexiblePlotManager),e("#addGeneExpressionToMetadataFromDesc").css("display","none")}),e("#addGeneVariantsToMetadataFromDesc").css("display","inline").off("click").on("click",function(){o.cohortMetadata.addGeneVariantsToMetadata(t,o.flexiblePlotManager),e("#addGeneVariantsToMetadataFromDesc").css("display","none")}),e("#markGeneFromDesc").css("display","inline").off("click").on("click",function(){o.wheelManager.markGene(t),e("#markGeneFromDesc").css("display","none")}),e("#createSubcohortFromGeneRecurrence").css("display","none").off("click").on("click",function(){var t=f,n=new Set([].concat(x(o.cohortMetadata.anyVariantAvailableDonors)).filter(function(e){return!o.selectionManager.registeredSubcohorts.get(o.currentSubcohortIndex).has(e)})),r=e("#geneRecurrenceSubcohortSelectionName"),i=r.val();o.cohortMetadata.finalizeSelection(t,n,i,"subcohortSelectionFromGeneRecurrenceDescription"),r.val("")}),e("#geneRecurrenceSubcohortSelectionName").off("change").on("change",function(){b.selectionManager.registeredSubcohortNamesSet.has(this.value)?e("#createSubcohortFromGeneRecurrence").css("display","none"):e("#createSubcohortFromGeneRecurrence").css("display","inline")}),e('.nav-tabs a[href="#geneRecDescriptionPane"]').tab("show")}},{key:"registerSelectorControls",value:function(){var t=this,n=this;this.resetChromosomeArmSelector(),this.resetGeneSelector(),this.resetCytobandSelector(),this.resetRppaSelector(),e("#geneSelector").off("awesomplete-selectcomplete").on("awesomplete-selectcomplete",function(){var e=parseInt(this.value),t=n.references.genes.get(e).geneName;n.references.geneInputAwesompleteCurrentGene=e,this.value=t,n.enableGeneSelectorFeatures()}),e("#cytobandSelector").off("awesomplete-selectcomplete").on("awesomplete-selectcomplete",function(){var e=parseInt(this.value),t=n.references.cytobands[e].cytobandName;n.references.cytobandInputAwesompleteCurrentCytoband=e,this.value=t,n.enableCytobandSelectorFeatures()}),e("#chromosomeArmSelector").off("awesomplete-selectcomplete").on("awesomplete-selectcomplete",function(){var e=parseInt(this.value),t=n.references.chromosomeArms[e].chromosomeArmName;n.references.chromosomeArmInputAwesompleteCurrentChromosomeArm=e,this.value=t,n.enableChromosomeArmSelectorFeatures()}),e("#antibodySelector").off("awesomplete-selectcomplete").on("awesomplete-selectcomplete",function(){var e=parseInt(this.value),t=n.references.rppaAntibodies[e].rppaName;n.references.rppaInputAwesompleteCurrentRppa=e,this.value=t,n.enableRppaSelectorFeatures()}),e("#markGene").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;if(e("#mainContentControl").hasClass("active"))t.wheelManager.markGene(n);else{var r=t.determineCurrentVolcano();null!==r&&r.markGene(n,-1,!1)}t.resetGeneSelector()}),e("#markCytoband").off("click").on("click",function(){var n=t.references.cytobandInputAwesompleteCurrentCytoband;e("#mainContentControl").hasClass("active")&&t.wheelManager.markCytoband(n),t.resetCytobandSelector()}),e("#startCorrelationVolcanoAnalysisGene").off("click").on("click",function(){var e=t.references.geneInputAwesompleteCurrentGene,n=t.determineCurrentVolcano();null!==n&&n.launchCorrelationAnalysis(e),t.resetGeneSelector()}),e("#clearMarkedGenes").off("click").on("click",function(){if(e("#mainContentControl").hasClass("active"))t.wheelManager.clearMarkedGenes();else{var n=t.determineCurrentVolcano();null!==n&&n.clearMarkedGenes()}}),e("#clearMarkedCytobands").off("click").on("click",function(){e("#mainContentControl").hasClass("active")&&t.wheelManager.clearMarkedCytobands()}),e("#markCytobandAllGenes").off("click").on("click",function(){var n=t.references.cytobandInputAwesompleteCurrentCytoband;if(e("#mainContentControl").hasClass("active"))t.wheelManager.markAllGenesOnCytoband(n);else{var r=t.determineCurrentVolcano();null!==r&&r.markAllGenesOnCytoband(n)}t.resetCytobandSelector()}),e("#hideCytobandAllGenes").off("click").on("click",function(){var n=t.references.cytobandInputAwesompleteCurrentCytoband;if(e("#mainContentControl").hasClass("active"));else{var r=t.determineCurrentVolcano();null!==r&&r.hideAllGenesOnCytoband(n)}t.resetCytobandSelector()}),e("#markAllGenesOnCytobandsCarryingGene").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;if(e("#mainContentControl").hasClass("active"))t.wheelManager.markAllGenesOnCytobandsContainingGene(n);else{var r=t.determineCurrentVolcano();null!==r&&r.markAllGenesOnCytobandsContainingGene(n)}t.resetGeneSelector()}),e("#markCytobandsCarryingGene").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;e("#mainContentControl").hasClass("active")&&t.wheelManager.markCytobandsCarryingGene(n),t.resetGeneSelector()}),e("#hideAllGenesOnCytobandsCarryingGene").off("click").on("click",function(){var e=t.references.geneInputAwesompleteCurrentGene,n=t.determineCurrentVolcano();null!==n&&n.hideAllGenesOnCytobandsContainingGene(e),t.resetGeneSelector()}),e("#addGeneExpressionToMetadata").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;e("#geneSelector").val("FETCHING"),t.cohortMetadata.addGeneExpressionToMetadata(n)}),e("#addAntibodyExpressionToMetadata").off("click").on("click",function(){var n=t.references.rppaInputAwesompleteCurrentRppa;e("#antibodySelector").val("FETCHING"),t.cohortMetadata.addRppaExpressionToMetadata(n)}),e("#addChromosomeArmVariantsToMetadata").off("click").on("click",function(){var e=t.references.chromosomeArmInputAwesompleteCurrentChromosomeArm;t.cohortMetadata.addChromosomeArmVariantsToMetadata(e)}),e("#addCytobandVariantsToMetadata").off("click").on("click",function(){var e=t.references.cytobandInputAwesompleteCurrentCytoband;t.cohortMetadata.addCytobandVariantsToMetadata(e)}),e("#addGeneVariantsToMetadata").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;e("#geneSelector").val("FETCHING"),t.cohortMetadata.addGeneVariantsToMetadata(n)}),e("#gotoGeneVariants").off("click").on("click",function(){var n=t.references.geneInputAwesompleteCurrentGene;e("#mainContentControl").hasClass("active")||(0,g.transitionToVariantScreen)(t.commonSettings);for(var r=new Set,o=3;o>=0;o--)t.wheelManager.wheelGeneMutTypes[o].size>0&&(r=t.wheelManager.wheelGeneMutTypes[o]);t.references.emitGeneClick(n,r)}),e("#gotoCytoband").off("click").on("click",function(){var n=t.references.cytobandInputAwesompleteCurrentCytoband;e("#mainContentControl").hasClass("active")||(0,g.transitionToVariantScreen)(t.commonSettings),t.references.emitCytobandClick(n)})}},{key:"resetGeneSelector",value:function(){["allGeneSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.geneInputAwesompleteCurrentGene=-1,e("#geneSelector").val("")}},{key:"resetChromosomeArmSelector",value:function(){["allChromosomeArmSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.chromosomeArmInputAwesompleteCurrentChromosomeArm=-1,e("#chromosomeArmSelector").val("")}},{key:"resetCytobandSelector",value:function(){["allCytobandSelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.cytobandInputAwesompleteCurrentCytoband=-1,e("#cytobandSelector").val("")}},{key:"resetRppaSelector",value:function(){["allAntibodySelectorControls"].forEach(function(t){e("#"+t).css("display","none")}),this.references.rppaInputAwesompleteCurrentRppa=-1,e("#antibodySelector").val("")}},{key:"enableGeneSelectorFeatures",value:function(){["allGeneSelectorControls"].forEach(function(t){e("#"+t).css("display","inline")}),this.cohortMetadata.geneExpressionAvailable>0&&e("#addGeneExpressionToMetadata").css("display","inline")}},{key:"enableCytobandSelectorFeatures",value:function(){["allCytobandSelectorControls"].forEach(function(t){e("#"+t).css("display","inline")})}},{key:"enableChromosomeArmSelectorFeatures",value:function(){["allChromosomeArmSelectorControls"].forEach(function(t){e("#"+t).css("display","inline")})}},{key:"enableRppaSelectorFeatures",value:function(){["allAntibodySelectorControls"].forEach(function(t){e("#"+t).css("display","inline")})}},{key:"registerVolcanoCommonControls",value:function(){var t=this;e("#volcanoDetailedView").off("click").on("click",function(){var e=t.determineCurrentVolcano().singleGeneExpression;if(e)e.convertToFullMode();else{var n=t.determineCurrentVolcano().singleRppaExpression;n&&n.convertToFullMode()}}),e("#volcanoClearGene").off("click").on("click",function(){t.determineCurrentVolcano().removeLastMarkedGene()}),e("#volcanoHideGene").off("click").on("click",function(){t.determineCurrentVolcano().hideLastMarkedGene()}),e("#volcanoPubmedGene").off("click").on("click",function(){t.determineCurrentVolcano().pubmedCurrentGene()}),e("#volcanoSetAsTopP").off("click").on("click",function(){t.determineCurrentVolcano().setCurrentGeneAsTopY()}),e("#volcanoSetAsTopFoldChange").off("click").on("click",function(){t.determineCurrentVolcano().setCurrentGeneAsTopX()}),e("#volcanoAddGeneExpressionToMetadata").off("click").on("click",function(){t.determineCurrentVolcano().addCurrentGeneExpressionToMetadata()}),e("#volcanoAddGeneVariantsToMetadata").off("click").on("click",function(){t.determineCurrentVolcano().addCurrentGeneVariantsToMetadata()}),e("#volcanoGoToGene").off("click").on("click",function(){var n=t.determineCurrentVolcano(),r=n.displaySettings.lastVolcanoItemIndex;if(-1!==r){var o=n.data[n.volcanoIndexToDataIndex.get(r)].getGeneIndices()[0];e("#mainContentControl").hasClass("active")||(0,g.transitionToVariantScreen)(t.commonSettings);for(var i=new Set,a=3;a>=0;a--)t.wheelManager.wheelGeneMutTypes[a].size>0&&(i=t.wheelManager.wheelGeneMutTypes[a]);t.references.emitGeneClick(o,i)}})}},{key:"determineCurrentVolcano",value:function(){return e("#variantGeneExpressionVolcanoContentPaneControl").hasClass("active")?this.variantGeneExpressionVolcano:e("#subcohortGeneExpressionVolcanoContentPaneControl").hasClass("active")?this.subcohortGeneExpressionVolcano:e("#subcohortMutexVolcanoContentPaneControl").hasClass("active")?this.subcohortMutexVolcano:e("#variantRppaExpressionVolcanoContentPaneControl").hasClass("active")?this.variantRppaExpressionVolcano:e("#subcohortRppaExpressionVolcanoContentPaneControl").hasClass("active")?this.subcohortRppaExpressionVolcano:e("#correlationGeneExpressionVolcanoContentPaneControl").hasClass("active")?this.correlationGeneExpressionVolcano:null}}]),t}()}).call(this,n(0))},function(e,t,n){var r,o=o||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=function(){return e.URL||e.webkitURL||e},n=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in n,o=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},s=function(e){setTimeout(function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()},4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=function(c,A,u){u||(c=l(c));var h,d=this,f="application/octet-stream"===c.type,p=function(){!function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,e)}catch(e){a(e)}}}(d,"writestart progress write writeend".split(" "))};if(d.readyState=d.INIT,r)return h=t().createObjectURL(c),void setTimeout(function(){n.href=h,n.download=A,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(n),p(),s(h),d.readyState=d.DONE});!function(){if((i||f&&o)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=i?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,d.readyState=d.DONE,p()},n.readAsDataURL(c),void(d.readyState=d.INIT)}h||(h=t().createObjectURL(c)),f?e.location.href=h:e.open(h,"_blank")||(e.location.href=h),d.readyState=d.DONE,p(),s(h)}()},A=c.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(A.abort=function(){},A.readyState=A.INIT=0,A.WRITING=1,A.DONE=2,A.error=A.onwritestart=A.onprogress=A.onwrite=A.onabort=A.onerror=A.onwriteend=null,function(e,t,n){return new c(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==e&&e.exports?e.exports.saveAs=o:null!==n(9)&&null!==n(19)&&(void 0===(r=function(){return o}.call(t,n,t,e))||(e.exports=r))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return void 0!==e},o=function(e){return null!==e&&"object"==typeof e},i=r(window)&&r(window.getComputedStyle);t.default=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=arguments.length<=2||void 0===arguments[2]||arguments[2];if(!function(e){return!!o(e)&&(r(window)&&o(window.Node)?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName)}(e))throw new Error("parameter 1 is not of type 'Element'");if(!1===n)return t;if(i)var a=e.ownerDocument.defaultView.getComputedStyle(e,null),s=!0===n?a:Object.keys(n);else a=r(e.currentStyle)?e.currentStyle:e.style,s=!0===n?Object.keys(a):Object.keys(n);for(var l=0,c=s.length;l<c;l++){var A=s[l],u=!0===n||n[A];if(!1!==u&&r(u)){var h=i?a.getPropertyValue(A):a[A];"string"==typeof h&&""!==h&&(!0!==u&&h===u||(t[A]=h))}}return t},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function o(e){return e&&e.__esModule?e:{default:e}}var i=o(n(348)),a=o(n(347)),s={"alignment-baseline":"auto","baseline-shift":"baseline",clip:"auto","clip-path":"none","clip-rule":"nonzero",color:"rgb(51, 51, 51)","color-interpolation":"srgb","color-interpolation-filters":"linearrgb","color-profile":"auto","color-rendering":"auto",cursor:"auto",direction:"ltr",display:"inline","dominant-baseline":"auto","enable-background":"",fill:"rgb(0, 0, 0)","fill-opacity":"1","fill-rule":"nonzero",filter:"none","flood-color":"rgb(0, 0, 0)","flood-opacity":"1",font:"","font-family":"normal","font-size":"medium","font-size-adjust":"auto","font-stretch":"normal","font-style":"normal","font-variant":"normal","font-weight":"400","glyph-orientation-horizontal":"0deg","glyph-orientation-vertical":"auto","image-rendering":"auto",kerning:"auto","letter-spacing":"0","lighting-color":"rgb(255, 255, 255)",marker:"","marker-end":"none","marker-mid":"none","marker-start":"none",mask:"none",opacity:"1",overflow:"visible","paint-order":"fill","pointer-events":"auto","shape-rendering":"auto","stop-color":"rgb(0, 0, 0)","stop-opacity":"1",stroke:"none","stroke-dasharray":"none","stroke-dashoffset":"0","stroke-linecap":"butt","stroke-linejoin":"miter","stroke-miterlimit":"4","stroke-opacity":"1","stroke-width":"1","text-anchor":"start","text-decoration":"none","text-rendering":"auto",startOffset:"0%","unicode-bidi":"normal",visibility:"visible","word-spacing":"0px","writing-mode":"lr-tb"},l=["id","xml: base","xml: lang","xml: space","height","result","width","x","y","xlink: href","href","style","class","d","pathLength","startOffset","x","y","dx","dy","glyphRef","format","x1","y1","x2","y2","rotate","textLength","cx","cy","r","rx","ry","fx","fy","width","height","refX","refY","orient","markerUnits","markerWidth","markerHeight","maskUnits","transform","viewBox","version","preserveAspectRatio","xmlns","points","offset","xlink:href"],c=["clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cursor","direction","fill","fill-opacity","fill-rule","font","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-orientation-horizontal","glyph-orientation-vertical","image-rendering","kerning","letter-spacing","marker","marker-end","marker-mid","marker-start","pointer-events","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-rendering","transform","visibility","white-space","word-spacing","writing-mode"],A=function(e){return void 0!==e},u=function(e){return void 0===e},h=function(e){return null!==e&&"object"==typeof e};var d="undefined"!=typeof document&&"download"in document.createElement("a")&&"function"==typeof MouseEvent;function f(e,t){if(d){var n=document.createElement("a");return n.setAttribute("href",e),n.setAttribute("download",t),n.dispatchEvent(new MouseEvent("click")),!0}return"undefined"!=typeof window&&(window.open(e,"_blank",""),!0)}function p(e,t,n){var r=document.createElement("canvas"),o=r.getContext("2d"),i=new Image;return i.onload=function(){r.width=i.width,r.height=i.height,o.drawImage(i,0,0),n(r)},i.src=e,!0}var g=!!window.MSInputMethodContext&&!!document.documentMode;c.forEach(function(e){e in s&&(s[e]=!0)});var m=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.attrs,r=t.styles;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.attrs=void 0===n?l:n,this.styles=void 0===r?s:r}return r(e,null,[{key:"getSvg",value:function(e){if(u(e)||""===e?e=document.body.querySelector("svg"):"string"==typeof e&&(e=document.body.querySelector(e)),e&&"svg"!==e.tagName&&(e=e.querySelector("svg")),!function(e){return!!h(e)&&(A(window)&&h(window.Node)?e instanceof window.Node:"number"==typeof e.nodeType&&"string"==typeof e.nodeName)}(e))throw new Error("svgsaver: Can't find an svg element");return e}},{key:"getFilename",value:function(e,t,n){return t&&""!==t||(t=(e.getAttribute("title")||"untitled")+"."+n),encodeURI(t)}}]),r(e,[{key:"cloneSVG",value:function(t){var n=function(e,t,n){var r=e.cloneNode(!0);return function e(t,n,r,o){r(t,n);for(var i=t.childNodes,a=0;a<i.length;a++)e(i[a],n.childNodes[a],r,o);o(t,n)}(e,r,function(e,t){t.style&&(0,i.default)(e,t.style,n)},function(e,r){r.style&&r.parentNode&&function(e,t){t=t||e.parentNode.style,c.forEach(function(n){e.style[n]===t[n]&&e.style.removeProperty(n)})}(r),r.attributes&&function(e,t,n){!0!==t&&Array.prototype.slice.call(e.attributes).forEach(function(r){r.specified&&(""===t||!1===t||u(n[r.name])&&t.indexOf(r.name)<0)&&e.removeAttribute(r.name)})}(r,t,n)}),r}(t=e.getSvg(t),this.attrs,this.styles);return n.setAttribute("xmlns","http://www.w3.org/2000/svg"),n.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),n.setAttribute("version",1.1),n.setAttribute("width",n.getAttribute("width")||"500"),n.setAttribute("height",n.getAttribute("height")||"900"),n}},{key:"getHTML",value:function(e){var t=this.cloneSVG(e);return t.outerHTML||(t.removeAttribute("xmlns"),t.removeAttribute("xmlns:xlink"),t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns","http://www.w3.org/2000/svg"),t.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),(new window.XMLSerializer).serializeToString(t))}},{key:"getBlob",value:function(e){var t=this.getHTML(e);return new Blob([t],{type:"text/xml"})}},{key:"getUri",value:function(e){var t=encodeURIComponent(this.getHTML(e));return A(window.btoa)?"data:image/svg+xml;base64,"+window.btoa(unescape(t)):"data:image/svg+xml,"+t}},{key:"asSvg",value:function(t,n){return t=e.getSvg(t),n=e.getFilename(t,n,"svg"),"function"==typeof Blob?a.default.saveAs(this.getBlob(t),n):f(this.getUri(t),n)}},{key:"getPngUri",value:function(t,n){return g&&console.error("svgsaver: getPngUri not supported on IE11"),t=e.getSvg(t),e.getFilename(t,null,"png"),p(this.getUri(t),0,function(e){n(e.toDataURL("image/png"))})}},{key:"asPng",value:function(t,n){return g&&console.error("svgsaver: asPng not supported on IE11"),t=e.getSvg(t),n=e.getFilename(t,n,"png"),function(e,t){return p(e,0,function(e){A(e.toBlob)?e.toBlob(function(e){a.default.saveAs(e,t)}):f(e.toDataURL("image/png"),t)})}(this.getUri(t),n)}}]),e}();t.default=m,e.exports=t.default},,function(e,t,n){},,function(e,t,n){},function(e,t,n){"use strict";(function(e){n(0),n(0),n(353),n(0),n(351);var t=n(1),r=n(346),o=n(139);n(126);var i=n(38);(0,t.cleanup)(),e.ajax({url:window.location.protocol+"//"+window.location.host+"/"+window.location.pathname.split("/")[1]+"/php/queryAvailableCohorts.php",type:"GET",dataType:"json",success:function(t){t.forEach(function(t){"references"!==t&&e("#cohortSelector").append("<option value="+t+">"+t+"</option>")})}});var a=new o.References;(new i.DistanceMeasures).realValidMetrics.forEach(function(t){e("#heatmapDistanceSelector").append("<option value="+t+">"+t+"</option>"),e("#UMAPDistanceSelector").append("<option value="+t+">"+t+"</option>"),e("#FlexibleClusteringDistanceSelector").append("<option value="+t+">"+t+"</option>")});for(var s=6;s<53;++s)12!==s?e("#fontSizeSelector").append("<option value="+s+">"+s+"</option>"):e("#fontSizeSelector").append("<option value="+s+" selected>"+s+"</option>");for(var l=23;l>=1;--l)e("#chromosomalSizeControls").prepend('<div class="input-group"><label for="coeff'+l+'" class="col-form-label" id="coeff'+l+'Label">'+l+': </label> <input type="number" id="coeff'+l+'" name="coeff'+l+'" data-provide="slider" data-slider-min="0" data-slider-max="27" data-slider-step="1" data-slider-value="7" data-slider-tooltip="hide" data-slider-orientation="horizontal"></div><br/>');window.cohortDump=[],e("#vdjTraModeGroup").css("display","none"),e("#cohortSelector").on("change",function(){"Select Cohort"!==this.value&&(window.cohortDump.length>0&&((0,t.transitionToVariantScreen)(window.cohortDump[0].commonSettings),window.cohortDump[0].cleanupCohort(),window.cohortDump.pop()),window.cohortDump.push(new r.Cohort(a,this.value,this.value.includes("_WES"))))})}).call(this,n(0))}]);